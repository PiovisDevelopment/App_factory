[{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\00_archive\\docs\\test-scripts\\verify-eur-1.1.3a.js","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: \"parserOptions.project\" has been provided for @typescript-eslint/parser.\nThe file was not found in any of the provided project(s): 00_archive\\docs\\test-scripts\\verify-eur-1.1.3a.js"}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * EUR-1.1.3a Verification Test\r\n * ============================\r\n * Manual test script to verify AI-generated components use design tokens.\r\n * \r\n * Run this in the Tauri app's DevTools console (press F12).\r\n */\r\n\r\n// Test 1: Check the prompt template contains design tokens\r\nconst checkPromptTemplate = () => {\r\n    console.log('%c=== EUR-1.1.3a Verification ===', 'color: #10b981; font-weight: bold; font-size: 16px;');\r\n\r\n    // Import the design token reference\r\n    import('/src/hooks/useComponentGenerator.ts').then(module => {\r\n        if (module.DESIGN_TOKEN_REFERENCE) {\r\n            console.log('%cÔ£ô DESIGN_TOKEN_REFERENCE is exported', 'color: #10b981;');\r\n            console.log('Design Token Reference:', module.DESIGN_TOKEN_REFERENCE.substring(0, 200) + '...');\r\n        } else {\r\n            console.log('%cÔ£ù DESIGN_TOKEN_REFERENCE not found', 'color: #ef4444;');\r\n        }\r\n    }).catch(err => {\r\n        console.log('%cÔÜá Could not dynamically import (module bundled)', 'color: #f59e0b;');\r\n        console.log('This is expected in production. Test via UI instead.');\r\n    });\r\n};\r\n\r\n// Test 2: Verify via generated code analysis\r\nconst testInstructions = `\r\n%c=== Manual Test Instructions ===\r\n\r\n1. Go to \"Generate\" tab in the sidebar\r\n2. Enter prompt: \"A primary button with hover effect\"\r\n3. Click \"Generate Component\"\r\n4. Check the generated code for:\r\n   \r\n   Ô£ô PASS if code contains:\r\n     - bg-primary-600 or similar primary colors\r\n     - hover:bg-primary-700 for hover effects\r\n     - rounded-md or similar Tailwind classes\r\n   \r\n   Ô£ù FAIL if code contains:\r\n     - style={{ backgroundColor: '...' }}\r\n     - Inline style objects\r\n     - Hardcoded hex colors (#3b82f6)\r\n\r\n5. Report results to the developer\r\n`;\r\n\r\nconsole.log(testInstructions, 'color: #0ea5e9; font-size: 14px;');\r\n\r\n// Run the check\r\ncheckPromptTemplate();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\debug_eslint.mjs","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: \"parserOptions.project\" has been provided for @typescript-eslint/parser.\nThe file was not found in any of the provided project(s): debug_eslint.mjs"}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import reactHooks from 'eslint-plugin-react-hooks';\r\n\r\nconsole.log('Keys:', Object.keys(reactHooks));\r\nif (reactHooks.configs) {\r\n    console.log('Configs:', Object.keys(reactHooks.configs));\r\n    if (reactHooks.configs.flat) {\r\n        console.log('Has Flat Config:', Object.keys(reactHooks.configs.flat));\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\eslint.config.mjs","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: \"parserOptions.project\" has been provided for @typescript-eslint/parser.\nThe file was not found in any of the provided project(s): eslint.config.mjs"}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import js from '@eslint/js';\r\nimport tseslint from 'typescript-eslint';\r\nimport reactPlugin from 'eslint-plugin-react';\r\nimport reactHooksPlugin from 'eslint-plugin-react-hooks';\r\nimport globals from 'globals';\r\n\r\nexport default tseslint.config(\r\n    {\r\n        ignores: ['dist/**', 'node_modules/**', 'docs/**', 'src-tauri/**'],\r\n    },\r\n    {\r\n        // 1. Setup: Parser & Globals\r\n        files: ['**/*.{js,mjs,cjs,ts,jsx,tsx}'],\r\n        languageOptions: {\r\n            ecmaVersion: 2020,\r\n            globals: {\r\n                ...globals.browser,\r\n                ...globals.node, // For PostCSS/Tailwind configs\r\n            },\r\n            parser: tseslint.parser,\r\n            parserOptions: {\r\n                project: './tsconfig.eslint.json',\r\n                tsconfigRootDir: import.meta.dirname,\r\n            },\r\n        },\r\n        plugins: {\r\n            react: reactPlugin,\r\n            'react-hooks': reactHooksPlugin,\r\n        },\r\n        settings: {\r\n            react: {\r\n                version: '18.3',\r\n            },\r\n        },\r\n\r\n        // 2. Base Rules (Recommended Types)\r\n        extends: [\r\n            js.configs.recommended,\r\n            ...tseslint.configs.recommendedTypeChecked,\r\n            // STRICT correctness, no stylistic fluff\r\n            ...tseslint.configs.strictTypeChecked,\r\n            ...tseslint.configs.stylisticTypeChecked,\r\n        ],\r\n\r\n        // 3. User-Directed Overrides (No Style, No Defaults)\r\n        rules: {\r\n            // REACT: Core correctness\r\n            ...reactPlugin.configs.flat.recommended.rules,\r\n            ...reactPlugin.configs.flat['jsx-runtime'].rules,\r\n\r\n            // HOOKS: Critical for Zustand/React interaction\r\n            // v7.0.1+ Native Flat Config\r\n            ...reactHooksPlugin.configs.flat.recommended.rules,\r\n\r\n            // TYPESCRIPT: Adjustments for \"No auto-fix assumptions\"\r\n            '@typescript-eslint/no-unused-vars': [\r\n                'error',\r\n                { argsIgnorePattern: '^_', varsIgnorePattern: '^_' }\r\n            ],\r\n            '@typescript-eslint/consistent-type-definitions': 'off', // Stylistic choice, disabling\r\n            '@typescript-eslint/no-empty-interface': 'off', // Common in placeholder components\r\n\r\n            // PROJECT SPECIFIC: Disable stylistic rules that might be in stylisticTypeChecked\r\n            // We want semantic correctness ONLY.\r\n            '@typescript-eslint/prefer-nullish-coalescing': 'error',\r\n            '@typescript-eslint/prefer-optional-chain': 'error',\r\n\r\n            // Ensure specific floating promises are handled (Reduces flaky async behavior)\r\n            '@typescript-eslint/no-floating-promises': 'error',\r\n            '@typescript-eslint/await-thenable': 'error',\r\n\r\n            // BROWNFIELD: Fire-and-forget patterns are intentional\r\n            '@typescript-eslint/no-confusing-void-expression': 'off',\r\n\r\n            // DISABLING formatting/style rules (Prettier/Oxlint territory)\r\n            'indent': 'off',\r\n            'quotes': 'off',\r\n            'semi': 'off',\r\n            'jsx-quotes': 'off',\r\n            'react/jsx-indent': 'off',\r\n            'max-len': 'off',\r\n        },\r\n    },\r\n    {\r\n        // Config files: Disable type checking\r\n        files: ['postcss.config.js', 'tailwind.config.js', 'vite.config.ts'],\r\n        extends: [tseslint.configs.disableTypeChecked],\r\n        languageOptions: {\r\n            parserOptions: {\r\n                project: null\r\n            }\r\n        },\r\n        rules: {\r\n            '@typescript-eslint/no-var-requires': 'off'\r\n        }\r\n    }\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\scripts\\capture_ui.js","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: \"parserOptions.project\" has been provided for @typescript-eslint/parser.\nThe file was not found in any of the provided project(s): scripts\\capture_ui.js"}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * scripts/capture_ui.js\r\n * Automates screenshot capture for App Factory documentation using Puppeteer.\r\n */\r\n\r\nimport puppeteer from 'puppeteer';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { fileURLToPath } from 'url';\r\n\r\nconst __filename = fileURLToPath(import.meta.url);\r\nconst __dirname = path.dirname(__filename);\r\n\r\n// Configuration\r\nconst BASE_URL = 'http://localhost:1420';\r\nconst OUTPUT_DIR = path.join(__dirname, '../docs/App_factory_code_refs/images');\r\nconst VIEWPORT = { width: 1920, height: 1080 };\r\n\r\n// Ensure output directory exists\r\nif (!fs.existsSync(OUTPUT_DIR)) {\r\n    fs.mkdirSync(OUTPUT_DIR, { recursive: true });\r\n}\r\n\r\n(async () => {\r\n    console.log('­ƒÜÇ Starting UI Capture...');\r\n\r\n    const browser = await puppeteer.launch({\r\n        headless: \"new\",\r\n        defaultViewport: VIEWPORT,\r\n        args: ['--no-sandbox', '--disable-setuid-sandbox']\r\n    });\r\n\r\n    const page = await browser.newPage();\r\n\r\n    // 2. Define Capture Function with Metadata Extraction\r\n    const captureState = async (stateName, actions = async () => { }) => {\r\n        console.log(`\\n­ƒô© Capturing State: ${stateName}`);\r\n\r\n        // Perform actions (navigation, clicks)\r\n        await actions();\r\n\r\n        // Wait for potential animations\r\n        await new Promise(r => setTimeout(r, 1000));\r\n\r\n        // Find all elements with data-ui-ref\r\n        const uiRefs = await page.evaluate(() => {\r\n            const elements = document.querySelectorAll('[data-ui-ref]');\r\n            const map = {};\r\n            elements.forEach(el => {\r\n                const rect = el.getBoundingClientRect();\r\n                const id = el.getAttribute('data-ui-ref');\r\n                // Only save if visible (width/height > 0)\r\n                if (rect.width > 0 && rect.height > 0) {\r\n                    map[id] = {\r\n                        x: rect.x,\r\n                        y: rect.y,\r\n                        width: rect.width,\r\n                        height: rect.height,\r\n                        label: id\r\n                    };\r\n                }\r\n            });\r\n            return map;\r\n        });\r\n\r\n        console.log(`   Found ${Object.keys(uiRefs).length} UI references.`);\r\n\r\n        // Take Screenshot\r\n        const screenshotFilename = `state_${stateName}.webp`;\r\n        await page.screenshot({\r\n            path: path.join(OUTPUT_DIR, screenshotFilename),\r\n            type: 'webp',\r\n            quality: 90\r\n        });\r\n\r\n        return {\r\n            image: screenshotFilename,\r\n            refs: uiRefs\r\n        };\r\n    };\r\n\r\n    const manifest = {\r\n        generatedAt: new Date().toISOString(),\r\n        states: []\r\n    };\r\n\r\n    try {\r\n        // 1. Initial Load\r\n        console.log(`Navigating to ${BASE_URL}...`);\r\n        await page.goto(BASE_URL, { waitUntil: 'networkidle0' });\r\n\r\n        // Wait for render\r\n        await new Promise(r => setTimeout(r, 2000));\r\n\r\n        // 2. Handle Launcher (transition to Editor)\r\n        // Check for \"App Factory\" or \"Projects\" which indicates Launcher\r\n        const isLauncher = await page.evaluate(() => {\r\n            const h1 = document.querySelector('h1');\r\n            return h1 && h1.innerText.includes('App Factory');\r\n        });\r\n\r\n        if (isLauncher) {\r\n            console.log(\"   Detected Launcher. Searching for 'New Project' button...\");\r\n\r\n            // Use page.evaluate to find the button - Robust and Puppeteer version agnostic\r\n            const buttonFound = await page.evaluate(() => {\r\n                const buttons = Array.from(document.querySelectorAll('button'));\r\n                const target = buttons.find(b => b.innerText.includes(\"New Project\"));\r\n                if (target) {\r\n                    target.click();\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n\r\n            if (buttonFound) {\r\n                console.log(\"   Clicked 'New Project'. Waiting for Editor transition...\");\r\n\r\n                // Wait specifically for the header which has the data-ui-ref we added\r\n                try {\r\n                    await page.waitForSelector('[data-ui-ref=\"layout-header\"]', { timeout: 10000 });\r\n                    console.log(\"   Ô£à Editor loaded successfully.\");\r\n                } catch (e) {\r\n                    console.warn(\"   ÔÜá´©Å Timed out waiting for Editor layout selector.\");\r\n                }\r\n            } else {\r\n                console.error(\"   ÔØî Could not find 'New Project' button.\");\r\n                // Try fallback: finding ANY button with 'New' or 'Project'\r\n                const fallbackClicked = await page.evaluate(() => {\r\n                    const buttons = Array.from(document.querySelectorAll('button'));\r\n                    const fb = buttons.find(b => b.innerText.includes('New')) || buttons[0];\r\n                    if (fb) { fb.click(); return true; }\r\n                    return false;\r\n                });\r\n                if (fallbackClicked) {\r\n                    console.log(\"   Attempting fallback click on first button found...\");\r\n                    await new Promise(r => setTimeout(r, 2000));\r\n                }\r\n            }\r\n        } else {\r\n            console.log(\"   Already in Editor (or unknown state).\");\r\n        }\r\n\r\n        // Give it a moment to settle\r\n        await new Promise(r => setTimeout(r, 2000));\r\n\r\n        // 3. Capture States\r\n\r\n        // State: Main Layout\r\n        manifest.states.push({\r\n            id: \"main_layout\",\r\n            title: \"Main Layout\",\r\n            data: await captureState('main_layout')\r\n        });\r\n\r\n        // State: Components Tab\r\n        console.log(\"   Switching to Components Tab...\");\r\n        const compTabClicked = await page.evaluate(() => {\r\n            const buttons = Array.from(document.querySelectorAll('button'));\r\n            // Looking for \"Comp\" tab (title=\"Comp\" or text=\"Comp\")\r\n            const compBtn = buttons.find(b => b.title === 'Comp' || b.innerText.includes('Comp'));\r\n            if (compBtn) {\r\n                compBtn.click();\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n\r\n        if (compTabClicked) {\r\n            manifest.states.push({\r\n                id: \"tab_components\",\r\n                title: \"Components Panel\",\r\n                data: await captureState('tab_components')\r\n            });\r\n        }\r\n\r\n        // Capture Settings Modal\r\n        console.log(\"   Opening Settings...\");\r\n        const settingsClicked = await page.evaluate(() => {\r\n            const buttons = Array.from(document.querySelectorAll('button'));\r\n            // Assuming settings icon button or title=\"Settings\"\r\n            const settingsBtn = buttons.find(b => b.title === 'Settings');\r\n            if (settingsBtn) {\r\n                settingsBtn.click();\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n\r\n        if (settingsClicked) {\r\n            manifest.states.push({\r\n                id: \"modal_settings\",\r\n                title: \"Settings Modal\",\r\n                data: await captureState('modal_settings')\r\n            });\r\n            // Close modal\r\n            await page.keyboard.press('Escape');\r\n        }\r\n\r\n        // Save Manifest\r\n        fs.writeFileSync(path.join(OUTPUT_DIR, 'ui_manifest.json'), JSON.stringify(manifest, null, 2));\r\n        console.log(`Ô£à Manifest saved to ui_manifest.json`);\r\n\r\n    } catch (error) {\r\n        console.error('ÔØî Error during capture:', error);\r\n    } finally {\r\n        await browser.close();\r\n        console.log('Ô£à Capture complete.');\r\n    }\r\n})();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\scripts\\generate_docs_images.js","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: \"parserOptions.project\" has been provided for @typescript-eslint/parser.\nThe file was not found in any of the provided project(s): scripts\\generate_docs_images.js"}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * scripts/generate_docs_images.js\r\n * Generates annotated screenshots for the Visual UI Dictionary.\r\n * Version 2.0 - Robust Selectors & Overlays\r\n */\r\n\r\nimport puppeteer from 'puppeteer';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { fileURLToPath } from 'url';\r\n\r\nconst __filename = fileURLToPath(import.meta.url);\r\nconst __dirname = path.dirname(__filename);\r\n\r\nconst BASE_URL = 'http://localhost:1420';\r\nconst OUTPUT_DIR = path.join(__dirname, '../docs/App_factory_code_refs/images');\r\nconst VIEWPORT = { width: 1920, height: 1080 };\r\n\r\n// COLORS\r\nconst COLORS = {\r\n    RED: 'rgba(239, 68, 68, 0.5)',    // red-500\r\n    BLUE: 'rgba(59, 130, 246, 0.5)',   // blue-500\r\n    GREEN: 'rgba(34, 197, 94, 0.5)',   // green-500\r\n    ORANGE: 'rgba(249, 115, 22, 0.5)', // orange-500\r\n};\r\n\r\n// Ensure output directory\r\nif (!fs.existsSync(OUTPUT_DIR)) {\r\n    fs.mkdirSync(OUTPUT_DIR, { recursive: true });\r\n}\r\n\r\n(async () => {\r\n    console.log('­ƒÜÇ Starting Robust UI Asset Generation...');\r\n    const browser = await puppeteer.launch({\r\n        headless: \"new\",\r\n        defaultViewport: VIEWPORT,\r\n        args: ['--no-sandbox', '--disable-setuid-sandbox']\r\n    });\r\n\r\n    const page = await browser.newPage();\r\n\r\n    // --- Helper: Highlight Function injected into page ---\r\n    const injectHighlighter = async () => {\r\n        await page.addStyleTag({\r\n            content: `\r\n                .docs-highlight-overlay {\r\n                    position: absolute;\r\n                    z-index: 99999;\r\n                    pointer-events: none;\r\n                    border: 4px solid;\r\n                    background-color: rgba(255, 255, 255, 0.1);\r\n                    border-radius: 4px;\r\n                    box-shadow: 0 0 10px rgba(0,0,0,0.3);\r\n                }\r\n                .docs-highlight-label {\r\n                    position: absolute;\r\n                    top: -24px;\r\n                    left: 0;\r\n                    background: #000;\r\n                    color: #fff;\r\n                    padding: 2px 8px;\r\n                    font-size: 12px;\r\n                    border-radius: 4px;\r\n                    white-space: nowrap;\r\n                }\r\n            `\r\n        });\r\n    };\r\n\r\n    // --- Helper: Draw Box ---\r\n    const highlight = async (selector, type = 'selector', color = COLORS.BLUE, label = '') => {\r\n        return page.evaluate((sel, t, col, lbl) => {\r\n            let el;\r\n            if (t === 'selector') {\r\n                el = document.querySelector(sel);\r\n            } else if (t === 'text') {\r\n                // Find element containing text\r\n                const all = Array.from(document.querySelectorAll('button, h2, h3, label, span, div'));\r\n                el = all.find(e => e.innerText && e.innerText.includes(sel) && e.offsetParent !== null);\r\n            } else if (t === 'selector-text') {\r\n                // specific selector containing text\r\n                const [css, text] = sel.split('::text=');\r\n                const candidates = Array.from(document.querySelectorAll(css));\r\n                el = candidates.find(e => e.innerText.includes(text));\r\n            }\r\n\r\n            if (el) {\r\n                const rect = el.getBoundingClientRect();\r\n                const overlay = document.createElement('div');\r\n                overlay.className = 'docs-highlight-overlay';\r\n                overlay.style.left = rect.left + 'px';\r\n                overlay.style.top = rect.top + 'px';\r\n                overlay.style.width = rect.width + 'px';\r\n                overlay.style.height = rect.height + 'px';\r\n                overlay.style.borderColor = col;\r\n\r\n                if (lbl) {\r\n                    const labelDiv = document.createElement('div');\r\n                    labelDiv.className = 'docs-highlight-label';\r\n                    labelDiv.innerText = lbl;\r\n                    labelDiv.style.backgroundColor = col.replace('0.5', '1');\r\n                    overlay.appendChild(labelDiv);\r\n                }\r\n\r\n                document.body.appendChild(overlay);\r\n                return true;\r\n            }\r\n            return false;\r\n        }, selector, type, color, label);\r\n    };\r\n\r\n    const clearHighlights = async () => {\r\n        await page.evaluate(() => {\r\n            const overlays = document.querySelectorAll('.docs-highlight-overlay');\r\n            overlays.forEach(el => el.remove());\r\n        });\r\n    };\r\n\r\n    try {\r\n        await injectHighlighter();\r\n\r\n        // --- 1. Launcher Capture ---\r\n        console.log(`Navigating to ${BASE_URL}...`);\r\n        await page.goto(BASE_URL, { waitUntil: 'networkidle0' });\r\n        await new Promise(r => setTimeout(r, 2000));\r\n\r\n        const isLauncher = await page.evaluate(() =>\r\n            document.querySelector('h1')?.innerText.includes('App Factory')\r\n        );\r\n\r\n        if (isLauncher) {\r\n            console.log(\"   ­ƒô© Capturing Launcher...\");\r\n            await highlight('New Project', 'text', COLORS.BLUE, 'New Project Button');\r\n            await highlight('Recent Projects', 'text', COLORS.GREEN, 'Recent Projects');\r\n            // Try to highlight the grid below Recent Projects\r\n            await page.evaluate(() => {\r\n                const h2 = Array.from(document.querySelectorAll('h2')).find(h => h.innerText.includes('Recent Projects'));\r\n                if (h2 && h2.nextElementSibling) {\r\n                    const grid = h2.nextElementSibling;\r\n                    const rect = grid.getBoundingClientRect();\r\n                    // Manually add overlay if standard highlight doesn't work well for siblings\r\n                }\r\n            });\r\n\r\n            await page.screenshot({ path: path.join(OUTPUT_DIR, 'launcher_annotated.webp'), type: 'webp' });\r\n            await clearHighlights();\r\n\r\n            // Enter Editor\r\n            await page.evaluate(() => {\r\n                Array.from(document.querySelectorAll('button'))\r\n                    .find(b => b.innerText.includes(\"New Project\"))?.click();\r\n            });\r\n            await new Promise(r => setTimeout(r, 2000));\r\n        }\r\n\r\n        // --- 2. Main Layout ---\r\n        console.log(\"   Waiting for Editor...\");\r\n        await page.waitForSelector('[data-ui-ref=\"layout-header\"]', { timeout: 10000 });\r\n        await new Promise(r => setTimeout(r, 1000));\r\n        await injectHighlighter(); // Re-inject styles after nav\r\n\r\n        console.log(\"   ­ƒô© Capturing Main Layout...\");\r\n        await highlight('[data-ui-ref=\"layout-header\"]', 'selector', COLORS.RED, 'Header');\r\n        await highlight('[data-ui-ref=\"layout-sidebar-left\"]', 'selector', COLORS.BLUE, 'Left Sidebar');\r\n        await highlight('[data-ui-ref=\"layout-center-canvas\"]', 'selector', COLORS.GREEN, 'Canvas');\r\n        await highlight('[data-ui-ref=\"layout-sidebar-right\"]', 'selector', COLORS.BLUE, 'Right Sidebar');\r\n\r\n        await page.screenshot({ path: path.join(OUTPUT_DIR, 'main_layout_annotated.webp'), type: 'webp' });\r\n        await clearHighlights();\r\n\r\n        // --- 3. Components Panel ---\r\n        console.log(\"   ­ƒô© Capturing Components Panel...\");\r\n        // Click Tab\r\n        await page.evaluate(() => {\r\n            const sidebar = document.querySelector('[data-ui-ref=\"layout-sidebar-left\"]');\r\n            if (sidebar) {\r\n                // Look for button with text \"Comp\" (abbreviation used in App.tsx)\r\n                const btn = Array.from(sidebar.querySelectorAll('button'))\r\n                    .find(b => b.textContent.trim() === 'Comp');\r\n                if (btn) btn.click();\r\n            }\r\n        });\r\n        await new Promise(r => setTimeout(r, 2000));\r\n\r\n        // Highlight \"New Component\" button\r\n        await highlight('New Component', 'text', COLORS.BLUE, 'AI Generator');\r\n        // Highlight Component Grid\r\n        await page.evaluate((col) => {\r\n            const btn = Array.from(document.querySelectorAll('button'))\r\n                .find(b => b.textContent.includes('New Component'));\r\n            if (btn && btn.nextElementSibling) {\r\n                const rect = btn.nextElementSibling.getBoundingClientRect();\r\n                const overlay = document.createElement('div');\r\n                overlay.className = 'docs-highlight-overlay';\r\n                overlay.style.left = rect.left + 'px';\r\n                overlay.style.top = rect.top + 'px';\r\n                overlay.style.width = rect.width + 'px';\r\n                overlay.style.height = rect.height + 'px';\r\n                overlay.style.borderColor = col;\r\n                document.body.appendChild(overlay);\r\n\r\n                // Add label for grid\r\n                const label = document.createElement('div');\r\n                label.className = 'docs-highlight-label';\r\n                label.innerText = 'Component Library';\r\n                label.style.backgroundColor = col.replace('0.5', '1');\r\n                overlay.appendChild(label);\r\n            }\r\n        }, COLORS.GREEN);\r\n\r\n        await page.screenshot({ path: path.join(OUTPUT_DIR, 'tab_components_annotated.webp'), type: 'webp' });\r\n        await clearHighlights();\r\n\r\n        // --- 4. Plugins Panel ---\r\n        console.log(\"   ­ƒô© Capturing Plugins Panel...\");\r\n        await page.evaluate(() => {\r\n            const sidebar = document.querySelector('[data-ui-ref=\"layout-sidebar-left\"]');\r\n            if (sidebar) {\r\n                // Look for button with text \"Plug\" (abbreviation used in App.tsx)\r\n                const btn = Array.from(sidebar.querySelectorAll('button'))\r\n                    .find(b => b.textContent.trim() === 'Plug');\r\n                if (btn) btn.click();\r\n            }\r\n        });\r\n        await new Promise(r => setTimeout(r, 2000));\r\n\r\n        // Highlight Filters button (Note: Filter button text is inside PluginGallery, may vary)\r\n        // PluginGallery has \"Filters\" text button only if showFilters is true?\r\n        // App.tsx passes `showViewToggle={false}` to PluginGallery.\r\n        // Let's check PluginGallery source if needed, but for now we look for ANY button in the gallery header.\r\n        // Actually, App.tsx renders: <PluginGallery ... />\r\n\r\n        // Highlight First Plugin Card (more specific selector)\r\n        await page.evaluate((col, colOrange) => {\r\n            // 1. Highlight Plugin Cards\r\n            const sidebar = document.querySelector('[data-ui-ref=\"layout-sidebar-left\"]');\r\n            if (sidebar) {\r\n                const cards = Array.from(sidebar.querySelectorAll('div[title]'));\r\n                const validCard = cards.find(c => c.getBoundingClientRect().height > 40);\r\n\r\n                if (validCard) {\r\n                    const rect = validCard.getBoundingClientRect();\r\n                    const overlay = document.createElement('div');\r\n                    overlay.className = 'docs-highlight-overlay';\r\n                    overlay.style.left = rect.left + 'px';\r\n                    overlay.style.top = rect.top + 'px';\r\n                    overlay.style.width = rect.width + 'px';\r\n                    overlay.style.height = rect.height + 'px';\r\n                    overlay.style.borderColor = col;\r\n                    document.body.appendChild(overlay);\r\n\r\n                    const label = document.createElement('div');\r\n                    label.className = 'docs-highlight-label';\r\n                    label.innerText = 'Plugin Card';\r\n                    label.style.backgroundColor = col.replace('0.5', '1');\r\n                    overlay.appendChild(label);\r\n                }\r\n\r\n                // 2. Highlight Category Filter Header (if present, usually \"Showing: ...\")\r\n                const filterHeader = Array.from(sidebar.querySelectorAll('div')).find(d => d.textContent.includes('Showing:'));\r\n                if (filterHeader) {\r\n                    const rect = filterHeader.getBoundingClientRect();\r\n                    const overlay = document.createElement('div');\r\n                    overlay.className = 'docs-highlight-overlay';\r\n                    overlay.style.left = rect.left + 'px';\r\n                    overlay.style.top = rect.top + 'px';\r\n                    overlay.style.width = rect.width + 'px';\r\n                    overlay.style.height = rect.height + 'px';\r\n                    overlay.style.borderColor = colOrange;\r\n                    document.body.appendChild(overlay);\r\n\r\n                    const label = document.createElement('div');\r\n                    label.className = 'docs-highlight-label';\r\n                    label.innerText = 'Active Filters';\r\n                    label.style.backgroundColor = colOrange.replace('0.5', '1');\r\n                    overlay.appendChild(label);\r\n                }\r\n            }\r\n        }, COLORS.BLUE, COLORS.ORANGE);\r\n\r\n        await page.screenshot({ path: path.join(OUTPUT_DIR, 'tab_plugins_annotated.webp'), type: 'webp' });\r\n        await clearHighlights();\r\n\r\n        // --- 5. Settings Modal ---\r\n        console.log(\"   ­ƒô© Capturing Settings Modal...\");\r\n        // Open Settings\r\n        await page.evaluate(() => {\r\n            Array.from(document.querySelectorAll('button'))\r\n                .find(b => b.title === 'Settings' || b.innerText === 'Settings')?.click();\r\n        });\r\n        await new Promise(r => setTimeout(r, 1000));\r\n\r\n        // Precise section highlighting\r\n        await highlight('label::text=LLM Provider', 'selector-text', COLORS.RED, 'Select Provider');\r\n        await highlight('label::text=Model', 'selector-text', COLORS.RED, 'Select Model');\r\n        await highlight('textarea#systemPrompt', 'selector', COLORS.GREEN, 'System Prompt Area');\r\n        await highlight('button::text=Test Connection', 'selector-text', COLORS.BLUE, 'Connection Test');\r\n\r\n        await page.screenshot({ path: path.join(OUTPUT_DIR, 'modal_settings_annotated.webp'), type: 'webp' });\r\n        await clearHighlights();\r\n        // Close modal\r\n        await page.keyboard.press('Escape');\r\n\r\n    } catch (error) {\r\n        console.error(\"ÔØî Error:\", error);\r\n    } finally {\r\n        await browser.close();\r\n        console.log('Ô£à Robust Generation complete.');\r\n    }\r\n})();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\App.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":826,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":826,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[28461,28463],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":827,"column":43,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":827,"endColumn":45,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[28532,28534],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":838,"column":68,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":838,"endColumn":70,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[28953,28955],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":904,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":904,"endColumn":37},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":904,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":904,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31241,31244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31241,31244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":914,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":914,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":914,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":914,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31512,31515],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31512,31515],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":924,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":924,"endColumn":38},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":924,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":924,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31782,31785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31782,31785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":991,"column":43,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":991,"endColumn":45,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[34520,34522],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":991,"column":85,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":991,"endColumn":87,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[34562,34564],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":993,"column":50,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":993,"endColumn":52,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[34658,34660],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":994,"column":46,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":994,"endColumn":48,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[34724,34726],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":995,"column":57,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":995,"endColumn":59,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[34802,34804],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":996,"column":57,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":996,"endColumn":59,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[34886,34888],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":998,"column":40,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":998,"endColumn":59},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1002,"column":47,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1002,"endColumn":69},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":1024,"column":5,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":1024,"endColumn":20,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[35802,35802],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[35802,35802],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":1148,"column":28,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":1148,"endColumn":33,"fix":{"range":[40461,40501],"text":"/(?:const|function)\\s+(\\w+)/.exec(code)"}},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1149,"column":42,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1149,"endColumn":44,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[40544,40546],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1149,"column":60,"nodeType":"CallExpression","messageId":"invalidType","endLine":1149,"endColumn":70},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1152,"column":36,"nodeType":"CallExpression","messageId":"invalidType","endLine":1152,"endColumn":46},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1165,"column":22,"nodeType":"CallExpression","messageId":"invalidType","endLine":1165,"endColumn":32},{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":1188,"column":58,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":1193,"endColumn":5,"fix":{"range":[41822,41937],"text":"{\n    elementId?: string;\n    action?: 'add' | 'update' | 'delete';\n    name?: string;\n    code: string;\n  }[]"}},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"string | undefined\" of template literal expression.","line":1200,"column":70,"nodeType":"LogicalExpression","messageId":"invalidType","endLine":1200,"endColumn":101},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1200,"column":82,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1200,"endColumn":84,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[42313,42315],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1262,"column":29,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1262,"endColumn":31,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[45106,45108],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1262,"column":47,"nodeType":"CallExpression","messageId":"invalidType","endLine":1262,"endColumn":57},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1272,"column":26,"nodeType":"CallExpression","messageId":"invalidType","endLine":1272,"endColumn":36},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1309,"column":13,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1309,"endColumn":30},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1335,"column":44,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1335,"endColumn":46,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[47555,47557],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1379,"column":11,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1379,"endColumn":22},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1389,"column":11,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1389,"endColumn":31},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1428,"column":22,"nodeType":"CallExpression","messageId":"invalidType","endLine":1428,"endColumn":32},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'windowConfig.height' and 'windowConfig.width'. Either include them or remove the dependency array.","line":1441,"column":6,"nodeType":"ArrayExpression","endLine":1441,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [canvasElements.length, windowConfig.height, windowConfig.width]","fix":{"range":[51161,51184],"text":"[canvasElements.length, windowConfig.height, windowConfig.width]"}}]},{"ruleId":"@typescript-eslint/require-await","severity":2,"message":"Async arrow function has no 'await' expression.","line":1444,"column":101,"nodeType":"ArrowFunctionExpression","messageId":"missingAwait","endLine":1444,"endColumn":103,"suggestions":[{"messageId":"removeAsync","fix":{"range":[51295,51301],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":1450,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":1450,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1450,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1450,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[51621,51624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[51621,51624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1453,"column":27,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1453,"endColumn":29,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[51766,51768],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1502,"column":19,"nodeType":"CallExpression","messageId":"invalidType","endLine":1502,"endColumn":29},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1603,"column":22,"nodeType":"CallExpression","messageId":"invalidType","endLine":1603,"endColumn":32},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1605,"column":35,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1605,"endColumn":37,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[56661,56663],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `{ id: string; type?: string | undefined; defaultSize?: { width: number; height: number; } | undefined; category?: string | undefined; }`.","line":1610,"column":33,"nodeType":"TSAsExpression","messageId":"unsafeArgument","endLine":1610,"endColumn":56},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1610,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1610,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[56835,56838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[56835,56838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'windowConfig.height' and 'windowConfig.width'. Either include them or remove the dependency array.","line":1616,"column":6,"nodeType":"ArrayExpression","endLine":1616,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [canvasElements.length, windowConfig.height, windowConfig.width]","fix":{"range":[57044,57067],"text":"[canvasElements.length, windowConfig.height, windowConfig.width]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'libraryComponents'. Either exclude it or remove the dependency array.","line":1635,"column":6,"nodeType":"ArrayExpression","endLine":1635,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[57928,57947],"text":"[]"}}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1661,"column":29,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1661,"endColumn":48},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1663,"column":31,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1663,"endColumn":52},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1695,"column":29,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1695,"endColumn":48},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1696,"column":31,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1696,"endColumn":52},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `SetStateAction<\"templates\" | \"containers\" | \"components\" | \"project\" | \"modals\" | \"plugins\" | \"aichat\">`.","line":1726,"column":49,"nodeType":"TSAsExpression","messageId":"unsafeArgument","endLine":1726,"endColumn":62},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1726,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1726,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[62144,62147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[62144,62147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1857,"column":64,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1857,"endColumn":66,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[68782,68784],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1888,"column":32,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1888,"endColumn":53},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1901,"column":32,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1901,"endColumn":53},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1934,"column":65,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1934,"endColumn":67,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[73135,73137],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1934,"column":73,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1934,"endColumn":75,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[73143,73145],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1934,"column":82,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1934,"endColumn":84,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[73152,73154],"text":""},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1936,"column":44,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1936,"endColumn":46,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[73246,73248],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1937,"column":77,"nodeType":"ChainExpression","messageId":"alwaysTruthy","endLine":1937,"endColumn":95},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1937,"column":89,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1937,"endColumn":91,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[73362,73364],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1960,"column":136,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1960,"endColumn":138,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[74723,74725],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2035,"column":60,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2035,"endColumn":62,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[78000,78002],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":2041,"column":57,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":2041,"endColumn":59,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[78278,78280],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":2053,"column":82,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":2053,"endColumn":84,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[78783,78785],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2114,"column":72,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2114,"endColumn":74,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[81553,81616],"text":"(selectedElement.props?.children ?? selectedElement.props?.label)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2114,"column":104,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2114,"endColumn":106,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[81617,81619],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2121,"column":71,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2121,"endColumn":73,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[81966,81968],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2133,"column":69,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2133,"endColumn":71,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[82615,82617],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2144,"column":126,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2144,"endColumn":128,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[83345,83347],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2145,"column":126,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2145,"endColumn":128,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[83513,83515],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2146,"column":126,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2146,"endColumn":128,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[83678,83680],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":2147,"column":137,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":2147,"endColumn":139,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[83850,83852],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":2217,"column":17,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":2217,"endColumn":53,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[86470,86470],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[86470,86470],"text":"await "},"desc":"Add await operator."}]}],"suppressedMessages":[],"errorCount":71,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * B003 - src/App.tsx\n * ==================\n * Root application component with providers and layout.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D018 (ThemeProvider), D049 (FactoryLayout), D040-D048 (Factory components)\n */\n\nimport React, { useState, useCallback, useEffect, useRef } from 'react';\nimport { ThemeProvider, useTheme } from './context/ThemeProvider';\nimport { FactoryLayout } from './components/factory/FactoryLayout';\nimport { PluginGallery, type PluginInfo } from './components/factory/PluginGallery';\nimport { ComponentGallery, type ComponentInfo } from './components/factory/ComponentGallery';\nimport { CanvasEditor, type CanvasElement, type ElementBounds } from './components/factory/CanvasEditor';\nimport { PropertyInspector } from './components/factory/PropertyInspector';\nimport { ProjectLoader, type ProjectInfo } from './components/project/ProjectLoader';\nimport { useProjectStore, type ProjectFile } from './stores/projectStore';\nimport { type ComponentFramework } from './stores/componentLibraryStore';\nimport { isTauri } from './utils/tauriUtils';\nimport { ThemeCustomizationPanel } from './components/ui/ThemeCustomizationPanel';\nimport { WindowConfigPanel, useWindowConfigStore } from './components/ui/WindowConfigPanel';\nimport { Modal } from './components/ui/Modal';\n// ProjectDetailsPanel import removed as it does not exist\n// Sidebar Icons\nconst FolderIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\" />\n  </svg>\n);\nconst ComponentIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n    <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"21\" />\n    <line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\" />\n  </svg>\n);\nconst PluginIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <polygon points=\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\" />\n  </svg>\n);\n// New Icons for Sidebar\nconst LayoutIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n    <path d=\"M3 9h18\" />\n    <path d=\"M9 21V9\" />\n  </svg>\n);\nconst WindowIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n    <path d=\"M3 9h18\" />\n    <path d=\"M9 21V9\" />\n    <rect x=\"7\" y=\"7\" width=\"10\" height=\"10\" />\n  </svg>\n);\n\n// Template Icon for sidebar (EUR-1.1.10)\nconst TemplateIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\n    <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\n  </svg>\n);\n\n// Backend Blueprint Icon (EUR-1.2.10)\nconst BlueprintIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <polygon points=\"12 2 2 7 12 12 22 7 12 2\" />\n    <polyline points=\"2 17 12 22 22 17\" />\n    <polyline points=\"2 12 12 17 22 12\" />\n  </svg>\n);\n\n// Running Man Icon for User Request\nconst RunningIcon = ({ className }: { className?: string }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M18.5 12.5L14.5 16.5L18.5 20.5\" />\n    <circle cx=\"13\" cy=\"4\" r=\"2.5\" />\n    <path d=\"M4 17L9 11L13 14L15 8\" />\n    <path d=\"M13 8H9L5 11\" />\n  </svg>\n);\n\n// PreviewPanel and CanvasPreview removed - Canvas now has device viewport selector\nimport { ComponentGenerator, type GeneratedComponent } from './components/ai/ComponentGenerator';\nimport { useComponentGenerator } from './hooks/useComponentGenerator';\nimport { SettingsPanel } from './components/ui/SettingsPanel';\nimport { useComponentLibraryStore, type ComponentCategory } from './stores/componentLibraryStore';\nimport { ImportWizard, type ComponentManifest } from './components/wizard/ImportWizard';\nimport { registerComponent } from './utils/ComponentRegistry';\nimport { MuiButtonAdapter, DashboardStatsBlock, GitHubRepoPreview } from './components/external/ExternalWrappers';\nimport { TemplateBrowser } from './components/templates/TemplateBrowser';\nimport { BackendBlueprintPanel, type PluginSlot } from './components/factory/BackendBlueprintPanel';\nimport { AiTeamVisualization } from './components/ai/AiTeamVisualization';\nimport { PluginConfigPanel, type PluginConfigOption } from './components/factory/PluginConfigPanel';\n\nimport { AiAppChatPanel, AiAppChatIcon } from './components/ai/AiAppChatPanel';\n\n/**\n * Application mode type.\n * - launcher: Shows project selection screen\n * - editor: Shows the factory editor interface\n */\ntype AppMode = 'launcher' | 'editor';\n\n/**\n * Extended PluginInfo with configuration options.\n */\ninterface PluginInfoWithConfig extends PluginInfo {\n  config?: PluginConfigOption[];\n}\n\n/**\n * Sample plugin data for demonstration.\n */\nconst samplePlugins: PluginInfoWithConfig[] = [\n  {\n    id: 'tts_kokoro',\n    name: 'Kokoro TTS',\n    version: '1.0.0',\n    description: 'High-quality text-to-speech using Kokoro model',\n    contract: 'tts',\n    status: 'unloaded',\n    author: 'Piovis',\n    builtIn: true,\n    tags: ['voice', 'speech', 'synthesis'],\n    config: [\n      {\n        key: 'voice',\n        label: 'Voice Model',\n        type: 'select',\n        value: 'af_sky',\n        defaultValue: 'af_sky',\n        description: 'The voice model to use for speech synthesis',\n        options: [\n          { value: 'af_sky', label: 'Sky (Female, American)' },\n          { value: 'af_bella', label: 'Bella (Female, American)' },\n          { value: 'am_adam', label: 'Adam (Male, American)' },\n          { value: 'bf_emma', label: 'Emma (Female, British)' },\n        ],\n      },\n      {\n        key: 'speed',\n        label: 'Speed',\n        type: 'number',\n        value: 1.0,\n        defaultValue: 1.0,\n        description: 'Speech speed multiplier (0.5 - 2.0)',\n        validation: { min: 0.5, max: 2.0 },\n      },\n    ],\n  },\n  {\n    id: 'stt_whisper',\n    name: 'Whisper STT',\n    version: '1.2.0',\n    description: 'Speech-to-text using OpenAI Whisper',\n    contract: 'stt',\n    status: 'unloaded',\n    author: 'Piovis',\n    builtIn: true,\n    tags: ['voice', 'transcription', 'recognition'],\n    config: [\n      {\n        key: 'model',\n        label: 'Model Size',\n        type: 'select',\n        value: 'base',\n        defaultValue: 'base',\n        description: 'Whisper model size (larger = more accurate but slower)',\n        options: [\n          { value: 'tiny', label: 'Tiny (~39M params)' },\n          { value: 'base', label: 'Base (~74M params)' },\n          { value: 'small', label: 'Small (~244M params)' },\n          { value: 'medium', label: 'Medium (~769M params)' },\n          { value: 'large-v3', label: 'Large v3 (~1.5B params)' },\n        ],\n      },\n      {\n        key: 'language',\n        label: 'Language',\n        type: 'select',\n        value: 'en',\n        defaultValue: 'en',\n        description: 'Transcription language',\n        options: [\n          { value: 'en', label: 'English' },\n          { value: 'auto', label: 'Auto-detect' },\n          { value: 'es', label: 'Spanish' },\n          { value: 'fr', label: 'French' },\n          { value: 'de', label: 'German' },\n        ],\n      },\n      {\n        key: 'useGpu',\n        label: 'Use GPU Acceleration',\n        type: 'boolean',\n        value: true,\n        defaultValue: true,\n        description: 'Enable CUDA acceleration for faster transcription',\n      },\n    ],\n  },\n  {\n    id: 'llm_ollama',\n    name: 'Ollama LLM',\n    version: '2.0.0',\n    description: 'Local LLM inference via Ollama',\n    contract: 'llm',\n    status: 'unloaded',\n    author: 'Piovis',\n    builtIn: true,\n    tags: ['ai', 'inference', 'local'],\n    config: [\n      {\n        key: 'model',\n        label: 'Model Name',\n        type: 'select',\n        value: 'llama3.2',\n        defaultValue: 'llama3.2',\n        description: 'The LLM model to use for inference',\n        options: [\n          { value: 'llama3.2', label: 'Llama 3.2' },\n          { value: 'llama3.1', label: 'Llama 3.1' },\n          { value: 'codellama', label: 'Code Llama' },\n          { value: 'mistral', label: 'Mistral' },\n          { value: 'phi3', label: 'Phi-3' },\n        ],\n      },\n      {\n        key: 'baseUrl',\n        label: 'Ollama Server URL',\n        type: 'string',\n        value: 'http://localhost:11434',\n        defaultValue: 'http://localhost:11434',\n        description: 'URL of the Ollama server',\n      },\n      {\n        key: 'temperature',\n        label: 'Temperature',\n        type: 'number',\n        value: 0.7,\n        defaultValue: 0.7,\n        description: 'Sampling temperature (0 = deterministic, 2 = creative)',\n        validation: { min: 0, max: 2 },\n      },\n      {\n        key: 'maxTokens',\n        label: 'Max Tokens',\n        type: 'number',\n        value: 2048,\n        defaultValue: 2048,\n        description: 'Maximum tokens to generate',\n        validation: { min: 1, max: 32768 },\n      },\n    ],\n  },\n  {\n    id: 'mem_chromadb',\n    name: 'ChromaDB Memory',\n    version: '1.1.0',\n    description: 'Vector memory storage using ChromaDB',\n    contract: 'memory',\n    status: 'unloaded',\n    author: 'Piovis',\n    tags: ['memory', 'vector', 'embeddings'],\n    config: [\n      {\n        key: 'persistPath',\n        label: 'Storage Path',\n        type: 'path',\n        value: './chroma_db',\n        defaultValue: './chroma_db',\n        description: 'Path to persist the vector database',\n      },\n      {\n        key: 'collectionName',\n        label: 'Collection Name',\n        type: 'string',\n        value: 'default',\n        defaultValue: 'default',\n        description: 'Name of the ChromaDB collection',\n      },\n    ],\n  },\n];\n\n/**\n * Sample UI components for the Component Gallery (UJ-1.1.2).\n */\nconst sampleComponents: ComponentInfo[] = [\n  {\n    id: 'button_primary',\n    name: 'Primary Button',\n    category: 'atoms',\n    type: 'button',\n    description: 'Standard primary action button with hover and focus states',\n    builtIn: true,\n    tags: ['action', 'interactive', 'primary'],\n    version: '1.0.0',\n  },\n  {\n    id: 'button_secondary',\n    name: 'Secondary Button',\n    category: 'atoms',\n    type: 'button',\n    description: 'Secondary action button for less prominent actions',\n    builtIn: true,\n    tags: ['action', 'interactive', 'secondary'],\n    version: '1.0.0',\n  },\n  {\n    id: 'input_text',\n    name: 'Text Input',\n    category: 'atoms',\n    type: 'input',\n    description: 'Single-line text input field with validation support',\n    builtIn: true,\n    tags: ['form', 'input', 'text'],\n    version: '1.0.0',\n  },\n  {\n    id: 'input_textarea',\n    name: 'Text Area',\n    category: 'atoms',\n    type: 'input',\n    description: 'Multi-line text input for longer content',\n    builtIn: true,\n    tags: ['form', 'input', 'multiline'],\n    version: '1.0.0',\n  },\n  {\n    id: 'select_dropdown',\n    name: 'Dropdown Select',\n    category: 'atoms',\n    type: 'select',\n    description: 'Dropdown selection component with search capability',\n    builtIn: true,\n    tags: ['form', 'select', 'dropdown'],\n    version: '1.0.0',\n  },\n  {\n    id: 'checkbox_standard',\n    name: 'Checkbox',\n    category: 'atoms',\n    type: 'checkbox',\n    description: 'Standard checkbox for boolean selections',\n    builtIn: true,\n    tags: ['form', 'checkbox', 'boolean'],\n    version: '1.0.0',\n  },\n  {\n    id: 'card_basic',\n    name: 'Basic Card',\n    category: 'molecules',\n    type: 'card',\n    description: 'Container card with header, body, and footer sections',\n    builtIn: true,\n    tags: ['container', 'content', 'card'],\n    version: '1.0.0',\n  },\n  {\n    id: 'card_media',\n    name: 'Media Card',\n    category: 'molecules',\n    type: 'card',\n    description: 'Card with image/media header and content area',\n    builtIn: true,\n    tags: ['container', 'media', 'image'],\n    version: '1.0.0',\n  },\n  {\n    id: 'panel_collapsible',\n    name: 'Collapsible Panel',\n    category: 'molecules',\n    type: 'panel',\n    description: 'Expandable panel with header toggle',\n    builtIn: true,\n    tags: ['container', 'collapsible', 'accordion'],\n    version: '1.0.0',\n  },\n  {\n    id: 'modal_dialog',\n    name: 'Modal Dialog',\n    category: 'molecules',\n    type: 'modal',\n    description: 'Overlay dialog for confirmations and forms',\n    builtIn: true,\n    tags: ['overlay', 'dialog', 'popup'],\n    version: '1.0.0',\n  },\n  {\n    id: 'list_standard',\n    name: 'Standard List',\n    category: 'molecules',\n    type: 'list',\n    description: 'Vertical list with configurable item rendering',\n    builtIn: true,\n    tags: ['list', 'items', 'collection'],\n    version: '1.0.0',\n  },\n  {\n    id: 'form_login',\n    name: 'Login Form',\n    category: 'organisms',\n    type: 'form',\n    description: 'Complete login form with validation',\n    builtIn: true,\n    tags: ['form', 'auth', 'login'],\n    version: '1.0.0',\n  },\n  {\n    id: 'nav_sidebar',\n    name: 'Sidebar Navigation',\n    category: 'organisms',\n    type: 'navigation',\n    description: 'Vertical sidebar navigation with nested items',\n    builtIn: true,\n    tags: ['navigation', 'sidebar', 'menu'],\n    version: '1.0.0',\n  },\n  {\n    id: 'nav_header',\n    name: 'Header Navigation',\n    category: 'organisms',\n    type: 'navigation',\n    description: 'Horizontal header with logo and nav links',\n    builtIn: true,\n    tags: ['navigation', 'header', 'topbar'],\n    version: '1.0.0',\n  },\n  {\n    id: 'layout_split',\n    name: 'Split Layout',\n    category: 'layouts',\n    type: 'container',\n    description: 'Two-column resizable split layout',\n    builtIn: true,\n    tags: ['layout', 'split', 'columns'],\n    version: '1.0.0',\n  },\n  {\n    id: 'layout_dashboard',\n    name: 'Dashboard Layout',\n    category: 'templates',\n    type: 'container',\n    description: 'Full dashboard template with sidebar, header, and content',\n    builtIn: true,\n    tags: ['template', 'dashboard', 'admin'],\n    version: '1.0.0',\n  },\n  // New Container Components\n  {\n    id: 'container_fluid',\n    name: 'Fluid Container',\n    category: 'containers',\n    type: 'container',\n    description: 'Full-size responsive container',\n    builtIn: true,\n    tags: ['layout', 'fluid', 'full'],\n    version: '1.0.0',\n    // Default size for drag-and-drop\n    defaultSize: { width: 400, height: 300 }\n  },\n  {\n    id: 'container_header',\n    name: 'Header Bar',\n    category: 'containers',\n    type: 'container',\n    description: 'Top navigation bar container',\n    builtIn: true,\n    tags: ['layout', 'header', 'nav'],\n    version: '1.0.0',\n    defaultSize: { width: 800, height: 64 }\n  },\n  {\n    id: 'container_sidebar',\n    name: 'Sidebar',\n    category: 'containers',\n    type: 'container',\n    description: 'Vertical sidebar navigation container',\n    builtIn: true,\n    tags: ['layout', 'sidebar', 'nav'],\n    version: '1.0.0',\n    defaultSize: { width: 250, height: 600 }\n  },\n  {\n    id: 'container_footer',\n    name: 'Footer',\n    category: 'containers',\n    type: 'container',\n    description: 'Bottom footer container area',\n    builtIn: true,\n    tags: ['layout', 'footer'],\n    version: '1.0.0',\n    defaultSize: { width: 800, height: 60 }\n  },\n  {\n    id: 'container_card',\n    name: 'Card Container',\n    category: 'containers',\n    type: 'container',\n    description: 'Content box with standard layout',\n    builtIn: true,\n    tags: ['layout', 'card', 'box'],\n    version: '1.0.0',\n    defaultSize: { width: 300, height: 200 }\n  },\n];\n\n/**\n * Initial canvas elements.\n * Starts empty to provide a clean slate.\n */\nconst initialCanvasElements: CanvasElement[] = [];\n\n/**\n * Header component with app title and toolbar.\n */\ninterface AppHeaderProps {\n  projectName?: string;\n  projectFileName?: string;\n  onBackToLauncher?: () => void;\n  isThemePanelOpen?: boolean;\n  onToggleThemePanel?: () => void;\n  isWindowConfigOpen?: boolean;\n  onToggleWindowConfig?: () => void;\n  showPreview?: boolean;\n  onTogglePreview?: () => void;\n  showBackendBlueprint?: boolean;\n  onToggleBackendBlueprint?: () => void;\n  onToggleSettings?: () => void;\n  onSaveProject?: () => void;\n\n  onSaveProjectAs?: () => void;\n}\n\nconst AppHeader: React.FC<AppHeaderProps> = ({\n  projectName,\n  projectFileName,\n  onBackToLauncher,\n  isThemePanelOpen = false,\n  onToggleThemePanel,\n  isWindowConfigOpen = false,\n  onToggleWindowConfig,\n  showPreview = false,\n  onTogglePreview,\n  showBackendBlueprint = false,\n  onToggleBackendBlueprint,\n  onToggleSettings,\n  onSaveProject,\n\n  onSaveProjectAs,\n}) => (\n  <div className=\"flex items-center justify-between w-full\">\n    <div className=\"flex items-center gap-3\">\n      {onBackToLauncher && (\n        <button\n          type=\"button\"\n          onClick={onBackToLauncher}\n          className=\"p-1.5 rounded-md text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100 transition-colors\"\n          title=\"Back to Projects\"\n        >\n          <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <line x1=\"19\" y1=\"12\" x2=\"5\" y2=\"12\" />\n            <polyline points=\"12 19 5 12 12 5\" />\n          </svg>\n        </button>\n      )}\n      <div className=\"h-8 w-8 rounded-lg bg-primary-500 flex items-center justify-center\">\n        <svg className=\"h-5 w-5 text-white\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n          <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n          <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\n          <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\n        </svg>\n      </div>\n      <div className=\"flex flex-col\">\n        <span className=\"font-semibold text-neutral-800\">App Factory</span>\n        {projectName && projectName !== 'Untitled Project' && (\n          <span className=\"text-xs text-neutral-500\">\n            {projectName}\n            {projectFileName && ` (${projectFileName})`}\n          </span>\n        )}\n      </div>\n    </div>\n    <div className=\"flex items-center gap-2\">\n      {/* Save Button */}\n      {onSaveProject && (\n        <button\n          type=\"button\"\n          onClick={onSaveProject}\n          className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium text-neutral-600 hover:text-neutral-800 hover:bg-neutral-100 transition-colors\"\n          title=\"Save Project\"\n        >\n          <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <path d=\"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\" />\n            <polyline points=\"17 21 17 13 7 13 7 21\" />\n            <polyline points=\"7 3 7 8 15 8\" />\n          </svg>\n          Save\n        </button>\n      )}\n      {/* Save As Button */}\n      {onSaveProjectAs && (\n        <button\n          type=\"button\"\n          onClick={onSaveProjectAs}\n          className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium text-neutral-600 hover:text-neutral-800 hover:bg-neutral-100 transition-colors\"\n          title=\"Save As\"\n        >\n          <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <path d=\"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\" />\n            <polyline points=\"17 21 17 13 7 13 7 21\" />\n            <polyline points=\"7 3 7 8 15 8\" />\n            <line x1=\"12\" y1=\"7\" x2=\"12\" y2=\"12\" />\n            <line x1=\"9.5\" y1=\"9.5\" x2=\"14.5\" y2=\"9.5\" />\n          </svg>\n          Save As\n        </button>\n      )}\n      {/* Theme Button */}\n      {onToggleThemePanel && (\n        <button\n          type=\"button\"\n          onClick={onToggleThemePanel}\n          className={[\n            \"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors\",\n            isThemePanelOpen\n              ? \"bg-primary-100 text-primary-700\"\n              : \"text-neutral-600 hover:text-neutral-800 hover:bg-neutral-100\",\n          ].join(\" \")}\n          title=\"Theme Customization\"\n        >\n          <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"5\" />\n            <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" />\n            <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" />\n            <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" />\n            <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" />\n            <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" />\n            <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" />\n            <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" />\n            <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" />\n          </svg>\n          Theme\n        </button>\n      )}\n      {/* Window Config Button */}\n      {onToggleWindowConfig && (\n        <button\n          type=\"button\"\n          onClick={onToggleWindowConfig}\n          className={[\n            \"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors\",\n            isWindowConfigOpen\n              ? \"bg-primary-100 text-primary-700\"\n              : \"text-neutral-600 hover:text-neutral-800 hover:bg-neutral-100\",\n          ].join(\" \")}\n          title=\"Window Configuration\"\n        >\n          <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n            <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\n          </svg>\n          Window\n        </button>\n      )}\n      {/* Preview Button */}\n      {onTogglePreview && (\n        <button\n          type=\"button\"\n          onClick={onTogglePreview}\n          className={[\n            \"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors\",\n            showPreview\n              ? \"bg-primary-100 text-primary-700\"\n              : \"text-neutral-600 hover:text-neutral-800 hover:bg-neutral-100\",\n          ].join(\" \")}\n          title=\"Toggle Preview Panel\"\n        >\n          <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\n            <circle cx=\"12\" cy=\"12\" r=\"3\" />\n          </svg>\n          Preview\n        </button>\n      )}\n      {/* Backend Blueprint Button (EUR-1.2.10) */}\n      {onToggleBackendBlueprint && (\n        <button\n          type=\"button\"\n          onClick={onToggleBackendBlueprint}\n          className={[\n            \"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-colors\",\n            showBackendBlueprint\n              ? \"bg-primary-100 text-primary-700\"\n              : \"text-neutral-600 hover:text-neutral-800 hover:bg-neutral-100\",\n          ].join(\" \")}\n          title=\"Backend Architecture Blueprint\"\n        >\n          <BlueprintIcon className=\"h-4 w-4\" />\n          Blueprint\n        </button>\n      )}\n      {/* Settings Button */}\n      {onToggleSettings && (\n        <button\n          type=\"button\"\n          onClick={onToggleSettings}\n          className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium text-neutral-600 hover:text-neutral-800 hover:bg-neutral-100 transition-colors\"\n          title=\"Settings\"\n        >\n          <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"3\" />\n            <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\n          </svg>\n          Settings\n        </button>\n      )}\n      <span className=\"text-xs text-neutral-500\">v1.0.0</span>\n    </div>\n  </div>\n);\n\n// sampleProjects removed - projects are now loaded dynamically from outputs/projects folder\n\n/**\n * Root application component.\n *\n * Wraps the entire application with necessary providers:\n * - ThemeProvider: Manages light/dark theme and design tokens\n *\n * Renders:\n * - ProjectLoader: When in launcher mode (start screen)\n * - FactoryLayout: When in editor mode (main factory interface)\n */\n\n/**\n * Calculates the initial size of a component based on \"Smart Rules\" relative to canvas size.\n */\nconst calculateInitialSize = (\n  component: { id: string; type?: string; defaultSize?: { width: number; height: number }; category?: string },\n  canvasWidth: number,\n  canvasHeight: number\n) => {\n  const normalizeId = (id: string) => id.toLowerCase();\n  const id = normalizeId(component.id);\n  const type = component.type?.toLowerCase();\n  const category = component.category?.toLowerCase();\n\n  // 1. Stats Card / Dashboard Block (Specific Fix for User)\n  if (id.includes('stats') || id.includes('dashboard_stats')) {\n    return { width: 340, height: 180 }; // Increased from 280x160 to prevent truncation\n  }\n\n  // 2. Navigation Components\n  if (type === 'navigation' || id.includes('nav')) {\n    if (id.includes('sidebar')) {\n      return { width: 250, height: Math.round(canvasHeight * 0.8) };\n    }\n    if (id.includes('header')) {\n      return { width: canvasWidth, height: 64 };\n    }\n  }\n\n  // 3. Form & Input Components\n  if (type === 'form' || id.includes('form')) {\n    return { width: 400, height: 500 };\n  }\n  if (type === 'input') {\n    if (id.includes('textarea') || id.includes('multiline')) {\n      return { width: 300, height: 120 };\n    }\n    return { width: 240, height: 48 }; // Standard input\n  }\n  if (type === 'select' || id.includes('dropdown')) {\n    return { width: 240, height: 48 };\n  }\n  if (type === 'checkbox' || type === 'radio') {\n    return { width: 160, height: 32 };\n  }\n\n  // 4. Buttons\n  if (type === 'button' || id.includes('btn') || id.includes('button')) {\n    return { width: 140, height: 44 };\n  }\n\n  // 5. Containers & Layouts\n  if (type === 'container' || category === 'layouts') {\n    if (id.includes('fluid')) {\n      return { width: Math.round(canvasWidth * 0.9), height: Math.round(canvasHeight * 0.9) };\n    }\n    if (id.includes('split')) {\n      return { width: Math.round(canvasWidth * 0.8), height: Math.round(canvasHeight * 0.6) };\n    }\n    return { width: Math.round(canvasWidth * 0.5), height: Math.round(canvasHeight * 0.5) };\n  }\n\n  // 6. Cards & Panels\n  if (type === 'card' || id.includes('card')) {\n    if (id.includes('media')) {\n      return { width: 320, height: 360 }; // Taller for media\n    }\n    return { width: 320, height: 220 }; // Generous default card\n  }\n  if (type === 'panel' || type === 'modal') {\n    return { width: 400, height: 300 };\n  }\n  if (type === 'list') {\n    return { width: 300, height: 400 };\n  }\n\n  // 7. Specific Library Components (MUI, etc)\n  if (id.includes('mui/monorepo') || id === 'github-repo') {\n    return { width: 340, height: 120 };\n  }\n\n  // 8. Fallback\n  return {\n    width: component.defaultSize?.width || 200, // Generous fallback\n    height: component.defaultSize?.height || 100\n  };\n};\n\nexport const App: React.FC = () => {\n  // Application mode state (launcher vs editor)\n  const [appMode, setAppMode] = useState<AppMode>('launcher');\n  const [saveNotice, setSaveNotice] = useState<string | null>(null);\n  const saveNoticeTimerRef = useRef<number | null>(null);\n\n  const showSaveNotice = useCallback((filePath: string) => {\n    const fileName = filePath.replace(/\\\\/g, \"/\").split(\"/\").pop() || filePath;\n    setSaveNotice(fileName);\n    if (saveNoticeTimerRef.current) {\n      clearTimeout(saveNoticeTimerRef.current);\n    }\n    saveNoticeTimerRef.current = window.setTimeout(() => {\n      setSaveNotice(null);\n      saveNoticeTimerRef.current = null;\n    }, 3000);\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      if (saveNoticeTimerRef.current) {\n        clearTimeout(saveNoticeTimerRef.current);\n      }\n    };\n  }, []);\n\n  // Theme Sync Logic\n  const { theme, setTheme } = useTheme();\n  const setProjectTheme = useProjectStore((state) => state.setTheme);\n\n  // Sync visual theme changes to project store for persistence\n  useEffect(() => {\n    setProjectTheme(theme);\n  }, [theme, setProjectTheme]);\n\n\n  // Project store actions\n  const saveProject = useProjectStore((state) => state.saveProject);\n  const saveProjectAs = useProjectStore((state) => state.saveProjectAs);\n  const setMetadata = useProjectStore((state) => state.setMetadata);\n\n  const handleSaveProject = useCallback(async () => {\n    const savedPath = await saveProject();\n    if (savedPath) {\n      showSaveNotice(savedPath);\n    }\n  }, [saveProject, showSaveNotice]);\n\n  const handleSaveProjectAs = useCallback(async () => {\n    const savedPath = await saveProjectAs();\n    if (savedPath) {\n      showSaveNotice(savedPath);\n    }\n  }, [saveProjectAs, showSaveNotice]);\n\n  // Sidebar tab state (UJ-1.1.2): includes templates tab for EUR-1.1.10, AI chat tab\n  const [activeSidebarTab, setActiveSidebarTab] = useState<'project' | 'components' | 'containers' | 'modals' | 'templates' | 'plugins' | 'aichat'>('project');\n\n  // Loaded template name (EUR-1.1.10) - displayed in canvas toolbar\n  const [loadedTemplateName, setLoadedTemplateName] = useState<string | null>(null);\n\n  // Register external components on mount (EUR-1.1.3b)\n  React.useEffect(() => {\n    registerComponent('@mui/monorepo', GitHubRepoPreview);\n    registerComponent('mui-button', MuiButtonAdapter);\n    registerComponent('dashboard-stat', DashboardStatsBlock);\n\n    // Add sample imported components to the list so they are available immediately for demo\n    const demoComponents: ComponentInfo[] = [\n      {\n        id: '@mui/monorepo',\n        name: 'MUI Monorepo',\n        category: 'molecules',\n        type: '@mui/monorepo' as any,\n        description: 'Imported from GitHub',\n        builtIn: false,\n        version: 'v7.3.6',\n        tags: ['github', 'imported']\n      },\n      {\n        id: 'mui-button',\n        name: 'Material Button',\n        category: 'atoms',\n        type: 'mui-button' as any,\n        description: 'Standard MUI Button',\n        builtIn: false,\n        version: '5.15.0',\n        tags: ['mui', 'atom']\n      },\n      {\n        id: 'dashboard-stat',\n        name: 'Stats Card',\n        category: 'molecules',\n        type: 'dashboard-stat' as any,\n        description: 'ReactComponents.com Block 1056',\n        builtIn: false,\n        version: '1.0.0',\n        tags: ['dashboard', 'card']\n      }\n    ];\n\n    // Append to sampleComponents if not exists\n    demoComponents.forEach(comp => {\n      if (!sampleComponents.some(c => c.id === comp.id)) {\n        sampleComponents.push(comp);\n      }\n    });\n\n    // Force refresh of gallery... this might benefit from state if I were using state for components\n    // But sampleComponents is a static imported array. This hack relies on re-render.\n  }, []);\n\n  // Project store actions\n  const loadProjectFromFile = useProjectStore((state) => state.loadProjectFromFile);\n  const projectName = useProjectStore((state) => state.metadata.name);\n  const projectFilePath = useProjectStore((state) => state.metadata.filePath);\n  const projectFileName = projectFilePath ? projectFilePath.replace(/\\\\/g, \"/\").split(\"/\").pop() : undefined;\n  const projectDescription = useProjectStore((state) => state.metadata.description);\n  // Subscribe to project theme for canvas (isolated from App Factory theme)\n  const projectTheme = useProjectStore((state) => state.theme);\n\n  // Dynamic project loading from outputs/projects folder\n  const [projects, setProjects] = useState<ProjectInfo[]>([]);\n  const [selectedProjectId, setSelectedProjectId] = useState<string | undefined>();\n  const [isLoadingProjects, setIsLoadingProjects] = useState(true);\n\n  // Load projects from outputs/projects folder on mount\n  useEffect(() => {\n    const loadProjects = async () => {\n      setIsLoadingProjects(true);\n      try {\n        const { isTauri } = await import('./utils/tauriUtils');\n        if (!isTauri()) {\n          console.warn('Project loading requires Tauri environment');\n          setIsLoadingProjects(false);\n          return;\n        }\n\n        const { readDir, readTextFile } = await import('@tauri-apps/api/fs');\n\n        // Absolute path to projects directory\n        const projectsDir = 'C:\\\\Users\\\\anujd\\\\Documents\\\\01_AI\\\\173_piovisstudio\\\\app_factory\\\\outputs\\\\projects';\n        console.log('Loading projects from:', projectsDir);\n\n        try {\n          const entries = await readDir(projectsDir);\n          const projectFiles = entries.filter(e => e.name?.endsWith('.json'));\n\n          // Load ALL project files (no grouping - show every file)\n          const loadedProjects: ProjectInfo[] = [];\n\n          for (const file of projectFiles) {\n            if (!file.path) continue;\n\n            try {\n              const content = await readTextFile(file.path);\n              const projectData = JSON.parse(content) as ProjectFile;\n\n              loadedProjects.push({\n                id: file.path,\n                name: projectData.metadata?.name || file.name?.replace('.json', '') || 'Unknown',\n                path: file.path,\n                description: projectData.metadata?.description || '',\n                version: projectData.metadata?.version || '1.0.0',\n                createdAt: new Date(projectData.metadata?.createdAt || Date.now()),\n                updatedAt: new Date(projectData.metadata?.modifiedAt || Date.now()),\n                plugins: [],\n                screens: Object.values(projectData.screens || {}).map(s => ({\n                  id: s.id,\n                  name: s.name,\n                  route: s.route,\n                  componentCount: Object.keys(projectData.components || {}).length,\n                })),\n                status: 'ready',\n              });\n            } catch {\n              // Skip files that can't be parsed\n            }\n          }\n\n          // Sort by updatedAt (most recent first)\n          loadedProjects.sort((a, b) => b.updatedAt.getTime() - a.updatedAt.getTime());\n          setProjects(loadedProjects);\n        } catch (err) {\n          console.warn('Could not read projects directory:', err);\n        }\n      } catch (err) {\n        console.error('Failed to load projects:', err);\n      } finally {\n        setIsLoadingProjects(false);\n      }\n    };\n\n    loadProjects();\n  }, []);\n\n  // Plugin state\n  const [plugins, setPlugins] = useState<PluginInfo[]>(samplePlugins);\n  const [selectedPluginId, setSelectedPluginId] = useState<string | undefined>();\n\n  // Derive plugin slots for BackendBlueprintPanel from plugins state\n  const pluginSlots: PluginSlot[] = React.useMemo(() => {\n    return plugins.map(p => ({\n      id: p.id,\n      contract: p.contract.toUpperCase(),\n      name: p.name,\n      pluginName: p.status === 'loaded' ? p.name : undefined,\n      status: p.status === 'loaded' ? 'healthy' as const :\n        p.status === 'loading' ? 'degraded' as const :\n          p.status === 'error' ? 'unhealthy' as const : 'empty' as const,\n    }));\n  }, [plugins]);\n\n  // Manual plugin slots (user-added via + button in Blueprint)\n  const [manualPluginSlots, setManualPluginSlots] = useState<PluginSlot[]>([]);\n\n  // Plugin filter for sidebar (when user clicks a slot in Blueprint)\n  const [pluginCategoryFilter, setPluginCategoryFilter] = useState<string | null>(null);\n\n  // Selected plugin for configuration panel (when user clicks a slot or selects a plugin)\n  const [selectedPluginForConfig, setSelectedPluginForConfig] = useState<PluginInfoWithConfig | null>(null);\n\n\n  // Component Gallery state (UJ-1.1.2)\n  const [selectedComponentIds, setSelectedComponentIds] = useState<string[]>([]);\n\n  // Component Generator state (UJ-1.1.3)\n  const [showGeneratorModal, setShowGeneratorModal] = useState(false);\n  const { state: generatorState, generate: generateComponent } = useComponentGenerator();\n  const addComponentToLibrary = useComponentLibraryStore((state) => state.addComponent);\n  // Subscribe to components array to trigger re-renders when AI updates library\n  const libraryComponents = useComponentLibraryStore((state) => state.components);\n\n  // Window Config State (for linking canvas size)\n  const windowConfig = useWindowConfigStore((state) => state.config);\n\n\n  // Canvas state\n  const [canvasElements, setCanvasElements] = useState<CanvasElement[]>(initialCanvasElements);\n  const [selectedElementIds, setSelectedElementIds] = useState<string[]>([]);\n\n  // Undo history state - stores snapshots of canvasElements before each mutation\n  const [canvasHistory, setCanvasHistory] = useState<CanvasElement[][]>([]);\n\n  // Theme panel and Preview state (UJ-1.1.1)\n  const [isThemePanelOpen, setIsThemePanelOpen] = useState(false);\n  const [isWindowConfigOpen, setIsWindowConfigOpen] = useState(false);\n  const [showPreview, setShowPreview] = useState(true);\n\n  // Backend Blueprint state (EUR-1.2.10)\n  const [showBackendBlueprint, setShowBackendBlueprint] = useState(false);\n\n  // AI Team Visualization state\n  const [isAiTeamOpen, setIsAiTeamOpen] = useState(false);\n\n\n  // Settings panel state\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n\n  // Import wizard state (EUR-1.1.3b)\n  const [showImportWizard, setShowImportWizard] = useState(false);\n\n  // Toggle handlers for Theme and Preview panels\n  const handleToggleThemePanel = useCallback(() => {\n    setIsThemePanelOpen((prev) => !prev);\n    // Close window config if opening theme\n    setIsWindowConfigOpen(false);\n  }, []);\n\n  const handleToggleWindowConfig = useCallback(() => {\n    setIsWindowConfigOpen((prev) => !prev);\n    // Close theme panel if opening window config\n    setIsThemePanelOpen(false);\n  }, []);\n\n  const handleTogglePreview = useCallback(() => {\n    setShowPreview((prev) => !prev);\n  }, []);\n\n  const handleToggleBackendBlueprint = useCallback(() => {\n    setShowBackendBlueprint((prev) => !prev);\n  }, []);\n\n  const handleToggleSettings = useCallback(() => {\n    setIsSettingsOpen((prev) => !prev);\n  }, []);\n\n  const handleAddGeneratedComponent = useCallback((component: GeneratedComponent) => {\n    const categoryMap: Record<GeneratedComponent['type'], ComponentCategory> = {\n      button: 'buttons',\n      input: 'forms',\n      card: 'cards',\n      form: 'forms',\n      list: 'other',\n      modal: 'modals',\n      navigation: 'navigation',\n      layout: 'layout',\n      custom: 'other',\n    };\n\n    addComponentToLibrary({\n      name: component.name,\n      code: component.code,\n      framework: component.framework,\n      description: component.prompt,\n      category: categoryMap[component.type],\n      tags: [component.type, component.framework],\n      prompt: component.prompt,\n    });\n  }, [addComponentToLibrary]);\n\n  /**\n   * Handle applying AI-generated code from Chat to canvas.\n   * Parses component name, adds to library, and places on canvas.\n   */\n  const handleApplyAiCode = useCallback((code: string, language: string) => {\n    // Parse component name from code\n    const nameMatch = code.match(/(?:const|function)\\s+(\\w+)/);\n    const componentName = nameMatch?.[1] || `AiComponent_${Date.now()}`;\n\n    // Add to component library\n    const componentId = `ai-chat-${Date.now()}`;\n    addComponentToLibrary({\n      name: componentName,\n      code: code,\n      framework: language === 'tsx' || language === 'jsx' || language === 'javascript' || language === 'react' ? 'react' : 'html',\n      description: 'Generated by AI Chat',\n      category: 'other',\n      tags: ['ai-generated', language],\n      prompt: 'AI Chat generated component',\n    });\n\n    // Add to canvas\n    const newElement: CanvasElement = {\n      id: `element-${Date.now()}`,\n      type: 'component',\n      name: componentName,\n      componentId: componentId,\n      bounds: {\n        x: 100 + (canvasElements.length * 20),\n        y: 100 + (canvasElements.length * 20),\n        width: 200,\n        height: 100,\n      },\n      zIndex: canvasElements.length + 1,\n    };\n\n    setCanvasElements((prev) => [...prev, newElement]);\n    setSelectedElementIds([newElement.id]);\n\n    console.log('[App] Applied AI code to canvas:', componentName);\n  }, [addComponentToLibrary, canvasElements.length]);\n\n  /**\n   * Handle applying structured canvas changes from AI.\n   * Updates existing components in-place or adds new ones.\n   */\n  const handleApplyCanvasChanges = useCallback((changes: Array<{\n    elementId?: string;\n    action?: 'add' | 'update' | 'delete';\n    name?: string;\n    code: string;\n  }>) => {\n    const { updateComponent, addComponent } = useComponentLibraryStore.getState();\n\n    changes.forEach(change => {\n      // Validate code is present and is a string\n      if (!change.code || typeof change.code !== 'string') {\n        console.error('[App] Invalid change code:', change);\n        alert(`Failed to apply changes: Invalid code generated for ${change.name || change.elementId}`);\n        return;\n      }\n\n      if (change.elementId) {\n        // Try exact ID match first\n        let element = canvasElements.find(el => el.id === change.elementId);\n\n        // Fallback: try matching by element name (case-insensitive partial match)\n        if (!element) {\n          const searchTerm = change.elementId.toLowerCase().replace(/[^a-z0-9]/g, '');\n          element = canvasElements.find(el => {\n            const elName = el.name.toLowerCase().replace(/[^a-z0-9]/g, '');\n            return elName.includes(searchTerm) || searchTerm.includes(elName);\n          });\n          if (element) {\n            console.log('[App] Found element by name fallback:', element.name, 'for:', change.elementId);\n          }\n        }\n\n        if (element?.componentId) {\n          // Check if component exists in library\n          const { getComponentById } = useComponentLibraryStore.getState();\n          const existingComponent = getComponentById(element.componentId);\n\n          if (existingComponent) {\n            // Update the component code in the library\n            updateComponent(element.componentId, { code: change.code });\n            console.log('[App] Ô£à Updated component:', element.componentId, 'for element:', element.id);\n            // Temporary debug alert\n            alert(`Updated component for ${element.name}`);\n          } else {\n            // Component not in library (built-in/template) -> Create new AI component (Fork)\n            console.log('[App] Component not in library, creating fork:', element.componentId);\n\n            const newComp = addComponent({\n              name: `${element.name} (AI)`,\n              code: change.code,\n              framework: 'react',\n              description: `AI modification of ${element.name}`,\n              category: 'other',\n              tags: ['ai-generated', 'fork'],\n              prompt: 'AI Chat modification'\n            });\n\n            // Update element to point to new component\n            setCanvasElements(prev => prev.map(el =>\n              el.id === change.elementId ? { ...el, componentId: newComp.id } : el\n            ));\n\n            alert(`Converted ${element.name} to custom AI component and applied changes.`);\n          }\n        } else {\n          console.warn('[App] ÔØî Element not found:', change.elementId);\n          console.log('[App] Available elements:', canvasElements.map(el => ({ id: el.id, name: el.name })));\n\n          // Alert user if element not found\n          alert(`Could not find element to update:\\nID: ${change.elementId}\\n\\nTry selecting the component first, or checking the name.`);\n        }\n      } else if (change.action === 'add' && change.code) {\n        // Add new component\n        const newComp = addComponent({\n          name: change.name || `AiComponent_${Date.now()}`,\n          code: change.code,\n          framework: 'react',\n          description: 'Generated by AI Chat',\n          category: 'other',\n          tags: ['ai-generated'],\n        });\n\n        // Add to canvas\n        const newElement: CanvasElement = {\n          id: `element-${Date.now()}`,\n          type: 'component',\n          name: newComp.name,\n          componentId: newComp.id,\n          bounds: {\n            x: 100 + (canvasElements.length * 20),\n            y: 100 + (canvasElements.length * 20),\n            width: 200,\n            height: 100,\n          },\n          zIndex: canvasElements.length + 1,\n        };\n\n        setCanvasElements((prev) => [...prev, newElement]);\n        setSelectedElementIds([newElement.id]);\n        console.log('[App] Added new AI component to canvas:', newComp.name);\n      }\n    });\n  }, [canvasElements]);\n\n  // Project loading handlers\n  const handleSelectProject = useCallback((project: ProjectInfo) => {\n    setSelectedProjectId(project.id);\n  }, []);\n\n  const handleOpenProject = useCallback(async (project: ProjectInfo) => {\n    // Read actual project file from disk in Tauri mode\n    if (isTauri()) {\n      try {\n        const { readTextFile } = await import('@tauri-apps/api/fs');\n        const content = await readTextFile(project.path);\n        const projectFile = JSON.parse(content) as ProjectFile;\n\n        // Load into project store\n        loadProjectFromFile(project.path, projectFile);\n\n        // Sync theme from loaded project to visual ThemeProvider\n        if (projectFile.theme) {\n          setTheme(projectFile.theme);\n        }\n\n        // Sync windowConfig from loaded project to WindowConfigStore\n        if (projectFile.windowConfig) {\n          useWindowConfigStore.getState().setConfig(projectFile.windowConfig);\n        }\n\n        // Sync canvas elements to local state\n        if (projectFile.canvasElements) {\n          setCanvasElements(projectFile.canvasElements as unknown as CanvasElement[]);\n        }\n\n        setAppMode('editor');\n      } catch (error) {\n        console.error('Failed to load project:', error);\n        // Fallback: still open editor with default state\n        setAppMode('editor');\n      }\n    } else {\n      // Browser mode: use sample data (for demo purposes)\n      const projectFile: ProjectFile = {\n        version: 2,\n        metadata: {\n          name: project.name,\n          description: project.description || '',\n          author: 'User',\n          version: project.version,\n          createdAt: project.createdAt.getTime(),\n          modifiedAt: project.updatedAt.getTime(),\n          filePath: project.path,\n          tags: [],\n        },\n        screens: {},\n        components: {},\n        theme: theme, // Use current theme instead of hardcoded\n        buildConfig: {\n          outputDir: './dist',\n          platform: 'windows',\n          mode: 'development',\n          includePythonRuntime: true,\n          bundledPlugins: [],\n          appIcon: null,\n          version: project.version,\n          publisher: '',\n          identifier: 'com.appfactory.app',\n        },\n      };\n\n      loadProjectFromFile(project.path, projectFile);\n      setAppMode('editor');\n    }\n  }, [loadProjectFromFile, setTheme, theme, setCanvasElements]);\n\n  const handleNewProject = useCallback(() => {\n    // In real app, would show new project wizard\n    setAppMode('editor');\n  }, []);\n\n  const handleBrowseProject = useCallback(async () => {\n    // Use store's browseAndLoadProject which handles file picker and loading\n    const browseAndLoadProject = useProjectStore.getState().browseAndLoadProject;\n    const success = await browseAndLoadProject();\n\n    if (success) {\n      // Get the loaded project state from store\n      const state = useProjectStore.getState();\n\n      // Sync theme from loaded project to visual ThemeProvider\n      if (state.theme) {\n        setTheme(state.theme);\n      }\n\n      // Sync windowConfig from loaded project to WindowConfigStore\n      if (state.windowConfig) {\n        useWindowConfigStore.getState().setConfig(state.windowConfig);\n      }\n\n      // Sync canvas elements to local state\n      if (state.canvasElements && state.canvasElements.length > 0) {\n        setCanvasElements(state.canvasElements as unknown as CanvasElement[]);\n      }\n\n      setAppMode('editor');\n    }\n  }, [setTheme, setCanvasElements]);\n\n  const handleBackToLauncher = useCallback(() => {\n    setAppMode('launcher');\n  }, []);\n\n  // Plugin handlers\n  const handlePluginSelect = useCallback((plugin: PluginInfo) => {\n    setSelectedPluginId(plugin.id);\n    // Also set it as the selected plugin for configuration\n    const pluginWithConfig = (plugins as PluginInfoWithConfig[]).find(p => p.id === plugin.id);\n    if (pluginWithConfig) {\n      setSelectedPluginForConfig(pluginWithConfig);\n      setSelectedElementIds([]); // Clear canvas selection\n    }\n  }, [plugins]);\n\n  // Component Gallery handlers (UJ-1.1.2)\n  const handleComponentSelectionChange = useCallback((component: ComponentInfo, selected: boolean) => {\n    setSelectedComponentIds((prev) => {\n      if (selected) {\n        // Add to selection if not already present\n        return prev.includes(component.id) ? prev : [...prev, component.id];\n      } else {\n        // Remove from selection\n        return prev.filter((id) => id !== component.id);\n      }\n    });\n  }, []);\n\n  // Handle adding component to canvas from gallery\n  const handleAddComponent = useCallback((component: ComponentInfo) => {\n    const newElement: CanvasElement = {\n      id: `element-${Date.now()}`,\n      type: 'component',\n      name: component.name,\n      componentId: component.id,\n      bounds: {\n        x: 100 + (canvasElements.length * 20), // Offset each new element\n        y: 100 + (canvasElements.length * 20),\n        ...calculateInitialSize(component, windowConfig.width, windowConfig.height),\n      },\n      zIndex: canvasElements.length + 1,\n    };\n    setCanvasElements((prev) => [...prev, newElement]);\n    setSelectedElementIds([newElement.id]);\n  }, [canvasElements.length]);\n\n  // Handle importing component from external URL (EUR-1.1.3b)\n  const handleImportComponent = useCallback(async (manifest: ComponentManifest, _sourceUrl: string) => {\n    // Add imported component to the sample components list\n    const newComponent: ComponentInfo = {\n      id: manifest.name,\n      name: manifest.displayName,\n      category: manifest.type === 'component' ? 'molecules' : 'organisms',\n      type: manifest.name as any, // Use unique name as type key for registry lookup\n      description: manifest.description,\n      builtIn: false,\n      tags: manifest.tags || [],\n      version: manifest.version,\n    };\n    // Note: In a real app, this would persist to a store\n    sampleComponents.push(newComponent);\n    console.log('Imported component:', newComponent);\n  }, []);\n\n  const handlePluginLoad = useCallback((plugin: PluginInfo) => {\n    setPlugins((prev) =>\n      prev.map((p) =>\n        p.id === plugin.id ? { ...p, status: 'loading' as const } : p\n      )\n    );\n    // Simulate loading delay\n    setTimeout(() => {\n      setPlugins((prev) =>\n        prev.map((p) =>\n          p.id === plugin.id ? { ...p, status: 'loaded' as const } : p\n        )\n      );\n    }, 1000);\n  }, []);\n\n  const handlePluginUnload = useCallback((plugin: PluginInfo) => {\n    setPlugins((prev) =>\n      prev.map((p) =>\n        p.id === plugin.id ? { ...p, status: 'unloaded' as const } : p\n      )\n    );\n  }, []);\n\n  // Blueprint slot handlers\n  const handleBlueprintSlotClick = useCallback((slot: PluginSlot) => {\n    // Find a plugin that matches this slot's contract\n    const matchingPlugin = (plugins as PluginInfoWithConfig[]).find(\n      p => p.contract.toUpperCase() === slot.contract.toUpperCase()\n    );\n    if (matchingPlugin) {\n      setSelectedPluginForConfig(matchingPlugin);\n      setSelectedElementIds([]); // Clear canvas selection when showing plugin config\n    }\n    // Switch to plugins tab and filter by this slot's category\n    setActiveSidebarTab('plugins');\n    setPluginCategoryFilter(slot.contract.toUpperCase());\n  }, [plugins]);\n\n  const handleAddManualSlot = useCallback((contract: string) => {\n    const newSlot: PluginSlot = {\n      id: `slot-${Date.now()}`,\n      contract: contract.toUpperCase(),\n      name: `${contract} Slot`,\n      pluginName: undefined,\n      status: 'empty',\n    };\n    setManualPluginSlots((prev) => [...prev, newSlot]);\n  }, []);\n\n  const handleRemoveManualSlot = useCallback((slotId: string) => {\n    setManualPluginSlots((prev) => prev.filter((s) => s.id !== slotId));\n  }, []);\n\n  const handleClearPluginFilter = useCallback(() => {\n    setPluginCategoryFilter(null);\n  }, []);\n\n  // Canvas handlers\n\n  // Helper to push current state to undo history before mutation\n  const pushToHistory = useCallback(() => {\n    setCanvasHistory((prev) => [...prev, canvasElements]);\n  }, [canvasElements]);\n\n  // Undo handler - pops last state from history and restores it\n  const handleUndo = useCallback(() => {\n    if (canvasHistory.length === 0) return;\n    const previousState = canvasHistory[canvasHistory.length - 1];\n    setCanvasHistory((prev) => prev.slice(0, -1));\n    setCanvasElements(previousState);\n    setSelectedElementIds([]);\n  }, [canvasHistory]);\n\n  // Clear canvas handler - clears all elements (with undo support)\n  const handleClearCanvas = useCallback(() => {\n    if (canvasElements.length === 0) return;\n    pushToHistory();\n    setCanvasElements([]);\n    setSelectedElementIds([]);\n  }, [canvasElements.length, pushToHistory]);\n\n  const handleElementSelect = useCallback((ids: string[]) => {\n    setSelectedElementIds(ids);\n    // Clear plugin config selection when canvas element is selected\n    if (ids.length > 0) {\n      setSelectedPluginForConfig(null);\n    }\n  }, []);\n\n  const handleElementMove = useCallback((id: string, bounds: ElementBounds) => {\n    setCanvasElements((prev) =>\n      prev.map((el) => (el.id === id ? { ...el, bounds } : el))\n    );\n  }, []);\n\n  const handleElementDelete = useCallback((ids: string[]) => {\n    pushToHistory();\n    setCanvasElements((prev) => prev.filter((el) => !ids.includes(el.id)));\n    setSelectedElementIds([]);\n  }, [pushToHistory]);\n\n  // Handle property changes from PropertyInspector\n  const handlePropertyChange = useCallback((key: string, value: unknown) => {\n    if (selectedElementIds.length !== 1) return;\n    const elementId = selectedElementIds[0];\n\n    setCanvasElements((prev) =>\n      prev.map((el) => {\n        if (el.id !== elementId) return el;\n\n        // Update bounds properties\n        if (['x', 'y', 'width', 'height'].includes(key)) {\n          return {\n            ...el,\n            bounds: {\n              ...el.bounds,\n              [key]: Number(value),\n            },\n          };\n        }\n\n        // Update component props (for text, variant, etc.)\n        return {\n          ...el,\n          props: {\n            ...el.props,\n            [key]: value,\n          },\n        };\n      })\n    );\n  }, [selectedElementIds]);\n\n  // Handle element drop from ComponentGallery (Phase 5: Drag-and-Drop)\n  const handleElementDrop = useCallback((\n    element: Partial<CanvasElement>,\n    position: { x: number; y: number }\n  ) => {\n    // Extract component info from dropped data (comes from ComponentGallery)\n    const droppedComponent = element as unknown as { id?: string; name?: string };\n    const newElement: CanvasElement = {\n      id: `element-${Date.now()}`,\n      type: 'component',\n      name: droppedComponent.name || 'New Component',\n      componentId: droppedComponent.id,\n      bounds: {\n        x: position.x,\n        y: position.y,\n        ...calculateInitialSize(droppedComponent as any, windowConfig.width, windowConfig.height),\n      },\n      zIndex: canvasElements.length + 1,\n    };\n    setCanvasElements((prev) => [...prev, newElement]);\n    setSelectedElementIds([newElement.id]);\n  }, [canvasElements.length]);\n\n  // Get component code by ID for live canvas preview\n  // Checks both componentLibraryStore (AI-generated) and sampleComponents (built-in)\n  const getComponentCode = useCallback((componentId: string): { code: string; framework: ComponentFramework } | null => {\n    // First check componentLibraryStore for AI-generated components\n    const libraryComponent = useComponentLibraryStore.getState().getComponentById(componentId);\n    if (libraryComponent) {\n      return { code: libraryComponent.code, framework: libraryComponent.framework };\n    }\n\n    // Then check sampleComponents for built-in components\n    // Return undefined so CanvasEditor falls back to TemplateComponentRenderer using componentId\n    const sampleComponent = sampleComponents.find(c => c.id === componentId);\n    if (sampleComponent) {\n      return null;\n    }\n\n    return null;\n  }, [libraryComponents]); // Re-create when components change to pick up AI updates\n\n  // Get selected element for property inspector\n  const selectedElement = canvasElements.find((el) => selectedElementIds.includes(el.id));\n\n  // Render launcher mode (project selection screen)\n  if (appMode === 'launcher') {\n    return (\n      <ThemeProvider>\n        <div className=\"min-h-screen bg-neutral-100 flex items-center justify-center p-8\">\n          <div className=\"w-full max-w-4xl\">\n            <div className=\"text-center mb-8\">\n              <div className=\"inline-flex items-center justify-center h-16 w-16 rounded-2xl bg-primary-500 mb-4\">\n                <svg className=\"h-10 w-10 text-white\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                  <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n                  <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\n                  <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\n                </svg>\n              </div>\n              <h1 className=\"text-3xl font-bold text-neutral-900\">App Factory</h1>\n              <p className=\"text-neutral-600 mt-2\">Create plugin-powered desktop applications</p>\n            </div>\n            <ProjectLoader\n              projects={projects}\n              selectedProjectId={selectedProjectId}\n              onSelectProject={handleSelectProject}\n              onOpenProject={handleOpenProject}\n              onNewProject={handleNewProject}\n              onBrowseProject={handleBrowseProject}\n              onToggleSettings={handleToggleSettings}\n              isLoading={isLoadingProjects}\n              className=\"h-[500px]\"\n            />\n          </div>\n        </div>\n      </ThemeProvider>\n    );\n  }\n\n  // Render editor mode (factory interface)\n  return (\n    <ThemeProvider>\n      <div className=\"min-h-screen bg-bg-primary text-text-primary\">\n        <FactoryLayout\n          key={`layout-${showBackendBlueprint ? 'with-blueprint' : 'no-blueprint'}`}\n          header={\n            <AppHeader\n              projectName={projectName}\n              projectFileName={projectFileName}\n              onBackToLauncher={handleBackToLauncher}\n              isThemePanelOpen={isThemePanelOpen}\n              onToggleThemePanel={handleToggleThemePanel}\n              isWindowConfigOpen={isWindowConfigOpen}\n              onToggleWindowConfig={handleToggleWindowConfig}\n              showPreview={showPreview}\n              onTogglePreview={handleTogglePreview}\n              showBackendBlueprint={showBackendBlueprint}\n              onToggleBackendBlueprint={handleToggleBackendBlueprint}\n              onToggleSettings={handleToggleSettings}\n\n              onSaveProject={handleSaveProject}\n              onSaveProjectAs={handleSaveProjectAs}\n            />\n          }\n          leftSidebar={\n            <div className=\"h-full flex flex-col\">\n              {/* Tab Switcher */}\n              <div className=\"p-2 border-b border-neutral-200\">\n                <div className=\"flex flex-wrap gap-1 rounded-lg bg-neutral-100 p-1\">\n                  {[\n                    { id: 'project', label: 'Proj', icon: FolderIcon },\n                    { id: 'components', label: 'Comp', icon: ComponentIcon },\n                    { id: 'containers', label: 'Cont', icon: LayoutIcon },\n                    { id: 'modals', label: 'Mod', icon: WindowIcon },\n                    { id: 'templates', label: 'Tmpl', icon: TemplateIcon },\n                    { id: 'plugins', label: 'Plug', icon: PluginIcon },\n                    { id: 'aichat', label: 'AI', icon: AiAppChatIcon },\n                    { id: 'aiteam', label: 'Team', icon: RunningIcon },\n                  ].map((tab) => {\n                    const Icon = tab.icon;\n                    const isActive = activeSidebarTab === tab.id;\n                    const isAiTeam = tab.id === 'aiteam';\n\n                    return (\n                      <button\n                        key={tab.id}\n                        type=\"button\"\n                        onClick={() => {\n                          if (isAiTeam) {\n                            setIsAiTeamOpen(true);\n                          } else {\n                            setActiveSidebarTab(tab.id as any);\n                          }\n                        }}\n                        className={[\n                          \"flex-1 min-w-[3rem] px-2 py-1.5 flex flex-col items-center justify-center gap-1 text-[10px] font-medium rounded-md transition-colors\",\n                          isActive\n                            ? \"bg-white text-neutral-900 shadow-sm\"\n                            : \"text-neutral-500 hover:text-neutral-700 hover:bg-neutral-200/50\",\n                        ].join(\" \")}\n                        title={isAiTeam ? \"AI Team Visualization\" : tab.label}\n                      >\n                        <Icon className=\"h-5 w-5\" />\n                        <span>{tab.label}</span>\n                      </button>\n                    );\n\n                  })}\n                </div>\n              </div>\n\n              {/* Gallery Content */}\n              <div className=\"flex-1 overflow-auto p-3\">\n                {activeSidebarTab === 'plugins' ? (\n                  <div className=\"space-y-3\">\n                    {/* Category Filter Banner */}\n                    {pluginCategoryFilter && (\n                      <div className=\"flex items-center justify-between px-3 py-2 bg-amber-50 border border-amber-200 rounded-lg\">\n                        <span className=\"text-xs text-amber-800\">\n                          Showing: <span className=\"font-semibold\">{pluginCategoryFilter}</span> plugins\n                        </span>\n                        <button\n                          type=\"button\"\n                          onClick={handleClearPluginFilter}\n                          className=\"text-xs text-amber-600 hover:text-amber-800 underline\"\n                        >\n                          Show all\n                        </button>\n                      </div>\n                    )}\n                    <PluginGallery\n                      plugins={pluginCategoryFilter\n                        ? plugins.filter(p => p.contract.toUpperCase() === pluginCategoryFilter)\n                        : plugins\n                      }\n                      selectedId={selectedPluginId}\n                      onSelect={handlePluginSelect}\n                      onLoad={handlePluginLoad}\n                      onUnload={handlePluginUnload}\n                      gridColumns={2}\n                      showViewToggle={false}\n                    />\n                  </div>\n                ) : activeSidebarTab === 'containers' ? (\n                  <div className=\"space-y-3\">\n                    <ComponentGallery\n                      key=\"containers\"\n                      components={sampleComponents.filter(c =>\n                        ['containers', 'layouts'].includes(c.category)\n                      )}\n                      selectedIds={selectedComponentIds}\n                      onSelectionChange={handleComponentSelectionChange}\n                      onAdd={handleAddComponent}\n                      gridColumns={2}\n                      showViewToggle={false}\n                      showFilters={false}\n                      draggable\n                    />\n                  </div>\n                ) : activeSidebarTab === 'modals' ? (\n                  <div className=\"space-y-3\">\n                    <ComponentGallery\n                      key=\"modals\"\n                      components={sampleComponents.filter(c => c.type === 'modal')}\n                      selectedIds={selectedComponentIds}\n                      onSelectionChange={handleComponentSelectionChange}\n                      onAdd={handleAddComponent}\n                      gridColumns={2}\n                      showViewToggle={false}\n                      showFilters={false}\n                      draggable\n                    />\n                  </div>\n                ) : activeSidebarTab === 'components' ? (\n                  <div className=\"space-y-3\">\n                    {/* New Component Button (UJ-1.1.3) */}\n                    <button\n                      type=\"button\"\n                      onClick={() => setShowGeneratorModal(true)}\n                      className=\"w-full flex items-center justify-center gap-2 px-3 py-2 bg-primary-500 text-white text-sm font-medium rounded-lg hover:bg-primary-600 transition-colors\"\n                    >\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                        <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n                        <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n                      </svg>\n                      New Component\n                    </button>\n                    {/* Import Component Button (EUR-1.1.3b) */}\n                    <button\n                      type=\"button\"\n                      onClick={() => setShowImportWizard(true)}\n                      className=\"w-full flex items-center justify-center gap-2 px-3 py-2 bg-neutral-100 text-neutral-700 text-sm font-medium rounded-lg hover:bg-neutral-200 transition-colors border border-neutral-200\"\n                    >\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                        <path d=\"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4\" />\n                        <polyline points=\"7 10 12 15 17 10\" />\n                        <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n                      </svg>\n                      Import Component\n                    </button>\n                    <ComponentGallery\n                      key=\"components-filtered\"\n                      components={sampleComponents.filter(c =>\n                        ['atoms', 'molecules', 'organisms'].includes(c.category) && c.type !== 'modal'\n                      )}\n                      selectedIds={selectedComponentIds}\n                      onSelectionChange={handleComponentSelectionChange}\n                      onAdd={handleAddComponent}\n                      gridColumns={2}\n                      showViewToggle={false}\n                      showFilters={false}\n                      draggable\n                    />\n                  </div>\n                ) : activeSidebarTab === 'templates' ? (\n                  // Templates tab content (EUR-1.1.10)\n                  <TemplateBrowser\n                    onLoadTemplate={(elements, windowSize, templateInfo) => {\n                      // Replace canvas with template elements\n                      setCanvasElements(elements);\n                      setSelectedElementIds([]);\n                      // Set the loaded template name for display\n                      setLoadedTemplateName(templateInfo?.name || null);\n                      // Optionally update window config if template specifies size\n                      if (windowSize) {\n                        useWindowConfigStore.getState().setConfig({\n                          width: windowSize.width,\n                          height: windowSize.height,\n                        });\n                      }\n                    }}\n                    onSaveAsTemplate={() => {\n                      // The TemplateBrowser handles its own save modal\n                    }}\n                  />\n                ) : activeSidebarTab === 'aichat' ? (\n                  // AI App Chat panel - full panel takeover\n                  <AiAppChatPanel\n                    className=\"h-full -m-3\"\n                    onApplyCode={handleApplyAiCode}\n                    canvasElements={canvasElements}\n                    getComponentCode={getComponentCode}\n                    onApplyCanvasChanges={handleApplyCanvasChanges}\n                  />\n                ) : (\n                  // Default or 'project' tab content - shows loaded project details\n                  <div className=\"p-3 space-y-4\">\n                    <div className=\"space-y-2\">\n                      {/* Editable App Name */}\n                      <input\n                        type=\"text\"\n                        value={projectName || ''}\n                        onChange={(e) => setMetadata({ name: e.target.value })}\n                        onBlur={() => saveProject()}\n                        onKeyDown={(e) => {\n                          if (e.key === 'Enter') {\n                            e.currentTarget.blur();\n                          }\n                        }}\n                        className=\"w-full font-semibold text-neutral-900 text-sm bg-transparent border-b border-transparent hover:border-neutral-300 focus:border-primary-500 focus:outline-none transition-colors px-0 py-1\"\n                        placeholder=\"Untitled Project\"\n                      />\n                      {/* Editable Description */}\n                      <textarea\n                        value={projectDescription || ''}\n                        onChange={(e) => setMetadata({ description: e.target.value })}\n                        onBlur={() => saveProject()}\n                        className=\"w-full text-xs text-neutral-500 bg-transparent border border-transparent hover:border-neutral-300 focus:border-primary-500 focus:outline-none resize-none transition-colors rounded px-1 py-1\"\n                        placeholder=\"Add a description...\"\n                        rows={2}\n                      />\n                    </div>\n\n                    {/* Project Stats */}\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <div className=\"bg-neutral-50 rounded-md p-2\">\n                        <div className=\"text-lg font-semibold text-primary-600\">{canvasElements.length}</div>\n                        <div className=\"text-xs text-neutral-500\">Elements</div>\n                      </div>\n                      <div className=\"bg-neutral-50 rounded-md p-2\">\n                        <div className=\"text-lg font-semibold text-primary-600\">{Object.keys(useProjectStore.getState().screens).length}</div>\n                        <div className=\"text-xs text-neutral-500\">Screens</div>\n                      </div>\n                    </div>\n\n                    {/* Canvas/Window Size */}\n                    <div className=\"space-y-2\">\n                      <h4 className=\"text-xs font-medium text-neutral-700 uppercase tracking-wide\">Canvas Size</h4>\n                      <div className=\"flex items-center gap-2 text-sm text-neutral-600 bg-neutral-50 rounded-md p-2\">\n                        <span>{windowConfig.width} x {windowConfig.height}px</span>\n                      </div>\n                    </div>\n\n                    {/* Theme Info */}\n                    <div className=\"space-y-2\">\n                      <h4 className=\"text-xs font-medium text-neutral-700 uppercase tracking-wide\">Project Theme</h4>\n                      <div className=\"flex items-center gap-2 text-sm text-neutral-600 bg-neutral-50 rounded-md p-2\">\n                        <div\n                          className=\"w-4 h-4 rounded-full border border-neutral-200\"\n                          style={{ backgroundColor: projectTheme?.colors?.primary?.[500] || '#3b82f6' }}\n                        />\n                        <span>{projectTheme?.name || 'Default'}</span>\n                        <span className=\"text-xs text-neutral-400 ml-auto\">{projectTheme?.mode || 'light'}</span>\n                      </div>\n                    </div>\n\n                    {/* Version & Status */}\n                    <div className=\"space-y-2\">\n                      <h4 className=\"text-xs font-medium text-neutral-700 uppercase tracking-wide\">Project Info</h4>\n                      <div className=\"space-y-1 text-xs text-neutral-600\">\n                        <div className=\"flex justify-between\">\n                          <span>Version</span>\n                          <span className=\"font-medium\">{useProjectStore.getState().metadata.version}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span>Author</span>\n                          <span className=\"font-medium\">{useProjectStore.getState().metadata.author || 'Unknown'}</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* File Path (if saved) */}\n                    {useProjectStore.getState().metadata.filePath && (\n                      <div className=\"space-y-1\">\n                        <h4 className=\"text-xs font-medium text-neutral-700 uppercase tracking-wide\">File Location</h4>\n                        <p className=\"text-xs text-neutral-500 font-mono truncate\" title={useProjectStore.getState().metadata.filePath || ''}>\n                          {useProjectStore.getState().metadata.filePath}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n\n              {/* Selection Summary (UJ-1.1.2) */}\n              {activeSidebarTab === 'components' && selectedComponentIds.length > 0 && (\n                <div className=\"p-3 border-t border-neutral-200 bg-primary-50\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-primary-700 font-medium\">\n                      {selectedComponentIds.length} component{selectedComponentIds.length !== 1 ? 's' : ''} selected\n                    </span>\n                    <button\n                      type=\"button\"\n                      onClick={() => setSelectedComponentIds([])}\n                      className=\"text-xs text-primary-600 hover:text-primary-800 underline\"\n                    >\n                      Clear\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          }\n          mainContent={\n            <CanvasEditor\n              elements={canvasElements}\n              selectedIds={selectedElementIds}\n              onSelect={handleElementSelect}\n              onMove={handleElementMove}\n              onResize={handleElementMove}\n              onDelete={handleElementDelete}\n              onDrop={handleElementDrop}\n              onClear={handleClearCanvas}\n              onUndo={handleUndo}\n              canUndo={canvasHistory.length > 0}\n              // Link canvas size to window config\n              canvasWidth={windowConfig.width}\n              canvasHeight={windowConfig.height}\n              getComponentCode={getComponentCode}\n              templateName={loadedTemplateName ?? undefined}\n              className=\"bg-neutral-100\" // Add a background to distinguish the canvas area\n              initialZoom={0.6}\n              gridSettings={{ size: 16, snap: true, visible: true }}\n              canvasTheme={projectTheme} // Use project theme (isolated from App Factory theme)\n            />\n          }\n          bottomPanel={\n            <BackendBlueprintPanel\n              className=\"h-full\"\n              compact\n              projectName={projectName}\n              canvasElements={canvasElements}\n              pluginRegistry={pluginSlots}\n              manualSlots={manualPluginSlots}\n              onSlotClick={handleBlueprintSlotClick}\n              onAddSlot={handleAddManualSlot}\n              onRemoveSlot={handleRemoveManualSlot}\n            />\n          }\n          rightSidebar={\n            <div className=\"h-full flex flex-col\">\n              {selectedPluginForConfig ? (\n                // Show plugin configuration panel when a plugin is selected\n                <PluginConfigPanel\n                  plugin={{\n                    id: selectedPluginForConfig.id,\n                    name: selectedPluginForConfig.name,\n                    version: selectedPluginForConfig.version,\n                    contract: selectedPluginForConfig.contract,\n                    description: selectedPluginForConfig.description,\n                    config: selectedPluginForConfig.config || [],\n                  }}\n                  onChange={(key, value) => {\n                    // Update the plugin config in the plugins array\n                    setPlugins((prev) =>\n                      prev.map((p) =>\n                        p.id === selectedPluginForConfig?.id\n                          ? {\n                            ...p,\n                            config: (p as PluginInfoWithConfig).config?.map((opt) =>\n                              opt.key === key ? { ...opt, value } : opt\n                            ),\n                          }\n                          : p\n                      )\n                    );\n                  }}\n                  onApply={(config) => {\n                    console.log('Applied plugin config:', selectedPluginForConfig?.id, config);\n                  }}\n                  onClose={() => setSelectedPluginForConfig(null)}\n                />\n              ) : (\n                // Show element properties when a canvas element is selected\n                <>\n                  <div className=\"p-3 border-b border-neutral-200\">\n                    <h2 className=\"text-sm font-semibold text-neutral-700\">Properties</h2>\n                  </div>\n                  <div className=\"flex-1 overflow-auto\">\n                    <PropertyInspector\n                      selectedElement={\n                        selectedElement\n                          ? {\n                            id: selectedElement.id,\n                            name: selectedElement.name,\n                            type: selectedElement.type,\n                            componentId: selectedElement.componentId,\n                          }\n                          : undefined\n                      }\n                      properties={\n                        selectedElement\n                          ? [\n                            {\n                              key: 'x',\n                              label: 'X Position',\n                              type: 'number',\n                              value: selectedElement.bounds.x,\n                              category: 'Position',\n                            },\n                            {\n                              key: 'y',\n                              label: 'Y Position',\n                              type: 'number',\n                              value: selectedElement.bounds.y,\n                              category: 'Position',\n                            },\n                            {\n                              key: 'width',\n                              label: 'Width',\n                              type: 'number',\n                              value: selectedElement.bounds.width,\n                              min: 1,\n                              category: 'Size',\n                            },\n                            {\n                              key: 'height',\n                              label: 'Height',\n                              type: 'number',\n                              value: selectedElement.bounds.height,\n                              min: 1,\n                              category: 'Size',\n                            },\n                            // Add component-specific properties if available\n                            ...(selectedElement.type === 'component' ? [\n                              {\n                                key: 'children',\n                                label: 'Label/Content',\n                                type: 'string' as const,\n                                value: selectedElement.props?.children || selectedElement.props?.label || '',\n                                category: 'Content'\n                              },\n                              {\n                                key: 'variant',\n                                label: 'Variant',\n                                type: 'select' as const,\n                                value: selectedElement.props?.variant || 'contained',\n                                options: [\n                                  { label: 'Contained', value: 'contained' },\n                                  { label: 'Outlined', value: 'outlined' },\n                                  { label: 'Text', value: 'text' }\n                                ],\n                                category: 'Style'\n                              },\n                              {\n                                key: 'color',\n                                label: 'Color',\n                                type: 'select' as const,\n                                value: selectedElement.props?.color || 'primary',\n                                options: [\n                                  { label: 'Primary', value: 'primary' },\n                                  { label: 'Secondary', value: 'secondary' },\n                                  { label: 'Success', value: 'success' },\n                                  { label: 'Error', value: 'error' }\n                                ],\n                                category: 'Style'\n                              },\n                              // Stats Card Props\n                              ...(selectedElement.componentId?.includes('stats') ? [\n                                { key: 'title', label: 'Title', type: 'string' as const, value: selectedElement.props?.title || 'Total Revenue', category: 'Content' },\n                                { key: 'value', label: 'Value', type: 'string' as const, value: selectedElement.props?.value || '$45,231.89', category: 'Content' },\n                                { key: 'trend', label: 'Trend', type: 'string' as const, value: selectedElement.props?.trend || '+20.1%', category: 'Content' },\n                                { key: 'progress', label: 'Progress %', type: 'number' as const, value: selectedElement.props?.progress || 70, category: 'Content' }\n                              ] : [])\n                            ] : [])\n                          ]\n                          : []\n                      }\n                      onChange={handlePropertyChange}\n                      editable\n                    />\n                  </div>\n                </>\n              )}\n            </div>\n          }\n\n          initialPanels={{\n            left: { type: 'plugins', visible: true },\n            right: { type: 'properties', visible: true },\n            bottom: { type: 'preview', visible: showBackendBlueprint, size: showBackendBlueprint ? 400 : 0 },\n          }}\n          preset=\"split\"\n          resizable\n          collapsible\n        />\n        {saveNotice && (\n          <div className=\"fixed top-16 right-4 z-50 pointer-events-none\">\n            <div className=\"flex items-center gap-2 rounded-md border border-success-200 bg-success-50 px-3 py-1.5 text-xs text-success-700 shadow-sm\">\n              <span className=\"font-medium\">Saved</span>\n              <span className=\"font-mono truncate\" title={saveNotice}>\n                {saveNotice}\n              </span>\n            </div>\n          </div>\n        )}\n        {/* Theme Customization Panel Overlay (UJ-1.1.1) */}\n        <ThemeCustomizationPanel\n          isOpen={isThemePanelOpen}\n          onClose={() => setIsThemePanelOpen(false)}\n          position=\"right\"\n          width=\"380px\"\n          onApplyToCanvas={(themeConfig) => {\n            // Update project store theme - this will flow to CanvasEditor via projectTheme prop\n            useProjectStore.getState().setTheme(themeConfig);\n          }}\n        />\n        {/* Window Config Panel Overlay (UJ-1.1.6) */}\n        <WindowConfigPanel\n          isOpen={isWindowConfigOpen}\n          onClose={() => setIsWindowConfigOpen(false)}\n          position=\"right\"\n          width=\"380px\"\n        />\n        {/* Component Generator Full-Screen Modal (UJ-1.1.3) */}\n        <Modal\n          isOpen={showGeneratorModal}\n          onClose={() => setShowGeneratorModal(false)}\n          title=\"AI Component Generator\"\n          size=\"full\"\n        >\n          <div className=\"h-[80vh]\">\n            <ComponentGenerator\n              onGenerate={async (prompt, type, framework) => {\n                const result = await generateComponent(prompt, type, framework);\n                return result;\n              }}\n              onSave={(component) => {\n                handleAddGeneratedComponent(component);\n                setShowGeneratorModal(false);\n              }}\n              onCopy={(code) => {\n                navigator.clipboard.writeText(code);\n              }}\n              isGenerating={generatorState.isGenerating}\n              className=\"h-full\"\n            />\n          </div>\n        </Modal>\n        {/* Settings Panel */}\n        <SettingsPanel\n          isOpen={isSettingsOpen}\n          onClose={() => setIsSettingsOpen(false)}\n        />\n        {/* AI Team Visualization Modal (New) */}\n        <Modal\n          isOpen={isAiTeamOpen}\n          onClose={() => setIsAiTeamOpen(false)}\n          title=\"AI Agent Team\"\n          size=\"full\"\n        >\n          <div className=\"h-[80vh]\">\n            <AiTeamVisualization />\n          </div>\n        </Modal>\n        {/* Import Wizard (EUR-1.1.3b) */}\n        <ImportWizard\n          isOpen={showImportWizard}\n          onClose={() => setShowImportWizard(false)}\n          onImport={handleImportComponent}\n        />\n      </div>\n    </ThemeProvider>\n  );\n};\n\nexport default App;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\AgentConfigPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":67,"column":16,"nodeType":"Identifier","messageId":"alwaysTruthy","endLine":67,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AgentConfigPanel.tsx\r\n * ====================\r\n * Collapsible accordion panel for configuring individual agents.\r\n * \r\n * Features:\r\n * - Agent enable/disable toggle in header\r\n * - LLM Provider dropdown (integrates with ApiKeyManager)\r\n * - LLM Model selection\r\n * - Temperature slider\r\n * - System prompt editor\r\n * - Tools toggle section\r\n * - Config validation with inline errors\r\n * \r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n */\r\n\r\nimport React, { useState, useCallback, useMemo } from 'react';\r\nimport { useAiTeamStore, type AgentConfiguration } from '../../stores/aiTeamStore';\r\nimport { validateAgentConfig, type ApiKeyInfo } from './ConfigValidator';\r\nimport { MODEL_OPTIONS } from '../../stores/settingsStore';\r\n\r\n// Provider options matching SettingsPanel\r\nconst PROVIDER_OPTIONS = [\r\n    { id: 'gemini', label: 'Google Gemini' },\r\n    { id: 'openai', label: 'OpenAI' },\r\n    { id: 'anthropic', label: 'Anthropic' },\r\n    { id: 'ollama', label: 'Ollama (Local)' },\r\n];\r\n\r\ninterface AgentConfigAccordionProps {\r\n    agent: AgentConfiguration;\r\n    apiKeys: ApiKeyInfo[];\r\n    isExpanded: boolean;\r\n    onToggleExpand: () => void;\r\n    disabled?: boolean;\r\n}\r\n\r\n/**\r\n * Single agent configuration accordion item.\r\n */\r\nconst AgentConfigAccordion: React.FC<AgentConfigAccordionProps> = ({\r\n    agent,\r\n    apiKeys,\r\n    isExpanded,\r\n    onToggleExpand,\r\n    disabled = false,\r\n}) => {\r\n    const {\r\n        updateAgentConfig,\r\n        toggleAgent,\r\n        toggleAgentTool,\r\n        isWorkflowRunning,\r\n    } = useAiTeamStore();\r\n\r\n    // Validate current config\r\n    const validation = useMemo(() =>\r\n        validateAgentConfig(agent, apiKeys),\r\n        [agent, apiKeys]\r\n    );\r\n\r\n    const isDisabled = disabled || isWorkflowRunning;\r\n\r\n    // Get available models for selected provider\r\n    const availableModels = useMemo(() => {\r\n        const models = MODEL_OPTIONS[agent.provider as keyof typeof MODEL_OPTIONS];\r\n        return models || [];\r\n    }, [agent.provider]);\r\n\r\n    // Handlers\r\n    const handleToggleEnabled = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (!isDisabled) {\r\n            toggleAgent(agent.id, e.target.checked);\r\n        }\r\n    }, [agent.id, toggleAgent, isDisabled]);\r\n\r\n    const handleProviderChange = useCallback((e: React.ChangeEvent<HTMLSelectElement>) => {\r\n        updateAgentConfig(agent.id, { provider: e.target.value });\r\n    }, [agent.id, updateAgentConfig]);\r\n\r\n    const handleModelChange = useCallback((e: React.ChangeEvent<HTMLSelectElement>) => {\r\n        updateAgentConfig(agent.id, { model: e.target.value });\r\n    }, [agent.id, updateAgentConfig]);\r\n\r\n    const handleTemperatureChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const value = parseFloat(e.target.value);\r\n        if (!isNaN(value)) {\r\n            updateAgentConfig(agent.id, { temperature: value });\r\n        }\r\n    }, [agent.id, updateAgentConfig]);\r\n\r\n    const handlePromptChange = useCallback((e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        updateAgentConfig(agent.id, { systemPrompt: e.target.value });\r\n    }, [agent.id, updateAgentConfig]);\r\n\r\n    const handleToolToggle = useCallback((toolId: string, enabled: boolean) => {\r\n        toggleAgentTool(agent.id, toolId, enabled);\r\n    }, [agent.id, toggleAgentTool]);\r\n\r\n    return (\r\n        <div className={`\r\n            border rounded-lg overflow-hidden transition-colors\r\n            ${agent.enabled\r\n                ? 'border-neutral-600 bg-neutral-800/50'\r\n                : 'border-neutral-700 bg-neutral-900/50 opacity-60'\r\n            }\r\n        `}>\r\n            {/* Header */}\r\n            <div\r\n                className=\"flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-neutral-700/30 transition-colors\"\r\n                onClick={onToggleExpand}\r\n            >\r\n                <div className=\"flex items-center gap-3\">\r\n                    {/* Expand/Collapse Icon */}\r\n                    <svg\r\n                        className={`w-4 h-4 text-neutral-400 transition-transform ${isExpanded ? 'rotate-90' : ''}`}\r\n                        viewBox=\"0 0 24 24\"\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        strokeWidth=\"2\"\r\n                    >\r\n                        <polyline points=\"9 18 15 12 9 6\" />\r\n                    </svg>\r\n\r\n                    {/* Agent Name */}\r\n                    <span className={`font-medium ${agent.enabled ? 'text-neutral-100' : 'text-neutral-400'}`}>\r\n                        {agent.name}\r\n                    </span>\r\n\r\n                    {/* Validation indicator */}\r\n                    {agent.enabled && !validation.valid && (\r\n                        <span className=\"text-xs text-red-400 flex items-center gap-1\">\r\n                            <svg className=\"w-3 h-3\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\" />\r\n                            </svg>\r\n                            Config error\r\n                        </span>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Enable/Disable Toggle */}\r\n                <label\r\n                    className=\"relative inline-flex items-center cursor-pointer\"\r\n                    onClick={(e) => e.stopPropagation()}\r\n                >\r\n                    <input\r\n                        type=\"checkbox\"\r\n                        checked={agent.enabled}\r\n                        onChange={handleToggleEnabled}\r\n                        disabled={isDisabled}\r\n                        className=\"sr-only peer\"\r\n                    />\r\n                    <div className={`\r\n                        w-9 h-5 bg-neutral-700 rounded-full peer \r\n                        peer-checked:bg-primary-500\r\n                        peer-disabled:opacity-50 peer-disabled:cursor-not-allowed\r\n                        after:content-[''] after:absolute after:top-0.5 after:left-[2px] \r\n                        after:bg-white after:rounded-full after:h-4 after:w-4 \r\n                        after:transition-all peer-checked:after:translate-x-full\r\n                    `} />\r\n                </label>\r\n            </div>\r\n\r\n            {/* Expandable Content */}\r\n            {isExpanded && agent.enabled && (\r\n                <div className=\"px-4 pb-4 space-y-4 border-t border-neutral-700\">\r\n                    {/* Validation Errors */}\r\n                    {!validation.valid && (\r\n                        <div className=\"mt-3 p-2 bg-red-900/30 border border-red-700/50 rounded text-xs text-red-300\">\r\n                            <ul className=\"list-disc list-inside space-y-1\">\r\n                                {validation.errors.map((error, i) => (\r\n                                    <li key={i}>{error}</li>\r\n                                ))}\r\n                            </ul>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* LLM Provider */}\r\n                    <div className=\"mt-3\">\r\n                        <label className=\"block text-xs font-medium text-neutral-400 mb-1\">\r\n                            LLM Provider\r\n                        </label>\r\n                        <select\r\n                            value={agent.provider}\r\n                            onChange={handleProviderChange}\r\n                            disabled={isDisabled}\r\n                            className=\"w-full px-2 py-1.5 text-sm bg-neutral-900 border border-neutral-600 rounded text-neutral-100 focus:ring-1 focus:ring-primary-500 disabled:opacity-50\"\r\n                        >\r\n                            {PROVIDER_OPTIONS.map((opt) => (\r\n                                <option key={opt.id} value={opt.id}>\r\n                                    {opt.label}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n\r\n                    {/* LLM Model */}\r\n                    <div>\r\n                        <label className=\"block text-xs font-medium text-neutral-400 mb-1\">\r\n                            Model\r\n                        </label>\r\n                        <select\r\n                            value={agent.model}\r\n                            onChange={handleModelChange}\r\n                            disabled={isDisabled}\r\n                            className=\"w-full px-2 py-1.5 text-sm bg-neutral-900 border border-neutral-600 rounded text-neutral-100 focus:ring-1 focus:ring-primary-500 disabled:opacity-50\"\r\n                        >\r\n                            {availableModels.length > 0 ? (\r\n                                availableModels.map((opt) => (\r\n                                    <option key={opt.id} value={opt.id}>\r\n                                        {opt.label}\r\n                                    </option>\r\n                                ))\r\n                            ) : (\r\n                                <option value={agent.model}>{agent.model}</option>\r\n                            )}\r\n                        </select>\r\n                    </div>\r\n\r\n                    {/* Temperature */}\r\n                    <div>\r\n                        <label className=\"block text-xs font-medium text-neutral-400 mb-1\">\r\n                            Temperature: {agent.temperature.toFixed(1)}\r\n                        </label>\r\n                        <input\r\n                            type=\"range\"\r\n                            min=\"0\"\r\n                            max=\"2\"\r\n                            step=\"0.1\"\r\n                            value={agent.temperature}\r\n                            onChange={handleTemperatureChange}\r\n                            disabled={isDisabled}\r\n                            className=\"w-full h-1.5 bg-neutral-700 rounded-lg appearance-none cursor-pointer accent-primary-500 disabled:opacity-50\"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* System Prompt (collapsed by default) */}\r\n                    <details className=\"group\">\r\n                        <summary className=\"text-xs font-medium text-neutral-400 cursor-pointer hover:text-neutral-300 flex items-center gap-1\">\r\n                            <svg className=\"w-3 h-3 transition-transform group-open:rotate-90\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                <polyline points=\"9 18 15 12 9 6\" />\r\n                            </svg>\r\n                            System Prompt\r\n                        </summary>\r\n                        <textarea\r\n                            value={agent.systemPrompt}\r\n                            onChange={handlePromptChange}\r\n                            disabled={isDisabled}\r\n                            rows={4}\r\n                            className=\"mt-2 w-full px-2 py-1.5 text-xs bg-neutral-900 border border-neutral-600 rounded text-neutral-100 focus:ring-1 focus:ring-primary-500 disabled:opacity-50 resize-none\"\r\n                            placeholder=\"Enter system instructions...\"\r\n                        />\r\n                    </details>\r\n\r\n                    {/* Tools */}\r\n                    {agent.tools.length > 0 && (\r\n                        <div>\r\n                            <label className=\"block text-xs font-medium text-neutral-400 mb-2\">\r\n                                Tools\r\n                            </label>\r\n                            <div className=\"space-y-2\">\r\n                                {agent.tools.map((tool) => (\r\n                                    <label\r\n                                        key={tool.id}\r\n                                        className=\"flex items-center gap-2 text-sm text-neutral-300 cursor-pointer\"\r\n                                    >\r\n                                        <input\r\n                                            type=\"checkbox\"\r\n                                            checked={tool.enabled}\r\n                                            onChange={(e) => handleToolToggle(tool.id, e.target.checked)}\r\n                                            disabled={isDisabled}\r\n                                            className=\"w-4 h-4 rounded border-neutral-600 bg-neutral-800 text-primary-500 focus:ring-primary-500 disabled:opacity-50\"\r\n                                        />\r\n                                        {tool.name}\r\n                                    </label>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n// ============================================\r\n// MAIN COMPONENT\r\n// ============================================\r\n\r\ninterface AgentConfigPanelProps {\r\n    className?: string;\r\n    /** API keys from ApiKeyManager for validation */\r\n    apiKeys?: ApiKeyInfo[];\r\n}\r\n\r\n/**\r\n * Right panel containing all agent configuration accordions.\r\n */\r\nexport const AgentConfigPanel: React.FC<AgentConfigPanelProps> = ({\r\n    className = '',\r\n    apiKeys = [],\r\n}) => {\r\n    const { agentConfigs } = useAiTeamStore();\r\n\r\n    // Track which agent is expanded\r\n    const [expandedAgentId, setExpandedAgentId] = useState<string | null>('orchestrator');\r\n\r\n    const handleToggleExpand = useCallback((agentId: string) => {\r\n        setExpandedAgentId((current) => current === agentId ? null : agentId);\r\n    }, []);\r\n\r\n    return (\r\n        <div className={`h-full flex flex-col bg-neutral-900 ${className}`}>\r\n            {/* Header */}\r\n            <div className=\"px-4 py-3 border-b border-neutral-700\">\r\n                <h3 className=\"text-sm font-semibold text-neutral-100\">Agent Configuration</h3>\r\n                <p className=\"text-xs text-neutral-500 mt-0.5\">Configure LLM and tools for each agent</p>\r\n            </div>\r\n\r\n            {/* Scrollable list of agents */}\r\n            <div className=\"flex-1 overflow-y-auto p-3 space-y-2 custom-scrollbar\">\r\n                {agentConfigs.map((agent) => (\r\n                    <AgentConfigAccordion\r\n                        key={agent.id}\r\n                        agent={agent}\r\n                        apiKeys={apiKeys}\r\n                        isExpanded={expandedAgentId === agent.id}\r\n                        onToggleExpand={() => handleToggleExpand(agent.id)}\r\n                    />\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nAgentConfigPanel.displayName = 'AgentConfigPanel';\r\n\r\nexport default AgentConfigPanel;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\AiAppChatPanel.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":216,"column":51,"nodeType":"Identifier","messageId":"invalidType","endLine":216,"endColumn":60},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":223,"column":39,"nodeType":"MemberExpression","messageId":"invalidType","endLine":223,"endColumn":50},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":233,"column":51,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":233,"endColumn":83},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .changes on an `any` value.","line":234,"column":56,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":234,"endColumn":63},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .changes on an `any` value.","line":234,"column":88,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":234,"endColumn":95},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":235,"column":53,"nodeType":"Identifier","messageId":"alwaysTruthy","endLine":235,"endColumn":73},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `CanvasChange[]`.","line":237,"column":74,"nodeType":"MemberExpression","messageId":"unsafeArgument","endLine":237,"endColumn":88},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .changes on an `any` value.","line":237,"column":81,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":237,"endColumn":88},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":275,"column":47,"nodeType":"Identifier","messageId":"invalidType","endLine":275,"endColumn":56},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":439,"column":57,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":439,"endColumn":64},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":441,"column":58,"nodeType":"MemberExpression","messageId":"invalidType","endLine":441,"endColumn":69},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":441,"column":74,"nodeType":"MemberExpression","messageId":"invalidType","endLine":441,"endColumn":85},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":441,"column":96,"nodeType":"MemberExpression","messageId":"invalidType","endLine":441,"endColumn":111},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":441,"column":115,"nodeType":"MemberExpression","messageId":"invalidType","endLine":441,"endColumn":131},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":467,"column":81,"nodeType":"CallExpression","messageId":"invalidType","endLine":467,"endColumn":118},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":490,"column":55,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":490,"endColumn":60,"fix":{"range":[20686,20733],"text":"/```json\\s*([\\s\\S]*?)\\s*```/.exec(result.text)"}},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":492,"column":35,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":492,"endColumn":68},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .changes on an `any` value.","line":493,"column":40,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":493,"endColumn":47},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .changes on an `any` value.","line":493,"column":72,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":493,"endColumn":79},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .changes on an `any` value.","line":494,"column":79,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":494,"endColumn":86},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `CanvasChange[]`.","line":496,"column":54,"nodeType":"MemberExpression","messageId":"unsafeArgument","endLine":496,"endColumn":68},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .changes on an `any` value.","line":496,"column":61,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":496,"endColumn":68},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'parseErr' is defined but never used.","line":499,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":499,"endColumn":38},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":505,"column":39,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":505,"endColumn":41,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[21607,21609],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":522,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":522,"endColumn":26,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[22322,22322],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[22322,22322],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":655,"column":45,"nodeType":"Identifier","messageId":"invalidType","endLine":655,"endColumn":56}],"suppressedMessages":[],"errorCount":26,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * AiAppChatPanel.tsx\n * ==================\n * AI App Chat panel component for the left sidebar.\n *\n * Features:\n * - Brain with speech bubble icon for sidebar tab\n * - Two modes: Chat (read-only) and Change (edit with approval)\n * - Three scopes: Backend, Frontend, Full\n * - Integrates with aiChatStore for state management\n * - Uses systematic debugging workflow for Change mode\n * - Ctrl+Enter to send, Enter for soft newline\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D010, D011, D014, aiChatStore, aiChatLlmService\n */\n\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport html2canvas from 'html2canvas';\nimport { useAiChatStore, type AiChatScope } from '../../stores/aiChatStore';\nimport { generateWithConfig, type ChatMessage } from '../../services/aiChatLlmService';\nimport { AiChatSettingsModal } from './AiChatSettingsModal';\nimport type { CanvasElement } from '../factory/canvasTypes';\n\n/**\n * Brain with Speech Bubble icon for AI App Chat.\n */\nexport const AiAppChatIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        {/* Brain outline - left hemisphere */}\n        <path d=\"M9.5 2C8 2 7 3 7 4.5C7 5 7 5.5 6.5 6C5.5 6.5 5 7.5 5 8.5C5 9.5 5.5 10 6 10.5C5.5 11.5 5.5 12.5 6 13.5C6.5 14.5 7.5 15 8.5 15C8.5 15.5 8.5 16 9 16.5\" />\n        {/* Brain outline - right hemisphere */}\n        <path d=\"M14.5 2C16 2 17 3 17 4.5C17 5 17 5.5 17.5 6C18.5 6.5 19 7.5 19 8.5C19 9.5 18.5 10 18 10.5C18.5 11.5 18.5 12.5 18 13.5C17.5 14.5 16.5 15 15.5 15C15.5 15.5 15.5 16 15 16.5\" />\n        {/* Brain center/connection */}\n        <path d=\"M12 2C12 2 11 4 11 6C11 8 12 9 12 9C12 9 13 8 13 6C13 4 12 2 12 2Z\" />\n        <path d=\"M9 10C10 10 11 9.5 12 9.5C13 9.5 14 10 15 10\" />\n        {/* Speech bubble */}\n        <path d=\"M6 17H4C3 17 2 18 2 19V20C2 21 3 22 4 22H7L9 20L7 18\" />\n        <circle cx=\"4.5\" cy=\"19.5\" r=\"0.5\" fill=\"currentColor\" />\n        <circle cx=\"6\" cy=\"19.5\" r=\"0.5\" fill=\"currentColor\" />\n        {/* Connection point */}\n        <path d=\"M12 16.5V15\" />\n    </svg>\n);\n\n/**\n * Settings gear icon.\n */\nconst SettingsIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <circle cx=\"12\" cy=\"12\" r=\"3\" />\n        <path d=\"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42\" />\n    </svg>\n);\n\n/**\n * Clear/trash icon.\n */\nconst ClearIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        <polyline points=\"3 6 5 6 21 6\" />\n        <path d=\"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2\" />\n    </svg>\n);\n\n/**\n * Resize handle icon (double arrow vertical).\n */\nconst ResizeHandleIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        <path d=\"M12 5l-3 3h6l-3-3z\" fill=\"currentColor\" />\n        <path d=\"M12 19l-3-3h6l-3 3z\" fill=\"currentColor\" />\n        <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\" />\n    </svg>\n);\n\n/**\n * Chat icon (message bubble).\n */\nconst ChatIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        <path d=\"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z\" />\n    </svg>\n);\n\n/**\n * Edit/pencil icon for Change mode.\n */\nconst EditIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        <path d=\"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7\" />\n        <path d=\"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z\" />\n    </svg>\n);\n\n/**\n * User icon.\n */\nconst UserIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        <path d=\"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2\" />\n        <circle cx=\"12\" cy=\"7\" r=\"4\" />\n    </svg>\n);\n\n/**\n * AI assistant icon.\n */\nconst AssistantIcon: React.FC<{ className?: string }> = ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n        <path d=\"M12 2a2 2 0 012 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 017 7h1a1 1 0 011 1v3a1 1 0 01-1 1h-1v1a2 2 0 01-2 2H5a2 2 0 01-2-2v-1H2a1 1 0 01-1-1v-3a1 1 0 011-1h1a7 7 0 017-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 012-2z\" />\n        <circle cx=\"7.5\" cy=\"14.5\" r=\"1.5\" />\n        <circle cx=\"16.5\" cy=\"14.5\" r=\"1.5\" />\n    </svg>\n);\n\n/**\n * Loading dots component.\n */\nconst LoadingDots: React.FC = () => (\n    <div className=\"flex items-center gap-1\">\n        <span className=\"w-2 h-2 bg-primary-500 rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\n        <span className=\"w-2 h-2 bg-primary-500 rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\n        <span className=\"w-2 h-2 bg-primary-500 rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\n    </div>\n);\n\n/**\n * Scope config for styling.\n */\nconst SCOPE_CONFIG: Record<AiChatScope, { label: string; short: string; color: string; activeColor: string }> = {\n    backend: {\n        label: 'Backend',\n        short: 'BE',\n        color: 'text-amber-600',\n        activeColor: 'bg-amber-500 text-white',\n    },\n    frontend: {\n        label: 'Frontend',\n        short: 'FE',\n        color: 'text-blue-600',\n        activeColor: 'bg-blue-500 text-white',\n    },\n    full: {\n        label: 'Full',\n        short: 'Full',\n        color: 'text-purple-600',\n        activeColor: 'bg-purple-500 text-white',\n    },\n};\n\n/**\n * Canvas change from AI response.\n */\nexport interface CanvasChange {\n    elementId?: string;\n    action?: 'add' | 'update' | 'delete';\n    name?: string;\n    code: string;\n}\n\n/**\n * Props for AiAppChatPanel.\n */\nexport interface AiAppChatPanelProps {\n    /** Custom className */\n    className?: string;\n    /** Callback to apply generated code to the canvas (legacy) */\n    onApplyCode?: (code: string, language: string) => void;\n    /** Canvas elements for context injection */\n    canvasElements?: CanvasElement[];\n    /** Function to get component code by ID */\n    getComponentCode?: (componentId: string) => { code?: string;[key: string]: unknown } | null;\n    /** Callback to apply structured canvas changes */\n    onApplyCanvasChanges?: (changes: CanvasChange[]) => void;\n}\n\n/**\n * Single chat message component with code block detection and Apply button.\n */\nconst ChatMessageItem: React.FC<{\n    message: ChatMessage;\n    showTimestamp?: boolean;\n    onApplyCode?: (code: string, language: string) => void;\n    onApplyCanvasChanges?: (changes: CanvasChange[]) => void;\n}> = ({\n    message,\n    showTimestamp = true,\n    onApplyCode,\n    onApplyCanvasChanges,\n}) => {\n        const isUser = message.role === 'user';\n        const isSystem = message.role === 'system';\n\n        const containerStyles = [\n            'flex gap-2 p-2 rounded-lg text-sm',\n            isUser ? 'bg-primary-50' : isSystem ? 'bg-amber-50' : 'bg-neutral-50',\n        ].join(' ');\n\n        const avatarStyles = [\n            'flex items-center justify-center w-6 h-6 rounded-full shrink-0',\n            isUser ? 'bg-primary-100 text-primary-600' : isSystem ? 'bg-amber-100 text-amber-600' : 'bg-neutral-200 text-neutral-600',\n        ].join(' ');\n\n        // Parse content to detect code blocks\n        const renderContent = (content: string) => {\n            // Regex to detect ```language\\n...code...\\n``` blocks\n            const codeBlockRegex = /```(\\w*)\\n([\\s\\S]*?)```/g;\n            const parts: React.ReactNode[] = [];\n            let lastIndex = 0;\n            let match;\n\n            while ((match = codeBlockRegex.exec(content)) !== null) {\n                // Text before the code block\n                if (match.index > lastIndex) {\n                    parts.push(<span key={`text-${lastIndex}`}>{content.slice(lastIndex, match.index)}</span>);\n                }\n\n                const language = match[1] || 'javascript';\n                const code = match[2];\n\n                parts.push(\n                    <div key={`code-${match.index}`} className=\"my-2 rounded-md overflow-hidden border border-neutral-200\">\n                        <div className=\"flex items-center justify-between px-2 py-1 bg-neutral-800 text-xs\">\n                            <span className=\"text-neutral-300 uppercase\">{language}</span>\n                            {language === 'json' && onApplyCanvasChanges ? (\n                                <button\n                                    type=\"button\"\n                                    onClick={() => {\n                                        // Debugging: Alert start\n                                        alert('Clicked Apply Changes');\n                                        try {\n                                            const parsed = JSON.parse(code.trim());\n                                            if (parsed.changes && Array.isArray(parsed.changes)) {\n                                                if (onApplyCanvasChanges) {\n                                                    // alert('Calling onApplyCanvasChanges with ' + parsed.changes.length + ' changes');\n                                                    onApplyCanvasChanges(parsed.changes);\n                                                } else {\n                                                    alert('Error: onApplyCanvasChanges prop is missing!');\n                                                }\n                                            } else {\n                                                console.warn('[ChatMessageItem] JSON does not contain valid changes array');\n                                                alert('Error: JSON missing \"changes\" array');\n                                            }\n                                        } catch (e) {\n                                            console.error('[ChatMessageItem] Failed to parse JSON changes', e);\n                                            alert('Error parsing JSON changes:\\n' + (e instanceof Error ? e.message : String(e)));\n                                        }\n                                    }}\n                                    className=\"px-2 py-0.5 bg-green-600 text-white rounded text-[10px] font-medium hover:bg-green-700 transition-colors\"\n                                >\n                                    Apply Changes\n                                </button>\n                            ) : onApplyCode ? (\n                                <button\n                                    type=\"button\"\n                                    onClick={() => onApplyCode(code.trim(), language)}\n                                    className=\"px-2 py-0.5 bg-primary-500 text-white rounded text-[10px] font-medium hover:bg-primary-600 transition-colors\"\n                                >\n                                    Apply to Canvas\n                                </button>\n                            ) : null}\n                        </div>\n                        <pre className=\"p-2 bg-neutral-900 text-neutral-100 text-xs overflow-x-auto\">\n                            <code>{code}</code>\n                        </pre>\n                    </div>\n                );\n\n                lastIndex = match.index + match[0].length;\n            }\n\n            // Remaining text after the last code block\n            if (lastIndex < content.length) {\n                parts.push(<span key={`text-${lastIndex}`}>{content.slice(lastIndex)}</span>);\n            }\n\n            return parts.length > 0 ? parts : content;\n        };\n\n        return (\n            <div className={containerStyles}>\n                <div className={avatarStyles}>\n                    {isUser ? <UserIcon className=\"h-3.5 w-3.5\" /> : <AssistantIcon className=\"h-3.5 w-3.5\" />}\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2 mb-0.5\">\n                        <span className=\"text-xs font-medium text-neutral-700\">\n                            {isUser ? 'You' : isSystem ? 'System' : 'AI'}\n                        </span>\n                        {showTimestamp && (\n                            <span className=\"text-[10px] text-neutral-400\">\n                                {new Date(message.timestamp).toLocaleTimeString(undefined, { hour: '2-digit', minute: '2-digit' })}\n                            </span>\n                        )}\n                    </div>\n                    <div className=\"text-neutral-800 whitespace-pre-wrap break-words\">\n                        {renderContent(message.content)}\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n/**\n * AI App Chat Panel component.\n * Replaces left sidebar content when AI Chat tab is active.\n */\nexport const AiAppChatPanel: React.FC<AiAppChatPanelProps> = ({\n    className = '',\n    onApplyCode,\n    canvasElements = [],\n    getComponentCode,\n    onApplyCanvasChanges,\n}) => {\n    // Store state\n    const {\n        mode,\n        scope,\n        chatHistory,\n        isGenerating,\n        error,\n        isSettingsOpen,\n        setMode,\n        setScope,\n        addMessage,\n        clearHistory,\n        setIsGenerating,\n        setError,\n        toggleSettings,\n        getCurrentConfig,\n    } = useAiChatStore();\n\n    // Local state\n    const [inputValue, setInputValue] = useState('');\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n    const inputContainerRef = useRef<HTMLDivElement>(null);\n\n    // Persisted textarea height\n    const STORAGE_KEY = 'ai-chat-input-height';\n    const DEFAULT_HEIGHT = 60;\n    const MIN_HEIGHT = 32;\n    const MAX_HEIGHT = 300;\n\n    const [inputHeight, setInputHeight] = useState<number>(() => {\n        const saved = localStorage.getItem(STORAGE_KEY);\n        return saved ? Math.max(MIN_HEIGHT, Math.min(MAX_HEIGHT, parseInt(saved, 10))) : DEFAULT_HEIGHT;\n    });\n\n    // Resize drag state\n    const [isResizing, setIsResizing] = useState(false);\n    const resizeStartY = useRef<number>(0);\n    const resizeStartHeight = useRef<number>(0);\n\n    // Get current scope's messages\n    const messages = chatHistory[scope];\n\n    // Auto-scroll to bottom\n    useEffect(() => {\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    }, [messages]);\n\n    // Focus textarea on mount\n    useEffect(() => {\n        textareaRef.current?.focus();\n    }, []);\n\n    // Handle resize drag\n    useEffect(() => {\n        if (!isResizing) return;\n\n        const handleMouseMove = (e: MouseEvent) => {\n            const delta = resizeStartY.current - e.clientY;\n            const newHeight = Math.max(MIN_HEIGHT, Math.min(MAX_HEIGHT, resizeStartHeight.current + delta));\n            setInputHeight(newHeight);\n        };\n\n        const handleMouseUp = () => {\n            setIsResizing(false);\n            // Persist to localStorage\n            localStorage.setItem(STORAGE_KEY, inputHeight.toString());\n        };\n\n        document.addEventListener('mousemove', handleMouseMove);\n        document.addEventListener('mouseup', handleMouseUp);\n\n        return () => {\n            document.removeEventListener('mousemove', handleMouseMove);\n            document.removeEventListener('mouseup', handleMouseUp);\n        };\n    }, [isResizing, inputHeight]);\n\n    // Start resize\n    const handleResizeStart = useCallback((e: React.MouseEvent) => {\n        e.preventDefault();\n        setIsResizing(true);\n        resizeStartY.current = e.clientY;\n        resizeStartHeight.current = inputHeight;\n    }, [inputHeight]);\n\n    /**\n     * Handle sending a message.\n     */\n    const handleSend = useCallback(async () => {\n        const trimmed = inputValue.trim();\n        if (!trimmed || isGenerating) return;\n\n        setInputValue('');\n        setError(null);\n\n        // Add user message\n        addMessage({ role: 'user', content: trimmed });\n\n        // Get current config\n        const config = getCurrentConfig();\n\n        // Generate response\n        setIsGenerating(true);\n        console.log('[AiAppChatPanel] Starting generation for prompt:', trimmed);\n        try {\n            // Convert ChatMessage[] to expected format\n            const history = messages.map(m => ({\n                ...m,\n                timestamp: m.timestamp instanceof Date ? m.timestamp : new Date(m.timestamp),\n            }));\n\n            // Capture canvas if frontend/full scope\n            const images: string[] = [];\n            // Build canvas context for AI\n            let canvasContext = '';\n\n            if (scope === 'frontend' || scope === 'full') {\n                // Build structured canvas context with element codes\n                if (canvasElements.length > 0 && getComponentCode) {\n                    canvasContext = '\\n\\n--- CANVAS_CONTEXT ---\\n';\n                    canvasElements.forEach((el, idx) => {\n                        const codeInfo = el.componentId ? getComponentCode(el.componentId) : null;\n                        canvasContext += `### Element ${idx + 1}: ${el.name} (ID: ${el.id})\\n`;\n                        canvasContext += `- Type: ${el.type}\\n`;\n                        canvasContext += `- Position: (${el.bounds.x}, ${el.bounds.y}) Size: ${el.bounds.width}x${el.bounds.height}\\n`;\n                        if (codeInfo?.code) {\n                            canvasContext += '```jsx\\n' + codeInfo.code + '\\n```\\n\\n';\n                        } else {\n                            canvasContext += '(No code available)\\n\\n';\n                        }\n                    });\n                    canvasContext += '--- END CANVAS_CONTEXT ---\\n';\n                    console.log('[AiAppChatPanel] Canvas context built for', canvasElements.length, 'elements');\n                }\n\n                // Also capture screenshot\n                const canvasElement = document.getElementById('canvas-editor');\n                if (canvasElement) {\n                    console.log('[AiAppChatPanel] Capturing canvas...', {\n                        width: canvasElement.clientWidth,\n                        height: canvasElement.clientHeight\n                    });\n                    try {\n                        const canvas = await html2canvas(canvasElement, {\n                            useCORS: true,\n                            logging: false,\n                            ignoreElements: (element) => element.classList.contains('canvas-controls')\n                        });\n                        const base64Image = canvas.toDataURL('image/png');\n                        images.push(base64Image);\n                        console.log(`[AiAppChatPanel] Canvas captured. Size: ~${Math.round(base64Image.length / 1024)}KB`);\n                    } catch (captureErr) {\n                        console.error('[AiAppChatPanel] Failed to capture canvas:', captureErr);\n                    }\n                } else {\n                    console.warn('[AiAppChatPanel] #canvas-editor element not found');\n                }\n            }\n\n            // Build final prompt with canvas context\n            const finalPrompt = canvasContext ? `${trimmed}\\n${canvasContext}` : trimmed;\n\n            console.log('[AiAppChatPanel] Calling generateWithConfig with history:', history.length, 'images:', images.length);\n            const result = await generateWithConfig(config, finalPrompt, history, images);\n            console.log('[AiAppChatPanel] Result:', result.success);\n\n            if (result.success && result.text) {\n                addMessage({ role: 'assistant', content: result.text });\n\n                // Try to parse JSON changes from AI response\n                if (onApplyCanvasChanges && mode === 'change') {\n                    try {\n                        // Extract JSON from code block if present\n                        const jsonMatch = result.text.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n                        if (jsonMatch) {\n                            const parsed = JSON.parse(jsonMatch[1]);\n                            if (parsed.changes && Array.isArray(parsed.changes)) {\n                                console.log('[AiAppChatPanel] Parsed', parsed.changes.length, 'changes from AI response');\n                                // Auto-apply in change mode - could add confirmation UI later\n                                onApplyCanvasChanges(parsed.changes);\n                            }\n                        }\n                    } catch (parseErr) {\n                        console.log('[AiAppChatPanel] No JSON changes in response (chat mode or plain text)');\n                    }\n                }\n            } else {\n                console.error('[AiAppChatPanel] Generation failed:', result.error);\n                setError(result.error || 'Failed to generate response');\n            }\n        } catch (err) {\n            const errorMessage = err instanceof Error ? err.message : 'Unknown error';\n            setError(errorMessage);\n        } finally {\n            setIsGenerating(false);\n        }\n    }, [inputValue, isGenerating, messages, addMessage, getCurrentConfig, setIsGenerating, setError, scope, canvasElements, getComponentCode, mode, onApplyCanvasChanges]);\n\n    /**\n     * Handle key press in textarea.\n     * Ctrl+Enter sends, Enter is soft newline.\n     */\n    const handleKeyDown = useCallback((e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n        if (e.key === 'Enter' && e.ctrlKey) {\n            e.preventDefault();\n            handleSend();\n        }\n    }, [handleSend]);\n\n    return (\n        <div className={`flex flex-col h-full ${className}`}>\n            {/* Compact Header with all controls in one row */}\n            <div className=\"px-2 py-1.5 border-b border-neutral-200 bg-white\">\n                <div className=\"flex items-center gap-1\">\n                    {/* Mode Toggle (Chat/Change) */}\n                    <button\n                        type=\"button\"\n                        onClick={() => setMode(mode === 'chat' ? 'change' : 'chat')}\n                        className={[\n                            'p-1.5 rounded-md transition-colors',\n                            mode === 'chat'\n                                ? 'bg-blue-100 text-blue-600'\n                                : 'bg-amber-100 text-amber-600',\n                        ].join(' ')}\n                        title={mode === 'chat' ? 'Chat mode (read-only)' : 'Change mode (can edit)'}\n                    >\n                        {mode === 'chat' ? <ChatIcon className=\"h-4 w-4\" /> : <EditIcon className=\"h-4 w-4\" />}\n                    </button>\n\n                    {/* Divider */}\n                    <div className=\"w-px h-5 bg-neutral-200\" />\n\n                    {/* Scope Switches (BE/FE/Full) */}\n                    {(['backend', 'frontend', 'full'] as AiChatScope[]).map((s) => (\n                        <button\n                            key={s}\n                            type=\"button\"\n                            onClick={() => setScope(s)}\n                            className={[\n                                'px-2 py-1 text-[10px] font-semibold rounded transition-colors',\n                                scope === s\n                                    ? SCOPE_CONFIG[s].activeColor\n                                    : `bg-neutral-100 ${SCOPE_CONFIG[s].color} hover:bg-neutral-200`,\n                            ].join(' ')}\n                            title={SCOPE_CONFIG[s].label}\n                        >\n                            {SCOPE_CONFIG[s].short}\n                        </button>\n                    ))}\n\n                    {/* Spacer */}\n                    <div className=\"flex-1\" />\n\n                    {/* Clear Chat */}\n                    <button\n                        type=\"button\"\n                        onClick={clearHistory}\n                        disabled={messages.length === 0 || isGenerating}\n                        className=\"p-1.5 rounded-md text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100 disabled:opacity-30 disabled:cursor-not-allowed transition-colors\"\n                        title=\"Clear chat\"\n                    >\n                        <ClearIcon className=\"h-4 w-4\" />\n                    </button>\n\n                    {/* Settings */}\n                    <button\n                        type=\"button\"\n                        onClick={toggleSettings}\n                        className=\"p-1.5 rounded-md text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100 transition-colors\"\n                        title=\"Settings\"\n                    >\n                        <SettingsIcon className=\"h-4 w-4\" />\n                    </button>\n                </div>\n            </div>\n\n            {/* Messages Area */}\n            <div className=\"flex-1 overflow-y-auto p-2 space-y-2 bg-neutral-50\">\n                {messages.length === 0 ? (\n                    <div className=\"flex flex-col items-center justify-center h-full text-neutral-400 py-8\">\n                        <AiAppChatIcon className=\"h-8 w-8 mb-2 opacity-50\" />\n                        <p className=\"text-xs text-center px-4\">\n                            Ctrl+Enter to send\n                        </p>\n                    </div>\n                ) : (\n                    <>\n                        {messages.map((msg) => (\n                            <ChatMessageItem\n                                key={msg.id}\n                                message={msg}\n                                showTimestamp\n                                onApplyCode={onApplyCode}\n                                onApplyCanvasChanges={onApplyCanvasChanges}\n                            />\n                        ))}\n                        {isGenerating && (\n                            <div className=\"flex gap-2 p-2 rounded-lg bg-neutral-50\">\n                                <div className=\"flex items-center justify-center w-6 h-6 rounded-full bg-neutral-200 text-neutral-600 shrink-0\">\n                                    <AssistantIcon className=\"h-3.5 w-3.5\" />\n                                </div>\n                                <div className=\"flex items-center\">\n                                    <LoadingDots />\n                                </div>\n                            </div>\n                        )}\n                    </>\n                )}\n                <div ref={messagesEndRef} />\n            </div>\n\n            {/* Error Display */}\n            {error && (\n                <div className=\"px-2 py-1.5 bg-error-50 border-t border-error-200 text-error-700 text-xs\">\n                    {error}\n                </div>\n            )}\n\n            {/* Input Area - Textarea with resizable height */}\n            <div ref={inputContainerRef} className=\"border-t border-neutral-200 bg-white\">\n                {/* Resize Handle */}\n                <div\n                    className=\"flex items-center justify-center h-4 cursor-ns-resize hover:bg-neutral-100 transition-colors group\"\n                    onMouseDown={handleResizeStart}\n                    title=\"Drag to resize\"\n                >\n                    <ResizeHandleIcon className=\"h-3 w-3 text-neutral-300 group-hover:text-neutral-500\" />\n                </div>\n                {/* Textarea */}\n                <div className=\"px-2 pb-2\">\n                    <textarea\n                        ref={textareaRef}\n                        value={inputValue}\n                        onChange={(e) => setInputValue(e.target.value)}\n                        onKeyDown={handleKeyDown}\n                        placeholder={mode === 'chat' ? 'Ask a question... (Ctrl+Enter)' : 'Describe changes... (Ctrl+Enter)'}\n                        disabled={isGenerating}\n                        className=\"w-full px-2 py-1.5 text-sm border border-neutral-200 rounded-md resize-none focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 disabled:bg-neutral-50 disabled:text-neutral-400\"\n                        style={{ height: `${inputHeight}px` }}\n                    />\n                </div>\n            </div>\n\n            {/* Settings Modal */}\n            {isSettingsOpen && <AiChatSettingsModal />}\n        </div>\n    );\n};\n\nAiAppChatPanel.displayName = 'AiAppChatPanel';\n\nexport default AiAppChatPanel;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\AiChatSettingsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":81,"column":24,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":81,"endColumn":62},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":112,"column":20,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":112,"endColumn":65}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AiChatSettingsModal.tsx\r\n * =======================\r\n * Settings modal for AI App Chat per-scope configuration.\r\n * \r\n * Features:\r\n * - Scope tabs (Backend / Frontend / Full)\r\n * - Provider dropdown (Gemini, OpenAI, Anthropic, Ollama)\r\n * - Model dropdown (dynamic based on provider)\r\n * - API Key status via apiKeyStore\r\n * - System prompt editor\r\n * - Temperature slider\r\n */\r\n\r\nimport React, { useState, useCallback } from 'react';\r\nimport { useAiChatStore, type AiChatScope } from '../../stores/aiChatStore';\r\nimport { MODEL_OPTIONS, type LLMProvider } from '../../stores/settingsStore';\r\nimport { DEFAULT_SYSTEM_PROMPTS, type AiChatProvider } from '../../services/aiChatLlmService';\r\n\r\n/**\r\n * Close icon.\r\n */\r\nconst CloseIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n    </svg>\r\n);\r\n\r\n/**\r\n * Provider options for dropdown.\r\n */\r\nconst PROVIDER_OPTIONS: { id: AiChatProvider; label: string }[] = [\r\n    { id: 'gemini', label: 'Google Gemini' },\r\n    { id: 'openai', label: 'OpenAI' },\r\n    { id: 'anthropic', label: 'Anthropic' },\r\n    { id: 'ollama', label: 'Ollama (Local)' },\r\n];\r\n\r\n/**\r\n * Scope labels.\r\n */\r\nconst SCOPE_LABELS: Record<AiChatScope, string> = {\r\n    backend: 'Backend AI',\r\n    frontend: 'Frontend AI',\r\n    full: 'Full AI',\r\n};\r\n\r\n/**\r\n * AI Chat Settings Modal component.\r\n */\r\nexport const AiChatSettingsModal: React.FC = () => {\r\n    const {\r\n        backendConfig,\r\n        frontendConfig,\r\n        fullConfig,\r\n        updateScopeConfig,\r\n        setSettingsOpen,\r\n    } = useAiChatStore();\r\n\r\n    // Active tab for scope selection in settings\r\n    const [activeTab, setActiveTab] = useState<AiChatScope>('full');\r\n\r\n    // Get config for current tab\r\n    const getCurrentTabConfig = () => {\r\n        switch (activeTab) {\r\n            case 'backend':\r\n                return backendConfig;\r\n            case 'frontend':\r\n                return frontendConfig;\r\n            case 'full':\r\n                return fullConfig;\r\n        }\r\n    };\r\n\r\n    const config = getCurrentTabConfig();\r\n\r\n    // Handle provider change\r\n    const handleProviderChange = useCallback((provider: AiChatProvider) => {\r\n        // Reset model to first available for new provider\r\n        const models = MODEL_OPTIONS[provider as LLMProvider] || [];\r\n        const firstModel = models[0]?.id || '';\r\n        updateScopeConfig(activeTab, { provider, model: firstModel });\r\n    }, [activeTab, updateScopeConfig]);\r\n\r\n    // Handle model change\r\n    const handleModelChange = useCallback((model: string) => {\r\n        updateScopeConfig(activeTab, { model });\r\n    }, [activeTab, updateScopeConfig]);\r\n\r\n    // Handle temperature change\r\n    const handleTempChange = useCallback((temp: number) => {\r\n        updateScopeConfig(activeTab, { temperature: Math.max(0, Math.min(2, temp)) });\r\n    }, [activeTab, updateScopeConfig]);\r\n\r\n    // Handle system prompt change\r\n    const handlePromptChange = useCallback((systemPrompt: string) => {\r\n        updateScopeConfig(activeTab, { systemPrompt });\r\n    }, [activeTab, updateScopeConfig]);\r\n\r\n    // Reset current scope to defaults\r\n    const handleResetScope = useCallback(() => {\r\n        updateScopeConfig(activeTab, {\r\n            provider: 'gemini',\r\n            model: 'gemini-2.5-flash',\r\n            systemPrompt: DEFAULT_SYSTEM_PROMPTS[activeTab],\r\n            temperature: activeTab === 'full' ? 0.2 : 0.3,\r\n        });\r\n    }, [activeTab, updateScopeConfig]);\r\n\r\n    // Get models for current provider\r\n    const models = MODEL_OPTIONS[config.provider as LLMProvider] || [];\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n            {/* Backdrop */}\r\n            <div\r\n                className=\"absolute inset-0 bg-black/50\"\r\n                onClick={() => setSettingsOpen(false)}\r\n            />\r\n\r\n            {/* Modal */}\r\n            <div className=\"relative bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[80vh] overflow-hidden flex flex-col\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between px-4 py-3 border-b border-neutral-200\">\r\n                    <h2 className=\"text-lg font-semibold text-neutral-900\">AI Chat Settings</h2>\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => setSettingsOpen(false)}\r\n                        className=\"p-1 rounded-md text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100 transition-colors\"\r\n                        aria-label=\"Close\"\r\n                    >\r\n                        <CloseIcon className=\"h-5 w-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Scope Tabs */}\r\n                <div className=\"flex border-b border-neutral-200\">\r\n                    {(['backend', 'frontend', 'full'] as AiChatScope[]).map((s) => (\r\n                        <button\r\n                            key={s}\r\n                            type=\"button\"\r\n                            onClick={() => setActiveTab(s)}\r\n                            className={[\r\n                                'flex-1 px-4 py-2 text-sm font-medium transition-colors border-b-2',\r\n                                activeTab === s\r\n                                    ? 'text-primary-600 border-primary-500'\r\n                                    : 'text-neutral-500 border-transparent hover:text-neutral-700 hover:bg-neutral-50',\r\n                            ].join(' ')}\r\n                        >\r\n                            {SCOPE_LABELS[s]}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 overflow-auto p-4 space-y-4\">\r\n                    {/* Provider */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            AI Provider\r\n                        </label>\r\n                        <select\r\n                            value={config.provider}\r\n                            onChange={(e) => handleProviderChange(e.target.value as AiChatProvider)}\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500\"\r\n                        >\r\n                            {PROVIDER_OPTIONS.map((opt) => (\r\n                                <option key={opt.id} value={opt.id}>\r\n                                    {opt.label}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n\r\n                    {/* Model */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            Model\r\n                        </label>\r\n                        <select\r\n                            value={config.model}\r\n                            onChange={(e) => handleModelChange(e.target.value)}\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500\"\r\n                        >\r\n                            {models.map((m) => (\r\n                                <option key={m.id} value={m.id}>\r\n                                    {m.label}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                        {config.provider !== 'ollama' && (\r\n                            <p className=\"mt-1 text-xs text-neutral-500\">\r\n                                API key configured in main Settings ÔåÆ API Keys\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Temperature */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            Temperature: {config.temperature.toFixed(1)}\r\n                        </label>\r\n                        <input\r\n                            type=\"range\"\r\n                            min=\"0\"\r\n                            max=\"2\"\r\n                            step=\"0.1\"\r\n                            value={config.temperature}\r\n                            onChange={(e) => handleTempChange(parseFloat(e.target.value))}\r\n                            className=\"w-full h-2 bg-neutral-200 rounded-lg appearance-none cursor-pointer\"\r\n                        />\r\n                        <div className=\"flex justify-between text-xs text-neutral-500 mt-1\">\r\n                            <span>Precise (0)</span>\r\n                            <span>Creative (2)</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* System Prompt */}\r\n                    <div>\r\n                        <div className=\"flex items-center justify-between mb-1\">\r\n                            <label className=\"block text-sm font-medium text-neutral-700\">\r\n                                System Prompt\r\n                            </label>\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleResetScope}\r\n                                className=\"text-xs text-primary-600 hover:text-primary-800\"\r\n                            >\r\n                                Reset to default\r\n                            </button>\r\n                        </div>\r\n                        <textarea\r\n                            value={config.systemPrompt}\r\n                            onChange={(e) => handlePromptChange(e.target.value)}\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 resize-none\"\r\n                            rows={8}\r\n                            placeholder=\"Enter system instructions for this AI scope...\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"flex justify-end gap-2 px-4 py-3 border-t border-neutral-200 bg-neutral-50\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => setSettingsOpen(false)}\r\n                        className=\"px-4 py-2 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-md hover:bg-neutral-50 transition-colors\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => setSettingsOpen(false)}\r\n                        className=\"px-4 py-2 text-sm font-medium text-white bg-primary-500 rounded-md hover:bg-primary-600 transition-colors\"\r\n                    >\r\n                        Save\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nAiChatSettingsModal.displayName = 'AiChatSettingsModal';\r\n\r\nexport default AiChatSettingsModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\AiTeamVisualization.tsx","messages":[{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .enabled on an `any` value.","line":36,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":36,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":37,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":37,"endColumn":46},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .active on an `any` value.","line":37,"column":27,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":37,"endColumn":33},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .label on an `any` value.","line":81,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":81,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .subLabel on an `any` value.","line":86,"column":36,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":86,"endColumn":44},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":86,"column":45,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":86,"endColumn":47,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3170,3172],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":152,"column":43,"nodeType":"Identifier","messageId":"invalidType","endLine":152,"endColumn":58},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise returned in function argument where a void return was expected.","line":367,"column":36,"nodeType":"Identifier","messageId":"voidReturnArgument","endLine":367,"endColumn":53},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'addLog', 'agentConfigs', 'resetSimulation', 'setProgress', 'setWorkflowRunning', and 'updateNodeStatus'. Either include them or remove the dependency array.","line":369,"column":8,"nodeType":"ArrayExpression","endLine":369,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [addLog, agentConfigs, resetSimulation, setProgress, setWorkflowRunning, updateNodeStatus]","fix":{"range":[15305,15307],"text":"[addLog, agentConfigs, resetSimulation, setProgress, setWorkflowRunning, updateNodeStatus]"}}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AiTeamVisualization.tsx\r\n * =======================\r\n * Three-panel AI Team visualization with:\r\n * - Left: Overall Status + Activity Log\r\n * - Center: ReactFlow process flow diagram\r\n * - Right: Agent Configuration panels\r\n * \r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n */\r\n\r\nimport React, { useEffect } from 'react';\r\nimport ReactFlow, {\r\n    Background,\r\n    Controls,\r\n    Handle,\r\n    Position,\r\n    NodeProps,\r\n} from 'reactflow';\r\nimport 'reactflow/dist/style.css';\r\n\r\nimport { useAiTeamStore } from '../../stores/aiTeamStore';\r\nimport { ResizablePanelLayout } from '../ui/ResizablePanelLayout';\r\nimport { WorkflowProfileSelector } from './WorkflowProfileSelector';\r\nimport { AgentConfigPanel } from './AgentConfigPanel';\r\n\r\n// ============================================\r\n// CUSTOM AGENT NODE\r\n// ============================================\r\n\r\n/**\r\n * Custom AgentNode for ReactFlow.\r\n * Supports: active (processing), enabled (in workflow), disabled (greyed out).\r\n */\r\nconst AgentNode = ({ data }: NodeProps) => {\r\n    const isEnabled = data.enabled !== false;\r\n    const isActive = data.active && isEnabled;\r\n\r\n    // Determine appearance based on state\r\n    let containerClass = 'bg-neutral-800 border-neutral-700';\r\n    let textClass = 'text-neutral-400';\r\n    let subTextClass = 'text-neutral-500';\r\n    let handleClass = '!bg-neutral-600 !border-neutral-500';\r\n\r\n    if (!isEnabled) {\r\n        // Disabled/greyed out state\r\n        containerClass = 'bg-neutral-900 border-neutral-800 opacity-40';\r\n        textClass = 'text-neutral-600';\r\n        subTextClass = 'text-neutral-700';\r\n        handleClass = '!bg-neutral-700 !border-neutral-700';\r\n    } else if (isActive) {\r\n        // Active/processing state\r\n        containerClass = 'bg-yellow-400 border-yellow-500 shadow-[0_0_20px_rgba(250,204,21,0.4)]';\r\n        textClass = 'text-neutral-900';\r\n        subTextClass = 'text-neutral-800 opacity-80';\r\n        handleClass = '!bg-neutral-900 !border-yellow-400';\r\n    }\r\n\r\n    return (\r\n        <div className={`\r\n            w-32 h-28 rounded-xl flex flex-col items-center justify-center \r\n            shadow-lg border-2 transition-all duration-500 \r\n            ${isEnabled ? 'hover:scale-105' : ''} \r\n            group relative overflow-hidden \r\n            ${containerClass}\r\n        `}>\r\n            {/* Active gradient background */}\r\n            {isActive && (\r\n                <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent pointer-events-none\" />\r\n            )}\r\n\r\n            {/* Top Handle */}\r\n            <Handle\r\n                type=\"target\"\r\n                position={Position.Top}\r\n                className={`!w-2.5 !h-2.5 !border-2 ${handleClass}`}\r\n            />\r\n\r\n            {/* Agent Label */}\r\n            <div className={`font-bold text-sm z-10 transition-colors duration-300 ${textClass}`}>\r\n                {data.label}\r\n            </div>\r\n\r\n            {/* Sub-label / Status */}\r\n            <div className={`text-xs mt-1 z-10 font-medium transition-colors duration-300 ${subTextClass}`}>\r\n                {isEnabled ? (data.subLabel || 'Idle') : 'Disabled'}\r\n            </div>\r\n\r\n            {/* Processing indicator */}\r\n            {isActive && (\r\n                <div className=\"mt-2 flex gap-1 z-10\">\r\n                    <div className=\"w-1.5 h-1.5 bg-neutral-900 rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\r\n                    <div className=\"w-1.5 h-1.5 bg-neutral-900 rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\r\n                    <div className=\"w-1.5 h-1.5 bg-neutral-900 rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\r\n                </div>\r\n            )}\r\n\r\n            {/* Bottom Handle */}\r\n            <Handle\r\n                type=\"source\"\r\n                position={Position.Bottom}\r\n                className={`!w-2.5 !h-2.5 !border-2 ${handleClass}`}\r\n            />\r\n\r\n            {/* Side Handles */}\r\n            <Handle\r\n                type=\"target\"\r\n                position={Position.Left}\r\n                id=\"l\"\r\n                className={`!w-2.5 !h-2.5 !border-2 ${handleClass}`}\r\n                style={{ top: '50%' }}\r\n            />\r\n            <Handle\r\n                type=\"source\"\r\n                position={Position.Right}\r\n                id=\"r\"\r\n                className={`!w-2.5 !h-2.5 !border-2 ${handleClass}`}\r\n                style={{ top: '50%' }}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nconst nodeTypes = {\r\n    agent: AgentNode,\r\n};\r\n\r\n// ============================================\r\n// LEFT PANEL: STATUS + ACTIVITY LOG\r\n// ============================================\r\n\r\nconst StatusPanel: React.FC = () => {\r\n    const { logs, overallProgress, isWorkflowRunning } = useAiTeamStore();\r\n\r\n    return (\r\n        <div className=\"h-full flex flex-col bg-neutral-900 border-r border-neutral-700\">\r\n            {/* Overall Status Section */}\r\n            <div className=\"p-4 border-b border-neutral-700\">\r\n                <h3 className=\"text-sm font-semibold text-neutral-100 mb-3 flex items-center gap-2\">\r\n                    Overall Status\r\n                    {isWorkflowRunning && (\r\n                        <span className=\"w-2 h-2 rounded-full bg-yellow-400 animate-pulse\" />\r\n                    )}\r\n                </h3>\r\n\r\n                {/* Progress Bar */}\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"flex-1 h-2 bg-neutral-800 rounded-full overflow-hidden\">\r\n                        <div\r\n                            className=\"h-full transition-all duration-500 shadow-[0_0_10px_rgba(250,204,21,0.5)]\"\r\n                            style={{\r\n                                width: `${overallProgress}%`,\r\n                                backgroundColor: overallProgress === 100 ? '#4ade80' : '#facc15'\r\n                            }}\r\n                        />\r\n                    </div>\r\n                    <span className={`text-sm font-mono min-w-[3rem] text-right ${overallProgress === 100 ? 'text-green-400' : 'text-yellow-400'\r\n                        }`}>\r\n                        {overallProgress}%\r\n                    </span>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Activity Log Section */}\r\n            <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n                <div className=\"px-4 py-2 border-b border-neutral-800\">\r\n                    <h4 className=\"text-xs font-semibold text-neutral-400 uppercase tracking-wider\">\r\n                        Activity Log\r\n                    </h4>\r\n                </div>\r\n\r\n                <div className=\"flex-1 overflow-y-auto p-3 font-mono text-xs custom-scrollbar\">\r\n                    <div className=\"space-y-2\">\r\n                        {logs.length === 0 ? (\r\n                            <div className=\"text-neutral-600 text-center py-4\">\r\n                                No activity yet\r\n                            </div>\r\n                        ) : (\r\n                            [...logs].reverse().map((log) => (\r\n                                <div\r\n                                    key={log.id}\r\n                                    className=\"flex items-start gap-2 animate-fade-in\"\r\n                                >\r\n                                    <span className={`mt-0.5 ${log.type === 'success' ? 'text-green-500' :\r\n                                        log.type === 'error' ? 'text-red-500' :\r\n                                            log.type === 'warning' ? 'text-orange-500' :\r\n                                                'text-blue-400'\r\n                                        }`}>\r\n                                        {log.type === 'success' ? 'Ô£ô' :\r\n                                            log.type === 'error' ? 'Ô£ù' : 'ÔûÂ'}\r\n                                    </span>\r\n                                    <span className=\"text-neutral-300 flex-1 break-words\">\r\n                                        {log.message}\r\n                                    </span>\r\n                                    <span className=\"text-neutral-600 text-[10px] whitespace-nowrap\">\r\n                                        {new Date(log.timestamp).toLocaleTimeString()}\r\n                                    </span>\r\n                                </div>\r\n                            ))\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Legend */}\r\n            <div className=\"p-3 border-t border-neutral-800 bg-neutral-900/50\">\r\n                <div className=\"flex flex-wrap gap-3 text-[10px] text-neutral-500\">\r\n                    <div className=\"flex items-center gap-1.5\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-yellow-400\" />\r\n                        <span>Processing</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-1.5\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-green-500\" />\r\n                        <span>Complete</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-1.5\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-neutral-600\" />\r\n                        <span>Idle</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ============================================\r\n// CENTER PANEL: PROCESS FLOW\r\n// ============================================\r\n\r\nconst ProcessFlowPanel: React.FC = () => {\r\n    const { nodes, edges } = useAiTeamStore();\r\n\r\n    return (\r\n        <div className=\"h-full w-full bg-[#1a1a1a] relative\">\r\n            {/* Header Overlay */}\r\n            <div className=\"absolute top-4 left-4 z-10 pointer-events-none\">\r\n                <h2 className=\"text-neutral-100 text-lg font-semibold\">Process Flow</h2>\r\n                <p className=\"text-neutral-500 text-xs\">Agent collaboration graph</p>\r\n            </div>\r\n\r\n            <ReactFlow\r\n                nodes={nodes}\r\n                edges={edges}\r\n                nodeTypes={nodeTypes}\r\n                fitView\r\n                fitViewOptions={{ padding: 0.3 }}\r\n                attributionPosition=\"bottom-right\"\r\n                className=\"bg-[#1a1a1a]\"\r\n                minZoom={0.5}\r\n                maxZoom={1.5}\r\n            >\r\n                <Background color=\"#333\" gap={20} size={1} />\r\n                <Controls\r\n                    className=\"!bg-neutral-800 !border-neutral-700 !fill-white [&>button]:!fill-white hover:[&>button]:!bg-neutral-700\"\r\n                    showInteractive={false}\r\n                />\r\n            </ReactFlow>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ============================================\r\n// MAIN COMPONENT\r\n// ============================================\r\n\r\ninterface AiTeamVisualizationProps {\r\n    className?: string;\r\n}\r\n\r\nexport const AiTeamVisualization: React.FC<AiTeamVisualizationProps> = ({\r\n    className = '',\r\n}) => {\r\n    const {\r\n        updateNodeStatus,\r\n        addLog,\r\n        setProgress,\r\n        resetSimulation,\r\n        setWorkflowRunning,\r\n        agentConfigs,\r\n    } = useAiTeamStore();\r\n\r\n    // Demo simulation effect (runs on mount)\r\n    useEffect(() => {\r\n        resetSimulation();\r\n\r\n        const runDemoSimulation = async () => {\r\n            // Only run simulation with enabled agents\r\n            const enabledAgents = agentConfigs.filter(a => a.enabled);\r\n            if (enabledAgents.length === 0) {\r\n                addLog('No agents enabled for this workflow', 'warning');\r\n                return;\r\n            }\r\n\r\n            setWorkflowRunning(true);\r\n\r\n            try {\r\n                // Step 1: Orchestrator Start\r\n                await new Promise(r => setTimeout(r, 800));\r\n                if (agentConfigs.find(a => a.id === 'orchestrator')?.enabled) {\r\n                    updateNodeStatus('orchestrator', { active: true, subLabel: 'Planning...' });\r\n                    addLog('Orchestrator initialized workflow', 'info');\r\n                }\r\n                setProgress(10);\r\n\r\n                // Step 2: Researcher\r\n                await new Promise(r => setTimeout(r, 1200));\r\n                updateNodeStatus('orchestrator', { active: false, subLabel: 'Done' });\r\n                if (agentConfigs.find(a => a.id === 'researcher')?.enabled) {\r\n                    updateNodeStatus('researcher', { active: true, subLabel: 'Researching...' });\r\n                    addLog('Researcher analyzing requirements', 'info');\r\n                }\r\n                setProgress(25);\r\n\r\n                await new Promise(r => setTimeout(r, 1500));\r\n                if (agentConfigs.find(a => a.id === 'researcher')?.enabled) {\r\n                    updateNodeStatus('researcher', { active: false, subLabel: 'Done' });\r\n                    addLog('Research complete: 3 patterns found', 'success');\r\n                }\r\n                setProgress(40);\r\n\r\n                // Step 3: Designer\r\n                if (agentConfigs.find(a => a.id === 'designer')?.enabled) {\r\n                    await new Promise(r => setTimeout(r, 1000));\r\n                    updateNodeStatus('designer', { active: true, subLabel: 'Designing...' });\r\n                    addLog('Designer creating blueprints', 'info');\r\n                    setProgress(55);\r\n\r\n                    await new Promise(r => setTimeout(r, 1500));\r\n                    updateNodeStatus('designer', { active: false, subLabel: 'Done' });\r\n                    addLog('Design complete: 2 blueprints', 'success');\r\n                }\r\n                setProgress(70);\r\n\r\n                // Step 4: Developer\r\n                if (agentConfigs.find(a => a.id === 'developer')?.enabled) {\r\n                    await new Promise(r => setTimeout(r, 1000));\r\n                    updateNodeStatus('developer', { active: true, subLabel: 'Coding...' });\r\n                    addLog('Developer implementing code', 'info');\r\n                    setProgress(80);\r\n\r\n                    await new Promise(r => setTimeout(r, 1500));\r\n                    updateNodeStatus('developer', { active: false, subLabel: 'Done' });\r\n                    addLog('Implementation complete', 'success');\r\n                }\r\n                setProgress(90);\r\n\r\n                // Step 5: QA\r\n                if (agentConfigs.find(a => a.id === 'qa')?.enabled) {\r\n                    await new Promise(r => setTimeout(r, 1000));\r\n                    updateNodeStatus('qa', { active: true, subLabel: 'Testing...' });\r\n                    addLog('QA validating output', 'info');\r\n\r\n                    await new Promise(r => setTimeout(r, 1200));\r\n                    updateNodeStatus('qa', { active: false, subLabel: 'Done' });\r\n                    addLog('QA passed: All tests green', 'success');\r\n                }\r\n\r\n                setProgress(100);\r\n                addLog('Workflow completed successfully', 'success');\r\n\r\n            } finally {\r\n                setWorkflowRunning(false);\r\n            }\r\n        };\r\n\r\n        // Start demo after short delay\r\n        const timeout = setTimeout(runDemoSimulation, 500);\r\n        return () => clearTimeout(timeout);\r\n    }, []); // Run once on mount\r\n\r\n    return (\r\n        <div className={`h-full w-full flex flex-col bg-[#1a1a1a] ${className}`}>\r\n            {/* Top Bar with Profile Selector */}\r\n            <div className=\"flex-shrink-0 px-4 py-3 border-b border-neutral-700 bg-neutral-900\">\r\n                <WorkflowProfileSelector />\r\n            </div>\r\n\r\n            {/* Main 3-Panel Layout */}\r\n            <div className=\"flex-1 overflow-hidden\">\r\n                <ResizablePanelLayout\r\n                    leftPanel={<StatusPanel />}\r\n                    centerPanel={<ProcessFlowPanel />}\r\n                    rightPanel={<AgentConfigPanel />}\r\n                    leftConfig={{ minWidth: 200, initialPercent: 25 }}\r\n                    rightConfig={{ minWidth: 250, initialPercent: 25 }}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AiTeamVisualization;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\ChatInterface.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\ComponentGenerator.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":336,"column":18,"nodeType":"CallExpression","messageId":"invalidType","endLine":336,"endColumn":28},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":350,"column":20,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":350,"endColumn":34},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":372,"column":20,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":372,"endColumn":34},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":391,"column":18,"nodeType":"CallExpression","messageId":"invalidType","endLine":391,"endColumn":28},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":423,"column":38,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":423,"endColumn":40,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[11555,11557],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":435,"column":20,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":435,"endColumn":34},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":446,"column":20,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":446,"endColumn":34},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":460,"column":7,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":460,"endColumn":26,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[12692,12692],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[12692,12692],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":462,"column":7,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":462,"endColumn":24,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[12731,12731],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[12731,12731],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":477,"column":7,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":477,"endColumn":62,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[13134,13134],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[13134,13134],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":490,"column":20,"nodeType":"CallExpression","messageId":"invalidType","endLine":490,"endColumn":30},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":574,"column":23,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[16373,16456],"text":"\n                e.g., &quot;A card with image, title, and action button\"\n              "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[16373,16456],"text":"\n                e.g., &ldquo;A card with image, title, and action button\"\n              "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[16373,16456],"text":"\n                e.g., &#34;A card with image, title, and action button\"\n              "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[16373,16456],"text":"\n                e.g., &rdquo;A card with image, title, and action button\"\n              "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":574,"column":67,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[16373,16456],"text":"\n                e.g., \"A card with image, title, and action button&quot;\n              "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[16373,16456],"text":"\n                e.g., \"A card with image, title, and action button&ldquo;\n              "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[16373,16456],"text":"\n                e.g., \"A card with image, title, and action button&#34;\n              "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[16373,16456],"text":"\n                e.g., \"A card with image, title, and action button&rdquo;\n              "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D070 - src/components/ai/ComponentGenerator.tsx\n * ================================================\n * AI-powered component generation interface with single-screen layout.\n *\n * Layout: 30% left chat panel | 70% right (preview top + code bottom)\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D010, D011, D012, D014, D015\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport React, { useState, useCallback, useRef, useEffect } from \"react\";\nimport { Button } from \"../ui/Button\";\nimport { Select, type SelectOption } from \"../ui/Select\";\nimport { LiveComponentPreview } from \"./LiveComponentPreview\";\nimport { generateText } from \"../../services/llmService\";\nimport { DESIGN_TOKEN_REFERENCE } from \"../../hooks/useComponentGenerator\";\n\n/**\n * Component type options for generation.\n */\nexport type ComponentType = \"button\" | \"input\" | \"card\" | \"form\" | \"list\" | \"modal\" | \"navigation\" | \"layout\" | \"custom\";\n\n/**\n * Framework target options.\n */\nexport type FrameworkTarget = \"react\" | \"vue\" | \"svelte\" | \"html\";\n\n/**\n * Generated component output structure.\n */\nexport interface GeneratedComponent {\n  /** Component name */\n  name: string;\n  /** Component type */\n  type: ComponentType;\n  /** Framework target */\n  framework: FrameworkTarget;\n  /** Generated code */\n  code: string;\n  /** Generated styles (if separate) */\n  styles?: string;\n  /** TypeScript types (if applicable) */\n  types?: string;\n  /** Generation timestamp */\n  generatedAt: Date;\n  /** Original prompt used */\n  prompt: string;\n}\n\n/**\n * Chat message structure for conversation history.\n */\ninterface ChatMessage {\n  id: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: Date;\n}\n\n/**\n * Component generator props.\n */\nexport interface ComponentGeneratorProps {\n  /** Callback when component is generated */\n  onGenerate: (prompt: string, type: ComponentType, framework: FrameworkTarget) => Promise<GeneratedComponent>;\n  /** Callback when user wants to add the generated component to the library */\n  onSave?: (component: GeneratedComponent) => void;\n  /** Callback when user copies code to clipboard */\n  onCopy?: (code: string) => void;\n  /** Available component type options */\n  componentTypes?: SelectOption[];\n  /** Available framework options */\n  frameworkOptions?: SelectOption[];\n  /** Whether generation is in progress */\n  isGenerating?: boolean;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * Default component type options.\n */\nconst defaultComponentTypes: SelectOption[] = [\n  { value: \"button\", label: \"Button\" },\n  { value: \"input\", label: \"Input Field\" },\n  { value: \"card\", label: \"Card\" },\n  { value: \"form\", label: \"Form\" },\n  { value: \"list\", label: \"List\" },\n  { value: \"modal\", label: \"Modal/Dialog\" },\n  { value: \"navigation\", label: \"Navigation\" },\n  { value: \"layout\", label: \"Layout\" },\n  { value: \"custom\", label: \"Custom\" },\n];\n\n/**\n * Default framework options.\n */\nconst defaultFrameworkOptions: SelectOption[] = [\n  { value: \"react\", label: \"React + TypeScript\" },\n  { value: \"vue\", label: \"Vue 3\" },\n  { value: \"svelte\", label: \"Svelte\" },\n  { value: \"html\", label: \"HTML + CSS\" },\n];\n\n/**\n * Magic wand icon for generate button.\n */\nconst WandIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M15 4V2\" />\n    <path d=\"M15 16v-2\" />\n    <path d=\"M8 9h2\" />\n    <path d=\"M20 9h2\" />\n    <path d=\"M17.8 11.8 19 13\" />\n    <path d=\"M15 9h0\" />\n    <path d=\"M17.8 6.2 19 5\" />\n    <path d=\"m3 21 9-9\" />\n    <path d=\"M12.2 6.2 11 5\" />\n  </svg>\n);\n\n/**\n * Copy icon.\n */\nconst CopyIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <rect width=\"14\" height=\"14\" x=\"8\" y=\"8\" rx=\"2\" ry=\"2\" />\n    <path d=\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\" />\n  </svg>\n);\n\n/**\n * Add-to-library icon.\n */\nconst PlusIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Send icon for chat.\n */\nconst SendIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" />\n    <polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\n  </svg>\n);\n\n/**\n * Clear/Reset icon.\n */\nconst ClearIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M3 6h18\" />\n    <path d=\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\" />\n    <path d=\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Code preview component with syntax highlighting placeholder.\n */\nconst CodePreview: React.FC<{\n  code: string;\n  language: string;\n  onCopy?: () => void;\n  maxHeight?: string;\n}> = ({ code, language, onCopy, maxHeight = \"300px\" }) => {\n  const containerStyles = [\n    \"relative\",\n    \"bg-neutral-900\",\n    \"rounded-lg\",\n    \"overflow-hidden\",\n    \"flex\",\n    \"flex-col\",\n  ].join(\" \");\n\n  const headerStyles = [\n    \"flex\",\n    \"items-center\",\n    \"justify-between\",\n    \"px-3\",\n    \"py-2\",\n    \"bg-neutral-800\",\n    \"border-b\",\n    \"border-neutral-700\",\n    \"flex-shrink-0\",\n  ].join(\" \");\n\n  const codeStyles = [\n    \"p-3\",\n    \"overflow-auto\",\n    \"text-xs\",\n    \"font-mono\",\n    \"text-neutral-100\",\n    \"whitespace-pre-wrap\",\n    \"flex-1\",\n  ].join(\" \");\n\n  return (\n    <div className={containerStyles} style={{ maxHeight }}>\n      <div className={headerStyles}>\n        <span className=\"text-xs text-neutral-400 uppercase tracking-wide\">\n          {language}\n        </span>\n        {onCopy && (\n          <Button\n            variant=\"ghost\"\n            size=\"xs\"\n            onClick={onCopy}\n            leftIcon={<CopyIcon />}\n            className=\"text-neutral-400 hover:text-white\"\n          >\n            Copy\n          </Button>\n        )}\n      </div>\n      <pre className={codeStyles}>\n        <code>{code}</code>\n      </pre>\n    </div>\n  );\n};\n\n/**\n * ComponentGenerator component.\n *\n * Single-screen AI-powered interface for generating UI components.\n * Layout: 30% left (chat) | 70% right (preview top + code bottom)\n */\nexport const ComponentGenerator: React.FC<ComponentGeneratorProps> = ({\n  onGenerate,\n  onSave,\n  onCopy,\n  componentTypes = defaultComponentTypes,\n  frameworkOptions = defaultFrameworkOptions,\n  isGenerating = false,\n  className = \"\",\n}) => {\n  // Generation state\n  const [prompt, setPrompt] = useState(\"\");\n  const [componentType, setComponentType] = useState<ComponentType>(\"button\");\n  const [framework, setFramework] = useState<FrameworkTarget>(\"react\");\n  const [generatedComponent, setGeneratedComponent] = useState<GeneratedComponent | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  // Chat state\n  const [chatHistory, setChatHistory] = useState<ChatMessage[]>([]);\n  const [isRefining, setIsRefining] = useState(false);\n  const [copyFeedback, setCopyFeedback] = useState(false);\n\n  // Refs\n  const chatContainerRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n\n  // Auto-scroll chat to bottom on new messages\n  useEffect(() => {\n    if (chatContainerRef.current) {\n      chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;\n    }\n  }, [chatHistory]);\n\n  // Generate new component\n  const handleGenerate = useCallback(async () => {\n    if (!prompt.trim()) {\n      setError(\"Please enter a description for the component you want to generate.\");\n      return;\n    }\n    if (framework !== \"react\") {\n      setError(\"Live preview is only supported for React. Select React to generate a demoable component.\");\n      return;\n    }\n\n    setError(null);\n\n    // Add user message to chat\n    const userMessage: ChatMessage = {\n      id: `msg-${Date.now()}`,\n      role: 'user',\n      content: prompt,\n      timestamp: new Date(),\n    };\n    setChatHistory(prev => [...prev, userMessage]);\n    setPrompt(\"\");\n\n    try {\n      const result = await onGenerate(prompt, componentType, framework);\n      setGeneratedComponent(result);\n\n      // Add success message to chat\n      const assistantMessage: ChatMessage = {\n        id: `msg-${Date.now() + 1}`,\n        role: 'assistant',\n        content: `Generated \"${result.name}\" component. Check the preview panel on the right to see it in action.`,\n        timestamp: new Date(),\n      };\n      setChatHistory(prev => [...prev, assistantMessage]);\n    } catch (err) {\n      let errorMsg = \"Failed to generate component\";\n      if (err instanceof Error) {\n        errorMsg = err.message;\n      } else if (typeof err === \"object\" && err !== null && \"message\" in err) {\n        const msg = (err as { message: string }).message;\n        if (typeof msg === \"string\" && msg.length > 0) {\n          errorMsg = msg;\n        }\n      } else if (typeof err === \"string\" && err.length > 0) {\n        errorMsg = err;\n      }\n      setError(errorMsg);\n\n      // Add error message to chat\n      const errorMessage: ChatMessage = {\n        id: `msg-${Date.now() + 1}`,\n        role: 'assistant',\n        content: `Error: ${errorMsg}`,\n        timestamp: new Date(),\n      };\n      setChatHistory(prev => [...prev, errorMessage]);\n    }\n  }, [prompt, componentType, framework, onGenerate]);\n\n  // Refine existing component\n  const handleRefinement = useCallback(async () => {\n    if (!prompt.trim() || !generatedComponent) return;\n\n    const userMessage = prompt.trim();\n    setPrompt(\"\");\n    setIsRefining(true);\n\n    // Add user message to chat\n    const chatUserMessage: ChatMessage = {\n      id: `msg-${Date.now()}`,\n      role: 'user',\n      content: userMessage,\n      timestamp: new Date(),\n    };\n    setChatHistory(prev => [...prev, chatUserMessage]);\n\n    try {\n      const refinementPrompt = `REFINE this component. Apply the user's changes EXACTLY.\n\nCURRENT CODE:\n${generatedComponent.code}\n\nUSER CHANGE REQUEST: \"${userMessage}\"\n\nRULES:\n1. Keep component name: ${generatedComponent.name}\n2. Output ONLY the component - no wrappers, no explanations\n3. Implement EVERY requested change literally:\n   - \"yellow\" ÔåÆ bg-yellow-400 or bg-amber-400\n   - \"make it spin\" ÔåÆ transition-transform duration-500 hover:rotate-[360deg]\n   - \"squishy\" ÔåÆ transition-transform duration-150 hover:scale-110 active:scale-90\n4. No TypeScript syntax, no imports, no markdown\n5. Keep aria-label and focus ring styles\n\n${DESIGN_TOKEN_REFERENCE}\n\nOUTPUT THE REFINED CODE ONLY:`;\n\n      const result = await generateText(refinementPrompt);\n\n      if (!result.success || !result.text) {\n        throw new Error(result.error || 'Refinement failed');\n      }\n\n      const refinedCode = result.text;\n      setGeneratedComponent(prev => prev ? {\n        ...prev,\n        code: refinedCode,\n        generatedAt: new Date(),\n      } as GeneratedComponent : null);\n\n      // Add success message to chat\n      const assistantMessage: ChatMessage = {\n        id: `msg-${Date.now() + 1}`,\n        role: 'assistant',\n        content: 'Component updated! The preview has been refreshed with your changes.',\n        timestamp: new Date(),\n      };\n      setChatHistory(prev => [...prev, assistantMessage]);\n\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : 'Refinement failed';\n\n      const errorMessage: ChatMessage = {\n        id: `msg-${Date.now() + 1}`,\n        role: 'assistant',\n        content: `Error: ${errorMsg}`,\n        timestamp: new Date(),\n      };\n      setChatHistory(prev => [...prev, errorMessage]);\n    } finally {\n      setIsRefining(false);\n    }\n  }, [prompt, generatedComponent]);\n\n  // Handle send action (generate or refine based on state)\n  const handleSend = useCallback(() => {\n    if (generatedComponent) {\n      handleRefinement();\n    } else {\n      handleGenerate();\n    }\n  }, [generatedComponent, handleRefinement, handleGenerate]);\n\n  // Handle keyboard submit\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  }, [handleSend]);\n\n  // Copy code to clipboard\n  const handleCopy = useCallback(() => {\n    if (generatedComponent) {\n      navigator.clipboard.writeText(generatedComponent.code);\n      onCopy?.(generatedComponent.code);\n      setCopyFeedback(true);\n      setTimeout(() => setCopyFeedback(false), 2000);\n    }\n  }, [generatedComponent, onCopy]);\n\n  // Save to library\n  const handleSave = useCallback(() => {\n    if (generatedComponent && onSave) {\n      onSave(generatedComponent);\n\n      const successMessage: ChatMessage = {\n        id: `msg-${Date.now()}`,\n        role: 'system',\n        content: `\"${generatedComponent.name}\" has been added to your component library.`,\n        timestamp: new Date(),\n      };\n      setChatHistory(prev => [...prev, successMessage]);\n    }\n  }, [generatedComponent, onSave]);\n\n  // Clear/reset conversation\n  const handleClear = useCallback(() => {\n    setChatHistory([]);\n    setGeneratedComponent(null);\n    setPrompt(\"\");\n    setError(null);\n  }, []);\n\n  // Container styles for the full-screen layout\n  const containerStyles = [\n    \"flex\",\n    \"h-full\",\n    \"w-full\",\n    \"bg-neutral-50\",\n    \"rounded-lg\",\n    \"overflow-hidden\",\n    \"border\",\n    \"border-neutral-200\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  return (\n    <div className={containerStyles} style={{ minHeight: \"600px\" }}>\n      {/* Left Panel - Chat (30%) */}\n      <div className=\"w-[30%] min-w-[280px] flex flex-col border-r border-neutral-200 bg-white\">\n        {/* Chat Header */}\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-neutral-200 bg-neutral-50\">\n          <div className=\"flex items-center gap-2\">\n            <WandIcon />\n            <span className=\"font-semibold text-sm text-neutral-800\">AI Component Generator</span>\n          </div>\n          <button\n            type=\"button\"\n            onClick={handleClear}\n            className=\"p-1.5 rounded-md text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100 transition-colors\"\n            title=\"Clear conversation\"\n          >\n            <ClearIcon />\n          </button>\n        </div>\n\n        {/* Configuration Options */}\n        <div className=\"px-4 py-3 border-b border-neutral-200 bg-neutral-50 space-y-3\">\n          <Select\n            label=\"Component Type\"\n            options={componentTypes}\n            value={componentType}\n            onChange={(e) => setComponentType(e.target.value as ComponentType)}\n            fullWidth\n            size=\"sm\"\n          />\n          <Select\n            label=\"Framework\"\n            options={frameworkOptions}\n            value={framework}\n            onChange={(e) => setFramework(e.target.value as FrameworkTarget)}\n            fullWidth\n            size=\"sm\"\n          />\n        </div>\n\n        {/* Chat Messages */}\n        <div\n          ref={chatContainerRef}\n          className=\"flex-1 overflow-y-auto p-4 space-y-3\"\n        >\n          {chatHistory.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <div className=\"inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary-100 mb-3\">\n                <WandIcon />\n              </div>\n              <p className=\"text-sm text-neutral-600 mb-2\">\n                Describe the component you want to create\n              </p>\n              <p className=\"text-xs text-neutral-400\">\n                e.g., \"A card with image, title, and action button\"\n              </p>\n            </div>\n          ) : (\n            chatHistory.map((msg) => (\n              <div\n                key={msg.id}\n                className={[\n                  'p-3 rounded-lg text-sm',\n                  msg.role === 'user'\n                    ? 'bg-primary-100 text-primary-900 ml-4'\n                    : msg.role === 'system'\n                      ? 'bg-success-50 text-success-700 border border-success-200'\n                      : 'bg-neutral-100 text-neutral-800 mr-4',\n                ].join(' ')}\n              >\n                {msg.role === 'user' && (\n                  <span className=\"text-xs font-medium text-primary-600 block mb-1\">You</span>\n                )}\n                {msg.role === 'assistant' && (\n                  <span className=\"text-xs font-medium text-neutral-500 block mb-1\">AI</span>\n                )}\n                {msg.content}\n              </div>\n            ))\n          )}\n\n          {/* Loading indicator */}\n          {(isGenerating || isRefining) && (\n            <div className=\"flex items-center gap-2 p-3 bg-neutral-100 rounded-lg mr-4\">\n              <div className=\"flex space-x-1\">\n                <span className=\"w-2 h-2 bg-primary-500 rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\n                <span className=\"w-2 h-2 bg-primary-500 rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\n                <span className=\"w-2 h-2 bg-primary-500 rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\n              </div>\n              <span className=\"text-sm text-neutral-500\">\n                {isGenerating ? 'Generating component...' : 'Refining component...'}\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Error Display */}\n        {error && (\n          <div className=\"mx-4 mb-2 p-2 bg-error-50 border border-error-200 rounded-lg text-xs text-error-700\">\n            {error}\n          </div>\n        )}\n\n        {/* Chat Input */}\n        <div className=\"p-4 border-t border-neutral-200 bg-white\">\n          <div className=\"flex gap-2\">\n            <textarea\n              ref={inputRef}\n              value={prompt}\n              onChange={(e) => setPrompt(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder={generatedComponent ? \"Describe changes to refine...\" : \"Describe your component...\"}\n              rows={2}\n              disabled={isGenerating || isRefining}\n              className={[\n                \"flex-1\",\n                \"px-3\",\n                \"py-2\",\n                \"text-sm\",\n                \"text-neutral-900\",\n                \"placeholder:text-neutral-400\",\n                \"border\",\n                \"border-neutral-300\",\n                \"rounded-lg\",\n                \"focus:outline-none\",\n                \"focus:ring-2\",\n                \"focus:ring-primary-500\",\n                \"focus:border-primary-500\",\n                \"resize-none\",\n                \"transition-colors\",\n                \"duration-150\",\n                \"disabled:bg-neutral-50\",\n                \"disabled:text-neutral-400\",\n              ].join(\" \")}\n            />\n            <Button\n              variant=\"primary\"\n              size=\"md\"\n              onClick={handleSend}\n              loading={isGenerating || isRefining}\n              disabled={!prompt.trim()}\n              className=\"self-end\"\n              title={generatedComponent ? \"Refine component\" : \"Generate component\"}\n            >\n              <SendIcon />\n            </Button>\n          </div>\n          {generatedComponent && (\n            <p className=\"text-xs text-neutral-400 mt-2\">\n              Describe changes to refine the component, or clear to start fresh.\n            </p>\n          )}\n        </div>\n      </div>\n\n      {/* Right Panel - Preview & Code (70%) */}\n      <div className=\"flex-1 flex flex-col bg-neutral-100 min-w-0 overflow-hidden\">\n        {generatedComponent ? (\n          <>\n            {/* Toolbar */}\n            <div className=\"flex items-center justify-between px-4 py-2 border-b border-neutral-200 bg-white\">\n              <div className=\"flex items-center gap-3\">\n                <span className=\"font-medium text-sm text-neutral-800\">\n                  {generatedComponent.name}\n                </span>\n                <span className=\"text-xs text-neutral-400\">\n                  {generatedComponent.type} ÔÇó {generatedComponent.framework}\n                </span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Button\n                  variant=\"secondary\"\n                  size=\"sm\"\n                  onClick={handleCopy}\n                  leftIcon={<CopyIcon />}\n                >\n                  {copyFeedback ? 'Copied!' : 'Copy Code'}\n                </Button>\n                {onSave && (\n                  <Button\n                    variant=\"primary\"\n                    size=\"sm\"\n                    onClick={handleSave}\n                    leftIcon={<PlusIcon />}\n                  >\n                    Add to Library\n                  </Button>\n                )}\n              </div>\n            </div>\n\n            {/* Upper Section - Preview */}\n            <div className=\"flex-1 min-h-0 p-4 overflow-auto\">\n              <div className=\"h-full bg-white rounded-lg border border-neutral-200 overflow-hidden\">\n                <div className=\"px-3 py-2 border-b border-neutral-200 bg-neutral-50\">\n                  <span className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide\">\n                    Live Preview\n                  </span>\n                </div>\n                <div className=\"h-[calc(100%-36px)] w-full flex items-center justify-center\">\n                  <LiveComponentPreview\n                    code={generatedComponent.code}\n                    framework={generatedComponent.framework}\n                    className=\"h-full w-full\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Lower Section - Code */}\n            <div className=\"h-[40%] min-h-[200px] p-4 pt-0\">\n              <CodePreview\n                code={generatedComponent.code}\n                language={generatedComponent.framework}\n                onCopy={handleCopy}\n                maxHeight=\"100%\"\n              />\n            </div>\n          </>\n        ) : (\n          /* Empty State */\n          <div className=\"flex-1 flex items-center justify-center\">\n            <div className=\"text-center max-w-md px-8\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-neutral-200 mb-4\">\n                <svg className=\"w-8 h-8 text-neutral-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n                  <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n                  <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"9\" />\n                  <line x1=\"9\" y1=\"13\" x2=\"15\" y2=\"13\" />\n                  <line x1=\"9\" y1=\"17\" x2=\"13\" y2=\"17\" />\n                </svg>\n              </div>\n              <h3 className=\"text-lg font-semibold text-neutral-700 mb-2\">\n                No Component Generated Yet\n              </h3>\n              <p className=\"text-sm text-neutral-500 mb-4\">\n                Use the chat panel on the left to describe the component you want to create.\n                The AI will generate the code and show a live preview here.\n              </p>\n              <div className=\"flex flex-wrap gap-2 justify-center\">\n                {['Button', 'Card', 'Form', 'Modal'].map((example) => (\n                  <button\n                    key={example}\n                    type=\"button\"\n                    onClick={() => {\n                      setPrompt(`A ${example.toLowerCase()} component with modern styling`);\n                      inputRef.current?.focus();\n                    }}\n                    className=\"px-3 py-1.5 text-xs font-medium text-primary-600 bg-primary-50 rounded-full hover:bg-primary-100 transition-colors\"\n                  >\n                    {example}\n                  </button>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nComponentGenerator.displayName = \"ComponentGenerator\";\n\nexport default ComponentGenerator;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\ConfigValidator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\ContractWizard.tsx","messages":[{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":561,"column":23,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":561,"endColumn":39},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":591,"column":25,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":591,"endColumn":86}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D072 - src/components/ai/ContractWizard.tsx\n * ============================================\n * AI-powered contract creation wizard for plugin development.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D010, D011, D012, D014, D015\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport React, { useState, useCallback } from \"react\";\nimport { Button } from \"../ui/Button\";\nimport { Input } from \"../ui/Input\";\nimport { Select, type SelectOption } from \"../ui/Select\";\nimport { Panel } from \"../ui/Panel\";\nimport { Modal } from \"../ui/Modal\";\n\n/**\n * Contract method parameter definition.\n */\nexport interface ContractParameter {\n  /** Parameter name */\n  name: string;\n  /** Parameter type (Python type annotation) */\n  type: string;\n  /** Parameter description */\n  description: string;\n  /** Whether parameter is required */\n  required: boolean;\n  /** Default value (if optional) */\n  defaultValue?: string;\n}\n\n/**\n * Contract method definition.\n */\nexport interface ContractMethod {\n  /** Method name */\n  name: string;\n  /** Method description */\n  description: string;\n  /** Method parameters */\n  parameters: ContractParameter[];\n  /** Return type */\n  returnType: string;\n  /** Whether method is async */\n  isAsync: boolean;\n}\n\n/**\n * Generated contract structure.\n */\nexport interface GeneratedContract {\n  /** Contract name */\n  name: string;\n  /** Contract category (tts, stt, llm, etc.) */\n  category: string;\n  /** Contract description */\n  description: string;\n  /** Contract methods */\n  methods: ContractMethod[];\n  /** Generated Python code */\n  code: string;\n  /** Hook specification code */\n  hookspecCode: string;\n  /** Example implementation */\n  exampleImplementation: string;\n  /** Generation timestamp */\n  generatedAt: Date;\n}\n\n/**\n * Contract wizard props.\n */\nexport interface ContractWizardProps {\n  /** Callback when contract is generated */\n  onGenerate: (name: string, category: string, description: string, methods: ContractMethod[]) => Promise<GeneratedContract>;\n  /** Callback when user saves the contract */\n  onSave?: (contract: GeneratedContract) => void;\n  /** Available contract categories */\n  categories?: SelectOption[];\n  /** Whether generation is in progress */\n  isGenerating?: boolean;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * Default contract categories.\n */\nconst defaultCategories: SelectOption[] = [\n  { value: \"tts\", label: \"Text-to-Speech (TTS)\" },\n  { value: \"stt\", label: \"Speech-to-Text (STT)\" },\n  { value: \"llm\", label: \"Large Language Model (LLM)\" },\n  { value: \"vision\", label: \"Computer Vision\" },\n  { value: \"audio\", label: \"Audio Processing\" },\n  { value: \"data\", label: \"Data Processing\" },\n  { value: \"custom\", label: \"Custom\" },\n];\n\n/**\n * Available Python types for parameters.\n */\nconst pythonTypes: SelectOption[] = [\n  { value: \"str\", label: \"str (String)\" },\n  { value: \"int\", label: \"int (Integer)\" },\n  { value: \"float\", label: \"float (Decimal)\" },\n  { value: \"bool\", label: \"bool (Boolean)\" },\n  { value: \"bytes\", label: \"bytes (Binary)\" },\n  { value: \"list[str]\", label: \"list[str] (String List)\" },\n  { value: \"list[int]\", label: \"list[int] (Integer List)\" },\n  { value: \"dict[str, Any]\", label: \"dict[str, Any] (Dictionary)\" },\n  { value: \"Optional[str]\", label: \"Optional[str]\" },\n  { value: \"Any\", label: \"Any\" },\n];\n\n/**\n * Plus icon.\n */\nconst PlusIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Code icon.\n */\nconst CodeIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"16 18 22 12 16 6\" />\n    <polyline points=\"8 6 2 12 8 18\" />\n  </svg>\n);\n\n/**\n * Method editor component.\n */\nconst MethodEditor: React.FC<{\n  method: ContractMethod;\n  onChange: (method: ContractMethod) => void;\n  onRemove: () => void;\n}> = ({ method, onChange, onRemove }) => {\n  const addParameter = () => {\n    onChange({\n      ...method,\n      parameters: [\n        ...method.parameters,\n        {\n          name: \"\",\n          type: \"str\",\n          description: \"\",\n          required: true,\n        },\n      ],\n    });\n  };\n\n  const updateParameter = (index: number, param: ContractParameter) => {\n    const newParams = [...method.parameters];\n    newParams[index] = param;\n    onChange({ ...method, parameters: newParams });\n  };\n\n  const removeParameter = (index: number) => {\n    onChange({\n      ...method,\n      parameters: method.parameters.filter((_, i) => i !== index),\n    });\n  };\n\n  return (\n    <div className=\"border border-neutral-200 rounded-lg p-4 space-y-4\">\n      <div className=\"flex items-start justify-between\">\n        <h4 className=\"text-sm font-semibold text-neutral-900\">Method</h4>\n        <Button\n          variant=\"ghost\"\n          size=\"xs\"\n          onClick={onRemove}\n          leftIcon={<TrashIcon />}\n          className=\"text-error-600 hover:text-error-700\"\n        >\n          Remove\n        </Button>\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-4\">\n        <Input\n          label=\"Method Name\"\n          value={method.name}\n          onChange={(e) => onChange({ ...method, name: e.target.value })}\n          placeholder=\"synthesize\"\n          fullWidth\n        />\n        <Select\n          label=\"Return Type\"\n          options={pythonTypes}\n          value={method.returnType}\n          onChange={(e) => onChange({ ...method, returnType: e.target.value })}\n          fullWidth\n        />\n      </div>\n\n      <Input\n        label=\"Description\"\n        value={method.description}\n        onChange={(e) => onChange({ ...method, description: e.target.value })}\n        placeholder=\"Describe what this method does\"\n        fullWidth\n      />\n\n      <div className=\"flex items-center gap-4\">\n        <label className=\"flex items-center gap-2 text-sm text-neutral-700 cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            checked={method.isAsync}\n            onChange={(e) => onChange({ ...method, isAsync: e.target.checked })}\n            className=\"w-4 h-4 text-primary-600 border-neutral-300 rounded focus:ring-primary-500\"\n          />\n          Async method\n        </label>\n      </div>\n\n      {/* Parameters */}\n      <div className=\"space-y-3\">\n        <div className=\"flex items-center justify-between\">\n          <h5 className=\"text-xs font-medium text-neutral-600 uppercase tracking-wide\">\n            Parameters\n          </h5>\n          <Button\n            variant=\"ghost\"\n            size=\"xs\"\n            onClick={addParameter}\n            leftIcon={<PlusIcon />}\n          >\n            Add Parameter\n          </Button>\n        </div>\n\n        {method.parameters.length === 0 ? (\n          <p className=\"text-sm text-neutral-400 italic\">No parameters defined</p>\n        ) : (\n          <div className=\"space-y-3\">\n            {method.parameters.map((param, index) => (\n              <div\n                key={index}\n                className=\"grid grid-cols-12 gap-2 items-end bg-neutral-50 p-3 rounded-lg\"\n              >\n                <div className=\"col-span-3\">\n                  <Input\n                    label={index === 0 ? \"Name\" : undefined}\n                    value={param.name}\n                    onChange={(e) =>\n                      updateParameter(index, { ...param, name: e.target.value })\n                    }\n                    placeholder=\"text\"\n                    size=\"sm\"\n                    fullWidth\n                  />\n                </div>\n                <div className=\"col-span-3\">\n                  <Select\n                    label={index === 0 ? \"Type\" : undefined}\n                    options={pythonTypes}\n                    value={param.type}\n                    onChange={(e) =>\n                      updateParameter(index, { ...param, type: e.target.value })\n                    }\n                    size=\"sm\"\n                    fullWidth\n                  />\n                </div>\n                <div className=\"col-span-4\">\n                  <Input\n                    label={index === 0 ? \"Description\" : undefined}\n                    value={param.description}\n                    onChange={(e) =>\n                      updateParameter(index, { ...param, description: e.target.value })\n                    }\n                    placeholder=\"Description\"\n                    size=\"sm\"\n                    fullWidth\n                  />\n                </div>\n                <div className=\"col-span-1 flex items-center justify-center\">\n                  <label className=\"flex items-center gap-1 text-xs text-neutral-600 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={param.required}\n                      onChange={(e) =>\n                        updateParameter(index, { ...param, required: e.target.checked })\n                      }\n                      className=\"w-3 h-3 text-primary-600 border-neutral-300 rounded\"\n                    />\n                    Req\n                  </label>\n                </div>\n                <div className=\"col-span-1\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"xs\"\n                    iconOnly\n                    onClick={() => removeParameter(index)}\n                    aria-label=\"Remove parameter\"\n                    className=\"text-error-500 hover:text-error-600\"\n                  >\n                    <TrashIcon />\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\n/**\n * Code preview component.\n */\nconst CodePreview: React.FC<{\n  code: string;\n  title: string;\n}> = ({ code, title }) => (\n  <div className=\"bg-neutral-900 rounded-lg overflow-hidden\">\n    <div className=\"px-4 py-2 bg-neutral-800 border-b border-neutral-700\">\n      <span className=\"text-xs text-neutral-400 uppercase tracking-wide\">{title}</span>\n    </div>\n    <pre className=\"p-4 overflow-x-auto text-sm font-mono text-neutral-100 whitespace-pre\">\n      <code>{code}</code>\n    </pre>\n  </div>\n);\n\n/**\n * ContractWizard component.\n *\n * A wizard interface for creating plugin contracts (interfaces) with AI assistance.\n * Helps define methods, parameters, and generates Python contract code.\n *\n * @example\n * ```tsx\n * const handleGenerate = async (name, category, description, methods) => {\n *   const result = await aiService.generateContract(name, category, description, methods);\n *   return result;\n * };\n *\n * <ContractWizard\n *   onGenerate={handleGenerate}\n *   onSave={(contract) => saveContract(contract)}\n * />\n * ```\n */\nexport const ContractWizard: React.FC<ContractWizardProps> = ({\n  onGenerate,\n  onSave,\n  categories = defaultCategories,\n  isGenerating = false,\n  className = \"\",\n}) => {\n  const [name, setName] = useState(\"\");\n  const [category, setCategory] = useState(\"tts\");\n  const [description, setDescription] = useState(\"\");\n  const [methods, setMethods] = useState<ContractMethod[]>([\n    {\n      name: \"\",\n      description: \"\",\n      parameters: [],\n      returnType: \"str\",\n      isAsync: false,\n    },\n  ]);\n  const [generatedContract, setGeneratedContract] = useState<GeneratedContract | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [showPreviewModal, setShowPreviewModal] = useState(false);\n\n  const addMethod = useCallback(() => {\n    setMethods((prev) => [\n      ...prev,\n      {\n        name: \"\",\n        description: \"\",\n        parameters: [],\n        returnType: \"str\",\n        isAsync: false,\n      },\n    ]);\n  }, []);\n\n  const updateMethod = useCallback((index: number, method: ContractMethod) => {\n    setMethods((prev) => {\n      const newMethods = [...prev];\n      newMethods[index] = method;\n      return newMethods;\n    });\n  }, []);\n\n  const removeMethod = useCallback((index: number) => {\n    setMethods((prev) => prev.filter((_, i) => i !== index));\n  }, []);\n\n  const handleGenerate = useCallback(async () => {\n    // Validation\n    if (!name.trim()) {\n      setError(\"Contract name is required\");\n      return;\n    }\n\n    const validMethods = methods.filter((m) => m.name.trim());\n    if (validMethods.length === 0) {\n      setError(\"At least one method with a name is required\");\n      return;\n    }\n\n    setError(null);\n    try {\n      const result = await onGenerate(name, category, description, validMethods);\n      setGeneratedContract(result);\n      setShowPreviewModal(true);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Failed to generate contract\");\n    }\n  }, [name, category, description, methods, onGenerate]);\n\n  const handleSave = useCallback(() => {\n    if (generatedContract && onSave) {\n      onSave(generatedContract);\n      setShowPreviewModal(false);\n    }\n  }, [generatedContract, onSave]);\n\n  const containerStyles = [\n    \"space-y-6\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  return (\n    <div className={containerStyles}>\n      {/* Contract definition */}\n      <Panel\n        variant=\"default\"\n        padding=\"lg\"\n        radius=\"lg\"\n        header=\"Define Contract\"\n        showHeaderDivider\n      >\n        <div className=\"space-y-6\">\n          {/* Basic info */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <Input\n              label=\"Contract Name\"\n              value={name}\n              onChange={(e) => setName(e.target.value)}\n              placeholder=\"TTSContract\"\n              helperText=\"Use PascalCase, e.g., MyCustomContract\"\n              fullWidth\n              isRequired\n            />\n            <Select\n              label=\"Category\"\n              options={categories}\n              value={category}\n              onChange={(e) => setCategory(e.target.value)}\n              fullWidth\n              isRequired\n            />\n          </div>\n\n          <Input\n            label=\"Description\"\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n            placeholder=\"Describe the purpose of this contract\"\n            helperText=\"A brief description of what plugins implementing this contract should do\"\n            fullWidth\n          />\n\n          {/* Methods section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"text-sm font-semibold text-neutral-900\">\n                Contract Methods\n              </h3>\n              <Button\n                variant=\"secondary\"\n                size=\"sm\"\n                onClick={addMethod}\n                leftIcon={<PlusIcon />}\n              >\n                Add Method\n              </Button>\n            </div>\n\n            {methods.map((method, index) => (\n              <MethodEditor\n                key={index}\n                method={method}\n                onChange={(m) => updateMethod(index, m)}\n                onRemove={() => removeMethod(index)}\n              />\n            ))}\n          </div>\n\n          {/* Error display */}\n          {error && (\n            <div className=\"p-3 bg-error-50 border border-error-200 rounded-lg text-sm text-error-700\">\n              {error}\n            </div>\n          )}\n\n          {/* Generate button */}\n          <div className=\"flex justify-end\">\n            <Button\n              variant=\"primary\"\n              size=\"lg\"\n              onClick={handleGenerate}\n              loading={isGenerating}\n              disabled={!name.trim() || methods.length === 0}\n              leftIcon={<CodeIcon />}\n            >\n              Generate Contract\n            </Button>\n          </div>\n        </div>\n      </Panel>\n\n      {/* Generated code preview */}\n      {generatedContract && (\n        <Panel\n          variant=\"elevated\"\n          padding=\"lg\"\n          radius=\"lg\"\n          header={`Generated: ${generatedContract.name}`}\n          showHeaderDivider\n        >\n          <div className=\"space-y-4\">\n            <CodePreview\n              code={generatedContract.code}\n              title=\"Contract Code\"\n            />\n\n            <div className=\"flex justify-end gap-3\">\n              <Button\n                variant=\"secondary\"\n                size=\"md\"\n                onClick={() => navigator.clipboard.writeText(generatedContract.code)}\n              >\n                Copy Code\n              </Button>\n              {onSave && (\n                <Button\n                  variant=\"primary\"\n                  size=\"md\"\n                  onClick={handleSave}\n                >\n                  Save Contract\n                </Button>\n              )}\n            </div>\n          </div>\n        </Panel>\n      )}\n\n      {/* Full preview modal */}\n      <Modal\n        isOpen={showPreviewModal}\n        onClose={() => setShowPreviewModal(false)}\n        title=\"Generated Contract\"\n        size=\"4xl\"\n        footer={\n          <>\n            <Button\n              variant=\"secondary\"\n              onClick={() => setShowPreviewModal(false)}\n            >\n              Close\n            </Button>\n            {onSave && (\n              <Button\n                variant=\"primary\"\n                onClick={handleSave}\n              >\n                Save Contract\n              </Button>\n            )}\n          </>\n        }\n      >\n        {generatedContract && (\n          <div className=\"space-y-6\">\n            {/* Contract info */}\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div>\n                <span className=\"font-medium text-neutral-700\">Name:</span>{\" \"}\n                <span className=\"text-neutral-900\">{generatedContract.name}</span>\n              </div>\n              <div>\n                <span className=\"font-medium text-neutral-700\">Category:</span>{\" \"}\n                <span className=\"text-neutral-900\">{generatedContract.category}</span>\n              </div>\n            </div>\n\n            <p className=\"text-sm text-neutral-600\">\n              {generatedContract.description}\n            </p>\n\n            {/* Generated code sections */}\n            <div className=\"space-y-4\">\n              <CodePreview\n                code={generatedContract.code}\n                title=\"Contract Definition\"\n              />\n\n              <CodePreview\n                code={generatedContract.hookspecCode}\n                title=\"Pluggy Hook Specification\"\n              />\n\n              <CodePreview\n                code={generatedContract.exampleImplementation}\n                title=\"Example Implementation\"\n              />\n            </div>\n          </div>\n        )}\n      </Modal>\n    </div>\n  );\n};\n\nContractWizard.displayName = \"ContractWizard\";\n\nexport default ContractWizard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\ConversationFlow.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":179,"column":30,"nodeType":"Identifier","messageId":"invalidType","endLine":179,"endColumn":38},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":204,"column":33,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":204,"endColumn":35,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5237,5239],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":213,"column":35,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":213,"endColumn":37,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5429,5431],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":218,"column":33,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":218,"endColumn":35,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5638,5640],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":225,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":225,"endColumn":58,"suggestions":[{"messageId":"addBrackets","fix":{"range":[5774,7451],"text":"{ const selectedValues = (value as string[]) || [];\n        return (\n          <div className=\"space-y-2\">\n            {step.options?.map((option) => (\n              <label\n                key={option.value}\n                className={[\n                  \"flex\",\n                  \"items-center\",\n                  \"gap-3\",\n                  \"p-3\",\n                  \"rounded-lg\",\n                  \"border\",\n                  \"cursor-pointer\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                  selectedValues.includes(option.value)\n                    ? \"border-primary-500 bg-primary-50\"\n                    : \"border-neutral-200 hover:border-neutral-300\",\n                ].join(\" \")}\n              >\n                <input\n                  type=\"checkbox\"\n                  checked={selectedValues.includes(option.value)}\n                  onChange={(e) => {\n                    if (e.target.checked) {\n                      onChange([...selectedValues, option.value]);\n                    } else {\n                      onChange(selectedValues.filter((v) => v !== option.value));\n                    }\n                  }}\n                  className=\"w-4 h-4 text-primary-600 border-neutral-300 rounded focus:ring-primary-500\"\n                />\n                <span className=\"text-sm text-neutral-900\">{option.label}</span>\n              </label>\n            ))}\n            {step.helperText && (\n              <p className=\"text-sm text-neutral-500 mt-2\">{step.helperText}</p>\n            )}\n            {error && (\n              <p className=\"text-sm text-error-600 mt-1\">{error}</p>\n            )}\n          </div>\n        ); }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":225,"column":33,"nodeType":"TSAsExpression","messageId":"alwaysTruthy","endLine":225,"endColumn":50},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":391,"column":9,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":391,"endColumn":21},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":449,"column":11,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":449,"endColumn":23},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":470,"column":7,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":470,"endColumn":19},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":570,"column":33,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":570,"endColumn":42}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D071 - src/components/ai/ConversationFlow.tsx\n * ==============================================\n * AI-powered conversation wizard for guided interactions.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D010, D011, D012, D014, D015\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport React, { useState, useCallback, useMemo } from \"react\";\nimport { Button } from \"../ui/Button\";\nimport { Input } from \"../ui/Input\";\nimport { Select, type SelectOption } from \"../ui/Select\";\nimport { Panel } from \"../ui/Panel\";\n\n/**\n * Conversation step types.\n */\nexport type StepType = \"text\" | \"select\" | \"multiselect\" | \"confirm\" | \"info\";\n\n/**\n * Single step in the conversation flow.\n */\nexport interface ConversationStep {\n  /** Unique step identifier */\n  id: string;\n  /** Step type determines input method */\n  type: StepType;\n  /** Question or prompt to display */\n  prompt: string;\n  /** Helper text for additional context */\n  helperText?: string;\n  /** Options for select/multiselect types */\n  options?: SelectOption[];\n  /** Placeholder text for text inputs */\n  placeholder?: string;\n  /** Validation function returning error message or null */\n  validate?: (value: unknown) => string | null;\n  /** Whether this step is required */\n  required?: boolean;\n  /** Conditional function to determine if step should be shown */\n  condition?: (answers: Record<string, unknown>) => boolean;\n  /** Default value for the step */\n  defaultValue?: unknown;\n}\n\n/**\n * Conversation flow configuration.\n */\nexport interface ConversationFlowConfig {\n  /** Flow title */\n  title: string;\n  /** Flow description */\n  description?: string;\n  /** Array of conversation steps */\n  steps: ConversationStep[];\n  /** Callback when flow completes */\n  onComplete: (answers: Record<string, unknown>) => void;\n  /** Callback when flow is cancelled */\n  onCancel?: () => void;\n}\n\n/**\n * Conversation flow props.\n */\nexport interface ConversationFlowProps extends ConversationFlowConfig {\n  /** Custom className */\n  className?: string;\n  /** Whether the flow is processing/loading */\n  isLoading?: boolean;\n  /** Initial answers (for resuming flows) */\n  initialAnswers?: Record<string, unknown>;\n}\n\n/**\n * Arrow right icon.\n */\nconst ArrowRightIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n    <polyline points=\"12 5 19 12 12 19\" />\n  </svg>\n);\n\n/**\n * Arrow left icon.\n */\nconst ArrowLeftIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"19\" y1=\"12\" x2=\"5\" y2=\"12\" />\n    <polyline points=\"12 19 5 12 12 5\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Info icon.\n */\nconst InfoIcon: React.FC = () => (\n  <svg\n    className=\"h-5 w-5\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\" />\n    <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" />\n  </svg>\n);\n\n/**\n * Progress indicator component.\n */\nconst ProgressIndicator: React.FC<{\n  currentStep: number;\n  totalSteps: number;\n}> = ({ currentStep, totalSteps }) => {\n  const progress = ((currentStep + 1) / totalSteps) * 100;\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"flex items-center justify-between text-sm\">\n        <span className=\"text-neutral-600\">\n          Step {currentStep + 1} of {totalSteps}\n        </span>\n        <span className=\"text-neutral-500\">{Math.round(progress)}%</span>\n      </div>\n      <div className=\"h-2 bg-neutral-200 rounded-full overflow-hidden\">\n        <div\n          className=\"h-full bg-primary-500 rounded-full transition-all duration-300\"\n          style={{ width: `${progress}%` }}\n        />\n      </div>\n    </div>\n  );\n};\n\n/**\n * Step renderer component.\n */\nconst StepRenderer: React.FC<{\n  step: ConversationStep;\n  value: unknown;\n  onChange: (value: unknown) => void;\n  error?: string | null;\n}> = ({ step, value, onChange, error }) => {\n  const renderInput = () => {\n    switch (step.type) {\n      case \"text\":\n        return (\n          <Input\n            value={(value as string) || \"\"}\n            onChange={(e) => onChange(e.target.value)}\n            placeholder={step.placeholder}\n            error={!!error}\n            errorMessage={error || undefined}\n            helperText={step.helperText}\n            fullWidth\n          />\n        );\n\n      case \"select\":\n        return (\n          <Select\n            options={step.options || []}\n            value={(value as string) || \"\"}\n            onChange={(e) => onChange(e.target.value)}\n            placeholder=\"Select an option\"\n            error={!!error}\n            errorMessage={error || undefined}\n            helperText={step.helperText}\n            fullWidth\n          />\n        );\n\n      case \"multiselect\":\n        const selectedValues = (value as string[]) || [];\n        return (\n          <div className=\"space-y-2\">\n            {step.options?.map((option) => (\n              <label\n                key={option.value}\n                className={[\n                  \"flex\",\n                  \"items-center\",\n                  \"gap-3\",\n                  \"p-3\",\n                  \"rounded-lg\",\n                  \"border\",\n                  \"cursor-pointer\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                  selectedValues.includes(option.value)\n                    ? \"border-primary-500 bg-primary-50\"\n                    : \"border-neutral-200 hover:border-neutral-300\",\n                ].join(\" \")}\n              >\n                <input\n                  type=\"checkbox\"\n                  checked={selectedValues.includes(option.value)}\n                  onChange={(e) => {\n                    if (e.target.checked) {\n                      onChange([...selectedValues, option.value]);\n                    } else {\n                      onChange(selectedValues.filter((v) => v !== option.value));\n                    }\n                  }}\n                  className=\"w-4 h-4 text-primary-600 border-neutral-300 rounded focus:ring-primary-500\"\n                />\n                <span className=\"text-sm text-neutral-900\">{option.label}</span>\n              </label>\n            ))}\n            {step.helperText && (\n              <p className=\"text-sm text-neutral-500 mt-2\">{step.helperText}</p>\n            )}\n            {error && (\n              <p className=\"text-sm text-error-600 mt-1\">{error}</p>\n            )}\n          </div>\n        );\n\n      case \"confirm\":\n        return (\n          <div className=\"space-y-4\">\n            {step.helperText && (\n              <p className=\"text-sm text-neutral-600\">{step.helperText}</p>\n            )}\n            <div className=\"flex items-center gap-4\">\n              <Button\n                variant={value === true ? \"primary\" : \"secondary\"}\n                onClick={() => onChange(true)}\n                size=\"md\"\n              >\n                Yes\n              </Button>\n              <Button\n                variant={value === false ? \"primary\" : \"secondary\"}\n                onClick={() => onChange(false)}\n                size=\"md\"\n              >\n                No\n              </Button>\n            </div>\n            {error && (\n              <p className=\"text-sm text-error-600\">{error}</p>\n            )}\n          </div>\n        );\n\n      case \"info\":\n        return (\n          <div className=\"flex items-start gap-3 p-4 bg-info-50 border border-info-200 rounded-lg\">\n            <span className=\"text-info-600 shrink-0\">\n              <InfoIcon />\n            </span>\n            <p className=\"text-sm text-info-800\">{step.helperText}</p>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div>\n        <h3 className=\"text-lg font-semibold text-neutral-900\">{step.prompt}</h3>\n        {step.required && step.type !== \"info\" && (\n          <span className=\"text-xs text-neutral-500 mt-1\">Required</span>\n        )}\n      </div>\n      {renderInput()}\n    </div>\n  );\n};\n\n/**\n * ConversationFlow component.\n *\n * A guided conversation wizard that walks users through a series of steps\n * to gather information. Supports text input, selection, multi-select,\n * confirmation, and informational steps.\n *\n * @example\n * ```tsx\n * const steps: ConversationStep[] = [\n *   {\n *     id: \"name\",\n *     type: \"text\",\n *     prompt: \"What would you like to name your project?\",\n *     placeholder: \"My Awesome Project\",\n *     required: true,\n *   },\n *   {\n *     id: \"type\",\n *     type: \"select\",\n *     prompt: \"What type of project is this?\",\n *     options: [\n *       { value: \"web\", label: \"Web Application\" },\n *       { value: \"mobile\", label: \"Mobile App\" },\n *     ],\n *     required: true,\n *   },\n * ];\n *\n * <ConversationFlow\n *   title=\"Create New Project\"\n *   steps={steps}\n *   onComplete={(answers) => console.log(answers)}\n * />\n * ```\n */\nexport const ConversationFlow: React.FC<ConversationFlowProps> = ({\n  title,\n  description,\n  steps,\n  onComplete,\n  onCancel,\n  className = \"\",\n  isLoading = false,\n  initialAnswers = {},\n}) => {\n  const [currentStepIndex, setCurrentStepIndex] = useState(0);\n  const [answers, setAnswers] = useState<Record<string, unknown>>(initialAnswers);\n  const [errors, setErrors] = useState<Record<string, string | null>>({});\n\n  // Filter steps based on conditions\n  const visibleSteps = useMemo(() => {\n    return steps.filter((step) => {\n      if (step.condition) {\n        return step.condition(answers);\n      }\n      return true;\n    });\n  }, [steps, answers]);\n\n  const currentStep = visibleSteps[currentStepIndex];\n  const isFirstStep = currentStepIndex === 0;\n  const isLastStep = currentStepIndex === visibleSteps.length - 1;\n\n  const validateCurrentStep = useCallback((): boolean => {\n    if (!currentStep) return true;\n\n    const value = answers[currentStep.id];\n\n    // Required validation\n    if (currentStep.required && currentStep.type !== \"info\") {\n      const isEmpty =\n        value === undefined ||\n        value === null ||\n        value === \"\" ||\n        (Array.isArray(value) && value.length === 0);\n\n      if (isEmpty) {\n        setErrors((prev) => ({\n          ...prev,\n          [currentStep.id]: \"This field is required\",\n        }));\n        return false;\n      }\n    }\n\n    // Custom validation\n    if (currentStep.validate) {\n      const error = currentStep.validate(value);\n      if (error) {\n        setErrors((prev) => ({\n          ...prev,\n          [currentStep.id]: error,\n        }));\n        return false;\n      }\n    }\n\n    setErrors((prev) => ({\n      ...prev,\n      [currentStep.id]: null,\n    }));\n    return true;\n  }, [currentStep, answers]);\n\n  const handleNext = useCallback(() => {\n    if (!validateCurrentStep()) return;\n\n    if (isLastStep) {\n      onComplete(answers);\n    } else {\n      setCurrentStepIndex((prev) => prev + 1);\n    }\n  }, [validateCurrentStep, isLastStep, onComplete, answers]);\n\n  const handlePrevious = useCallback(() => {\n    if (!isFirstStep) {\n      setCurrentStepIndex((prev) => prev - 1);\n    }\n  }, [isFirstStep]);\n\n  const handleValueChange = useCallback(\n    (value: unknown) => {\n      if (!currentStep) return;\n      setAnswers((prev) => ({\n        ...prev,\n        [currentStep.id]: value,\n      }));\n      // Clear error when value changes\n      setErrors((prev) => ({\n        ...prev,\n        [currentStep.id]: null,\n      }));\n    },\n    [currentStep]\n  );\n\n  const containerStyles = [\n    \"w-full\",\n    \"max-w-2xl\",\n    \"mx-auto\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  if (!currentStep) {\n    return null;\n  }\n\n  return (\n    <div className={containerStyles}>\n      <Panel\n        variant=\"elevated\"\n        padding=\"lg\"\n        radius=\"lg\"\n      >\n        {/* Header */}\n        <div className=\"mb-6\">\n          <h2 className=\"text-xl font-bold text-neutral-900\">{title}</h2>\n          {description && (\n            <p className=\"text-sm text-neutral-600 mt-1\">{description}</p>\n          )}\n        </div>\n\n        {/* Progress */}\n        <div className=\"mb-8\">\n          <ProgressIndicator\n            currentStep={currentStepIndex}\n            totalSteps={visibleSteps.length}\n          />\n        </div>\n\n        {/* Current step */}\n        <div className=\"mb-8\">\n          <StepRenderer\n            step={currentStep}\n            value={answers[currentStep.id] ?? currentStep.defaultValue}\n            onChange={handleValueChange}\n            error={errors[currentStep.id]}\n          />\n        </div>\n\n        {/* Navigation */}\n        <div className=\"flex items-center justify-between pt-6 border-t border-neutral-200\">\n          <div>\n            {onCancel && (\n              <Button\n                variant=\"ghost\"\n                size=\"md\"\n                onClick={onCancel}\n                disabled={isLoading}\n              >\n                Cancel\n              </Button>\n            )}\n          </div>\n\n          <div className=\"flex items-center gap-3\">\n            {!isFirstStep && (\n              <Button\n                variant=\"secondary\"\n                size=\"md\"\n                onClick={handlePrevious}\n                disabled={isLoading}\n                leftIcon={<ArrowLeftIcon />}\n              >\n                Back\n              </Button>\n            )}\n            <Button\n              variant=\"primary\"\n              size=\"md\"\n              onClick={handleNext}\n              loading={isLoading}\n              rightIcon={isLastStep ? <CheckIcon /> : <ArrowRightIcon />}\n            >\n              {isLastStep ? \"Complete\" : \"Next\"}\n            </Button>\n          </div>\n        </div>\n      </Panel>\n\n      {/* Step indicators */}\n      <div className=\"flex items-center justify-center gap-2 mt-6\">\n        {visibleSteps.map((step, index) => (\n          <button\n            key={step.id}\n            onClick={() => {\n              if (index < currentStepIndex) {\n                setCurrentStepIndex(index);\n              }\n            }}\n            disabled={index > currentStepIndex}\n            className={[\n              \"w-3\",\n              \"h-3\",\n              \"rounded-full\",\n              \"transition-colors\",\n              \"duration-150\",\n              index === currentStepIndex\n                ? \"bg-primary-500\"\n                : index < currentStepIndex\n                ? \"bg-primary-300 hover:bg-primary-400 cursor-pointer\"\n                : \"bg-neutral-200 cursor-not-allowed\",\n            ].join(\" \")}\n            aria-label={`Step ${index + 1}: ${step.prompt}`}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nConversationFlow.displayName = \"ConversationFlow\";\n\nexport default ConversationFlow;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\FixSuggestions.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":274,"column":30,"nodeType":"Identifier","messageId":"invalidType","endLine":274,"endColumn":40},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":489,"column":38,"nodeType":"MemberExpression","messageId":"invalidType","endLine":489,"endColumn":48},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":490,"column":40,"nodeType":"MemberExpression","messageId":"invalidType","endLine":490,"endColumn":52},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":504,"column":23,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":504,"endColumn":37},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":545,"column":27,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":549,"endColumn":20}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D073 - src/components/ai/FixSuggestions.tsx\n * ============================================\n * AI-powered fix suggestions for errors and issues.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D010, D014, D015\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport React, { useState, useCallback } from \"react\";\nimport { Button } from \"../ui/Button\";\nimport { Panel } from \"../ui/Panel\";\n\n/**\n * Severity levels for issues.\n */\nexport type IssueSeverity = \"error\" | \"warning\" | \"info\" | \"hint\";\n\n/**\n * Issue structure that needs fixing.\n */\nexport interface Issue {\n  /** Unique issue identifier */\n  id: string;\n  /** Issue title/summary */\n  title: string;\n  /** Detailed description */\n  description: string;\n  /** Issue severity */\n  severity: IssueSeverity;\n  /** File where issue occurred */\n  file?: string;\n  /** Line number */\n  line?: number;\n  /** Column number */\n  column?: number;\n  /** Error code (if applicable) */\n  code?: string;\n  /** Original error message */\n  originalMessage?: string;\n}\n\n/**\n * Suggested fix structure.\n */\nexport interface FixSuggestion {\n  /** Unique suggestion identifier */\n  id: string;\n  /** Related issue ID */\n  issueId: string;\n  /** Fix title */\n  title: string;\n  /** Detailed explanation of the fix */\n  explanation: string;\n  /** Confidence level (0-100) */\n  confidence: number;\n  /** Code diff or patch */\n  diff?: string;\n  /** Whether this fix can be auto-applied */\n  autoApplicable: boolean;\n  /** Potential side effects */\n  sideEffects?: string[];\n  /** Resources or documentation links */\n  resources?: { title: string; url: string }[];\n}\n\n/**\n * Fix suggestions props.\n */\nexport interface FixSuggestionsProps {\n  /** Array of issues to display fixes for */\n  issues: Issue[];\n  /** Callback to get AI-generated fix suggestions */\n  onGetSuggestions: (issue: Issue) => Promise<FixSuggestion[]>;\n  /** Callback when user applies a fix */\n  onApplyFix?: (suggestion: FixSuggestion) => Promise<void>;\n  /** Callback when user dismisses an issue */\n  onDismissIssue?: (issue: Issue) => void;\n  /** Whether suggestions are loading */\n  isLoading?: boolean;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * Severity icon component.\n */\nconst SeverityIcon: React.FC<{ severity: IssueSeverity }> = ({ severity }) => {\n  const iconColors = {\n    error: \"text-error-500\",\n    warning: \"text-warning-500\",\n    info: \"text-info-500\",\n    hint: \"text-neutral-500\",\n  };\n\n  const baseClass = `h-5 w-5 ${iconColors[severity]}`;\n\n  switch (severity) {\n    case \"error\":\n      return (\n        <svg\n          className={baseClass}\n          xmlns=\"http://www.w3.org/2000/svg\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\" />\n          <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\" />\n        </svg>\n      );\n    case \"warning\":\n      return (\n        <svg\n          className={baseClass}\n          xmlns=\"http://www.w3.org/2000/svg\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" />\n          <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" />\n          <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\n        </svg>\n      );\n    case \"info\":\n      return (\n        <svg\n          className={baseClass}\n          xmlns=\"http://www.w3.org/2000/svg\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\" />\n          <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" />\n        </svg>\n      );\n    default:\n      return (\n        <svg\n          className={baseClass}\n          xmlns=\"http://www.w3.org/2000/svg\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\" />\n          <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\n        </svg>\n      );\n  }\n};\n\n/**\n * Lightbulb icon.\n */\nconst LightbulbIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"9\" y1=\"18\" x2=\"15\" y2=\"18\" />\n    <line x1=\"10\" y1=\"22\" x2=\"14\" y2=\"22\" />\n    <path d=\"M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * External link icon.\n */\nconst ExternalLinkIcon: React.FC = () => (\n  <svg\n    className=\"h-3 w-3\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\" />\n    <polyline points=\"15 3 21 3 21 9\" />\n    <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\" />\n  </svg>\n);\n\n/**\n * X icon for dismiss.\n */\nconst XIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Confidence indicator component.\n */\nconst ConfidenceIndicator: React.FC<{ confidence: number }> = ({ confidence }) => {\n  const getColor = () => {\n    if (confidence >= 80) return \"bg-success-500\";\n    if (confidence >= 50) return \"bg-warning-500\";\n    return \"bg-error-500\";\n  };\n\n  return (\n    <div className=\"flex items-center gap-2\">\n      <div className=\"flex-1 h-2 bg-neutral-200 rounded-full overflow-hidden\">\n        <div\n          className={`h-full ${getColor()} rounded-full transition-all duration-300`}\n          style={{ width: `${confidence}%` }}\n        />\n      </div>\n      <span className=\"text-xs text-neutral-600 w-10 text-right\">{confidence}%</span>\n    </div>\n  );\n};\n\n/**\n * Diff viewer component.\n */\nconst DiffViewer: React.FC<{ diff: string }> = ({ diff }) => {\n  const lines = diff.split(\"\\n\");\n\n  return (\n    <div className=\"bg-neutral-900 rounded-lg overflow-hidden\">\n      <div className=\"px-4 py-2 bg-neutral-800 border-b border-neutral-700\">\n        <span className=\"text-xs text-neutral-400 uppercase tracking-wide\">\n          Suggested Changes\n        </span>\n      </div>\n      <pre className=\"p-4 overflow-x-auto text-sm font-mono\">\n        {lines.map((line, index) => {\n          let lineClass = \"text-neutral-300\";\n          if (line.startsWith(\"+\") && !line.startsWith(\"+++\")) {\n            lineClass = \"text-success-400 bg-success-900/30\";\n          } else if (line.startsWith(\"-\") && !line.startsWith(\"---\")) {\n            lineClass = \"text-error-400 bg-error-900/30\";\n          } else if (line.startsWith(\"@@\")) {\n            lineClass = \"text-info-400\";\n          }\n          return (\n            <div key={index} className={`${lineClass} px-2 -mx-2`}>\n              {line}\n            </div>\n          );\n        })}\n      </pre>\n    </div>\n  );\n};\n\n/**\n * Single suggestion card component.\n */\nconst SuggestionCard: React.FC<{\n  suggestion: FixSuggestion;\n  onApply?: () => void;\n  isApplying?: boolean;\n}> = ({ suggestion, onApply, isApplying }) => {\n  const [showDiff, setShowDiff] = useState(false);\n\n  return (\n    <div className=\"border border-neutral-200 rounded-lg p-4 space-y-3\">\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex items-start gap-3\">\n          <span className=\"text-primary-500 mt-0.5\">\n            <LightbulbIcon />\n          </span>\n          <div>\n            <h4 className=\"text-sm font-medium text-neutral-900\">\n              {suggestion.title}\n            </h4>\n            <p className=\"text-sm text-neutral-600 mt-1\">\n              {suggestion.explanation}\n            </p>\n          </div>\n        </div>\n        {suggestion.autoApplicable && onApply && (\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            onClick={onApply}\n            loading={isApplying}\n            leftIcon={<CheckIcon />}\n          >\n            Apply\n          </Button>\n        )}\n      </div>\n\n      {/* Confidence */}\n      <div className=\"pl-7\">\n        <span className=\"text-xs text-neutral-500 block mb-1\">Confidence</span>\n        <ConfidenceIndicator confidence={suggestion.confidence} />\n      </div>\n\n      {/* Side effects warning */}\n      {suggestion.sideEffects && suggestion.sideEffects.length > 0 && (\n        <div className=\"pl-7\">\n          <div className=\"p-3 bg-warning-50 border border-warning-200 rounded-lg\">\n            <span className=\"text-xs font-medium text-warning-700 block mb-1\">\n              Potential Side Effects\n            </span>\n            <ul className=\"text-sm text-warning-600 list-disc list-inside\">\n              {suggestion.sideEffects.map((effect, index) => (\n                <li key={index}>{effect}</li>\n              ))}\n            </ul>\n          </div>\n        </div>\n      )}\n\n      {/* Diff preview toggle */}\n      {suggestion.diff && (\n        <div className=\"pl-7\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setShowDiff(!showDiff)}\n          >\n            {showDiff ? \"Hide\" : \"Show\"} Changes\n          </Button>\n          {showDiff && (\n            <div className=\"mt-3\">\n              <DiffViewer diff={suggestion.diff} />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Resources */}\n      {suggestion.resources && suggestion.resources.length > 0 && (\n        <div className=\"pl-7\">\n          <span className=\"text-xs text-neutral-500 block mb-2\">\n            Related Resources\n          </span>\n          <div className=\"flex flex-wrap gap-2\">\n            {suggestion.resources.map((resource, index) => (\n              <a\n                key={index}\n                href={resource.url}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 hover:underline\"\n              >\n                {resource.title}\n                <ExternalLinkIcon />\n              </a>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\n/**\n * Issue card with expandable suggestions.\n */\nconst IssueCard: React.FC<{\n  issue: Issue;\n  onGetSuggestions: () => Promise<FixSuggestion[]>;\n  onApplyFix?: (suggestion: FixSuggestion) => Promise<void>;\n  onDismiss?: () => void;\n}> = ({ issue, onGetSuggestions, onApplyFix, onDismiss }) => {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [suggestions, setSuggestions] = useState<FixSuggestion[]>([]);\n  const [isLoadingSuggestions, setIsLoadingSuggestions] = useState(false);\n  const [applyingId, setApplyingId] = useState<string | null>(null);\n\n  const handleExpand = useCallback(async () => {\n    if (!isExpanded && suggestions.length === 0) {\n      setIsLoadingSuggestions(true);\n      try {\n        const result = await onGetSuggestions();\n        setSuggestions(result);\n      } catch (err) {\n        console.error(\"Failed to get suggestions:\", err);\n      } finally {\n        setIsLoadingSuggestions(false);\n      }\n    }\n    setIsExpanded(!isExpanded);\n  }, [isExpanded, suggestions.length, onGetSuggestions]);\n\n  const handleApply = useCallback(\n    async (suggestion: FixSuggestion) => {\n      if (!onApplyFix) return;\n      setApplyingId(suggestion.id);\n      try {\n        await onApplyFix(suggestion);\n      } finally {\n        setApplyingId(null);\n      }\n    },\n    [onApplyFix]\n  );\n\n  const severityBg = {\n    error: \"border-l-error-500 bg-error-50/50\",\n    warning: \"border-l-warning-500 bg-warning-50/50\",\n    info: \"border-l-info-500 bg-info-50/50\",\n    hint: \"border-l-neutral-400 bg-neutral-50\",\n  };\n\n  return (\n    <div\n      className={`border-l-4 rounded-lg overflow-hidden ${severityBg[issue.severity]}`}\n    >\n      {/* Issue header */}\n      <div className=\"p-4\">\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex items-start gap-3\">\n            <SeverityIcon severity={issue.severity} />\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-sm font-semibold text-neutral-900\">\n                {issue.title}\n              </h3>\n              <p className=\"text-sm text-neutral-600 mt-0.5\">\n                {issue.description}\n              </p>\n              {issue.file && (\n                <p className=\"text-xs text-neutral-500 mt-1 font-mono\">\n                  {issue.file}\n                  {issue.line && `:${issue.line}`}\n                  {issue.column && `:${issue.column}`}\n                </p>\n              )}\n              {issue.code && (\n                <span className=\"inline-block mt-1 px-2 py-0.5 bg-neutral-200 rounded text-xs font-mono text-neutral-700\">\n                  {issue.code}\n                </span>\n              )}\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={handleExpand}\n              leftIcon={<LightbulbIcon />}\n            >\n              {isExpanded ? \"Hide\" : \"Get\"} Suggestions\n            </Button>\n            {onDismiss && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                iconOnly\n                onClick={onDismiss}\n                aria-label=\"Dismiss issue\"\n              >\n                <XIcon />\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Suggestions panel */}\n      {isExpanded && (\n        <div className=\"border-t border-neutral-200 bg-white p-4\">\n          {isLoadingSuggestions ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"flex items-center gap-2 text-neutral-500\">\n                <div className=\"w-5 h-5 border-2 border-neutral-300 border-t-primary-500 rounded-full animate-spin\" />\n                <span className=\"text-sm\">Getting AI suggestions...</span>\n              </div>\n            </div>\n          ) : suggestions.length === 0 ? (\n            <div className=\"text-center py-6 text-neutral-500\">\n              <LightbulbIcon />\n              <p className=\"text-sm mt-2\">No suggestions available</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {suggestions.map((suggestion) => (\n                <SuggestionCard\n                  key={suggestion.id}\n                  suggestion={suggestion}\n                  onApply={\n                    onApplyFix && suggestion.autoApplicable\n                      ? () => handleApply(suggestion)\n                      : undefined\n                  }\n                  isApplying={applyingId === suggestion.id}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\n/**\n * FixSuggestions component.\n *\n * Displays a list of issues with AI-powered fix suggestions. Users can\n * expand issues to see suggestions, view diffs, and apply fixes.\n *\n * @example\n * ```tsx\n * const issues = [\n *   {\n *     id: \"1\",\n *     title: \"Missing required parameter\",\n *     description: \"Function 'synthesize' is missing required parameter 'voice_id'\",\n *     severity: \"error\",\n *     file: \"plugins/tts_kokoro/plugin.py\",\n *     line: 42,\n *   },\n * ];\n *\n * <FixSuggestions\n *   issues={issues}\n *   onGetSuggestions={async (issue) => {\n *     return await aiService.getSuggestions(issue);\n *   }}\n *   onApplyFix={async (suggestion) => {\n *     await applyPatch(suggestion.diff);\n *   }}\n * />\n * ```\n */\nexport const FixSuggestions: React.FC<FixSuggestionsProps> = ({\n  issues,\n  onGetSuggestions,\n  onApplyFix,\n  onDismissIssue,\n  isLoading = false,\n  className = \"\",\n}) => {\n  const [dismissedIds, setDismissedIds] = useState<Set<string>>(new Set());\n\n  const visibleIssues = issues.filter((issue) => !dismissedIds.has(issue.id));\n\n  const handleDismiss = useCallback(\n    (issue: Issue) => {\n      setDismissedIds((prev) => new Set([...prev, issue.id]));\n      onDismissIssue?.(issue);\n    },\n    [onDismissIssue]\n  );\n\n  const containerStyles = [\"space-y-4\", className].filter(Boolean).join(\" \");\n\n  // Group issues by severity\n  const errorIssues = visibleIssues.filter((i) => i.severity === \"error\");\n  const warningIssues = visibleIssues.filter((i) => i.severity === \"warning\");\n  const infoIssues = visibleIssues.filter((i) => i.severity === \"info\");\n  const hintIssues = visibleIssues.filter((i) => i.severity === \"hint\");\n\n  if (visibleIssues.length === 0) {\n    return (\n      <Panel variant=\"default\" padding=\"lg\" radius=\"lg\" className={className}>\n        <div className=\"text-center py-8\">\n          <div className=\"inline-flex items-center justify-center w-12 h-12 rounded-full bg-success-100 text-success-600 mb-3\">\n            <CheckIcon />\n          </div>\n          <h3 className=\"text-lg font-semibold text-neutral-900\">\n            No Issues Found\n          </h3>\n          <p className=\"text-sm text-neutral-500 mt-1\">\n            Everything looks good! No issues to fix.\n          </p>\n        </div>\n      </Panel>\n    );\n  }\n\n  return (\n    <div className={containerStyles}>\n      {/* Summary header */}\n      <Panel variant=\"default\" padding=\"md\" radius=\"lg\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <h2 className=\"text-lg font-semibold text-neutral-900\">\n              Issues ({visibleIssues.length})\n            </h2>\n            <div className=\"flex items-center gap-3 text-sm\">\n              {errorIssues.length > 0 && (\n                <span className=\"text-error-600\">\n                  {errorIssues.length} error{errorIssues.length !== 1 ? \"s\" : \"\"}\n                </span>\n              )}\n              {warningIssues.length > 0 && (\n                <span className=\"text-warning-600\">\n                  {warningIssues.length} warning{warningIssues.length !== 1 ? \"s\" : \"\"}\n                </span>\n              )}\n              {infoIssues.length > 0 && (\n                <span className=\"text-info-600\">\n                  {infoIssues.length} info\n                </span>\n              )}\n              {hintIssues.length > 0 && (\n                <span className=\"text-neutral-500\">\n                  {hintIssues.length} hint{hintIssues.length !== 1 ? \"s\" : \"\"}\n                </span>\n              )}\n            </div>\n          </div>\n          {isLoading && (\n            <div className=\"flex items-center gap-2 text-neutral-500\">\n              <div className=\"w-4 h-4 border-2 border-neutral-300 border-t-primary-500 rounded-full animate-spin\" />\n              <span className=\"text-sm\">Analyzing...</span>\n            </div>\n          )}\n        </div>\n      </Panel>\n\n      {/* Issues list */}\n      <div className=\"space-y-3\">\n        {visibleIssues.map((issue) => (\n          <IssueCard\n            key={issue.id}\n            issue={issue}\n            onGetSuggestions={() => onGetSuggestions(issue)}\n            onApplyFix={onApplyFix}\n            onDismiss={onDismissIssue ? () => handleDismiss(issue) : undefined}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nFixSuggestions.displayName = \"FixSuggestions\";\n\nexport default FixSuggestions;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\LiveComponentPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1316,1319],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1316,1319],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1411,1414],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1411,1414],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":53,"column":29,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":53,"endColumn":34,"fix":{"range":[1997,2045],"text":"/const\\s+([A-Z][a-zA-Z0-9]*)\\s*[:=]/.exec(code)"}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":57,"column":28,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":57,"endColumn":33,"fix":{"range":[2154,2203],"text":"/function\\s+([A-Z][a-zA-Z0-9]*)\\s*\\(/.exec(code)"}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":61,"column":30,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":61,"endColumn":35,"fix":{"range":[2315,2378],"text":"/export\\s+(?:const|function)\\s+([A-Z][a-zA-Z0-9]*)/.exec(code)"}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":79,"column":43,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":79,"endColumn":48,"fix":{"range":[2890,2929],"text":"/^(\\{[^}]+\\})\\s*:\\s*.+$/.exec(trimmed)"}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":83,"column":48,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":83,"endColumn":53,"fix":{"range":[3097,3137],"text":"/^(\\[[^\\]]+\\])\\s*:\\s*.+$/.exec(trimmed)"}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":177,"column":37,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":177,"endColumn":42,"fix":{"range":[7856,7887],"text":"/function\\s+(\\w+)/.exec(match)"}},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":225,"column":60,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":225,"endColumn":62,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[10063,10065],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":241,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":241,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10550,10553],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10550,10553],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-implied-eval","severity":2,"message":"Implied eval. Do not use the Function constructor to create functions.","line":255,"column":26,"nodeType":"NewExpression","messageId":"noFunctionConstructor","endLine":261,"endColumn":10},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":263,"column":15,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":263,"endColumn":51},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `Function` typed value.","line":263,"column":27,"nodeType":"Identifier","messageId":"unsafeCall","endLine":263,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":269,"column":18,"nodeType":"Property","messageId":"anyAssignment","endLine":269,"endColumn":27},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":311,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":311,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[13178,13180],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\LiveComponentPreview.tsx:351:13\n  349 |     useEffect(() => {\n  350 |         if (!code || typeof code !== 'string' || !code.trim()) {\n> 351 |             setState({ Component: null, error: 'No code provided', isCompiling: false });\n      |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  352 |             return;\n  353 |         }\n  354 |","line":351,"column":13,"nodeType":null,"endLine":351,"endColumn":21},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":386,"column":142,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":386,"endColumn":144,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[15864,15866],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, comparison is always true, since `\"react\" === \"react\"` is true.","line":397,"column":100,"nodeType":"BinaryExpression","messageId":"comparisonBetweenLiteralTypes","endLine":397,"endColumn":121},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":399,"column":17,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":399,"endColumn":38},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":409,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":409,"endColumn":24,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[16670,16670],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[16670,16670],"text":"await "},"desc":"Add await operator."}]}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":6,"fixableWarningCount":0,"source":"/**\r\n * src/components/ai/LiveComponentPreview.tsx\r\n * ==========================================\r\n * Live preview renderer for AI-generated React components.\r\n * Uses backend SWC compiler (Rust/Tauri) for reliable TypeScript compilation.\r\n * Falls back to Sucrase for browser-only development.\r\n *\r\n * Architecture: Option B (Backend Pre-Compilation)\r\n * Dependencies: D070 (ComponentGenerator), compilerService\r\n *\r\n * NOTICE TO AI ASSISTANTS:\r\n * ========================\r\n * This component dynamically compiles and renders user-generated JSX code.\r\n * Use caution when modifying the compilation or execution logic.\r\n */\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { compileTsx } from '../../services/compilerService';\r\n\r\n// =============================================================================\r\n// TYPES\r\n// =============================================================================\r\n\r\ninterface LiveComponentPreviewProps {\r\n    /** Raw React/TSX code to render */\r\n    code: string;\r\n    /** Target framework (only 'react' supported initially) */\r\n    framework: 'react' | 'vue' | 'svelte' | 'html';\r\n    /** Preview container className */\r\n    className?: string;\r\n    /** Optional scope for injected dependencies (components, utils, icons) */\r\n    scope?: Record<string, any>;\r\n    /** Optional props to pass to the rendered component */\r\n    props?: Record<string, any>;\r\n}\r\n\r\ninterface PreviewState {\r\n    Component: React.ComponentType | null;\r\n    error: string | null;\r\n    isCompiling: boolean;\r\n}\r\n\r\n// =============================================================================\r\n// HELPER FUNCTIONS\r\n// =============================================================================\r\n\r\n/**\r\n * Extract the component name from generated code.\r\n * Looks for: const ComponentName = or function ComponentName\r\n */\r\nfunction extractComponentName(code: string): string | null {\r\n    // Match: const ComponentName: React.FC = \r\n    const constMatch = code.match(/const\\s+([A-Z][a-zA-Z0-9]*)\\s*[:=]/);\r\n    if (constMatch) return constMatch[1];\r\n\r\n    // Match: function ComponentName(\r\n    const funcMatch = code.match(/function\\s+([A-Z][a-zA-Z0-9]*)\\s*\\(/);\r\n    if (funcMatch) return funcMatch[1];\r\n\r\n    // Match: export const ComponentName\r\n    const exportMatch = code.match(/export\\s+(?:const|function)\\s+([A-Z][a-zA-Z0-9]*)/);\r\n    if (exportMatch) return exportMatch[1];\r\n\r\n    return null;\r\n}\r\n\r\n/**\r\n * Clean function parameters by removing type annotations.\r\n * Only processes actual function parameters, not JSX content.\r\n */\r\nfunction cleanFunctionParams(params: string): string {\r\n    return params\r\n        .split(',')\r\n        .map((p: string) => {\r\n            const trimmed = p.trim();\r\n            if (!trimmed) return '';\r\n\r\n            // Handle destructuring: { prop }: Type => { prop }\r\n            const destructMatch = trimmed.match(/^(\\{[^}]+\\})\\s*:\\s*.+$/);\r\n            if (destructMatch) return destructMatch[1];\r\n\r\n            // Handle array destructuring: [a, b]: Type => [a, b]\r\n            const arrayDestructMatch = trimmed.match(/^(\\[[^\\]]+\\])\\s*:\\s*.+$/);\r\n            if (arrayDestructMatch) return arrayDestructMatch[1];\r\n\r\n            // Handle regular params: param: Type => param\r\n            // But NOT if it contains Tailwind-like patterns (word:word without spaces)\r\n            if (trimmed.includes(':')) {\r\n                const colonIndex = trimmed.indexOf(':');\r\n                const beforeColon = trimmed.substring(0, colonIndex).trim();\r\n                const afterColon = trimmed.substring(colonIndex + 1).trim();\r\n\r\n                // If afterColon starts with a letter (type annotation), strip it\r\n                // But if it looks like a value (number, string, etc.), keep it\r\n                if (/^[A-Za-z]/.test(afterColon) && /^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(beforeColon)) {\r\n                    return beforeColon;\r\n                }\r\n            }\r\n\r\n            return trimmed;\r\n        })\r\n        .filter((p: string) => p.length > 0)\r\n        .join(', ');\r\n}\r\n\r\n/**\r\n * Normalize AI-generated code for runtime compilation.\r\n * Strips imports, interfaces, TypeScript annotations, and simplifies patterns.\r\n *\r\n * This function handles patterns that Sucrase cannot process at runtime:\r\n * - Import statements (React is injected)\r\n * - Interface/type definitions\r\n * - Type annotations on parameters and return values\r\n * - Generic type parameters\r\n * - Type assertions (as, satisfies)\r\n * - Markdown code fences from LLM output\r\n *\r\n * IMPORTANT: Does NOT touch JSX content - Tailwind classes like hover:bg-primary\r\n * contain colons but are NOT type annotations.\r\n */\r\nfunction normalizeCode(code: string): string {\r\n    let normalized = code;\r\n\r\n    // Remove markdown code fences (LLMs often wrap code in ```)\r\n    normalized = normalized.replace(/^```(?:tsx?|jsx?|typescript|javascript|react)?\\s*\\n?/gm, '');\r\n    normalized = normalized.replace(/```\\s*$/gm, '');\r\n\r\n    // Remove import statements (React is provided at runtime)\r\n    normalized = normalized.replace(/^import\\s+.*?from\\s+['\"][^'\"]*['\"];?\\s*$/gm, '');\r\n    normalized = normalized.replace(/^import\\s+['\"][^'\"]*['\"];?\\s*$/gm, '');\r\n    normalized = normalized.replace(/^import\\s+type\\s+.*?from\\s+['\"][^'\"]*['\"];?\\s*$/gm, '');\r\n\r\n    // Remove interface definitions with their content (multi-line aware)\r\n    // Handle nested braces by being more conservative\r\n    normalized = normalized.replace(/interface\\s+\\w+(?:\\s+extends\\s+[^{]+)?\\s*\\{[\\s\\S]*?\\n\\}/gm, '');\r\n\r\n    // Remove type definitions (including multi-line)\r\n    normalized = normalized.replace(/^type\\s+\\w+\\s*=\\s*[\\s\\S]*?;\\s*$/gm, '');\r\n    normalized = normalized.replace(/\\btype\\s+\\w+\\s*=\\s*[^;]+;/g, '');\r\n\r\n    // Remove export keywords (we'll access the component directly)\r\n    normalized = normalized.replace(/^export\\s+default\\s+/gm, '');\r\n    normalized = normalized.replace(/^export\\s+/gm, '');\r\n\r\n    // Remove React.FC and FC type annotations\r\n    normalized = normalized.replace(/:\\s*React\\.FC<[^>]*>/g, '');\r\n    normalized = normalized.replace(/:\\s*React\\.FC/g, '');\r\n    normalized = normalized.replace(/:\\s*FC<[^>]*>/g, '');\r\n    normalized = normalized.replace(/:\\s*FC\\b/g, '');\r\n\r\n    // Remove generic type parameters from function/const declarations: <T, U>\r\n    normalized = normalized.replace(/(<[A-Z][^>]*>)\\s*(?=\\()/g, '');\r\n\r\n    // Remove return type annotations: ): Type => or ): Type {\r\n    // Only match when followed by arrow or opening brace (function body)\r\n    normalized = normalized.replace(/\\)\\s*:\\s*[\\w<>[\\]|&\\s,]+(?=\\s*[=>]\\s*[{(])/g, ')');\r\n    normalized = normalized.replace(/\\)\\s*:\\s*[\\w<>[\\]|&\\s,]+(?=\\s*\\{)/g, ')');\r\n\r\n    // Remove parameter type annotations ONLY in function/arrow function signatures\r\n    // Pattern: matches function declarations and arrow functions, NOT JSX or return statements\r\n    // Match: const name = (param: Type) => or function name(param: Type)\r\n    // Use lookbehind to ensure we're in a function context\r\n\r\n    // Arrow function parameters: = (params) =>\r\n    normalized = normalized.replace(/=\\s*\\(([^)]*)\\)\\s*=>/g, (match, params: string) => {\r\n        if (!params.includes(':')) return match;\r\n        // Skip if it looks like JSX (contains quotes or HTML-like content)\r\n        if (params.includes('\"') || params.includes(\"'\") || params.includes('<')) return match;\r\n        const cleanedParams = cleanFunctionParams(params);\r\n        return `= (${cleanedParams}) =>`;\r\n    });\r\n\r\n    // Regular function parameters: function name(params) or name(params) {\r\n    normalized = normalized.replace(/function\\s+\\w+\\s*\\(([^)]*)\\)/g, (match, params: string) => {\r\n        if (!params.includes(':')) return match;\r\n        if (params.includes('\"') || params.includes(\"'\") || params.includes('<')) return match;\r\n        const funcNameMatch = match.match(/function\\s+(\\w+)/);\r\n        const funcName = funcNameMatch ? funcNameMatch[1] : '';\r\n        const cleanedParams = cleanFunctionParams(params);\r\n        return `function ${funcName}(${cleanedParams})`;\r\n    });\r\n\r\n    // Callback parameters in hooks: useCallback((param: Type) =>\r\n    normalized = normalized.replace(/(useCallback|useMemo|useEffect)\\s*\\(\\s*\\(([^)]*)\\)\\s*=>/g, (match, hookName: string, params: string) => {\r\n        if (!params.includes(':')) return match;\r\n        if (params.includes('\"') || params.includes(\"'\") || params.includes('<')) return match;\r\n        const cleanedParams = cleanFunctionParams(params);\r\n        return `${hookName}((${cleanedParams}) =>`;\r\n    });\r\n\r\n    // Remove 'as Type' assertions\r\n    normalized = normalized.replace(/\\s+as\\s+[\\w<>[\\]|&]+/g, '');\r\n\r\n    // Remove 'satisfies Type' expressions\r\n    normalized = normalized.replace(/\\s+satisfies\\s+[\\w<>[\\]|&]+/g, '');\r\n\r\n    // Remove type annotations on const/let/var: const x: Type = \r\n    normalized = normalized.replace(/(const|let|var)\\s+(\\w+)\\s*:\\s*[\\w<>[\\]|&\\s,]+\\s*=/g, '$1 $2 =');\r\n\r\n    // Remove useState type parameters: useState<Type>() => useState()\r\n    normalized = normalized.replace(/useState<[^>]+>/g, 'useState');\r\n    normalized = normalized.replace(/useRef<[^>]+>/g, 'useRef');\r\n    normalized = normalized.replace(/useCallback<[^>]+>/g, 'useCallback');\r\n    normalized = normalized.replace(/useMemo<[^>]+>/g, 'useMemo');\r\n\r\n    // Remove consecutive empty lines\r\n    normalized = normalized.replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n');\r\n\r\n    return normalized.trim();\r\n}\r\n\r\n/**\r\n * Compile TSX code to executable JavaScript using backend SWC compiler.\r\n * Falls back to Sucrase in browser-only mode.\r\n */\r\nasync function compileCode(code: string): Promise<{ compiledCode: string; error: string | null }> {\r\n    try {\r\n        // Normalize code first to strip imports and complex types\r\n        const normalizedCode = normalizeCode(code);\r\n\r\n        // Use compilerService (Tauri SWC backend or Sucrase fallback)\r\n        const result = await compileTsx(normalizedCode);\r\n\r\n        if (!result.success || !result.code) {\r\n            return { compiledCode: '', error: result.error || 'Compilation failed' };\r\n        }\r\n\r\n        return { compiledCode: result.code, error: null };\r\n    } catch (err) {\r\n        const errorMessage = err instanceof Error ? err.message : 'Unknown compilation error';\r\n        return { compiledCode: '', error: `Compilation Error: ${errorMessage}` };\r\n    }\r\n}\r\n\r\n/**\r\n * Create a React component from compiled code string.\r\n */\r\nfunction createComponent(\r\n    compiledCode: string,\r\n    componentName: string,\r\n    scope: Record<string, any> = {}\r\n): { Component: React.ComponentType | null; error: string | null } {\r\n    try {\r\n        // Merge default React scope with provided scope\r\n        // CRITICAL FIX: Filter out keys that are not valid JS identifiers (e.g., 'theme-customization')\r\n        // failing to do so causes 'new Function' to throw SyntaxErrors.\r\n        const finalScope = { React, ...scope };\r\n        const validScopeEntries = Object.entries(finalScope).filter(([key]) => /^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(key));\r\n\r\n        const scopeKeys = validScopeEntries.map(([key]) => key);\r\n        const scopeValues = validScopeEntries.map(([, value]) => value);\r\n\r\n        // Create a function that returns the component\r\n        // We provide React and all scope items as dependencies\r\n        const createFn = new Function(\r\n            ...scopeKeys,\r\n            `\r\n      ${compiledCode}\r\n      return ${componentName};\r\n      `\r\n        );\r\n\r\n        const Component = createFn(...scopeValues);\r\n\r\n        if (typeof Component !== 'function') {\r\n            return { Component: null, error: `${componentName} is not a valid React component` };\r\n        }\r\n\r\n        return { Component, error: null };\r\n    } catch (err) {\r\n        const errorMessage = err instanceof Error ? err.message : 'Unknown runtime error';\r\n        return { Component: null, error: `Runtime Error: ${errorMessage}` };\r\n    }\r\n}\r\n\r\n// =============================================================================\r\n// ERROR BOUNDARY\r\n// =============================================================================\r\n\r\ninterface ErrorBoundaryProps {\r\n    children: React.ReactNode;\r\n    fallback?: React.ReactNode;\r\n    renderFallback?: (error: Error) => React.ReactNode;\r\n    onError?: (error: Error, errorInfo: React.ErrorInfo) => void;\r\n}\r\n\r\ninterface ErrorBoundaryState {\r\n    hasError: boolean;\r\n    error: Error | null;\r\n}\r\n\r\nclass PreviewErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\r\n    constructor(props: ErrorBoundaryProps) {\r\n        super(props);\r\n        this.state = { hasError: false, error: null };\r\n    }\r\n\r\n    static getDerivedStateFromError(error: Error): ErrorBoundaryState {\r\n        return { hasError: true, error };\r\n    }\r\n\r\n    componentDidCatch(error: Error, errorInfo: React.ErrorInfo): void {\r\n        this.props.onError?.(error, errorInfo);\r\n    }\r\n\r\n    render(): React.ReactNode {\r\n        if (this.state.hasError && this.state.error) {\r\n            if (this.props.renderFallback) {\r\n                return this.props.renderFallback(this.state.error);\r\n            }\r\n            return this.props.fallback || null;\r\n        }\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\n// =============================================================================\r\n// MAIN COMPONENT\r\n// =============================================================================\r\n\r\n/**\r\n * LiveComponentPreview component.\r\n *\r\n * Dynamically compiles and renders React components from TSX code strings.\r\n * Includes error boundary for graceful failure handling.\r\n */\r\nexport const LiveComponentPreview: React.FC<LiveComponentPreviewProps> = ({\r\n    code,\r\n    framework,\r\n    className = '',\r\n    scope = {},\r\n    props = {},\r\n}) => {\r\n    const [state, setState] = useState<PreviewState>({\r\n        Component: null,\r\n        error: null,\r\n        isCompiling: false,\r\n    });\r\n\r\n    // Track mounted state to avoid state updates after unmount\r\n    const isMountedRef = useRef(true);\r\n\r\n    useEffect(() => {\r\n        isMountedRef.current = true;\r\n        return () => { isMountedRef.current = false; };\r\n    }, []);\r\n\r\n    // Compile and create component when code changes\r\n    useEffect(() => {\r\n        if (!code || typeof code !== 'string' || !code.trim()) {\r\n            setState({ Component: null, error: 'No code provided', isCompiling: false });\r\n            return;\r\n        }\r\n\r\n        // Only support React for now\r\n        if (framework !== 'react') {\r\n            setState({\r\n                Component: null,\r\n                error: `Live preview is not yet available for ${framework}. Only React is currently supported.`,\r\n                isCompiling: false,\r\n            });\r\n            return;\r\n        }\r\n\r\n        setState(prev => ({ ...prev, isCompiling: true }));\r\n        console.log('[LiveComponentPreview] Starting compilation for:', code.slice(0, 50) + '...');\r\n\r\n        // Async compilation function\r\n        const compileAsync = async () => {\r\n            // Extract component name\r\n            const componentName = extractComponentName(code);\r\n            if (!componentName) {\r\n                if (isMountedRef.current) {\r\n                    setState({\r\n                        Component: null,\r\n                        error: 'Could not find a React component in the generated code.',\r\n                        isCompiling: false,\r\n                    });\r\n                }\r\n                return;\r\n            }\r\n\r\n            // Compile code using backend SWC compiler\r\n            const { compiledCode, error: compileError } = await compileCode(code);\r\n            console.log('[LiveComponentPreview] Compiled Code:', compiledCode);\r\n            console.log('[LiveComponentPreview] Compilation result:', { success: !compileError, error: compileError, codeLength: compiledCode?.length });\r\n\r\n            if (!isMountedRef.current) return;\r\n\r\n            if (compileError) {\r\n                console.error('[LiveComponentPreview] Compilation failed:', compileError);\r\n                setState({ Component: null, error: compileError, isCompiling: false });\r\n                return;\r\n            }\r\n\r\n            // Create component\r\n            const { Component, error: createError } = createComponent(compiledCode, componentName, framework === 'react' ? { ...scope } : {});\r\n\r\n            if (!isMountedRef.current) return;\r\n\r\n            if (createError) {\r\n                setState({ Component: null, error: createError, isCompiling: false });\r\n                return;\r\n            }\r\n\r\n            setState({ Component, error: null, isCompiling: false });\r\n        };\r\n\r\n        compileAsync();\r\n    }, [code, framework, scope]);\r\n\r\n\r\n\r\n    // Container styles - sizes to content, parent handles centering\r\n    // CENTERING STRATEGY CITATIONS:\r\n    // 1. Apple HIG: Focus on content, use consistent alignment.\r\n    // 2. CSS Flexbox: 'justify-center items-center' provides robust centering for flexible content.\r\n    //    Ref: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Aligning_Items_in_a_Flex_Container\r\n    // 3. W3C: 'align-items: center' and 'justify-content: center' are the standard for 2D centering.\r\n    const containerStyles = [\r\n        'relative',\r\n        'flex',\r\n        'items-center',\r\n        'justify-center',\r\n        'h-full',\r\n        'w-full',\r\n        'overflow-auto', // Ensure content accessible if it exceeds bounds\r\n        className,\r\n    ].filter(Boolean).join(' ');\r\n\r\n    // Loading state\r\n    if (state.isCompiling) {\r\n        return (\r\n            <div className={containerStyles}>\r\n                <div className=\"flex items-center gap-2 text-neutral-500\">\r\n                    <svg className=\"animate-spin h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\r\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\r\n                    </svg>\r\n                    <span>Compiling preview...</span>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Error state\r\n    if (state.error) {\r\n        return (\r\n            <div className={containerStyles}>\r\n                <div className=\"p-4 bg-error-50 text-error-700 rounded-lg max-w-md\">\r\n                    <p className=\"font-medium mb-1\">Preview Error</p>\r\n                    <p className=\"text-sm font-mono whitespace-pre-wrap\">{state.error}</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // No component state\r\n    if (!state.Component) {\r\n        return (\r\n            <div className={containerStyles}>\r\n                <p className=\"text-neutral-400 text-sm\">No component to preview</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Render component\r\n    const { Component } = state;\r\n\r\n    return (\r\n        <div className={containerStyles}>\r\n            <PreviewErrorBoundary\r\n                renderFallback={(err) => (\r\n                    <div className=\"p-4 bg-error-50 border border-error-200 rounded-lg text-center max-w-md mx-auto\">\r\n                        <p className=\"text-error-700 font-medium\">Runtime Error</p>\r\n                        <p className=\"text-error-600 text-sm mt-1 font-mono text-left whitespace-pre-wrap\">\r\n                            {err.message}\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            >\r\n                <Component {...props} />\r\n            </PreviewErrorBoundary>\r\n        </div>\r\n    );\r\n};\r\n\r\nLiveComponentPreview.displayName = 'LiveComponentPreview';\r\n\r\nexport default LiveComponentPreview;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\RegisterContractWizard.tsx","messages":[{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":435,"column":17,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":435,"endColumn":60},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'steps' array makes the dependencies of useCallback Hook (at line 622) change on every render. To fix this, wrap the initialization of 'steps' in its own useMemo() Hook.","line":497,"column":9,"nodeType":"VariableDeclarator","endLine":502,"endColumn":4},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'steps' array makes the dependencies of useCallback Hook (at line 630) change on every render. To fix this, wrap the initialization of 'steps' in its own useMemo() Hook.","line":497,"column":9,"nodeType":"VariableDeclarator","endLine":502,"endColumn":4},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":610,"column":15,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":610,"endColumn":55},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":611,"column":44,"nodeType":"Property","messageId":"anyAssignment","endLine":611,"endColumn":50},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":696,"column":55,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., &quot;debug_\" for debugging plugins).\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., &ldquo;debug_\" for debugging plugins).\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., &#34;debug_\" for debugging plugins).\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., &rdquo;debug_\" for debugging plugins).\n            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":696,"column":62,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., \"debug_&quot; for debugging plugins).\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., \"debug_&ldquo; for debugging plugins).\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., \"debug_&#34; for debugging plugins).\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20892,21084],"text":"\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., \"debug_&rdquo; for debugging plugins).\n            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":889,"column":25,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":889,"endColumn":41}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D093 - src/components/ai/RegisterContractWizard.tsx\n * ====================================================\n * Wizard for registering new contract types (plugin categories).\n *\n * This component allows users to create NEW plugin categories by defining:\n * - A unique prefix (e.g., \"debug_\", \"mcp_\")\n * - Required contract methods\n * - Smoke test configuration\n *\n * Unlike ContractWizard (D072) which creates contracts FROM existing categories,\n * this wizard creates NEW categories that are added to config/contract_prefixes.yaml.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D010, D011, D012, D014, D015, D072, D078\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport React, { useState, useCallback, useMemo } from \"react\";\nimport { Button } from \"../ui/Button\";\nimport { Input } from \"../ui/Input\";\nimport { Select, type SelectOption } from \"../ui/Select\";\nimport { Panel } from \"../ui/Panel\";\nimport { type ContractMethod, type ContractParameter } from \"./ContractWizard\";\n\n/**\n * Smoke test configuration for the contract.\n */\nexport interface SmokeTestConfig {\n  /** Method to call for smoke test */\n  method: string;\n  /** Parameters to pass */\n  params: Record<string, unknown>;\n  /** Expected result pattern or type */\n  expected: string;\n}\n\n/**\n * New contract type definition.\n */\nexport interface NewContractType {\n  /** Prefix for plugins of this type (e.g., \"debug\") */\n  prefix: string;\n  /** Full contract name (e.g., \"DebugContract\") */\n  contractName: string;\n  /** Description of this contract type */\n  description: string;\n  /** Required methods for this contract */\n  requiredMethods: ContractMethod[];\n  /** Optional smoke test configuration */\n  smokeTest?: SmokeTestConfig;\n  /** Example plugins for this category */\n  examples?: string[];\n}\n\n/**\n * Generated YAML preview for the new contract type.\n */\nexport interface ContractYamlPreview {\n  /** YAML content for contract_prefixes.yaml */\n  prefixYaml: string;\n  /** Python contract class code */\n  contractCode: string;\n}\n\n/**\n * Props for RegisterContractWizard component.\n */\nexport interface RegisterContractWizardProps {\n  /** Callback when a new contract type is registered */\n  onRegister: (contractType: NewContractType) => Promise<void>;\n  /** Existing prefixes to prevent duplicates */\n  existingPrefixes?: string[];\n  /** Callback when wizard is closed */\n  onClose?: () => void;\n  /** Whether registration is in progress */\n  isRegistering?: boolean;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * Wizard steps.\n */\ntype WizardStep = \"prefix\" | \"methods\" | \"smokeTest\" | \"preview\";\n\n/**\n * Available Python types for method parameters.\n */\nconst pythonTypes: SelectOption[] = [\n  { value: \"str\", label: \"str (String)\" },\n  { value: \"int\", label: \"int (Integer)\" },\n  { value: \"float\", label: \"float (Decimal)\" },\n  { value: \"bool\", label: \"bool (Boolean)\" },\n  { value: \"bytes\", label: \"bytes (Binary)\" },\n  { value: \"list[str]\", label: \"list[str] (String List)\" },\n  { value: \"list[int]\", label: \"list[int] (Integer List)\" },\n  { value: \"dict[str, Any]\", label: \"dict[str, Any] (Dictionary)\" },\n  { value: \"Optional[str]\", label: \"Optional[str]\" },\n  { value: \"Any\", label: \"Any\" },\n];\n\n/**\n * Plus icon.\n */\nconst PlusIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Arrow right icon.\n */\nconst ArrowRightIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n    <polyline points=\"12 5 19 12 12 19\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Step indicator component.\n */\nconst StepIndicator: React.FC<{\n  steps: { key: WizardStep; label: string }[];\n  currentStep: WizardStep;\n}> = ({ steps, currentStep }) => {\n  const currentIndex = steps.findIndex((s) => s.key === currentStep);\n\n  return (\n    <div className=\"flex items-center justify-center gap-2 mb-6\">\n      {steps.map((step, index) => {\n        const isComplete = index < currentIndex;\n        const isCurrent = index === currentIndex;\n\n        return (\n          <React.Fragment key={step.key}>\n            <div className=\"flex items-center gap-2\">\n              <div\n                className={[\n                  \"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors\",\n                  isComplete && \"bg-success-500 text-white\",\n                  isCurrent && \"bg-primary-500 text-white\",\n                  !isComplete && !isCurrent && \"bg-neutral-200 text-neutral-500\",\n                ].filter(Boolean).join(\" \")}\n              >\n                {isComplete ? <CheckIcon /> : index + 1}\n              </div>\n              <span\n                className={[\n                  \"text-sm hidden sm:inline\",\n                  isCurrent && \"font-medium text-neutral-900\",\n                  !isCurrent && \"text-neutral-500\",\n                ].filter(Boolean).join(\" \")}\n              >\n                {step.label}\n              </span>\n            </div>\n            {index < steps.length - 1 && (\n              <div\n                className={[\n                  \"w-8 h-0.5\",\n                  isComplete ? \"bg-success-500\" : \"bg-neutral-200\",\n                ].join(\" \")}\n              />\n            )}\n          </React.Fragment>\n        );\n      })}\n    </div>\n  );\n};\n\n/**\n * Method editor for defining contract methods.\n */\nconst MethodEditor: React.FC<{\n  method: ContractMethod;\n  onChange: (method: ContractMethod) => void;\n  onRemove: () => void;\n}> = ({ method, onChange, onRemove }) => {\n  const addParameter = () => {\n    onChange({\n      ...method,\n      parameters: [\n        ...method.parameters,\n        {\n          name: \"\",\n          type: \"str\",\n          description: \"\",\n          required: true,\n        },\n      ],\n    });\n  };\n\n  const updateParameter = (index: number, param: ContractParameter) => {\n    const newParams = [...method.parameters];\n    newParams[index] = param;\n    onChange({ ...method, parameters: newParams });\n  };\n\n  const removeParameter = (index: number) => {\n    onChange({\n      ...method,\n      parameters: method.parameters.filter((_, i) => i !== index),\n    });\n  };\n\n  return (\n    <div className=\"border border-neutral-200 rounded-lg p-4 space-y-4\">\n      <div className=\"flex items-start justify-between\">\n        <h4 className=\"text-sm font-semibold text-neutral-900\">Method</h4>\n        <Button\n          variant=\"ghost\"\n          size=\"xs\"\n          onClick={onRemove}\n          leftIcon={<TrashIcon />}\n          className=\"text-error-600 hover:text-error-700\"\n        >\n          Remove\n        </Button>\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-4\">\n        <Input\n          label=\"Method Name\"\n          value={method.name}\n          onChange={(e) => onChange({ ...method, name: e.target.value })}\n          placeholder=\"process\"\n          fullWidth\n        />\n        <Select\n          label=\"Return Type\"\n          options={pythonTypes}\n          value={method.returnType}\n          onChange={(e) => onChange({ ...method, returnType: e.target.value })}\n          fullWidth\n        />\n      </div>\n\n      <Input\n        label=\"Description\"\n        value={method.description}\n        onChange={(e) => onChange({ ...method, description: e.target.value })}\n        placeholder=\"Describe what this method does\"\n        fullWidth\n      />\n\n      <div className=\"flex items-center gap-4\">\n        <label className=\"flex items-center gap-2 text-sm text-neutral-700 cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            checked={method.isAsync}\n            onChange={(e) => onChange({ ...method, isAsync: e.target.checked })}\n            className=\"w-4 h-4 text-primary-600 border-neutral-300 rounded focus:ring-primary-500\"\n          />\n          Async method\n        </label>\n      </div>\n\n      {/* Parameters */}\n      <div className=\"space-y-3\">\n        <div className=\"flex items-center justify-between\">\n          <h5 className=\"text-xs font-medium text-neutral-600 uppercase tracking-wide\">\n            Parameters\n          </h5>\n          <Button\n            variant=\"ghost\"\n            size=\"xs\"\n            onClick={addParameter}\n            leftIcon={<PlusIcon />}\n          >\n            Add Parameter\n          </Button>\n        </div>\n\n        {method.parameters.length === 0 ? (\n          <p className=\"text-sm text-neutral-400 italic\">No parameters defined</p>\n        ) : (\n          <div className=\"space-y-2\">\n            {method.parameters.map((param, index) => (\n              <div\n                key={index}\n                className=\"grid grid-cols-12 gap-2 items-end bg-neutral-50 p-2 rounded-lg\"\n              >\n                <div className=\"col-span-3\">\n                  <Input\n                    label={index === 0 ? \"Name\" : undefined}\n                    value={param.name}\n                    onChange={(e) =>\n                      updateParameter(index, { ...param, name: e.target.value })\n                    }\n                    placeholder=\"arg\"\n                    size=\"sm\"\n                    fullWidth\n                  />\n                </div>\n                <div className=\"col-span-3\">\n                  <Select\n                    label={index === 0 ? \"Type\" : undefined}\n                    options={pythonTypes}\n                    value={param.type}\n                    onChange={(e) =>\n                      updateParameter(index, { ...param, type: e.target.value })\n                    }\n                    size=\"sm\"\n                    fullWidth\n                  />\n                </div>\n                <div className=\"col-span-4\">\n                  <Input\n                    label={index === 0 ? \"Description\" : undefined}\n                    value={param.description}\n                    onChange={(e) =>\n                      updateParameter(index, { ...param, description: e.target.value })\n                    }\n                    placeholder=\"Description\"\n                    size=\"sm\"\n                    fullWidth\n                  />\n                </div>\n                <div className=\"col-span-1 flex items-center justify-center\">\n                  <label className=\"flex items-center gap-1 text-xs text-neutral-600 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={param.required}\n                      onChange={(e) =>\n                        updateParameter(index, { ...param, required: e.target.checked })\n                      }\n                      className=\"w-3 h-3 text-primary-600 border-neutral-300 rounded\"\n                    />\n                    Req\n                  </label>\n                </div>\n                <div className=\"col-span-1\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"xs\"\n                    iconOnly\n                    onClick={() => removeParameter(index)}\n                    aria-label=\"Remove parameter\"\n                    className=\"text-error-500 hover:text-error-600\"\n                  >\n                    <TrashIcon />\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\n/**\n * Code preview component.\n */\nconst CodePreview: React.FC<{\n  code: string;\n  title: string;\n  language?: string;\n}> = ({ code, title }) => (\n  <div className=\"bg-neutral-900 rounded-lg overflow-hidden\">\n    <div className=\"px-4 py-2 bg-neutral-800 border-b border-neutral-700 flex items-center justify-between\">\n      <span className=\"text-xs text-neutral-400 uppercase tracking-wide\">{title}</span>\n      <Button\n        variant=\"ghost\"\n        size=\"xs\"\n        onClick={() => navigator.clipboard.writeText(code)}\n        className=\"text-neutral-400 hover:text-neutral-200\"\n      >\n        Copy\n      </Button>\n    </div>\n    <pre className=\"p-4 overflow-x-auto text-sm font-mono text-neutral-100 whitespace-pre max-h-64\">\n      <code>{code}</code>\n    </pre>\n  </div>\n);\n\n/**\n * RegisterContractWizard component.\n *\n * A multi-step wizard for registering new contract types (plugin categories).\n * This creates new entries in config/contract_prefixes.yaml and generates\n * the corresponding Python contract class.\n *\n * @example\n * ```tsx\n * <RegisterContractWizard\n *   onRegister={async (contractType) => {\n *     await ipc.call('contract/register', contractType);\n *   }}\n *   existingPrefixes={['tts', 'stt', 'llm']}\n *   onClose={() => setShowWizard(false)}\n * />\n * ```\n */\nexport const RegisterContractWizard: React.FC<RegisterContractWizardProps> = ({\n  onRegister,\n  existingPrefixes = [],\n  onClose,\n  isRegistering = false,\n  className = \"\",\n}) => {\n  // Wizard state\n  const [currentStep, setCurrentStep] = useState<WizardStep>(\"prefix\");\n  const [error, setError] = useState<string | null>(null);\n\n  // Form state\n  const [prefix, setPrefix] = useState(\"\");\n  const [contractName, setContractName] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [methods, setMethods] = useState<ContractMethod[]>([\n    {\n      name: \"\",\n      description: \"\",\n      parameters: [],\n      returnType: \"str\",\n      isAsync: false,\n    },\n  ]);\n  const [smokeTest, setSmokeTest] = useState<SmokeTestConfig>({\n    method: \"\",\n    params: {},\n    expected: \"\",\n  });\n  const [smokeTestParamsJson, setSmokeTestParamsJson] = useState(\"{}\");\n\n  // Wizard steps configuration\n  const steps: { key: WizardStep; label: string }[] = [\n    { key: \"prefix\", label: \"Prefix & Name\" },\n    { key: \"methods\", label: \"Methods\" },\n    { key: \"smokeTest\", label: \"Smoke Test\" },\n    { key: \"preview\", label: \"Preview\" },\n  ];\n\n  // Derived contract name from prefix\n  const derivedContractName = useMemo(() => {\n    if (contractName) return contractName;\n    if (!prefix) return \"\";\n    // Convert prefix to PascalCase + \"Contract\"\n    return prefix.charAt(0).toUpperCase() + prefix.slice(1) + \"Contract\";\n  }, [prefix, contractName]);\n\n  // Generate YAML preview\n  const yamlPreview = useMemo(() => {\n    const validMethods = methods.filter((m) => m.name.trim());\n    const smokeMethod = smokeTest.method || (validMethods[0]?.name || \"health_check\");\n\n    return `  ${prefix}:\n    contract: ${prefix}_contract\n    description: \"${description || `${derivedContractName} plugins`}\"\n    examples:\n      - ${prefix}_example_plugin\n    smoke_test:\n      method: ${smokeMethod}\n      params: ${JSON.stringify(smokeTest.params)}\n      expected: \"${smokeTest.expected || 'not null'}\"`;\n  }, [prefix, description, derivedContractName, methods, smokeTest]);\n\n  // Generate Python contract code\n  const pythonCode = useMemo(() => {\n    const validMethods = methods.filter((m) => m.name.trim());\n    const methodDefs = validMethods.map((m) => {\n      const params = m.parameters\n        .map((p) => `${p.name}: ${p.type}${p.required ? \"\" : \" = None\"}`)\n        .join(\", \");\n      const asyncPrefix = m.isAsync ? \"async \" : \"\";\n      return `    @abstractmethod\n    ${asyncPrefix}def ${m.name}(self${params ? \", \" + params : \"\"}) -> ${m.returnType}:\n        \"\"\"${m.description || m.name}\"\"\"\n        pass`;\n    }).join(\"\\n\\n\");\n\n    return `\"\"\"\ncontracts/${prefix}_contract.py\n==============================\n${description || `Contract for ${prefix} plugins.`}\n\nArchitecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\nProtocol: JSON-RPC 2.0 over stdin/stdout\n\"\"\"\n\nfrom abc import abstractmethod\nfrom typing import Any, Optional\nfrom contracts.base import PluginBase\n\n\nclass ${derivedContractName}(PluginBase):\n    \"\"\"\n    ${description || `Contract interface for ${prefix} plugins.`}\n\n    All ${prefix}_ prefixed plugins must implement this contract.\n    \"\"\"\n\n${methodDefs}\n`;\n  }, [prefix, derivedContractName, description, methods]);\n\n  // Validation\n  const validatePrefix = useCallback(() => {\n    if (!prefix.trim()) {\n      setError(\"Prefix is required\");\n      return false;\n    }\n    if (!/^[a-z][a-z0-9_]*$/.test(prefix)) {\n      setError(\"Prefix must start with a letter and contain only lowercase letters, numbers, and underscores\");\n      return false;\n    }\n    if (existingPrefixes.includes(prefix)) {\n      setError(`Prefix \"${prefix}\" already exists`);\n      return false;\n    }\n    setError(null);\n    return true;\n  }, [prefix, existingPrefixes]);\n\n  const validateMethods = useCallback(() => {\n    const validMethods = methods.filter((m) => m.name.trim());\n    if (validMethods.length === 0) {\n      setError(\"At least one method is required\");\n      return false;\n    }\n    for (const method of validMethods) {\n      if (!/^[a-z_][a-z0-9_]*$/.test(method.name)) {\n        setError(`Invalid method name: ${method.name}`);\n        return false;\n      }\n    }\n    setError(null);\n    return true;\n  }, [methods]);\n\n  // Navigation\n  const goNext = useCallback(() => {\n    const stepIndex = steps.findIndex((s) => s.key === currentStep);\n    if (currentStep === \"prefix\" && !validatePrefix()) return;\n    if (currentStep === \"methods\" && !validateMethods()) return;\n\n    if (currentStep === \"smokeTest\") {\n      // Parse smoke test params\n      try {\n        const params = JSON.parse(smokeTestParamsJson);\n        setSmokeTest((prev) => ({ ...prev, params }));\n      } catch {\n        setError(\"Invalid JSON for smoke test parameters\");\n        return;\n      }\n    }\n\n    if (stepIndex < steps.length - 1) {\n      setCurrentStep(steps[stepIndex + 1].key);\n      setError(null);\n    }\n  }, [currentStep, steps, validatePrefix, validateMethods, smokeTestParamsJson]);\n\n  const goBack = useCallback(() => {\n    const stepIndex = steps.findIndex((s) => s.key === currentStep);\n    if (stepIndex > 0) {\n      setCurrentStep(steps[stepIndex - 1].key);\n      setError(null);\n    }\n  }, [currentStep, steps]);\n\n  // Method management\n  const addMethod = useCallback(() => {\n    setMethods((prev) => [\n      ...prev,\n      {\n        name: \"\",\n        description: \"\",\n        parameters: [],\n        returnType: \"str\",\n        isAsync: false,\n      },\n    ]);\n  }, []);\n\n  const updateMethod = useCallback((index: number, method: ContractMethod) => {\n    setMethods((prev) => {\n      const newMethods = [...prev];\n      newMethods[index] = method;\n      return newMethods;\n    });\n  }, []);\n\n  const removeMethod = useCallback((index: number) => {\n    setMethods((prev) => prev.filter((_, i) => i !== index));\n  }, []);\n\n  // Submit\n  const handleRegister = useCallback(async () => {\n    const validMethods = methods.filter((m) => m.name.trim());\n\n    const contractType: NewContractType = {\n      prefix,\n      contractName: derivedContractName,\n      description,\n      requiredMethods: validMethods,\n      smokeTest: smokeTest.method ? smokeTest : undefined,\n    };\n\n    try {\n      await onRegister(contractType);\n      onClose?.();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Registration failed\");\n    }\n  }, [prefix, derivedContractName, description, methods, smokeTest, onRegister, onClose]);\n\n  const containerStyles = [\"space-y-6\", className].filter(Boolean).join(\" \");\n\n  return (\n    <div className={containerStyles}>\n      <Panel\n        variant=\"default\"\n        padding=\"lg\"\n        radius=\"lg\"\n        header=\"Register New Contract Type\"\n        showHeaderDivider\n      >\n        <StepIndicator steps={steps} currentStep={currentStep} />\n\n        {/* Step 1: Prefix & Name */}\n        {currentStep === \"prefix\" && (\n          <div className=\"space-y-6\">\n            <div className=\"text-sm text-neutral-600 mb-4\">\n              Define a unique prefix for your new plugin category. This prefix will be used\n              to identify plugins of this type (e.g., \"debug_\" for debugging plugins).\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Input\n                label=\"Prefix\"\n                value={prefix}\n                onChange={(e) => setPrefix(e.target.value.toLowerCase())}\n                placeholder=\"debug\"\n                helperText=\"Lowercase, no spaces (e.g., debug, mcp, audio)\"\n                fullWidth\n                isRequired\n              />\n              <Input\n                label=\"Contract Name\"\n                value={contractName}\n                onChange={(e) => setContractName(e.target.value)}\n                placeholder={derivedContractName || \"DebugContract\"}\n                helperText=\"PascalCase (auto-generated if empty)\"\n                fullWidth\n              />\n            </div>\n\n            <Input\n              label=\"Description\"\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              placeholder=\"Describe what plugins of this type do\"\n              helperText=\"Brief description for documentation\"\n              fullWidth\n            />\n\n            {prefix && (\n              <div className=\"p-3 bg-neutral-50 rounded-lg text-sm\">\n                <p className=\"font-medium text-neutral-700 mb-1\">Preview:</p>\n                <p className=\"text-neutral-600\">\n                  Plugins will be named: <code className=\"bg-neutral-200 px-1 rounded\">{prefix}_*</code>\n                </p>\n                <p className=\"text-neutral-600\">\n                  Contract file: <code className=\"bg-neutral-200 px-1 rounded\">contracts/{prefix}_contract.py</code>\n                </p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Step 2: Methods */}\n        {currentStep === \"methods\" && (\n          <div className=\"space-y-4\">\n            <div className=\"text-sm text-neutral-600 mb-4\">\n              Define the required methods that plugins implementing this contract must provide.\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"text-sm font-semibold text-neutral-900\">\n                Contract Methods\n              </h3>\n              <Button\n                variant=\"secondary\"\n                size=\"sm\"\n                onClick={addMethod}\n                leftIcon={<PlusIcon />}\n              >\n                Add Method\n              </Button>\n            </div>\n\n            <div className=\"space-y-4\">\n              {methods.map((method, index) => (\n                <MethodEditor\n                  key={index}\n                  method={method}\n                  onChange={(m) => updateMethod(index, m)}\n                  onRemove={() => removeMethod(index)}\n                />\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Step 3: Smoke Test */}\n        {currentStep === \"smokeTest\" && (\n          <div className=\"space-y-6\">\n            <div className=\"text-sm text-neutral-600 mb-4\">\n              Configure a smoke test that will be run to verify plugins of this type are working correctly.\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Select\n                label=\"Test Method\"\n                options={[\n                  { value: \"\", label: \"Select a method...\" },\n                  ...methods\n                    .filter((m) => m.name.trim())\n                    .map((m) => ({ value: m.name, label: m.name })),\n                ]}\n                value={smokeTest.method}\n                onChange={(e) => setSmokeTest((prev) => ({ ...prev, method: e.target.value }))}\n                fullWidth\n              />\n              <Input\n                label=\"Expected Result\"\n                value={smokeTest.expected}\n                onChange={(e) => setSmokeTest((prev) => ({ ...prev, expected: e.target.value }))}\n                placeholder=\"not null\"\n                helperText=\"Expected result pattern (e.g., 'not null', 'dict')\"\n                fullWidth\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                Test Parameters (JSON)\n              </label>\n              <textarea\n                value={smokeTestParamsJson}\n                onChange={(e) => setSmokeTestParamsJson(e.target.value)}\n                placeholder='{\"key\": \"value\"}'\n                className=\"w-full h-24 px-3 py-2 border border-neutral-300 rounded-lg font-mono text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\n              />\n              <p className=\"mt-1 text-xs text-neutral-500\">\n                Parameters to pass to the smoke test method\n              </p>\n            </div>\n          </div>\n        )}\n\n        {/* Step 4: Preview */}\n        {currentStep === \"preview\" && (\n          <div className=\"space-y-6\">\n            <div className=\"text-sm text-neutral-600 mb-4\">\n              Review the generated configuration and code before registering.\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n              <CodePreview\n                code={yamlPreview}\n                title=\"contract_prefixes.yaml entry\"\n                language=\"yaml\"\n              />\n              <CodePreview\n                code={pythonCode}\n                title=\"Contract Python Class\"\n                language=\"python\"\n              />\n            </div>\n\n            <div className=\"p-4 bg-warning-50 border border-warning-200 rounded-lg\">\n              <p className=\"text-sm text-warning-800\">\n                <strong>Note:</strong> Registering this contract type will:\n              </p>\n              <ul className=\"mt-2 text-sm text-warning-700 list-disc list-inside\">\n                <li>Add an entry to <code>config/contract_prefixes.yaml</code></li>\n                <li>Create <code>contracts/{prefix}_contract.py</code></li>\n                <li>Make the <code>{prefix}_</code> prefix available for new plugins</li>\n              </ul>\n            </div>\n          </div>\n        )}\n\n        {/* Error display */}\n        {error && (\n          <div className=\"p-3 bg-error-50 border border-error-200 rounded-lg text-sm text-error-700\">\n            {error}\n          </div>\n        )}\n\n        {/* Navigation buttons */}\n        <div className=\"flex justify-between pt-4 border-t border-neutral-200\">\n          <div>\n            {currentStep !== \"prefix\" && (\n              <Button variant=\"secondary\" onClick={goBack}>\n                Back\n              </Button>\n            )}\n          </div>\n          <div className=\"flex gap-3\">\n            {onClose && (\n              <Button variant=\"ghost\" onClick={onClose}>\n                Cancel\n              </Button>\n            )}\n            {currentStep !== \"preview\" ? (\n              <Button\n                variant=\"primary\"\n                onClick={goNext}\n                rightIcon={<ArrowRightIcon />}\n              >\n                Next\n              </Button>\n            ) : (\n              <Button\n                variant=\"primary\"\n                onClick={handleRegister}\n                loading={isRegistering}\n                leftIcon={<CheckIcon />}\n              >\n                Register Contract Type\n              </Button>\n            )}\n          </div>\n        </div>\n      </Panel>\n    </div>\n  );\n};\n\nRegisterContractWizard.displayName = \"RegisterContractWizard\";\n\nexport default RegisterContractWizard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\WorkflowProfileSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ai\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\external\\ExternalWrappers.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[327,330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[327,330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":10,"column":22,"nodeType":"LogicalExpression","messageId":"anyAssignment","endLine":10,"endColumn":50},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .variant on an `any` value.","line":10,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":10,"endColumn":35},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":10,"column":36,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":10,"endColumn":38,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[407,409],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":11,"column":20,"nodeType":"LogicalExpression","messageId":"anyAssignment","endLine":11,"endColumn":44},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .color on an `any` value.","line":11,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":11,"endColumn":31},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":11,"column":32,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":11,"endColumn":34,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[455,457],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .children on an `any` value.","line":15,"column":20,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":15,"endColumn":28},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":15,"column":29,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":15,"endColumn":31,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[604,633],"text":"(props.children ?? props.label)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .label on an `any` value.","line":15,"column":38,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":15,"endColumn":43},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":15,"column":44,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":15,"endColumn":46,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[634,636],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[957,960],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[957,960],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .title on an `any` value.","line":28,"column":86,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":28,"endColumn":91},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":28,"column":92,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":28,"endColumn":94,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[1350,1352],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":29,"column":91,"nodeType":"LogicalExpression","messageId":"anyAssignment","endLine":29,"endColumn":118},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .value on an `any` value.","line":29,"column":97,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":29,"endColumn":102},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":29,"column":103,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":29,"endColumn":105,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[1477,1479],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .value on an `any` value.","line":30,"column":32,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":30,"endColumn":37},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":30,"column":38,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":30,"endColumn":40,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[1533,1535],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `any` typed value.","line":33,"column":131,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":33,"endColumn":167},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .trend on an `any` value.","line":33,"column":138,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":33,"endColumn":143},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":33,"column":144,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":33,"endColumn":146,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[1745,1747],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .startsWith on an `any` value.","line":33,"column":157,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":33,"endColumn":167},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .trend on an `any` value.","line":37,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":37,"endColumn":33},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":37,"column":34,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":37,"endColumn":36,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[1936,1938],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .progress on an `any` value.","line":43,"column":43,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":43,"endColumn":51},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":43,"column":57,"nodeType":"MemberExpression","messageId":"invalidType","endLine":43,"endColumn":71},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .progress on an `any` value.","line":43,"column":63,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":43,"endColumn":71},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .footer on an `any` value.","line":46,"column":71,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":46,"endColumn":77},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":46,"column":78,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":46,"endColumn":80,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[2369,2371],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2697,2700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2697,2700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .name on an `any` value.","line":61,"column":64,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":61,"endColumn":68},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":61,"column":69,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":61,"endColumn":71,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3120,3122],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .version on an `any` value.","line":62,"column":60,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":62,"endColumn":67},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":62,"column":68,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":62,"endColumn":70,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3214,3216],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .description on an `any` value.","line":64,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":64,"endColumn":39},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":64,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":64,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3349,3351],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":37,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// React import not needed with JSX transform\r\nimport MuiButton from '@mui/material/Button';\r\n\r\n// =============================================================================\r\n// 1. MATERIAL UI ADAPTER\r\n// =============================================================================\r\nexport const MuiButtonAdapter = (props: any) => {\r\n    return (\r\n        <MuiButton\r\n            variant={props.variant || 'contained'}\r\n            color={props.color || 'primary'}\r\n            onClick={() => alert('MUI Button Clicked!')}\r\n            sx={{ width: '100%', height: '100%' }}\r\n        >\r\n            {props.children || props.label || 'MUI Button'}\r\n        </MuiButton>\r\n    );\r\n};\r\n\r\n// =============================================================================\r\n// 2. REACT COMPONENTS BLOCK ADAPTER (Simulating Block 1056)\r\n// =============================================================================\r\nexport const DashboardStatsBlock = (props: any) => {\r\n    return (\r\n        <div className=\"p-4 bg-white rounded-lg shadow-sm border border-gray-100 font-sans h-full flex flex-col justify-center overflow-hidden\">\r\n            <div className=\"flex justify-between items-start mb-2 w-full\">\r\n                <div className=\"min-w-0 flex-1 mr-2\">\r\n                    <p className=\"text-sm font-medium text-gray-500 truncate\">{props.title || 'Total Revenue'}</p>\r\n                    <h3 className=\"text-2xl font-bold text-gray-900 mt-1 truncate\" title={props.value || '$45,231.89'}>\r\n                        {props.value || '$45,231.89'}\r\n                    </h3>\r\n                </div>\r\n                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium h-6 whitespace-nowrap ${(props.trend || '+20.1%').startsWith('+')\r\n                    ? 'bg-green-100 text-green-800'\r\n                    : 'bg-red-100 text-red-800'\r\n                    }`}>\r\n                    {props.trend || '+20.1%'}\r\n                </span>\r\n            </div>\r\n            <div className=\"h-2 w-full bg-gray-100 rounded-full overflow-hidden mt-2 shrink-0\">\r\n                <div\r\n                    className=\"h-full bg-blue-500\"\r\n                    style={{ width: props.progress ? `${props.progress}%` : '70%' }}\r\n                />\r\n            </div>\r\n            <p className=\"text-xs text-gray-400 mt-2 truncate\">{props.footer || 'Compared to last month'}</p>\r\n        </div>\r\n    );\r\n};\r\n\r\n// =============================================================================\r\n// 3. GITHUB COMPONENT ADAPTER (Simulating @mui/monorepo)\r\n// =============================================================================\r\nexport const GitHubRepoPreview = (props: any) => {\r\n    return (\r\n        <div className=\"flex items-center gap-3 p-3 bg-slate-800 text-white rounded border border-slate-700 h-full w-full\">\r\n            <div className=\"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center font-bold shrink-0\">\r\n                GH\r\n            </div>\r\n            <div className=\"overflow-hidden\">\r\n                <div className=\"font-semibold truncate\">{props.name || '@mui/monorepo'}</div>\r\n                <div className=\"text-xs opacity-75\">{props.version || 'v7.3.6'}</div>\r\n                <div className=\"text-[10px] text-slate-400 mt-1 truncate\">\r\n                    {props.description || 'Material UI Monorepo'}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\BackendBlueprintPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":84,"column":18,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":84,"endColumn":42},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":178,"column":25,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":178,"endColumn":27,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[7000,7002],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\BackendBlueprintPanel.tsx:194:9\n  192 |       if (flow?.from === 'fe' && feComponents.length > 0) {\n  193 |         const randomIdx = Math.floor(Math.random() * feComponents.length);\n> 194 |         setActiveFeComponent(feComponents[randomIdx].id);\n      |         ^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  195 |       } else {\n  196 |         setActiveFeComponent(null);\n  197 |       }","line":194,"column":9,"nodeType":null,"endLine":194,"endColumn":29},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":239,"column":30,"nodeType":"MemberExpression","messageId":"invalidType","endLine":239,"endColumn":51},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":240,"column":54,"nodeType":"MemberExpression","messageId":"invalidType","endLine":240,"endColumn":69},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":442,"column":19,"nodeType":"Identifier","messageId":"invalidType","endLine":442,"endColumn":23},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":442,"column":33,"nodeType":"Identifier","messageId":"invalidType","endLine":442,"endColumn":35},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":444,"column":60,"nodeType":"Identifier","messageId":"invalidType","endLine":444,"endColumn":64},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":444,"column":74,"nodeType":"Identifier","messageId":"invalidType","endLine":444,"endColumn":76},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":449,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":449,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20489,20492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20489,20492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":450,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":450,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20521,20524],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20521,20524],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":451,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":451,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20630,20633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20630,20633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":452,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":452,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20729,20732],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20729,20732],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":461,"column":21,"nodeType":"MemberExpression","messageId":"invalidType","endLine":461,"endColumn":36},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access [color] on an `any` value.","line":461,"column":30,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":461,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Computed name [color] resolves to an `any` value.","line":461,"column":30,"nodeType":"Identifier","messageId":"unsafeComputedMemberAccess","endLine":461,"endColumn":35},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":461,"column":40,"nodeType":"MemberExpression","messageId":"invalidType","endLine":461,"endColumn":59},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access [color] on an `any` value.","line":461,"column":53,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":461,"endColumn":58},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Computed name [color] resolves to an `any` value.","line":461,"column":53,"nodeType":"Identifier","messageId":"unsafeComputedMemberAccess","endLine":461,"endColumn":58},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":461,"column":63,"nodeType":"MemberExpression","messageId":"invalidType","endLine":461,"endColumn":83},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access [color] on an `any` value.","line":461,"column":77,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":461,"endColumn":82},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Computed name [color] resolves to an `any` value.","line":461,"column":77,"nodeType":"Identifier","messageId":"unsafeComputedMemberAccess","endLine":461,"endColumn":82},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":465,"column":102,"nodeType":"Identifier","messageId":"invalidType","endLine":465,"endColumn":107},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":465,"column":120,"nodeType":"Identifier","messageId":"invalidType","endLine":465,"endColumn":125},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":469,"column":107,"nodeType":"Identifier","messageId":"invalidType","endLine":469,"endColumn":112},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":482,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":482,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22167,22170],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22167,22170],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":486,"column":28,"nodeType":"Identifier","messageId":"invalidType","endLine":486,"endColumn":33},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":486,"column":56,"nodeType":"Identifier","messageId":"invalidType","endLine":486,"endColumn":61},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"any\" of template literal expression.","line":486,"column":81,"nodeType":"Identifier","messageId":"invalidType","endLine":486,"endColumn":86},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":495,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":495,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22669,22672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22669,22672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":512,"column":153,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":512,"endColumn":155,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[23756,23758],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":31,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * BackendBlueprintPanel - Dynamic Canvas-Aware Architecture Visualization\n * =======================================================================\n * Premium visualization of the Tauri Brownfield architecture.\n *\n * Design Pillars:\n * 1. Visual Excellence: Glassmorphism, subtle gradients, and fluid motion.\n * 2. Spatial Logic: Connections attach to borders (aligned via % grid).\n * 3. Information Density: Compact cards with full text visibility (no truncation).\n * 4. Interactive Feedback: Hover states, active flow indication, and clear status.\n *\n * Layout Coordinates (SVG ViewBox 0-1000):\n * - User Zone (0-10%): Center ~5%.\n * - FE Zone (12-40%): Connections at 125 and 385.\n * - IPC Zone (42-70%): Connections at 425 and 685.\n * - Plugin Zone (72-100%): Connections at 725.\n */\n\nimport React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';\nimport { type CanvasElement } from './CanvasEditor';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport type HealthStatus = 'healthy' | 'degraded' | 'unhealthy' | 'empty';\n\nexport interface PluginSlot {\n  id: string;\n  contract: string;\n  name: string;\n  pluginName?: string;\n  status: HealthStatus;\n}\n\nexport interface BackendBlueprintPanelProps {\n  className?: string;\n  compact?: boolean;\n  onSlotClick?: (slot: PluginSlot) => void;\n  onAddSlot?: (contract: string) => void;\n  onRemoveSlot?: (slotId: string) => void;\n  projectName?: string;\n  canvasElements?: CanvasElement[];\n  pluginRegistry?: PluginSlot[];\n  manualSlots?: PluginSlot[];\n}\n\nexport const PLUGIN_CATEGORIES = ['LLM', 'STT', 'TTS', 'Memory', 'Database', 'Custom'] as const;\n\n// ============================================================================\n// MAPPINGS & HELPERS\n// ============================================================================\n\nconst componentPluginMapping: Record<string, string[]> = {\n  'chat': ['LLM'], 'message': ['LLM'], 'conversation': ['LLM'], 'input': ['LLM'],\n  'voice': ['STT'], 'mic': ['STT'],\n  'speaker': ['TTS'], 'audio': ['TTS'],\n  'memory': ['Memory'], 'vector': ['Memory'],\n  'database': ['Database'], 'sql': ['Database'],\n};\n\nfunction analyzeCanvasForPlugins(elements: CanvasElement[]): string[] {\n  const requiredPlugins = new Set<string>();\n  elements.forEach(element => {\n    const term = (element.name + element.type).toLowerCase();\n    Object.entries(componentPluginMapping).forEach(([key, plugins]) => {\n      if (term.includes(key)) plugins.forEach(p => requiredPlugins.add(p));\n    });\n  });\n  return Array.from(requiredPlugins);\n}\n\nconst pluginMetadata: Record<string, { name: string; defaultPlugin?: string }> = {\n  'LLM': { name: 'Language Model', defaultPlugin: 'Ollama' },\n  'STT': { name: 'Speech-to-Text', defaultPlugin: 'Whisper' },\n  'TTS': { name: 'Text-to-Speech', defaultPlugin: 'Kokoro' },\n  'Memory': { name: 'Vector Memory' },\n  'Database': { name: 'Database Connector' },\n};\n\nfunction buildRequiredSlots(required: string[], registry?: PluginSlot[]): PluginSlot[] {\n  return required.map(contract => {\n    const existing = registry?.find(s => s.contract.toUpperCase() === contract.toUpperCase());\n    const meta = pluginMetadata[contract] || { name: contract };\n    if (existing) return existing;\n    return {\n      id: contract.toLowerCase(),\n      contract,\n      name: meta.name,\n      pluginName: meta.defaultPlugin,\n      status: meta.defaultPlugin ? 'healthy' : 'empty',\n    };\n  });\n}\n\nfunction extractFeComponents(elements: CanvasElement[]) {\n  const iconMap: Record<string, string> = {\n    chat: '­ƒÆ¼', input: 'Ô£Å´©Å', button: '­ƒöÿ', voice: '­ƒÄñ', speaker: '­ƒöè',\n    default: '­ƒÆá'\n  };\n  return elements.slice(0, 8).map(el => {\n    let icon = iconMap.default;\n    const nameLower = (el.name || '').toLowerCase();\n    for (const [k, v] of Object.entries(iconMap)) {\n      if (nameLower.includes(k)) { icon = v; break; }\n    }\n    return { id: el.id, name: el.name || 'Component', icon };\n  });\n}\n\n// ============================================================================\n// ANIMATION & DATA FLOW\n// ============================================================================\n\ninterface DataFlow {\n  step: number;\n  from: 'user' | 'fe' | 'ipc' | 'plugin';\n  to: 'user' | 'fe' | 'ipc' | 'plugin';\n  label: string;\n  description: string;\n}\n\nfunction generateDataFlows(requiredPlugins: string[]): DataFlow[] {\n  const flows: DataFlow[] = [];\n  let s = 1;\n  // Use Case: \"Sending a Message\" - Simple, Non-Technical Terms\n  flows.push({ step: s++, from: 'user', to: 'fe', label: 'Interaction', description: 'Step 1: User types a prompt' });\n  flows.push({ step: s++, from: 'fe', to: 'ipc', label: 'Command', description: 'Step 2: App sends text to Core' });\n  if (requiredPlugins.length) {\n    flows.push({ step: s++, from: 'ipc', to: 'plugin', label: 'Process', description: 'Step 3: Core asks AI to think' });\n    flows.push({ step: s++, from: 'plugin', to: 'ipc', label: 'Result', description: 'Step 4: AI Model returns answer' });\n  }\n  flows.push({ step: s++, from: 'ipc', to: 'fe', label: 'Update', description: 'Step 5: App receives AI reply' });\n  flows.push({ step: s++, from: 'fe', to: 'user', label: 'View', description: 'Step 6: User reads the response' });\n  return flows;\n}\n\n// ============================================================================\n// MAIN COMPONENT\n// ============================================================================\n\nexport const BackendBlueprintPanel: React.FC<BackendBlueprintPanelProps> = ({\n  className = '',\n  canvasElements = [],\n  pluginRegistry,\n  manualSlots = [],\n  onAddSlot,\n  // onRemoveSlot, // Not yet implemented\n  // onSlotClick,  // Not yet implemented\n}) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [activeStep, setActiveStep] = useState<number | null>(null);\n  const animationRef = useRef<number>(0);\n  const [showAddMenu, setShowAddMenu] = useState(false);\n\n  // Specific Component Targeting State\n  const [activeFeComponent, setActiveFeComponent] = useState<string | null>(null);\n\n  // Data processing\n  const required = useMemo(() => analyzeCanvasForPlugins(canvasElements), [canvasElements]);\n  const autoSlots = useMemo(() => buildRequiredSlots(required, pluginRegistry), [required, pluginRegistry]);\n  const allSlots = useMemo(() => {\n    return [...autoSlots, ...manualSlots.map(s => ({ ...s, id: `manual-${s.id}` }))];\n  }, [autoSlots, manualSlots]);\n  const feComponents = useMemo(() => extractFeComponents(canvasElements), [canvasElements]);\n  const flows = useMemo(() => generateDataFlows(required), [required]);\n\n  // Current Animation State info\n  const currentFlow = useMemo(() =>\n    activeStep !== null ? flows.find(f => f.step === activeStep) : null\n    , [activeStep, flows]);\n\n  // Animation Loop\n  const runAnimation = useCallback(() => {\n    let s = 0;\n    const animate = () => {\n      const flow = flows[s];\n      setActiveStep(flow?.step || 1);\n\n      s = (s + 1) % flows.length;\n      // REDUCED SPEED: 3000ms per step\n      animationRef.current = window.setTimeout(animate, 3000);\n    };\n    animate();\n  }, [flows]);\n\n  // Handle specific component targeting based on active step\n  useEffect(() => {\n    if (activeStep !== null) {\n      const flow = flows.find(f => f.step === activeStep);\n      // Strictly highlight a random FE component ONLY when FE is the SOURCE of the action\n      if (flow?.from === 'fe' && feComponents.length > 0) {\n        const randomIdx = Math.floor(Math.random() * feComponents.length);\n        setActiveFeComponent(feComponents[randomIdx].id);\n      } else {\n        setActiveFeComponent(null);\n      }\n    } else {\n      setActiveFeComponent(null);\n    }\n  }, [activeStep, flows, feComponents]);\n\n  const toggleAnimation = () => {\n    if (isAnimating) {\n      clearTimeout(animationRef.current);\n      setActiveStep(null);\n      setActiveFeComponent(null);\n    } else {\n      runAnimation();\n    }\n    setIsAnimating(!isAnimating);\n  };\n\n  useEffect(() => () => clearTimeout(animationRef.current), []);\n\n  const isActive = (zone: string) => {\n    if (!isAnimating || activeStep === null) return false;\n    const current = flows.find(f => f.step === activeStep);\n    return current?.from === zone;\n  };\n\n  return (\n    <div className={`flex flex-col h-full bg-slate-50/50 ${className}`}>\n      {/* 1. Header with Glassmorphism */}\n      <div className=\"relative flex items-center justify-between px-5 py-3 bg-white/80 backdrop-blur-sm border-b border-slate-200 sticky top-0 z-40 shrink-0\">\n\n        {/* LEFT: Title & Badges */}\n        <div className=\"flex items-center gap-4 z-10\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"p-1.5 bg-indigo-50 rounded-lg\">\n              <svg className=\"w-4 h-4 text-indigo-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n              </svg>\n            </div>\n            <h2 className=\"text-sm font-bold text-slate-800 tracking-tight leading-tight\">System Architecture</h2>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Badge label={`${canvasElements.length} Components`} color=\"blue\" />\n            {required.length > 0 && <Badge label={`${required.length} Plugins`} color=\"emerald\" />}\n          </div>\n        </div>\n\n        {/* CENTER: Dynamic Status Description (Absolute Center) */}\n        {isAnimating && currentFlow && (\n          <div className=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none\">\n            <div className=\"px-4 py-1.5 rounded-full bg-indigo-50 border border-indigo-100 shadow-sm animate-in fade-in zoom-in-95 duration-300\">\n              <span className=\"text-xs font-bold text-indigo-700 block text-center min-w-[200px] whitespace-nowrap\">\n                {currentFlow.description}\n              </span>\n            </div>\n          </div>\n        )}\n\n        {/* RIGHT: Action Button */}\n        <div className=\"z-10\">\n          <button\n            onClick={toggleAnimation}\n            className={`\n              relative overflow-hidden px-4 py-1.5 rounded-full text-xs font-semibold shadow-sm transition-all duration-300 border\n              ${isAnimating\n                ? 'bg-rose-50 text-rose-600 border-rose-200 hover:bg-rose-100'\n                : 'bg-indigo-600 text-white border-transparent hover:bg-indigo-700 hover:shadow-md'\n              }\n            `}\n          >\n            {isAnimating ? 'Stop' : 'Simulate'}\n          </button>\n        </div>\n      </div>\n\n      {/* 2. Main Visualization Area */}\n      <div className=\"flex-1 p-6 overflow-hidden relative isolate flex flex-col justify-center\">\n\n        {/* SVG Overlay: Connections between Borders */}\n        <div className=\"absolute inset-x-6 top-6 bottom-6 z-0 pointer-events-none\">\n          <svg className=\"w-full h-full\" viewBox=\"0 0 1000 300\" preserveAspectRatio=\"none\">\n            <defs>\n              <linearGradient id=\"flowGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                <stop offset=\"0%\" stopColor=\"#6366f1\" stopOpacity=\"0.1\" />\n                <stop offset=\"100%\" stopColor=\"#8b5cf6\" stopOpacity=\"0.1\" />\n              </linearGradient>\n              <filter id=\"glowParams\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n                <feGaussianBlur stdDeviation=\"3\" result=\"coloredBlur\" />\n                <feMerge>\n                  <feMergeNode in=\"coloredBlur\" />\n                  <feMergeNode in=\"SourceGraphic\" />\n                </feMerge>\n              </filter>\n            </defs>\n\n            {/* Static Connection Lines (Dashed) - BRIDGING THE GAPS (Borders) */}\n            {/* User Right (85) -> FE Left (125) */}\n            <path d=\"M 85 150 L 125 150\" stroke=\"#cbd5e1\" strokeWidth=\"2\" strokeDasharray=\"4,4\" opacity=\"0.5\" />\n            {/* FE Right (385) -> IPC Left (425) */}\n            <path d=\"M 385 150 L 425 150\" stroke=\"#cbd5e1\" strokeWidth=\"2\" strokeDasharray=\"4,4\" opacity=\"0.5\" />\n            {/* IPC Right (685) -> Plugin Left (725) */}\n            <path d=\"M 685 150 L 725 150\" stroke=\"#cbd5e1\" strokeWidth=\"2\" strokeDasharray=\"4,4\" opacity=\"0.5\" />\n\n            {/* Animated Flow Packets */}\n            {isAnimating && activeStep !== null && (\n              <>\n                {/* 1. User -> FE */}\n                {activeStep === 1 && <FlowPacket from={85} to={125} color=\"#3b82f6\" />}\n                {/* 2. FE -> IPC */}\n                {activeStep === 2 && <FlowPacket from={385} to={425} color=\"#8b5cf6\" />}\n                {/* 3. IPC -> Plugin */}\n                {activeStep === 3 && <FlowPacket from={685} to={725} color=\"#f59e0b\" />}\n                {/* 4. Plugin -> IPC (Return) */}\n                {activeStep === 4 && <FlowPacket from={725} to={685} color=\"#f59e0b\" />}\n                {/* 5. IPC -> FE (Return) */}\n                {activeStep === 5 && <FlowPacket from={425} to={385} color=\"#8b5cf6\" />}\n                {/* 6. FE -> User (Return) */}\n                {activeStep === 6 && <FlowPacket from={125} to={85} color=\"#3b82f6\" />}\n              </>\n            )}\n          </svg>\n        </div>\n\n        {/* Grid Layout for Zones - Percentage based to align with SVG 0-1000 scale */}\n        <div className=\"grid grid-cols-[10%_28%_28%_28%] gap-[2%] h-full z-10 relative\">\n\n          {/* ZONE 1: USER (External) */}\n          <div className=\"flex flex-col justify-center items-center h-full\">\n            <div className={`\n              w-20 h-20 rounded-2xl flex flex-col items-center justify-center border-2 transition-all duration-500\n              ${isActive('user')\n                ? 'bg-blue-50 border-blue-500 shadow-[0_0_25px_rgba(59,130,246,0.3)] scale-110 ring-4 ring-blue-100'\n                : 'bg-white border-dashed border-slate-300 opacity-80'\n              }\n            `}>\n              <div className={`p-2 rounded-full mb-1 transition-colors duration-500 ${isActive('user') ? 'bg-blue-100 text-blue-600' : 'bg-slate-100 text-slate-400'}`}>\n                <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" /></svg>\n              </div>\n              <span className=\"text-[10px] font-bold uppercase tracking-wider text-slate-500\">User</span>\n            </div>\n\n            {/* Status Indicator */}\n            <div className={`mt-4 px-3 py-1 rounded-full text-[10px] bg-slate-100 text-slate-500 font-bold tracking-wide transition-all duration-300 ${isActive('user') ? 'translate-y-0 opacity-100' : 'translate-y-2 opacity-0'}`}>\n              {activeStep === 1 ? 'INPUT' : (activeStep === 6 ? 'VIEW' : 'IDLE')}\n            </div>\n          </div>\n\n          {/* ZONE 2: FRONTEND */}\n          <ZoneCard\n            title=\"React Frontend\"\n            color=\"blue\"\n            active={isActive('fe')}\n            icon={<svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" /></svg>}\n          >\n            {feComponents.length === 0 ? (\n              <EmptyState label=\"Add components\" />\n            ) : (\n              <div className=\"grid grid-cols-1 gap-2 content-start overflow-y-auto pr-1 custom-scrollbar max-h-full\">\n                {feComponents.map(c => (\n                  <ComponentPill\n                    key={c.id}\n                    icon={c.icon}\n                    name={c.name}\n                    // Highlights ONLY when FE is active AND this specific component was selected\n                    active={isActive('fe') && (activeFeComponent === c.id)}\n                    color=\"blue\"\n                  />\n                ))}\n              </div>\n            )}\n          </ZoneCard>\n\n          {/* ZONE 3: IPC BRIDGE */}\n          <ZoneCard\n            title=\"IPC Bridge\"\n            subtitle=\"Tauri Core (Rust)\"\n            color=\"purple\"\n            active={isActive('ipc')}\n            icon={<svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" /></svg>}\n          >\n            <div className=\"space-y-2 h-full flex flex-col justify-center\">\n              <TechPill label=\"Tauri Commands\" detail=\"invoke()\" active={isActive('ipc')} />\n              <TechPill label=\"Process Mgmt\" detail=\"std::process\" active={isActive('ipc')} />\n              <div className={`p-2 rounded border text-center transition-all duration-500 mt-auto ${isActive('ipc') ? 'bg-purple-50 border-purple-200 shadow-inner scale-105' : 'bg-slate-50 border-slate-100'}`}>\n                <div className=\"text-[9px] font-bold text-slate-400 uppercase mb-1\">Protocol</div>\n                <div className=\"text-xs font-mono text-slate-600\">JSON-RPC 2.0</div>\n                <div className={`h-3 mt-1 text-[9px] text-purple-600 font-bold transition-opacity duration-300 ${isActive('ipc') ? 'opacity-100' : 'opacity-0'}`}>\n                  Processing...\n                </div>\n              </div>\n            </div>\n          </ZoneCard>\n\n          {/* ZONE 4: PLUGIN SIDECAR */}\n          <ZoneCard\n            title=\"Plugin Sidecar\"\n            subtitle=\"Python Environment\"\n            color=\"amber\"\n            active={isActive('plugin')}\n            icon={<svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" /></svg>}\n            action={\n              <button onClick={() => setShowAddMenu(!showAddMenu)} className=\"hover:bg-amber-100 p-1 rounded-md text-amber-600 transition-colors\">\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" /></svg>\n              </button>\n            }\n          >\n            {showAddMenu && (\n              <div className=\"absolute right-2 top-10 w-32 bg-white rounded-lg shadow-xl border border-slate-100 z-50 py-1 animate-in fade-in zoom-in-95 duration-200\">\n                {PLUGIN_CATEGORIES.map(cat => (\n                  <button key={cat} onClick={() => { onAddSlot?.(cat); setShowAddMenu(false); }} className=\"w-full text-left px-3 py-1.5 text-[11px] hover:bg-slate-50 text-slate-600\">\n                    {cat}\n                  </button>\n                ))}\n              </div>\n            )}\n\n            {allSlots.length === 0 ? (\n              <EmptyState label=\"No plugins\" />\n            ) : (\n              <div className=\"space-y-2 overflow-y-auto pr-1 custom-scrollbar max-h-full\">\n                {allSlots.map(slot => (\n                  <PluginSlotRow key={slot.id} slot={slot} active={isActive('plugin')} />\n                ))}\n              </div>\n            )}\n          </ZoneCard>\n\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// ============================================================================\n// SUB-COMPONENTS\n// ============================================================================\n\nconst Badge = ({ label, color }: { label: string, color: string }) => (\n  <span className={`px-2 py-0.5 rounded-md text-[10px] font-bold bg-${color}-50 text-${color}-600 border border-${color}-100 whitespace-nowrap`}>\n    {label}\n  </span>\n);\n\nconst FlowPacket = ({ from, to, color }: { from: number, to: number, color: string }) => (\n  <g>\n    <path d={`M ${from} 150 L ${to} 150`} stroke={color} strokeWidth=\"3\" fill=\"none\" strokeLinecap=\"round\" opacity=\"0.4\" />\n    <circle r=\"5\" fill={color} filter=\"url(#glowParams)\">\n      <animateMotion dur=\"1.2s\" repeatCount=\"1\" path={`M ${from} 150 L ${to} 150`} keyPoints=\"0;1\" keyTimes=\"0;1\" />\n    </circle>\n  </g>\n);\n\nconst ZoneCard = ({ title, subtitle, color, icon, children, active, action }: any) => {\n  const borderColors: any = { blue: 'border-blue-400', purple: 'border-purple-400', amber: 'border-amber-400' };\n  const bgColors: any = { blue: 'bg-blue-50', purple: 'bg-purple-50', amber: 'bg-amber-50' };\n  const activeShadows: any = {\n    blue: 'shadow-[0_0_30px_rgba(59,130,246,0.3)] ring-4 ring-blue-100',\n    purple: 'shadow-[0_0_30px_rgba(139,92,246,0.3)] ring-4 ring-purple-100',\n    amber: 'shadow-[0_0_30px_rgba(245,158,11,0.3)] ring-4 ring-orange-100'\n  };\n\n  return (\n    <div className={`\n      flex flex-col rounded-xl border backdrop-blur-sm transition-all duration-500 relative h-full overflow-hidden\n      ${active ? `${bgColors[color]} ${borderColors[color]} ${activeShadows[color]} scale-105 z-20` : `bg-white/60 border-slate-200 z-10`}\n    `}>\n      <div className={`px-3 py-2 border-b border-slate-100 flex items-center justify-between bg-white/40 shrink-0`}>\n        <div className=\"flex items-center gap-2 min-w-0\">\n          <div className={`p-1.5 rounded-md shrink-0 transition-colors duration-500 ${active ? `bg-${color}-100 text-${color}-600` : 'bg-slate-100 text-slate-400'}`}>\n            {icon}\n          </div>\n          <div className=\"min-w-0\">\n            <div className={`text-xs font-bold truncate transition-colors duration-500 ${active ? `text-${color}-900` : 'text-slate-700'}`}>{title}</div>\n            {subtitle && <div className=\"text-[9px] text-slate-400 truncate\">{subtitle}</div>}\n          </div>\n        </div>\n        {action}\n      </div>\n      <div className=\"p-2 flex-1 overflow-hidden flex flex-col min-h-0\">\n        {children}\n      </div>\n    </div>\n  );\n};\n\nconst ComponentPill = ({ icon, name, active, color }: any) => (\n  <div className={`\n    flex items-center gap-2 px-2 py-2 rounded-lg border text-[11px] font-medium transition-all duration-500\n    ${active\n      ? `bg-white border-${color}-300 shadow-md text-${color}-700 ring-2 ring-${color}-100 scale-105`\n      : 'bg-slate-50 border-slate-100 text-slate-500'\n    }\n  `}>\n    <span className=\"shrink-0\">{icon}</span>\n    <span className=\"whitespace-normal leading-tight break-words\">{name}</span>\n  </div>\n);\n\nconst TechPill = ({ label, detail, active }: any) => (\n  <div className={`\n     px-2 py-2 rounded-lg border transition-all duration-500 flex justify-between items-center\n     ${active ? 'bg-white border-purple-200 shadow-sm scale-105' : 'bg-slate-50 border-slate-100'}\n  `}>\n    <span className={`text-[10px] font-semibold transition-colors duration-500 ${active ? 'text-purple-700' : 'text-slate-600'}`}>{label}</span>\n    <span className=\"text-[9px] font-mono text-slate-400\">{detail}</span>\n  </div>\n);\n\nconst PluginSlotRow = ({ slot, active }: { slot: PluginSlot, active: boolean }) => (\n  <div className={`\n    flex items-center gap-2 px-2 py-2 rounded-lg border transition-all duration-500\n    ${active ? 'bg-white border-amber-200 shadow-md scale-105 ring-2 ring-orange-100' : 'bg-slate-50 border-slate-100'}\n  `}>\n    <div className={`w-2 h-2 rounded-full shrink-0 ${slot.status === 'healthy' ? 'bg-emerald-400' : 'bg-amber-300'}`} />\n    <div className=\"flex-1 min-w-0\">\n      <div className={`text-[10px] font-bold truncate transition-colors duration-500 ${active ? 'text-amber-800' : 'text-slate-600'}`}>{slot.pluginName || 'Empty Slot'}</div>\n      <div className=\"text-[9px] text-slate-400 truncate\">{slot.contract}</div>\n    </div>\n    <div className={`text-[9px] px-1.5 py-0.5 rounded shrink-0 ${slot.status === 'healthy' ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-200 text-slate-500'}`}>\n      {slot.status === 'healthy' ? 'RDY' : '...'}\n    </div>\n  </div>\n);\n\nconst EmptyState = ({ label }: { label: string }) => (\n  <div className=\"h-full flex flex-col items-center justify-center text-slate-300 p-4\">\n    <div className=\"text-2xl mb-1 opacity-50\">ÔÜí</div>\n    <div className=\"text-[10px] font-medium text-center\">{label}</div>\n  </div>\n);\n\nexport default BackendBlueprintPanel;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\CanvasEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":211,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6809,6812],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6809,6812],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'showRulers' is assigned a value but never used. Allowed unused args must match /^_/u.","line":234,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":234,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'showGuides' is assigned a value but never used. Allowed unused args must match /^_/u.","line":235,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":235,"endColumn":17},{"ruleId":"prefer-const","severity":2,"message":"'newBounds' is never reassigned. Use 'const' instead.","line":465,"column":13,"nodeType":"Identifier","messageId":"useConst","endLine":465,"endColumn":22,"fix":{"range":[15212,15255],"text":"const newBounds = { ...resizeInitialBounds };"}},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":543,"column":17,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":543,"endColumn":45},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":669,"column":36,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":669,"endColumn":38,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22225,22227],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":687,"column":29,"nodeType":"TSAsExpression","messageId":"alwaysTruthy","endLine":687,"endColumn":91},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1021,"column":39,"nodeType":"MemberExpression","messageId":"invalidType","endLine":1021,"endColumn":44},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1021,"column":51,"nodeType":"MemberExpression","messageId":"invalidType","endLine":1021,"endColumn":56},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1021,"column":69,"nodeType":"Identifier","messageId":"invalidType","endLine":1021,"endColumn":73},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1037,"column":38,"nodeType":"MemberExpression","messageId":"invalidType","endLine":1037,"endColumn":55},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1037,"column":61,"nodeType":"MemberExpression","messageId":"invalidType","endLine":1037,"endColumn":78},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1054,"column":20,"nodeType":"MemberExpression","messageId":"invalidType","endLine":1054,"endColumn":38},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":1055,"column":20,"nodeType":"MemberExpression","messageId":"invalidType","endLine":1055,"endColumn":35}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\r\n * D045 - src/components/factory/CanvasEditor.tsx\r\n * ================================================\r\n * Layout canvas editor for visual component arrangement.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\r\n *\r\n * Rules:\r\n *   - NO hardcoded colors, spacing, or sizes\r\n *   - ALL styling via Tailwind classes referencing design tokens\r\n *   - Fully typed props with TypeScript\r\n */\r\n\r\nimport React, {\r\n  forwardRef,\r\n  useState,\r\n  useCallback,\r\n  useRef,\r\n  useEffect,\r\n  useMemo,\r\n  type HTMLAttributes,\r\n} from \"react\";\r\nimport { LiveComponentPreview } from \"../ai/LiveComponentPreview\";\r\nimport { generateThemeCSSProperties } from \"../../hooks/useThemedStyles\";\r\n// unused: resolveColor, resolveBorder, getComponent, isComponentRegistered\r\nimport { getRegistry } from \"../../utils/ComponentRegistry\";\r\nimport type { ThemeConfig } from \"../../context/ThemeProvider\";\r\nimport * as LucideIcons from \"lucide-react\";\r\n\r\n/**\r\n * Canvas element types.\r\n */\r\nimport { TemplateComponentRenderer, elementTypeColors } from \"./TemplateComponentRenderer\";\r\nimport type { CanvasElement, CanvasElementType, ElementBounds } from \"./canvasTypes\";\r\n\r\nexport type { CanvasElement, CanvasElementType, ElementBounds };\r\n\r\n\r\n/**\r\n * Tool types.\r\n */\r\ntype ToolType = \"select\" | \"pan\";\r\n\r\n/**\r\n * Device preset for viewport simulation.\r\n */\r\ninterface DevicePreset {\r\n  name: string;\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\n/**\r\n * Built-in device presets.\r\n */\r\nconst devicePresets: DevicePreset[] = [\r\n  { name: \"Desktop (1920├ù1080)\", width: 1920, height: 1080 },\r\n  { name: \"Laptop (1366├ù768)\", width: 1366, height: 768 },\r\n  { name: \"Tablet (1024├ù768)\", width: 1024, height: 768 },\r\n  { name: \"iPad (834├ù1194)\", width: 834, height: 1194 },\r\n  { name: \"iPhone 14 Pro (393├ù852)\", width: 393, height: 852 },\r\n  { name: \"iPhone SE (375├ù667)\", width: 375, height: 667 },\r\n];\r\n\r\n/**\r\n * CanvasEditor component.\r\n *\r\n * A visual layout editor for arranging components on a canvas\r\n * with drag-and-drop, resize, grid snap, and zoom capabilities.\r\n *\r\n * @example\r\n * ```tsx\r\n * <CanvasEditor\r\n *   elements={canvasElements}\r\n *   selectedIds={[selectedId]}\r\n *   canvasWidth={1920}\r\n *   canvasHeight={1080}\r\n *   gridSettings={{ size: 8, snap: true, visible: true }}\r\n *   onSelect={(ids) => setSelectedId(ids[0])}\r\n *   onMove={(id, bounds) => updateElement(id, bounds)}\r\n *   editable\r\n * />\r\n * ```\r\n */\r\n\r\n/**\r\n * Cursor icon.\r\n */\r\nconst CursorIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <path d=\"M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z\" />\r\n    <path d=\"M13 13l6 6\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Hand/pan icon.\r\n */\r\nconst HandIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <path d=\"M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0\" />\r\n    <path d=\"M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2\" />\r\n    <path d=\"M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8\" />\r\n    <path d=\"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Zoom in icon.\r\n */\r\nconst ZoomInIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\r\n    <line x1=\"11\" y1=\"8\" x2=\"11\" y2=\"14\" />\r\n    <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Zoom out icon.\r\n */\r\nconst ZoomOutIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\r\n    <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Grid icon.\r\n */\r\nconst GridIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n    <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n    <line x1=\"3\" y1=\"15\" x2=\"21\" y2=\"15\" />\r\n    <line x1=\"9\" y1=\"3\" x2=\"9\" y2=\"21\" />\r\n    <line x1=\"15\" y1=\"3\" x2=\"15\" y2=\"21\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Trash icon.\r\n */\r\nconst TrashIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <polyline points=\"3 6 5 6 21 6\" />\r\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Play icon (for demo mode).\r\n */\r\nconst PlayIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <polygon points=\"5 3 19 12 5 21 5 3\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Stop icon (for demo mode).\r\n */\r\nconst StopIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Clear/eraser icon (for clear canvas).\r\n */\r\nconst ClearIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <path d=\"M20 5H9l-7 7 7 7h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z\" />\r\n    <line x1=\"18\" y1=\"9\" x2=\"12\" y2=\"15\" />\r\n    <line x1=\"12\" y1=\"9\" x2=\"18\" y2=\"15\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Undo icon (curved arrow left).\r\n */\r\nconst UndoIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <path d=\"M3 7v6h6\" />\r\n    <path d=\"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * CanvasEditor props.\r\n */\r\nexport interface CanvasEditorProps extends Omit<HTMLAttributes<HTMLDivElement>, 'onDrop' | 'onSelect'> {\r\n  elements: CanvasElement[];\r\n  selectedIds?: string[];\r\n  canvasWidth?: number;\r\n  canvasHeight?: number;\r\n  initialZoom?: number;\r\n  gridSettings?: { size: number; snap: boolean; visible: boolean };\r\n  editable?: boolean;\r\n  showRulers?: boolean;\r\n  showGuides?: boolean;\r\n  onSelect?: (ids: string[]) => void;\r\n  onMove?: (id: string, bounds: ElementBounds) => void;\r\n  onResize?: (id: string, bounds: ElementBounds) => void;\r\n  onDelete?: (ids: string[]) => void;\r\n  onDrop?: (component: any, position: { x: number; y: number }) => void;\r\n  onZoomChange?: (zoom: number) => void;\r\n  onCanvasSizeChange?: (width: number, height: number) => void;\r\n  getComponentCode?: (id: string) => { code: string; framework?: string } | null;\r\n  templateName?: string;\r\n  demoMode?: boolean;\r\n  onDemoModeChange?: (isDemo: boolean) => void;\r\n  canvasTheme?: ThemeConfig;\r\n  onClear?: () => void;\r\n  onUndo?: () => void;\r\n  canUndo?: boolean;\r\n}\r\n\r\nexport const CanvasEditor = forwardRef<HTMLDivElement, CanvasEditorProps>(\r\n  (\r\n    {\r\n      elements,\r\n      selectedIds = [],\r\n      canvasWidth = 1920,\r\n      canvasHeight = 1080,\r\n      initialZoom = 0.5,\r\n      gridSettings = { size: 8, snap: true, visible: true },\r\n      editable = true,\r\n      showRulers = true,\r\n      showGuides = false,\r\n      onSelect,\r\n      onMove,\r\n      onResize,\r\n      onDelete,\r\n      onDrop,\r\n      onZoomChange,\r\n      onCanvasSizeChange,\r\n      getComponentCode,\r\n      templateName,\r\n      demoMode: externalDemoMode,\r\n      onDemoModeChange,\r\n      canvasTheme,\r\n      onClear,\r\n      onUndo,\r\n      canUndo = false,\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    // State\r\n    const [zoom, setZoom] = useState(initialZoom);\r\n    const [pan, setPan] = useState({ x: 0, y: 0 });\r\n    const [tool, setTool] = useState<ToolType>(\"select\");\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [isResizing, setIsResizing] = useState(false);\r\n    const [isPanning, setIsPanning] = useState(false);\r\n    const [dragStart, setDragStart] = useState<{ x: number; y: number } | null>(null);\r\n    const [showGrid, setShowGrid] = useState(gridSettings.visible);\r\n    const [currentDevice, setCurrentDevice] = useState(0);\r\n    const [effectiveWidth, setEffectiveWidth] = useState(canvasWidth);\r\n    const [effectiveHeight, setEffectiveHeight] = useState(canvasHeight);\r\n\r\n    // Demo mode state (internal or controlled)\r\n    const [internalDemoMode, setInternalDemoMode] = useState(false);\r\n    const isDemoMode = externalDemoMode ?? internalDemoMode;\r\n    const toggleDemoMode = useCallback(() => {\r\n      const newValue = !isDemoMode;\r\n      setInternalDemoMode(newValue);\r\n      onDemoModeChange?.(newValue);\r\n    }, [isDemoMode, onDemoModeChange]);\r\n\r\n    // Resize state\r\n    const [resizeDirection, setResizeDirection] = useState<string | null>(null);\r\n    const [resizeStart, setResizeStart] = useState<{ x: number; y: number } | null>(null);\r\n    const [resizeInitialBounds, setResizeInitialBounds] = useState<ElementBounds | null>(null);\r\n    const [resizeElementId, setResizeElementId] = useState<string | null>(null);\r\n\r\n    // Refs\r\n    const canvasRef = useRef<HTMLDivElement>(null);\r\n    const viewportRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Theme - generate CSS properties from canvasTheme prop (isolated from App Factory theme)\r\n    // If no canvasTheme provided, use a clean default with white background\r\n    const canvasThemeStyles = useMemo(() => {\r\n      if (canvasTheme) {\r\n        return generateThemeCSSProperties(canvasTheme);\r\n      }\r\n      // Default canvas styling when no theme is provided\r\n      return {\r\n        backgroundColor: '#ffffff',\r\n        color: '#18181b',\r\n      };\r\n    }, [canvasTheme]);\r\n\r\n    // Snap to grid\r\n    const snapToGrid = useCallback(\r\n      (value: number): number => {\r\n        if (!gridSettings.snap) return value;\r\n        return Math.round(value / gridSettings.size) * gridSettings.size;\r\n      },\r\n      [gridSettings.snap, gridSettings.size]\r\n    );\r\n\r\n    // Get element by ID\r\n    const getElementById = useCallback(\r\n      (id: string): CanvasElement | undefined => {\r\n        const findElement = (elements: CanvasElement[]): CanvasElement | undefined => {\r\n          for (const el of elements) {\r\n            if (el.id === id) return el;\r\n            if (el.children) {\r\n              const found = findElement(el.children);\r\n              if (found) return found;\r\n            }\r\n          }\r\n          return undefined;\r\n        };\r\n        return findElement(elements);\r\n      },\r\n      [elements]\r\n    );\r\n\r\n    // Handle zoom\r\n    const handleZoomIn = useCallback(() => {\r\n      const newZoom = Math.min(zoom + 0.1, 2);\r\n      setZoom(newZoom);\r\n      onZoomChange?.(newZoom);\r\n    }, [zoom, onZoomChange]);\r\n\r\n    const handleZoomOut = useCallback(() => {\r\n      const newZoom = Math.max(zoom - 0.1, 0.1);\r\n      setZoom(newZoom);\r\n      onZoomChange?.(newZoom);\r\n    }, [zoom, onZoomChange]);\r\n\r\n    const handleZoomReset = useCallback(() => {\r\n      setZoom(1);\r\n      setPan({ x: 0, y: 0 });\r\n      onZoomChange?.(1);\r\n    }, [onZoomChange]);\r\n\r\n    // Handle wheel zoom (Ctrl + middle mouse wheel)\r\n    const handleWheel = useCallback(\r\n      (e: React.WheelEvent) => {\r\n        // Only zoom when Ctrl key is held\r\n        if (!e.ctrlKey) return;\r\n\r\n        e.preventDefault();\r\n\r\n        // deltaY > 0 means scrolling down (zoom out)\r\n        // deltaY < 0 means scrolling up (zoom in)\r\n        if (e.deltaY < 0) {\r\n          handleZoomIn();\r\n        } else if (e.deltaY > 0) {\r\n          handleZoomOut();\r\n        }\r\n      },\r\n      [handleZoomIn, handleZoomOut]\r\n    );\r\n\r\n    // Handle element click\r\n    const handleElementClick = useCallback(\r\n      (e: React.MouseEvent, element: CanvasElement) => {\r\n        // In demo mode, let clicks pass through to interactive components\r\n        if (!editable || isDemoMode) return;\r\n        e.stopPropagation();\r\n\r\n        if (e.shiftKey) {\r\n          // Multi-select\r\n          const newSelection = selectedIds.includes(element.id)\r\n            ? selectedIds.filter((id) => id !== element.id)\r\n            : [...selectedIds, element.id];\r\n          onSelect?.(newSelection);\r\n        } else {\r\n          onSelect?.([element.id]);\r\n        }\r\n      },\r\n      [editable, isDemoMode, selectedIds, onSelect]\r\n    );\r\n\r\n    // Handle canvas click (deselect)\r\n    const handleCanvasClick = useCallback(\r\n      (e: React.MouseEvent) => {\r\n        if (e.target === canvasRef.current) {\r\n          onSelect?.([]);\r\n        }\r\n      },\r\n      [onSelect]\r\n    );\r\n\r\n    // Handle drag start\r\n    const handleDragStart = useCallback(\r\n      (e: React.MouseEvent, element: CanvasElement) => {\r\n        if (!editable || element.locked || isDemoMode) return;\r\n        e.preventDefault();\r\n        setIsDragging(true);\r\n        setDragStart({ x: e.clientX, y: e.clientY });\r\n      },\r\n      [editable, isDemoMode]\r\n    );\r\n\r\n    // Handle drag\r\n    const handleDrag = useCallback(\r\n      (e: React.MouseEvent) => {\r\n        if (!isDragging || !dragStart || selectedIds.length === 0) return;\r\n\r\n        const dx = (e.clientX - dragStart.x) / zoom;\r\n        const dy = (e.clientY - dragStart.y) / zoom;\r\n\r\n        selectedIds.forEach((id) => {\r\n          const element = getElementById(id);\r\n          if (element && !element.locked) {\r\n            const newBounds = {\r\n              ...element.bounds,\r\n              x: snapToGrid(element.bounds.x + dx),\r\n              y: snapToGrid(element.bounds.y + dy),\r\n            };\r\n            onMove?.(id, newBounds);\r\n          }\r\n        });\r\n\r\n        setDragStart({ x: e.clientX, y: e.clientY });\r\n      },\r\n      [isDragging, dragStart, selectedIds, zoom, getElementById, snapToGrid, onMove]\r\n    );\r\n\r\n    // Handle drag end\r\n    const handleDragEnd = useCallback(() => {\r\n      setIsDragging(false);\r\n      setDragStart(null);\r\n    }, []);\r\n\r\n    // ===== RESIZE HANDLERS =====\r\n    // Material Design minimum touch target: 48dp\r\n    const MIN_SIZE = 48;\r\n\r\n    // Handle resize start\r\n    const handleResizeStart = useCallback(\r\n      (e: React.MouseEvent, element: CanvasElement, direction: string) => {\r\n        if (!editable || element.locked) return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setIsResizing(true);\r\n        setResizeDirection(direction);\r\n        setResizeStart({ x: e.clientX, y: e.clientY });\r\n        setResizeInitialBounds({ ...element.bounds });\r\n        setResizeElementId(element.id);\r\n      },\r\n      [editable]\r\n    );\r\n\r\n    // Handle resize drag\r\n    const handleResizeMove = useCallback(\r\n      (e: React.MouseEvent) => {\r\n        if (!isResizing || !resizeStart || !resizeInitialBounds || !resizeDirection || !resizeElementId) return;\r\n\r\n        const dx = (e.clientX - resizeStart.x) / zoom;\r\n        const dy = (e.clientY - resizeStart.y) / zoom;\r\n\r\n        let newBounds = { ...resizeInitialBounds };\r\n\r\n        // Apply resize based on direction\r\n        if (resizeDirection.includes('e')) {\r\n          newBounds.width = Math.max(MIN_SIZE, snapToGrid(resizeInitialBounds.width + dx));\r\n        }\r\n        if (resizeDirection.includes('w')) {\r\n          const newWidth = Math.max(MIN_SIZE, snapToGrid(resizeInitialBounds.width - dx));\r\n          const widthDelta = resizeInitialBounds.width - newWidth;\r\n          newBounds.x = snapToGrid(resizeInitialBounds.x + widthDelta);\r\n          newBounds.width = newWidth;\r\n        }\r\n        if (resizeDirection.includes('s')) {\r\n          newBounds.height = Math.max(MIN_SIZE, snapToGrid(resizeInitialBounds.height + dy));\r\n        }\r\n        if (resizeDirection.includes('n')) {\r\n          const newHeight = Math.max(MIN_SIZE, snapToGrid(resizeInitialBounds.height - dy));\r\n          const heightDelta = resizeInitialBounds.height - newHeight;\r\n          newBounds.y = snapToGrid(resizeInitialBounds.y + heightDelta);\r\n          newBounds.height = newHeight;\r\n        }\r\n\r\n        onResize?.(resizeElementId, newBounds);\r\n      },\r\n      [isResizing, resizeStart, resizeInitialBounds, resizeDirection, resizeElementId, zoom, snapToGrid, onResize]\r\n    );\r\n\r\n    // Handle resize end\r\n    const handleResizeEnd = useCallback(() => {\r\n      setIsResizing(false);\r\n      setResizeDirection(null);\r\n      setResizeStart(null);\r\n      setResizeInitialBounds(null);\r\n      setResizeElementId(null);\r\n    }, []);\r\n\r\n    // Handle pan\r\n    const handlePanStart = useCallback(\r\n      (e: React.MouseEvent) => {\r\n        if (tool !== \"pan\" && !e.buttons) return;\r\n        setIsPanning(true);\r\n        setDragStart({ x: e.clientX, y: e.clientY });\r\n      },\r\n      [tool]\r\n    );\r\n\r\n    const handlePanMove = useCallback(\r\n      (e: React.MouseEvent) => {\r\n        if (!isPanning || !dragStart) return;\r\n\r\n        const dx = e.clientX - dragStart.x;\r\n        const dy = e.clientY - dragStart.y;\r\n\r\n        setPan((prev) => ({\r\n          x: prev.x + dx,\r\n          y: prev.y + dy,\r\n        }));\r\n\r\n        setDragStart({ x: e.clientX, y: e.clientY });\r\n      },\r\n      [isPanning, dragStart]\r\n    );\r\n\r\n    const handlePanEnd = useCallback(() => {\r\n      setIsPanning(false);\r\n      setDragStart(null);\r\n    }, []);\r\n\r\n    // Handle drop\r\n    const handleCanvasDrop = useCallback(\r\n      (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        if (!editable) return;\r\n\r\n        const data = e.dataTransfer.getData(\"application/json\");\r\n        if (!data) return;\r\n\r\n        try {\r\n          const component = JSON.parse(data);\r\n          const rect = canvasRef.current?.getBoundingClientRect();\r\n          if (!rect) return;\r\n\r\n          const x = snapToGrid((e.clientX - rect.left - pan.x) / zoom);\r\n          const y = snapToGrid((e.clientY - rect.top - pan.y) / zoom);\r\n\r\n          console.log(\"[CanvasEditor] Dropped component:\", component);\r\n          onDrop?.(component, { x, y });\r\n        } catch (err) {\r\n          console.error(\"Failed to parse dropped data:\", err);\r\n        }\r\n      },\r\n      [editable, zoom, pan, snapToGrid, onDrop]\r\n    );\r\n\r\n    const handleDragOver = useCallback((e: React.DragEvent) => {\r\n      e.preventDefault();\r\n      e.dataTransfer.dropEffect = \"copy\";\r\n    }, []);\r\n\r\n    // Handle keyboard\r\n    useEffect(() => {\r\n      const handleKeyDown = (e: KeyboardEvent) => {\r\n        if (!editable) return;\r\n\r\n        // Check if the user is typing in an input field - allow normal behavior\r\n        const activeElement = document.activeElement;\r\n        const isInputElement =\r\n          activeElement instanceof HTMLInputElement ||\r\n          activeElement instanceof HTMLTextAreaElement ||\r\n          activeElement?.getAttribute('contenteditable') === 'true';\r\n\r\n        if (isInputElement) {\r\n          // Allow all keyboard events to pass through to input elements\r\n          return;\r\n        }\r\n\r\n        if (e.key === \"Delete\" || e.key === \"Backspace\") {\r\n          if (selectedIds.length > 0) {\r\n            onDelete?.(selectedIds);\r\n          }\r\n        }\r\n\r\n        if (e.key === \"Escape\") {\r\n          onSelect?.([]);\r\n        }\r\n\r\n        // Arrow keys for moving\r\n        if ([\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\"].includes(e.key)) {\r\n          e.preventDefault();\r\n          const delta = e.shiftKey ? gridSettings.size * 4 : gridSettings.size;\r\n          selectedIds.forEach((id) => {\r\n            const element = getElementById(id);\r\n            if (element && !element.locked) {\r\n              const newBounds = { ...element.bounds };\r\n              switch (e.key) {\r\n                case \"ArrowUp\":\r\n                  newBounds.y -= delta;\r\n                  break;\r\n                case \"ArrowDown\":\r\n                  newBounds.y += delta;\r\n                  break;\r\n                case \"ArrowLeft\":\r\n                  newBounds.x -= delta;\r\n                  break;\r\n                case \"ArrowRight\":\r\n                  newBounds.x += delta;\r\n                  break;\r\n              }\r\n              onMove?.(id, newBounds);\r\n            }\r\n          });\r\n        }\r\n      };\r\n\r\n      window.addEventListener(\"keydown\", handleKeyDown);\r\n      return () => window.removeEventListener(\"keydown\", handleKeyDown);\r\n    }, [editable, selectedIds, gridSettings.size, getElementById, onDelete, onSelect, onMove]);\r\n\r\n\r\n    // Container styles\r\n    const containerStyles = [\r\n      \"flex\",\r\n      \"flex-col\",\r\n      \"h-full\",\r\n      \"bg-neutral-200\",\r\n      \"rounded-lg\",\r\n      \"overflow-hidden\",\r\n      className,\r\n    ].join(\" \");\r\n\r\n    // Render element recursively\r\n    const renderElement = (element: CanvasElement): React.ReactNode => {\r\n      const isSelected = selectedIds.includes(element.id);\r\n      if (element.visible === false) return null;\r\n\r\n      // Get component code if this is a component-type element\r\n      const componentData = element.type === 'component' && element.componentId && getComponentCode\r\n        ? getComponentCode(element.componentId)\r\n        : null;\r\n\r\n      return (\r\n        <div\r\n          key={element.id}\r\n          className={[\r\n            \"absolute\",\r\n            // In demo mode, let clicks pass through to interactive components\r\n            isDemoMode && \"pointer-events-none\",\r\n            // Hide debug styling in demo mode\r\n            !isDemoMode && \"border-2\",\r\n            !isDemoMode && \"rounded\",\r\n            !isDemoMode && \"cursor-move\",\r\n            \"transition-shadow\",\r\n            \"duration-150\",\r\n            !isDemoMode && elementTypeColors[element.type],\r\n            isSelected && !isDemoMode && \"ring-2 ring-primary-500 ring-offset-2\",\r\n            element.locked && !isDemoMode && \"opacity-50 cursor-not-allowed\",\r\n          ]\r\n            .filter(Boolean)\r\n            .join(\" \")}\r\n          style={{\r\n            left: element.bounds.x,\r\n            top: element.bounds.y,\r\n            width: element.bounds.width,\r\n            height: element.bounds.height,\r\n            zIndex: element.zIndex || 0,\r\n          }}\r\n          onClick={(e) => handleElementClick(e, element)}\r\n          onMouseDown={(e) => handleDragStart(e, element)}\r\n        >\r\n          {/* Element label - hidden in demo mode */}\r\n          {!isDemoMode && (\r\n            <div className=\"absolute -top-5 left-0 px-1 text-xs font-medium text-neutral-600 bg-white rounded shadow-sm truncate max-w-full\">\r\n              {element.name}\r\n            </div>\r\n          )}\r\n\r\n          {/* Live component preview for component-type elements */}\r\n          <div className={`absolute inset-0 overflow-hidden flex items-center justify-center ${isDemoMode ? \"pointer-events-auto\" : \"\"}`}>\r\n            {componentData?.code ? (\r\n              // AI-generated component: use LiveComponentPreview with injected scope\r\n              <LiveComponentPreview\r\n                code={componentData.code}\r\n                framework={(componentData.framework as 'react' | 'vue' | 'svelte' | 'html') || 'react'}\r\n                className=\"w-full h-full\"\r\n                scope={{\r\n                  ...getRegistry(), // Inject all registered UI components\r\n                  ...LucideIcons,   // Inject all Lucide icons\r\n                }}\r\n                props={element.props}\r\n              />\r\n            ) : element.componentId ? (\r\n              // Template/built-in component: use TemplateComponentRenderer\r\n              // This has rich visual previews for all template component types\r\n              <TemplateComponentRenderer\r\n                componentId={element.componentId}\r\n                props={element.props}\r\n                bounds={{ width: element.bounds.width, height: element.bounds.height }}\r\n                demoMode={isDemoMode}\r\n              />\r\n            ) : null}\r\n          </div>\r\n\r\n\r\n          {/* Resize handles (when selected, hidden in demo mode) */}\r\n          {isSelected && editable && !element.locked && !isDemoMode && (\r\n            <>\r\n              {/* Corner handles */}\r\n              {[\"nw\", \"ne\", \"sw\", \"se\"].map((pos) => (\r\n                <div\r\n                  key={pos}\r\n                  className={[\r\n                    \"absolute\",\r\n                    \"h-3\",\r\n                    \"w-3\",\r\n                    \"bg-white\",\r\n                    \"border-2\",\r\n                    \"border-primary-500\",\r\n                    \"rounded-sm\",\r\n                    \"transition-transform\",\r\n                    \"duration-100\",\r\n                    \"hover:scale-125\",\r\n                    \"hover:shadow-md\",\r\n                    \"active:scale-110\",\r\n                    pos.includes(\"n\") ? \"-top-1.5\" : \"-bottom-1.5\",\r\n                    pos.includes(\"w\") ? \"-left-1.5\" : \"-right-1.5\",\r\n                    `cursor-${pos}-resize`,\r\n                  ].join(\" \")}\r\n                  onMouseDown={(e) => handleResizeStart(e, element, pos)}\r\n                />\r\n              ))}\r\n              {/* Edge handles */}\r\n              {[\"n\", \"s\", \"e\", \"w\"].map((pos) => (\r\n                <div\r\n                  key={pos}\r\n                  className={[\r\n                    \"absolute\",\r\n                    \"bg-white\",\r\n                    \"border-2\",\r\n                    \"border-primary-500\",\r\n                    \"rounded-sm\",\r\n                    \"transition-transform\",\r\n                    \"duration-100\",\r\n                    \"hover:scale-110\",\r\n                    \"active:scale-100\",\r\n                    pos === \"n\" || pos === \"s\" ? \"h-2 w-4 left-1/2 -translate-x-1/2\" : \"h-4 w-2 top-1/2 -translate-y-1/2\",\r\n                    pos === \"n\" && \"-top-1\",\r\n                    pos === \"s\" && \"-bottom-1\",\r\n                    pos === \"e\" && \"-right-1\",\r\n                    pos === \"w\" && \"-left-1\",\r\n                    `cursor-${pos}-resize`,\r\n                  ].join(\" \")}\r\n                  onMouseDown={(e) => handleResizeStart(e, element, pos)}\r\n                />\r\n              ))}\r\n            </>\r\n          )}\r\n\r\n          {/* Children */}\r\n          {element.children && element.children.length > 0 && (\r\n            <div className=\"absolute inset-2\">\r\n              {element.children.map(renderElement)}\r\n            </div>\r\n          )}\r\n        </div>\r\n      );\r\n    };\r\n\r\n    return (\r\n      <div id=\"canvas-editor\" ref={ref} className={containerStyles} {...props}>\r\n        {/* Toolbar */}\r\n        <div className=\"flex items-center gap-2 p-2 bg-white border-b border-neutral-200\">\r\n          {/* Tool buttons */}\r\n          <div className=\"flex border border-neutral-200 rounded-md overflow-hidden\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setTool(\"select\")}\r\n              className={[\r\n                \"p-1.5\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n                tool === \"select\"\r\n                  ? \"bg-primary-50 text-primary-600\"\r\n                  : \"text-neutral-500 hover:bg-neutral-50\",\r\n              ].join(\" \")}\r\n              title=\"Select tool (V)\"\r\n              aria-label=\"Select tool\"\r\n            >\r\n              <CursorIcon className=\"h-4 w-4\" />\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setTool(\"pan\")}\r\n              className={[\r\n                \"p-1.5\",\r\n                \"border-l\",\r\n                \"border-neutral-200\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n                tool === \"pan\"\r\n                  ? \"bg-primary-50 text-primary-600\"\r\n                  : \"text-neutral-500 hover:bg-neutral-50\",\r\n              ].join(\" \")}\r\n              title=\"Pan tool (H)\"\r\n              aria-label=\"Pan tool\"\r\n            >\r\n              <HandIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Grid toggle */}\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setShowGrid(!showGrid)}\r\n            className={[\r\n              \"p-1.5\",\r\n              \"rounded-md\",\r\n              \"transition-colors\",\r\n              \"duration-150\",\r\n              showGrid\r\n                ? \"bg-primary-50 text-primary-600\"\r\n                : \"text-neutral-500 hover:bg-neutral-50\",\r\n            ].join(\" \")}\r\n            title=\"Toggle grid\"\r\n            aria-label=\"Toggle grid visibility\"\r\n          >\r\n            <GridIcon className=\"h-4 w-4\" />\r\n          </button>\r\n\r\n          {/* Device selector */}\r\n          <select\r\n            value={currentDevice}\r\n            onChange={(e) => {\r\n              const idx = Number(e.target.value);\r\n              setCurrentDevice(idx);\r\n              const device = devicePresets[idx];\r\n              setEffectiveWidth(device.width);\r\n              setEffectiveHeight(device.height);\r\n              onCanvasSizeChange?.(device.width, device.height);\r\n            }}\r\n            className=\"px-2 py-1 text-xs border border-neutral-200 rounded-md bg-white text-neutral-600 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n            aria-label=\"Select device viewport size\"\r\n          >\r\n            {devicePresets.map((device, idx) => (\r\n              <option key={device.name} value={idx}>\r\n                {device.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n\r\n          {/* Template Name Badge (EUR-1.1.10) */}\r\n          {templateName && (\r\n            <div className=\"flex items-center gap-1.5 px-2.5 py-1 bg-primary-50 border border-primary-200 rounded-md\">\r\n              <svg className=\"h-3.5 w-3.5 text-primary-500\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\r\n                <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\r\n                <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\r\n                <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\r\n              </svg>\r\n              <span className=\"text-xs font-medium text-primary-700\">{templateName}</span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Spacer */}\r\n          <div className=\"flex-1\" />\r\n\r\n          {/* Zoom controls */}\r\n          <div className=\"flex items-center gap-1 border border-neutral-200 rounded-md overflow-hidden\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleZoomOut}\r\n              disabled={zoom <= 0.1}\r\n              className=\"p-1.5 text-neutral-500 hover:bg-neutral-50 disabled:opacity-50\"\r\n              title=\"Zoom out\"\r\n              aria-label=\"Zoom out\"\r\n            >\r\n              <ZoomOutIcon className=\"h-4 w-4\" />\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleZoomReset}\r\n              className=\"px-2 py-1 text-xs font-medium text-neutral-600 hover:bg-neutral-50 min-w-12 text-center\"\r\n              title=\"Reset zoom\"\r\n              aria-label=\"Reset zoom to 100%\"\r\n            >\r\n              {Math.round(zoom * 100)}%\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleZoomIn}\r\n              disabled={zoom >= 2}\r\n              className=\"p-1.5 text-neutral-500 hover:bg-neutral-50 disabled:opacity-50\"\r\n              title=\"Zoom in\"\r\n              aria-label=\"Zoom in\"\r\n            >\r\n              <ZoomInIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Demo Mode Toggle */}\r\n          <button\r\n            type=\"button\"\r\n            onClick={toggleDemoMode}\r\n            className={[\r\n              \"flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors duration-150\",\r\n              isDemoMode\r\n                ? \"bg-success-100 text-success-700 border border-success-300\"\r\n                : \"bg-neutral-100 text-neutral-600 hover:bg-neutral-200 border border-neutral-200\",\r\n            ].join(\" \")}\r\n            title={isDemoMode ? \"Exit Demo Mode\" : \"Enter Demo Mode - Preview interactive experience\"}\r\n            aria-label={isDemoMode ? \"Exit demo mode\" : \"Enter demo mode\"}\r\n          >\r\n            {isDemoMode ? (\r\n              <>\r\n                <StopIcon className=\"h-3.5 w-3.5\" />\r\n                <span>Exit Demo</span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <PlayIcon className=\"h-3.5 w-3.5\" />\r\n                <span>Demo</span>\r\n              </>\r\n            )}\r\n          </button>\r\n\r\n          {/* Delete button */}\r\n          {selectedIds.length > 0 && editable && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onDelete?.(selectedIds)}\r\n              className=\"p-1.5 rounded-md text-error-500 hover:bg-error-50 transition-colors duration-150\"\r\n              title=\"Delete selected\"\r\n              aria-label=\"Delete selected elements\"\r\n            >\r\n              <TrashIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n\r\n          {/* Undo button */}\r\n          {editable && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onUndo?.()}\r\n              disabled={!canUndo}\r\n              className={[\r\n                \"p-1.5 rounded-md transition-colors duration-150\",\r\n                canUndo\r\n                  ? \"text-neutral-600 hover:bg-neutral-100\"\r\n                  : \"text-neutral-300 cursor-not-allowed\",\r\n              ].join(\" \")}\r\n              title=\"Undo last action (Ctrl+Z)\"\r\n              aria-label=\"Undo last action\"\r\n            >\r\n              <UndoIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n\r\n          {/* Clear Canvas button */}\r\n          {editable && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onClear?.()}\r\n              disabled={elements.length === 0}\r\n              className={[\r\n                \"p-1.5 rounded-md transition-colors duration-150\",\r\n                elements.length > 0\r\n                  ? \"text-warning-600 hover:bg-warning-50\"\r\n                  : \"text-neutral-300 cursor-not-allowed\",\r\n              ].join(\" \")}\r\n              title=\"Clear canvas\"\r\n              aria-label=\"Clear all elements from canvas\"\r\n            >\r\n              <ClearIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Canvas viewport */}\r\n        <div\r\n          ref={viewportRef}\r\n          className={[\r\n            \"flex-1\",\r\n            \"overflow-hidden\",\r\n            \"relative\",\r\n            \"p-4\",\r\n            tool === \"pan\" && \"cursor-grab\",\r\n            isPanning && \"cursor-grabbing\",\r\n          ]\r\n            .filter(Boolean)\r\n            .join(\" \")}\r\n          onMouseDown={tool === \"pan\" ? handlePanStart : undefined}\r\n          onMouseMove={\r\n            isResizing ? handleResizeMove :\r\n              isPanning ? handlePanMove :\r\n                isDragging ? handleDrag :\r\n                  undefined\r\n          }\r\n          onMouseUp={() => {\r\n            handlePanEnd();\r\n            handleDragEnd();\r\n            handleResizeEnd();\r\n          }}\r\n          onMouseLeave={() => {\r\n            handlePanEnd();\r\n            handleDragEnd();\r\n            handleResizeEnd();\r\n          }}\r\n          onWheel={handleWheel}\r\n        >\r\n          {/* Canvas with theme applied - uses canvasTheme (project theme), NOT App Factory theme */}\r\n          <div\r\n            ref={canvasRef}\r\n            className=\"absolute shadow-xl\"\r\n            style={{\r\n              ...canvasThemeStyles,\r\n              width: effectiveWidth,\r\n              height: effectiveHeight,\r\n              transform: `translate(${pan.x}px, ${pan.y}px) scale(${zoom})`,\r\n              transformOrigin: \"0 0\",\r\n            }}\r\n            onClick={handleCanvasClick}\r\n            onDrop={handleCanvasDrop}\r\n            onDragOver={handleDragOver}\r\n          >\r\n            {/* Grid */}\r\n            {showGrid && (\r\n              <div\r\n                className=\"absolute inset-0 pointer-events-none\"\r\n                style={{\r\n                  backgroundImage: `\r\n                    linear-gradient(to right, var(--color-neutral-100) 1px, transparent 1px),\r\n                    linear-gradient(to bottom, var(--color-neutral-100) 1px, transparent 1px)\r\n                  `,\r\n                  backgroundSize: `${gridSettings.size}px ${gridSettings.size}px`,\r\n                }}\r\n              />\r\n            )}\r\n\r\n            {/* Elements */}\r\n            {elements.map(renderElement)}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Status bar */}\r\n        <div className=\"flex items-center justify-between px-3 py-1.5 bg-neutral-50 border-t border-neutral-200 text-xs text-neutral-500\">\r\n          <span>\r\n            Canvas: {effectiveWidth}├ù{effectiveHeight}px\r\n          </span>\r\n          <span>\r\n            {selectedIds.length > 0\r\n              ? `${selectedIds.length} element${selectedIds.length > 1 ? \"s\" : \"\"} selected`\r\n              : `${elements.length} element${elements.length !== 1 ? \"s\" : \"\"}`}\r\n          </span>\r\n          <span>Grid: {gridSettings.size}px</span>\r\n        </div>\r\n      </div >\r\n    );\r\n  }\r\n);\r\n\r\nCanvasEditor.displayName = \"CanvasEditor\";\r\n\r\nexport default CanvasEditor;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\CanvasPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":75,"column":23,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":75,"endColumn":87},{"ruleId":"react-hooks/error-boundaries","severity":2,"message":"Error: Avoid constructing JSX within try/catch\n\nReact does not immediately render components when JSX is rendered, so any errors from this component will not be caught by the try/catch. To catch errors in rendering a given component, wrap that component in an error boundary. (https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary).\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\CanvasPreview.tsx:78:20\n  76 |\n  77 |         try {\n> 78 |             return <Component {...props} />;\n     |                    ^^^^^^^^^^^^^^^^^^^^^^^^ Avoid constructing JSX within try/catch\n  79 |         } catch {\n  80 |             // Fall through to placeholder\n  81 |         }","line":78,"column":20,"nodeType":null,"endLine":78,"endColumn":44},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\CanvasPreview.tsx:78:21\n  76 |\n  77 |         try {\n> 78 |             return <Component {...props} />;\n     |                     ^^^^^^^^^ This component is created during render\n  79 |         } catch {\n  80 |             // Fall through to placeholder\n  81 |         }\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\CanvasPreview.tsx:74:27\n  72 |     // Try to render built-in component from registry\n  73 |     if (componentData?.componentType && isComponentRegistered(componentData.componentType)) {\n> 74 |         const Component = getComponent(componentData.componentType);\n     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ The component is created during render here\n  75 |         const props = defaultComponentProps[componentData.componentType.toLowerCase()] || {};\n  76 |\n  77 |         try {","line":78,"column":21,"nodeType":null,"endLine":78,"endColumn":30},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":148,"column":47,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":148,"endColumn":49,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[4991,4993],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":148,"column":65,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":148,"endColumn":67,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5009,5011],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * CanvasPreview.tsx\r\n * =================\r\n * Renders canvas elements in the Preview panel as a live preview.\r\n * This component takes canvas elements and renders them positioned\r\n * according to their bounds, with actual component rendering.\r\n * \r\n * Theme Support: Uses ThemedCanvasWrapper to apply theme customizations.\r\n */\r\n\r\nimport React from 'react';\r\nimport { type CanvasElement } from './CanvasEditor';\r\nimport { getComponent, isComponentRegistered } from '../../utils/ComponentRegistry';\r\nimport { ThemedCanvasWrapper } from './ThemedCanvasWrapper';\r\n\r\ninterface CanvasPreviewProps {\r\n    /** Canvas elements to render */\r\n    elements: CanvasElement[];\r\n    /** Canvas width for scaling */\r\n    canvasWidth: number;\r\n    /** Canvas height for scaling */\r\n    canvasHeight: number;\r\n    /** Function to get component rendering info by componentId */\r\n    getComponentCode?: (componentId: string) => {\r\n        code?: string;\r\n        framework?: 'react' | 'vue' | 'svelte' | 'html';\r\n        componentType?: string;\r\n    } | null;\r\n    /** Additional CSS classes */\r\n    className?: string;\r\n}\r\n\r\n/**\r\n * Default props for built-in component types.\r\n */\r\nconst defaultComponentProps: Record<string, Record<string, unknown>> = {\r\n    button: { children: 'Button', variant: 'primary', size: 'md' },\r\n    input: { placeholder: 'Enter text...', size: 'md' },\r\n    select: {\r\n        options: [\r\n            { value: '1', label: 'Option 1' },\r\n            { value: '2', label: 'Option 2' },\r\n        ],\r\n        placeholder: 'Select...',\r\n        size: 'md'\r\n    },\r\n    checkbox: { label: 'Checkbox', size: 'md' },\r\n    panel: { children: 'Panel Content', className: 'p-4' },\r\n    card: { children: 'Card Content', className: 'p-4' },\r\n    tabs: {\r\n        tabs: [\r\n            { id: '1', label: 'Tab 1' },\r\n            { id: '2', label: 'Tab 2' },\r\n        ],\r\n        activeTab: '1',\r\n        size: 'md'\r\n    },\r\n};\r\n\r\n/**\r\n * Renders a single canvas element preview.\r\n */\r\nconst ElementPreview: React.FC<{\r\n    element: CanvasElement;\r\n    getComponentCode?: CanvasPreviewProps['getComponentCode'];\r\n}> = ({ element, getComponentCode }) => {\r\n    // Get component info if this is a component-type element\r\n    const componentData = element.componentId && getComponentCode\r\n        ? getComponentCode(element.componentId)\r\n        : null;\r\n\r\n    // Try to render built-in component from registry\r\n    if (componentData?.componentType && isComponentRegistered(componentData.componentType)) {\r\n        const Component = getComponent(componentData.componentType);\r\n        const props = defaultComponentProps[componentData.componentType.toLowerCase()] || {};\r\n\r\n        try {\r\n            return <Component {...props} />;\r\n        } catch {\r\n            // Fall through to placeholder\r\n        }\r\n    }\r\n\r\n    // For containers/text/other types, show placeholder with children\r\n    if (element.type === 'container') {\r\n        return (\r\n            <div className=\"w-full h-full border border-neutral-200 bg-neutral-50/50 rounded flex items-center justify-center\">\r\n                <span className=\"text-xs text-neutral-400\">{element.name}</span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (element.type === 'text') {\r\n        return (\r\n            <div className=\"w-full h-full flex items-center\">\r\n                <span className=\"text-sm text-neutral-700\">{element.name}</span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Default placeholder for unregistered components\r\n    return (\r\n        <div className=\"w-full h-full border border-dashed border-neutral-300 bg-neutral-50 rounded flex items-center justify-center\">\r\n            <span className=\"text-xs text-neutral-500\">{element.name}</span>\r\n        </div>\r\n    );\r\n};\r\n\r\n/**\r\n * CanvasPreview component.\r\n * \r\n * Renders all canvas elements as positioned components,\r\n * creating a true WYSIWYG preview of the canvas layout.\r\n */\r\nexport const CanvasPreview: React.FC<CanvasPreviewProps> = ({\r\n    elements,\r\n    canvasWidth,\r\n    canvasHeight,\r\n    getComponentCode,\r\n    className = '',\r\n}) => {\r\n    if (elements.length === 0) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-full text-neutral-400\">\r\n                <p className=\"text-sm\">No elements on canvas</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <ThemedCanvasWrapper\r\n            className={`relative overflow-auto ${className}`}\r\n            style={{ minHeight: '100%' }}\r\n            applyBackground\r\n        >\r\n            {/* Scaled canvas container */}\r\n            <div\r\n                className=\"relative\"\r\n                style={{\r\n                    width: canvasWidth,\r\n                    height: canvasHeight,\r\n                    transform: 'scale(0.5)',\r\n                    transformOrigin: 'top left',\r\n                }}\r\n            >\r\n                {elements\r\n                    .filter(el => el.visible !== false)\r\n                    .sort((a, b) => (a.zIndex || 0) - (b.zIndex || 0))\r\n                    .map((element) => (\r\n                        <div\r\n                            key={element.id}\r\n                            className=\"absolute overflow-hidden\"\r\n                            style={{\r\n                                left: element.bounds.x,\r\n                                top: element.bounds.y,\r\n                                width: element.bounds.width,\r\n                                height: element.bounds.height,\r\n                            }}\r\n                        >\r\n                            <ElementPreview\r\n                                element={element}\r\n                                getComponentCode={getComponentCode}\r\n                            />\r\n                        </div>\r\n                    ))}\r\n            </div>\r\n        </ThemedCanvasWrapper>\r\n    );\r\n};\r\n\r\nexport default CanvasPreview;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ComponentCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ComponentGallery.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":445,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":445,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[12787,12789],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":749,"column":17,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":749,"endColumn":48},{"ruleId":"react-hooks/error-boundaries","severity":2,"message":"Error: Avoid constructing JSX within try/catch\n\nReact does not immediately render components when JSX is rendered, so any errors from this component will not be caught by the try/catch. To catch errors in rendering a given component, wrap that component in an error boundary. (https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary).\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ComponentGallery.tsx:752:12\n  750 |\n  751 |   try {\n> 752 |     return <Component {...props} />;\n      |            ^^^^^^^^^^^^^^^^^^^^^^^^ Avoid constructing JSX within try/catch\n  753 |   } catch {\n  754 |     return <span className=\"text-xs text-neutral-400\">Preview</span>;\n  755 |   }","line":752,"column":12,"nodeType":null,"endLine":752,"endColumn":36},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ComponentGallery.tsx:752:13\n  750 |\n  751 |   try {\n> 752 |     return <Component {...props} />;\n      |             ^^^^^^^^^ This component is created during render\n  753 |   } catch {\n  754 |     return <span className=\"text-xs text-neutral-400\">Preview</span>;\n  755 |   }\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ComponentGallery.tsx:722:21\n  720 |\n  721 |   // Fallback to Component Registry\n> 722 |   const Component = getComponent(type);\n      |                     ^^^^^^^^^^^^^^^^^^ The component is created during render here\n  723 |\n  724 |   // Provide sample props based on component type\n  725 |   const sampleProps: Record<string, Record<string, unknown>> = {","line":752,"column":13,"nodeType":null,"endLine":752,"endColumn":22}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * D042 - src/components/factory/ComponentGallery.tsx\r\n * ====================================================\r\n * Frontend component gallery for displaying available UI components.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\r\n *\r\n * Rules:\r\n *   - NO hardcoded colors, spacing, or sizes\r\n *   - ALL styling via Tailwind classes referencing design tokens\r\n *   - Fully typed props with TypeScript\r\n */\r\n\r\nimport React, { forwardRef, useState, useMemo, type HTMLAttributes } from \"react\";\r\nimport { getComponent, isComponentRegistered } from \"../../utils/ComponentRegistry\";\r\n\r\n/**\r\n * Component category enumeration.\r\n */\r\nexport type ComponentCategory =\r\n  | \"atoms\"\r\n  | \"molecules\"\r\n  | \"organisms\"\r\n  | \"templates\"\r\n  | \"layouts\"\r\n  | \"containers\"\r\n  | \"custom\";\r\n\r\n/**\r\n * Component type for specific UI patterns.\r\n */\r\nexport type ComponentType =\r\n  | \"button\"\r\n  | \"input\"\r\n  | \"select\"\r\n  | \"checkbox\"\r\n  | \"panel\"\r\n  | \"modal\"\r\n  | \"card\"\r\n  | \"list\"\r\n  | \"form\"\r\n  | \"navigation\"\r\n  | \"container\"\r\n  | \"custom\";\r\n\r\n/**\r\n * Component information interface.\r\n */\r\nexport interface ComponentInfo {\r\n  /** Unique component identifier */\r\n  id: string;\r\n  /** Display name */\r\n  name: string;\r\n  /** Component category */\r\n  category: ComponentCategory;\r\n  /** Component type */\r\n  type: ComponentType;\r\n  /** Short description */\r\n  description: string;\r\n  /** Preview thumbnail URL */\r\n  thumbnail?: string;\r\n  /** Whether component is built-in */\r\n  builtIn?: boolean;\r\n  /** Tags for filtering */\r\n  tags?: string[];\r\n  /** Props schema (simplified) */\r\n  propsSchema?: Record<string, string>;\r\n  /** Default props values */\r\n  defaultProps?: Record<string, unknown>;\r\n  /** Usage example code */\r\n  exampleCode?: string;\r\n  /** Component version */\r\n  /** Component version */\r\n  version?: string;\r\n  /** Default size (width/height) for drag-and-drop */\r\n  defaultSize?: { width: number; height: number };\r\n}\r\n\r\n/**\r\n * Gallery filter options.\r\n */\r\nexport interface ComponentFilters {\r\n  /** Filter by category */\r\n  category?: ComponentCategory | \"all\";\r\n  /** Filter by type */\r\n  type?: ComponentType | \"all\";\r\n  /** Search query */\r\n  search?: string;\r\n  /** Show only built-in components */\r\n  builtInOnly?: boolean;\r\n}\r\n\r\n/**\r\n * Sort options.\r\n */\r\nexport type ComponentSortBy = \"name\" | \"category\" | \"type\";\r\nexport type SortOrder = \"asc\" | \"desc\";\r\n\r\n/**\r\n * View mode.\r\n */\r\nexport type ViewMode = \"grid\" | \"list\";\r\n\r\n/**\r\n * Category color mapping.\r\n */\r\nconst categoryColors: Record<ComponentCategory, string> = {\r\n  atoms: \"bg-primary-100 text-primary-700 border-primary-200\",\r\n  molecules: \"bg-success-50 text-success-700 border-success-200\",\r\n  organisms: \"bg-warning-50 text-warning-700 border-warning-200\",\r\n  templates: \"bg-info-50 text-info-700 border-info-200\",\r\n  layouts: \"bg-neutral-100 text-neutral-700 border-neutral-200\",\r\n  containers: \"bg-indigo-50 text-indigo-700 border-indigo-200\",\r\n  custom: \"bg-neutral-50 text-neutral-600 border-neutral-200\",\r\n};\r\n\r\n/**\r\n * Category labels.\r\n */\r\nconst categoryLabels: Record<ComponentCategory, string> = {\r\n  atoms: \"Atoms\",\r\n  molecules: \"Molecules\",\r\n  organisms: \"Organisms\",\r\n  templates: \"Templates\",\r\n  layouts: \"Layouts\",\r\n  containers: \"Containers\",\r\n  custom: \"Custom\",\r\n};\r\n\r\n/**\r\n * Search icon component.\r\n */\r\nconst SearchIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n    aria-hidden=\"true\"\r\n  >\r\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n    <path d=\"m21 21-4.3-4.3\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Grid icon component.\r\n */\r\nconst GridIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n    aria-hidden=\"true\"\r\n  >\r\n    <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\r\n    <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\r\n    <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\r\n    <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * List icon component.\r\n */\r\nconst ListIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n    aria-hidden=\"true\"\r\n  >\r\n    <line x1=\"8\" y1=\"6\" x2=\"21\" y2=\"6\" />\r\n    <line x1=\"8\" y1=\"12\" x2=\"21\" y2=\"12\" />\r\n    <line x1=\"8\" y1=\"18\" x2=\"21\" y2=\"18\" />\r\n    <line x1=\"3\" y1=\"6\" x2=\"3.01\" y2=\"6\" />\r\n    <line x1=\"3\" y1=\"12\" x2=\"3.01\" y2=\"12\" />\r\n    <line x1=\"3\" y1=\"18\" x2=\"3.01\" y2=\"18\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Filter icon component.\r\n */\r\nconst FilterIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n    aria-hidden=\"true\"\r\n  >\r\n    <polygon points=\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Component placeholder icon.\r\n */\r\nconst ComponentIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n    aria-hidden=\"true\"\r\n  >\r\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n    <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n    <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Grid column class mapping.\r\n */\r\nconst gridColumnClasses: Record<number, string> = {\r\n  2: \"grid-cols-1 sm:grid-cols-2\",\r\n  3: \"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3\",\r\n  4: \"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\",\r\n};\r\n\r\n/**\r\n * ComponentGallery component props.\r\n */\r\nexport interface ComponentGalleryProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\"> {\r\n  /** Array of components to display */\r\n  components: ComponentInfo[];\r\n  /** Currently selected component ID (single-select mode - deprecated, use selectedIds) */\r\n  selectedId?: string;\r\n  /** Currently selected component IDs (multi-select mode) */\r\n  selectedIds?: string[];\r\n  /** Callback when a component is selected (single-select mode - deprecated) */\r\n  onSelect?: (component: ComponentInfo) => void;\r\n  /** Callback when a component selection changes (multi-select mode) */\r\n  onSelectionChange?: (component: ComponentInfo, selected: boolean) => void;\r\n  /** Callback when a component is added to canvas */\r\n  onAdd?: (component: ComponentInfo) => void;\r\n  /** Callback when component info is requested */\r\n  onInfo?: (component: ComponentInfo) => void;\r\n  /** Initial filters */\r\n  initialFilters?: ComponentFilters;\r\n  /** Initial sort settings */\r\n  initialSort?: { by: ComponentSortBy; order: SortOrder };\r\n  /** Initial view mode */\r\n  initialViewMode?: ViewMode;\r\n  /** Whether to show filter controls */\r\n  showFilters?: boolean;\r\n  /** Whether to show search input */\r\n  showSearch?: boolean;\r\n  /** Whether to show view mode toggle */\r\n  showViewToggle?: boolean;\r\n  /** Empty state message */\r\n  emptyMessage?: string;\r\n  /** Loading state */\r\n  isLoading?: boolean;\r\n  /** Grid columns for grid view */\r\n  gridColumns?: 2 | 3 | 4;\r\n  /** Enable drag and drop */\r\n  draggable?: boolean;\r\n}\r\n\r\n/**\r\n * ComponentGallery component.\r\n *\r\n * Displays a grid or list of available UI components with filtering,\r\n * searching, and drag-and-drop capabilities.\r\n *\r\n * @example\r\n * ```tsx\r\n * <ComponentGallery\r\n *   components={componentList}\r\n *   selectedId=\"button-primary\"\r\n *   onSelect={(component) => console.log(\"Selected:\", component)}\r\n *   onAdd={(component) => addToCanvas(component)}\r\n *   showFilters\r\n *   showSearch\r\n *   draggable\r\n * />\r\n * ```\r\n */\r\nexport const ComponentGallery = forwardRef<HTMLDivElement, ComponentGalleryProps>(\r\n  (\r\n    {\r\n      components,\r\n      selectedId,\r\n      selectedIds = [],\r\n      onSelect,\r\n      onSelectionChange,\r\n      onAdd,\r\n      onInfo,\r\n      initialFilters = { category: \"all\", type: \"all\", search: \"\" },\r\n      initialSort = { by: \"name\", order: \"asc\" },\r\n      initialViewMode = \"grid\",\r\n      showFilters = true,\r\n      showSearch = true,\r\n      showViewToggle = true,\r\n      emptyMessage = \"No components found\",\r\n      isLoading = false,\r\n      gridColumns = 3,\r\n      draggable = false,\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    // State\r\n    const [filters, setFilters] = useState<ComponentFilters>(initialFilters);\r\n    const [sortBy] = useState<ComponentSortBy>(initialSort.by);\r\n    const [sortOrder] = useState<SortOrder>(initialSort.order);\r\n    const [viewMode, setViewMode] = useState<ViewMode>(initialViewMode);\r\n    const [showFilterPanel, setShowFilterPanel] = useState(false);\r\n\r\n    // Filter and sort components\r\n    const filteredComponents = useMemo(() => {\r\n      let result = [...components];\r\n\r\n      // Apply category filter\r\n      if (filters.category && filters.category !== \"all\") {\r\n        result = result.filter((c) => c.category === filters.category);\r\n      }\r\n\r\n      // Apply type filter\r\n      if (filters.type && filters.type !== \"all\") {\r\n        result = result.filter((c) => c.type === filters.type);\r\n      }\r\n\r\n      // Apply built-in filter\r\n      if (filters.builtInOnly) {\r\n        result = result.filter((c) => c.builtIn);\r\n      }\r\n\r\n      // Apply search filter\r\n      if (filters.search) {\r\n        const searchLower = filters.search.toLowerCase();\r\n        result = result.filter(\r\n          (c) =>\r\n            c.name.toLowerCase().includes(searchLower) ||\r\n            c.description.toLowerCase().includes(searchLower) ||\r\n            c.id.toLowerCase().includes(searchLower) ||\r\n            c.tags?.some((t) => t.toLowerCase().includes(searchLower))\r\n        );\r\n      }\r\n\r\n      // Apply sorting\r\n      result.sort((a, b) => {\r\n        let comparison = 0;\r\n        switch (sortBy) {\r\n          case \"name\":\r\n            comparison = a.name.localeCompare(b.name);\r\n            break;\r\n          case \"category\":\r\n            comparison = a.category.localeCompare(b.category);\r\n            break;\r\n          case \"type\":\r\n            comparison = a.type.localeCompare(b.type);\r\n            break;\r\n        }\r\n        return sortOrder === \"asc\" ? comparison : -comparison;\r\n      });\r\n\r\n      return result;\r\n    }, [components, filters, sortBy, sortOrder]);\r\n\r\n    // Handle search input\r\n    const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      setFilters((prev) => ({ ...prev, search: e.target.value }));\r\n    };\r\n\r\n    // Handle filter changes\r\n    const handleCategoryFilter = (category: ComponentCategory | \"all\") => {\r\n      setFilters((prev) => ({ ...prev, category }));\r\n    };\r\n\r\n    // Container styles\r\n    const containerStyles = [\"flex\", \"flex-col\", \"gap-4\", className].filter(Boolean).join(\" \");\r\n\r\n    // Toolbar styles\r\n    const toolbarStyles = [\r\n      \"flex\",\r\n      \"flex-wrap\",\r\n      \"items-center\",\r\n      \"gap-3\",\r\n      \"p-3\",\r\n      \"bg-neutral-50\",\r\n      \"border\",\r\n      \"border-neutral-200\",\r\n      \"rounded-lg\",\r\n    ].join(\" \");\r\n\r\n    // Grid/list container styles\r\n    const contentStyles =\r\n      viewMode === \"grid\"\r\n        ? [\"grid\", \"gap-4\", gridColumnClasses[gridColumns]].join(\" \")\r\n        : [\"flex\", \"flex-col\", \"gap-2\"].join(\" \");\r\n\r\n    // Empty state styles\r\n    const emptyStyles = [\r\n      \"flex\",\r\n      \"flex-col\",\r\n      \"items-center\",\r\n      \"justify-center\",\r\n      \"py-12\",\r\n      \"text-neutral-500\",\r\n    ].join(\" \");\r\n\r\n    // Loading state styles\r\n    const loadingStyles = [\"flex\", \"items-center\", \"justify-center\", \"py-12\"].join(\" \");\r\n\r\n    return (\r\n      <div ref={ref} className={containerStyles} {...props}>\r\n        {/* Toolbar */}\r\n        {(showSearch || showFilters || showViewToggle) && (\r\n          <div className={toolbarStyles}>\r\n            {/* Search */}\r\n            {showSearch && (\r\n              <div className=\"relative flex-1 min-w-48\">\r\n                <SearchIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\" />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Search components...\"\r\n                  value={filters.search || \"\"}\r\n                  onChange={handleSearchChange}\r\n                  className={[\r\n                    \"w-full\",\r\n                    \"pl-9\",\r\n                    \"pr-4\",\r\n                    \"py-2\",\r\n                    \"text-sm\",\r\n                    \"bg-white\",\r\n                    \"border\",\r\n                    \"border-neutral-200\",\r\n                    \"rounded-md\",\r\n                    \"focus:outline-none\",\r\n                    \"focus:ring-2\",\r\n                    \"focus:ring-primary-500\",\r\n                    \"focus:border-transparent\",\r\n                    \"placeholder:text-neutral-400\",\r\n                  ].join(\" \")}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Filter toggle */}\r\n            {showFilters && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowFilterPanel(!showFilterPanel)}\r\n                className={[\r\n                  \"flex\",\r\n                  \"items-center\",\r\n                  \"gap-2\",\r\n                  \"px-3\",\r\n                  \"py-2\",\r\n                  \"text-sm\",\r\n                  \"font-medium\",\r\n                  \"rounded-md\",\r\n                  \"border\",\r\n                  \"transition-colors\",\r\n                  \"duration-150\",\r\n                  showFilterPanel\r\n                    ? \"bg-primary-50 border-primary-200 text-primary-700\"\r\n                    : \"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50\",\r\n                ].join(\" \")}\r\n              >\r\n                <FilterIcon className=\"h-4 w-4\" />\r\n                <span>Filters</span>\r\n              </button>\r\n            )}\r\n\r\n            {/* View mode toggle */}\r\n            {showViewToggle && (\r\n              <div className=\"flex border border-neutral-200 rounded-md overflow-hidden\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setViewMode(\"grid\")}\r\n                  className={[\r\n                    \"p-2\",\r\n                    \"transition-colors\",\r\n                    \"duration-150\",\r\n                    viewMode === \"grid\"\r\n                      ? \"bg-primary-50 text-primary-600\"\r\n                      : \"bg-white text-neutral-500 hover:bg-neutral-50\",\r\n                  ].join(\" \")}\r\n                  aria-label=\"Grid view\"\r\n                >\r\n                  <GridIcon className=\"h-4 w-4\" />\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setViewMode(\"list\")}\r\n                  className={[\r\n                    \"p-2\",\r\n                    \"border-l\",\r\n                    \"border-neutral-200\",\r\n                    \"transition-colors\",\r\n                    \"duration-150\",\r\n                    viewMode === \"list\"\r\n                      ? \"bg-primary-50 text-primary-600\"\r\n                      : \"bg-white text-neutral-500 hover:bg-neutral-50\",\r\n                  ].join(\" \")}\r\n                  aria-label=\"List view\"\r\n                >\r\n                  <ListIcon className=\"h-4 w-4\" />\r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            {/* Component count */}\r\n            <span className=\"text-sm text-neutral-500 ml-auto\">\r\n              {filteredComponents.length} component{filteredComponents.length !== 1 ? \"s\" : \"\"}\r\n            </span>\r\n          </div>\r\n        )}\r\n\r\n        {/* Filter panel (collapsible) */}\r\n        {showFilters && showFilterPanel && (\r\n          <div className=\"flex flex-wrap gap-4 p-4 bg-white border border-neutral-200 rounded-lg\">\r\n            {/* Category filter */}\r\n            <div className=\"flex flex-col gap-2\">\r\n              <label className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide\">\r\n                Category\r\n              </label>\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {(\r\n                  [\"all\", \"atoms\", \"molecules\", \"organisms\", \"templates\", \"layouts\", \"containers\", \"custom\"] as const\r\n                ).map((category) => (\r\n                  <button\r\n                    key={category}\r\n                    type=\"button\"\r\n                    onClick={() => handleCategoryFilter(category)}\r\n                    className={[\r\n                      \"px-3\",\r\n                      \"py-1\",\r\n                      \"text-xs\",\r\n                      \"font-medium\",\r\n                      \"rounded-full\",\r\n                      \"border\",\r\n                      \"transition-colors\",\r\n                      \"duration-150\",\r\n                      filters.category === category\r\n                        ? \"bg-primary-100 border-primary-300 text-primary-700\"\r\n                        : \"bg-white border-neutral-200 text-neutral-600 hover:bg-neutral-50\",\r\n                    ].join(\" \")}\r\n                  >\r\n                    {category === \"all\" ? \"All\" : categoryLabels[category]}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Loading state */}\r\n        {isLoading && (\r\n          <div className={loadingStyles}>\r\n            <div className=\"flex items-center gap-3 text-neutral-500\">\r\n              <div className=\"h-5 w-5 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\r\n              <span>Loading components...</span>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Empty state */}\r\n        {!isLoading && filteredComponents.length === 0 && (\r\n          <div className={emptyStyles}>\r\n            <div className=\"h-12 w-12 mb-4 text-neutral-300\">\r\n              <ComponentIcon className=\"h-full w-full\" />\r\n            </div>\r\n            <p className=\"text-neutral-500\">{emptyMessage}</p>\r\n            {filters.search && (\r\n              <p className=\"text-sm text-neutral-400 mt-1\">\r\n                Try adjusting your search or filters\r\n              </p>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Component grid/list */}\r\n        {!isLoading && filteredComponents.length > 0 && (\r\n          <div className={contentStyles}>\r\n            {filteredComponents.map((component) => {\r\n              // Support both single-select (selectedId) and multi-select (selectedIds) modes\r\n              const isSelected = selectedIds.length > 0\r\n                ? selectedIds.includes(component.id)\r\n                : selectedId === component.id;\r\n\r\n              return (\r\n                <ComponentGalleryItem\r\n                  key={component.id}\r\n                  component={component}\r\n                  isSelected={isSelected}\r\n                  isMultiSelect={selectedIds.length > 0 || onSelectionChange !== undefined}\r\n                  viewMode={viewMode}\r\n                  draggable={draggable}\r\n                  onSelect={() => onSelect?.(component)}\r\n                  onSelectionChange={(selected) => onSelectionChange?.(component, selected)}\r\n                  onAdd={() => onAdd?.(component)}\r\n                  onInfo={() => onInfo?.(component)}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nComponentGallery.displayName = \"ComponentGallery\";\r\n\r\n/**\r\n * Component preview renderer - renders actual component from registry for thumbnails.\r\n */\r\nconst ComponentPreviewRenderer: React.FC<{ component: ComponentInfo }> = ({ component }) => {\r\n  const { id, type } = component;\r\n\r\n  // Specific visual previews for Containers & Layouts\r\n  if (id === 'container_fluid') {\r\n    return (\r\n      <div className=\"w-full h-full bg-indigo-50 border-2 border-dashed border-indigo-200 flex items-center justify-center rounded\">\r\n        <span className=\"text-[10px] font-medium text-indigo-400\">Fluid</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (id === 'container_header') {\r\n    return (\r\n      <div className=\"w-full h-full bg-neutral-50 border border-neutral-200 rounded flex flex-col overflow-hidden\">\r\n        <div className=\"h-6 w-full bg-indigo-100 border-b border-indigo-200 flex items-center px-1 gap-1\">\r\n          <div className=\"w-2 h-2 rounded-full bg-indigo-300\"></div>\r\n          <div className=\"w-8 h-1.5 bg-indigo-200 rounded-sm\"></div>\r\n        </div>\r\n        <div className=\"flex-1 bg-white\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (id === 'container_sidebar') {\r\n    return (\r\n      <div className=\"w-full h-full bg-neutral-50 border border-neutral-200 rounded flex overflow-hidden\">\r\n        <div className=\"w-6 h-full bg-indigo-100 border-r border-indigo-200 flex flex-col items-center py-1 gap-1\">\r\n          <div className=\"w-3 h-3 rounded bg-indigo-300 mb-1\"></div>\r\n          <div className=\"w-3 h-0.5 bg-indigo-200\"></div>\r\n          <div className=\"w-3 h-0.5 bg-indigo-200\"></div>\r\n        </div>\r\n        <div className=\"flex-1 bg-white\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (id === 'container_footer') {\r\n    return (\r\n      <div className=\"w-full h-full bg-neutral-50 border border-neutral-200 rounded flex flex-col justify-end overflow-hidden\">\r\n        <div className=\"flex-1 bg-white\"></div>\r\n        <div className=\"h-6 w-full bg-indigo-100 border-t border-indigo-200 flex items-center justify-center\">\r\n          <div className=\"w-12 h-1.5 bg-indigo-200 rounded-sm\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (id === 'container_card' || id === 'card_basic' || id === 'card_media') {\r\n    return (\r\n      <div className=\"w-full h-full flex items-center justify-center bg-neutral-50 p-2\">\r\n        <div className=\"w-full h-full bg-white border border-neutral-200 rounded shadow-sm flex flex-col overflow-hidden\">\r\n          {id === 'card_media' ? (\r\n            <div className=\"h-1/2 bg-neutral-100 border-b border-neutral-100 flex items-center justify-center\">\r\n              <div className=\"w-4 h-4 text-neutral-300\">\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" /><circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" /><polyline points=\"21 15 16 10 5 21\" /></svg>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"h-5 border-b border-neutral-100 bg-neutral-50\"></div>\r\n          )}\r\n          <div className=\"flex-1 p-1\">\r\n            <div className=\"w-3/4 h-1.5 bg-neutral-100 rounded-sm mb-1\"></div>\r\n            <div className=\"w-1/2 h-1.5 bg-neutral-100 rounded-sm\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (id === 'layout_split') {\r\n    return (\r\n      <div className=\"w-full h-full bg-white border border-neutral-200 rounded flex overflow-hidden\">\r\n        <div className=\"w-1/2 h-full bg-indigo-50 border-r border-indigo-100 flex items-center justify-center\">\r\n          <span className=\"text-[9px] text-indigo-300\">1</span>\r\n        </div>\r\n        <div className=\"w-1/2 h-full bg-white flex items-center justify-center\">\r\n          <span className=\"text-[9px] text-neutral-300\">2</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Fallback to Component Registry\r\n  const Component = getComponent(type);\r\n\r\n  // Provide sample props based on component type\r\n  const sampleProps: Record<string, Record<string, unknown>> = {\r\n    button: { children: \"Button\", variant: \"primary\", size: \"sm\" },\r\n    input: { placeholder: \"Input...\", size: \"sm\" },\r\n    select: {\r\n      options: [{ value: \"1\", label: \"Option\" }],\r\n      placeholder: \"Select\",\r\n      size: \"sm\"\r\n    },\r\n    checkbox: { label: \"Check\", size: \"sm\" },\r\n    panel: { children: \"Panel\", className: \"p-2 text-xs\" },\r\n    modal: { children: \"Modal\", isOpen: false },\r\n    card: { children: \"Card\", className: \"p-2 text-xs\" },\r\n    tabs: {\r\n      tabs: [{ id: \"1\", label: \"Tab\" }],\r\n      activeTab: \"1\",\r\n      size: \"sm\"\r\n    },\r\n    navigation: {\r\n      tabs: [{ id: \"1\", label: \"Nav\" }],\r\n      activeTab: \"1\",\r\n      size: \"sm\"\r\n    },\r\n  };\r\n\r\n  const props = sampleProps[type.toLowerCase()] || {};\r\n\r\n  try {\r\n    return <Component {...props} />;\r\n  } catch {\r\n    return <span className=\"text-xs text-neutral-400\">Preview</span>;\r\n  }\r\n};\r\n\r\n/**\r\n * Internal gallery item component.\r\n */\r\ninterface ComponentGalleryItemProps {\r\n  component: ComponentInfo;\r\n  isSelected: boolean;\r\n  isMultiSelect?: boolean;\r\n  viewMode: ViewMode;\r\n  draggable?: boolean;\r\n  onSelect?: () => void;\r\n  onSelectionChange?: (selected: boolean) => void;\r\n  onAdd?: () => void;\r\n  onInfo?: () => void;\r\n}\r\n\r\nconst ComponentGalleryItem: React.FC<ComponentGalleryItemProps> = ({\r\n  component,\r\n  isSelected,\r\n  isMultiSelect = false,\r\n  viewMode,\r\n  draggable = false,\r\n  onSelect,\r\n  onSelectionChange,\r\n  onAdd,\r\n  onInfo,\r\n}) => {\r\n  const isGrid = viewMode === \"grid\";\r\n\r\n  const handleDragStart = (e: React.DragEvent) => {\r\n    if (!draggable) return;\r\n    e.dataTransfer.setData(\"application/json\", JSON.stringify(component));\r\n    e.dataTransfer.effectAllowed = \"copy\";\r\n  };\r\n\r\n  const itemStyles = [\r\n    \"group\",\r\n    \"relative\",\r\n    \"bg-white\",\r\n    \"border\",\r\n    \"rounded-lg\",\r\n    \"cursor-pointer\",\r\n    \"transition-all\",\r\n    \"duration-150\",\r\n    isSelected\r\n      ? \"border-primary-500 ring-2 ring-primary-100\"\r\n      : \"border-neutral-200 hover:border-neutral-300 hover:shadow-sm\",\r\n    isGrid ? \"p-4\" : \"p-3 flex items-center gap-4\",\r\n    draggable && \"cursor-grab active:cursor-grabbing\",\r\n  ]\r\n    .filter(Boolean)\r\n    .join(\" \");\r\n\r\n  const handleClick = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    // In multi-select mode, toggle selection via checkbox\r\n    if (isMultiSelect) {\r\n      onSelectionChange?.(!isSelected);\r\n    } else {\r\n      onSelect?.();\r\n    }\r\n  };\r\n\r\n  const handleCheckboxChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    e.stopPropagation();\r\n    onSelectionChange?.(e.target.checked);\r\n  };\r\n\r\n  const handleAdd = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    onAdd?.();\r\n  };\r\n\r\n  const preventDrag = (e: React.DragEvent) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n  };\r\n\r\n  const handleInfo = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    onInfo?.();\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={itemStyles}\r\n      onClick={handleClick}\r\n      draggable={draggable}\r\n      onDragStart={handleDragStart}\r\n      role=\"button\"\r\n      tabIndex={0}\r\n      onKeyDown={(e) => {\r\n        if (e.key === 'Enter' || e.key === ' ') {\r\n          e.preventDefault();\r\n          handleClick(e as unknown as React.MouseEvent);\r\n        }\r\n      }}\r\n      aria-label={`${component.name} - ${component.description}`}\r\n      title={component.description}\r\n    >\r\n      {/* Multi-select checkbox (UJ-1.1.2) */}\r\n      {isMultiSelect && (\r\n        <div className=\"absolute top-3 right-3 z-10\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={isSelected}\r\n            onChange={handleCheckboxChange}\r\n            onClick={(e) => e.stopPropagation()}\r\n            className={[\r\n              \"h-4\",\r\n              \"w-4\",\r\n              \"rounded\",\r\n              \"border-neutral-300\",\r\n              \"text-primary-500\",\r\n              \"focus:ring-primary-500\",\r\n              \"focus:ring-offset-0\",\r\n              \"cursor-pointer\",\r\n              \"transition-colors\",\r\n            ].join(\" \")}\r\n            aria-label={`Select ${component.name}`}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Thumbnail or live preview */}\r\n      <div\r\n        className={[\r\n          \"flex\",\r\n          \"items-center\",\r\n          \"justify-center\",\r\n          \"bg-neutral-50\",\r\n          \"rounded-md\",\r\n          \"border\",\r\n          \"border-neutral-100\",\r\n          \"overflow-hidden\",\r\n          isGrid ? \"h-24 mb-3\" : \"h-12 w-12 shrink-0\",\r\n        ].join(\" \")}\r\n      >\r\n        {component.thumbnail ? (\r\n          <img\r\n            src={component.thumbnail}\r\n            alt={`${component.name} preview`}\r\n            className=\"h-full w-full object-contain p-2\"\r\n          />\r\n        ) : isComponentRegistered(component.type) ? (\r\n          <div className=\"w-full h-full transform scale-90 pointer-events-none flex items-center justify-center\">\r\n            <ComponentPreviewRenderer component={component} />\r\n          </div>\r\n        ) : (\r\n          <ComponentIcon className={isGrid ? \"h-10 w-10 text-neutral-300\" : \"h-6 w-6 text-neutral-300\"} />\r\n        )}\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className={isGrid ? \"\" : \"flex-1 min-w-0\"}>\r\n        {/* Category badge */}\r\n        <span\r\n          className={[\r\n            \"inline-flex\",\r\n            \"items-center\",\r\n            \"px-2\",\r\n            \"py-0.5\",\r\n            \"text-xs\",\r\n            \"font-medium\",\r\n            \"rounded\",\r\n            \"border\",\r\n            categoryColors[component.category],\r\n            isGrid ? \"mb-2\" : \"\",\r\n          ].join(\" \")}\r\n        >\r\n          {categoryLabels[component.category]}\r\n        </span>\r\n\r\n        {/* Name */}\r\n        <div className={isGrid ? \"mt-2\" : \"mt-1\"}>\r\n          <h4 className=\"text-sm font-semibold text-neutral-900 truncate\">\r\n            {component.name}\r\n            {component.builtIn && (\r\n              <span className=\"ml-1 text-xs font-normal text-neutral-400\">(built-in)</span>\r\n            )}\r\n          </h4>\r\n          {component.version && (\r\n            <span className=\"text-xs text-neutral-500\">v{component.version}</span>\r\n          )}\r\n        </div>\r\n\r\n        {/* Description */}\r\n        <p\r\n          className={[\r\n            \"text-sm\",\r\n            \"text-neutral-600\",\r\n            \"mt-1\",\r\n            isGrid ? \"line-clamp-2\" : \"truncate\",\r\n          ].join(\" \")}\r\n        >\r\n          {component.description}\r\n        </p>\r\n\r\n        {/* Tags */}\r\n        {isGrid && component.tags && component.tags.length > 0 && (\r\n          <div className=\"flex flex-wrap gap-1 mt-2\">\r\n            {component.tags.slice(0, 3).map((tag) => (\r\n              <span\r\n                key={tag}\r\n                className=\"px-1.5 py-0.5 text-xs bg-neutral-100 text-neutral-600 rounded\"\r\n              >\r\n                {tag}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Action buttons */}\r\n      <div\r\n        className={[\r\n          \"flex\",\r\n          \"items-center\",\r\n          \"gap-2\",\r\n          isGrid\r\n            ? \"absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-150\"\r\n            : \"\",\r\n        ].join(\" \")}\r\n      >\r\n        {onAdd && (\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleAdd}\r\n            onDragStart={preventDrag}\r\n            onDrag={preventDrag}\r\n            draggable={false}\r\n            className={[\r\n              \"px-3\",\r\n              \"py-1.5\",\r\n              \"text-xs\",\r\n              \"font-medium\",\r\n              \"rounded-md\",\r\n              \"bg-primary-500\",\r\n              \"text-white\",\r\n              \"hover:bg-primary-600\",\r\n              \"transition-colors\",\r\n              \"duration-150\",\r\n            ].join(\" \")}\r\n          >\r\n            Add\r\n          </button>\r\n        )}\r\n        {onInfo && (\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleInfo}\r\n            onDragStart={preventDrag}\r\n            onDrag={preventDrag}\r\n            draggable={false}\r\n            className={[\r\n              \"p-1.5\",\r\n              \"rounded-md\",\r\n              \"text-neutral-500\",\r\n              \"hover:text-neutral-700\",\r\n              \"hover:bg-neutral-100\",\r\n              \"transition-colors\",\r\n              \"duration-150\",\r\n            ].join(\" \")}\r\n            title=\"More info\"\r\n          >\r\n            <svg\r\n              className=\"h-4 w-4\"\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              viewBox=\"0 0 24 24\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"2\"\r\n            >\r\n              <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n              <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\" />\r\n              <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" />\r\n            </svg>\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ComponentGallery;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ExportModal.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":717,"column":38,"nodeType":"Identifier","messageId":"invalidType","endLine":717,"endColumn":46}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * D047 - src/components/factory/ExportModal.tsx\r\n * ===============================================\r\n * Export configuration modal for project export settings.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D015 (Modal.tsx)\r\n *\r\n * Rules:\r\n *   - NO hardcoded colors, spacing, or sizes\r\n *   - ALL styling via Tailwind classes referencing design tokens\r\n *   - Fully typed props with TypeScript\r\n */\r\n\r\nimport React, { forwardRef, useState, useCallback, type HTMLAttributes } from \"react\";\r\n\r\n/**\r\n * Export format options.\r\n */\r\nexport type ExportFormat = \"tauri\" | \"electron\" | \"web\" | \"react-native\";\r\n\r\n/**\r\n * Build target options.\r\n */\r\nexport type BuildTarget = \"windows\" | \"macos\" | \"linux\" | \"all\";\r\n\r\n/**\r\n * Export configuration.\r\n */\r\nexport interface ExportConfig {\r\n  /** Export format */\r\n  format: ExportFormat;\r\n  /** Build targets */\r\n  targets: BuildTarget[];\r\n  /** Output directory */\r\n  outputDir: string;\r\n  /** Project name */\r\n  projectName: string;\r\n  /** Version string */\r\n  version: string;\r\n  /** Include plugins */\r\n  includePlugins: boolean;\r\n  /** Plugin IDs to include */\r\n  selectedPlugins: string[];\r\n  /** Bundle Python runtime */\r\n  bundlePython: boolean;\r\n  /** Enable code signing */\r\n  codeSign: boolean;\r\n  /** Create installer */\r\n  createInstaller: boolean;\r\n  /** Installer type */\r\n  installerType?: \"msi\" | \"exe\" | \"dmg\" | \"deb\" | \"appimage\";\r\n  /** Minify code */\r\n  minify: boolean;\r\n  /** Source maps */\r\n  sourceMaps: boolean;\r\n  /** Environment */\r\n  environment: \"development\" | \"production\";\r\n}\r\n\r\n/**\r\n * Available plugin info for selection.\r\n */\r\nexport interface AvailablePlugin {\r\n  id: string;\r\n  name: string;\r\n  required?: boolean;\r\n}\r\n\r\n/**\r\n * ExportModal component props.\r\n */\r\nexport interface ExportModalProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSubmit\"> {\r\n  /** Whether modal is open */\r\n  isOpen: boolean;\r\n  /** Callback to close modal */\r\n  onClose: () => void;\r\n  /** Callback when export is triggered */\r\n  onExport: (config: ExportConfig) => void;\r\n  /** Initial configuration */\r\n  initialConfig?: Partial<ExportConfig>;\r\n  /** Available plugins for selection */\r\n  availablePlugins?: AvailablePlugin[];\r\n  /** Whether export is in progress */\r\n  isExporting?: boolean;\r\n  /** Export progress (0-100) */\r\n  progress?: number;\r\n  /** Export status message */\r\n  statusMessage?: string;\r\n}\r\n\r\n/**\r\n * Close icon.\r\n */\r\nconst CloseIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Folder icon.\r\n */\r\nconst FolderIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Export icon.\r\n */\r\nconst ExportIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\r\n    <polyline points=\"17 8 12 3 7 8\" />\r\n    <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Format descriptions.\r\n */\r\nconst formatDescriptions: Record<ExportFormat, { label: string; description: string }> = {\r\n  tauri: {\r\n    label: \"Tauri\",\r\n    description: \"Native desktop app with Rust backend (recommended)\",\r\n  },\r\n  electron: {\r\n    label: \"Electron\",\r\n    description: \"Cross-platform desktop using Node.js\",\r\n  },\r\n  web: {\r\n    label: \"Web App\",\r\n    description: \"Progressive Web App for browsers\",\r\n  },\r\n  \"react-native\": {\r\n    label: \"React Native\",\r\n    description: \"Mobile app for iOS and Android\",\r\n  },\r\n};\r\n\r\n/**\r\n * Target labels.\r\n */\r\nconst targetLabels: Record<BuildTarget, string> = {\r\n  windows: \"Windows\",\r\n  macos: \"macOS\",\r\n  linux: \"Linux\",\r\n  all: \"All Platforms\",\r\n};\r\n\r\n/**\r\n * Default export configuration.\r\n */\r\nconst defaultConfig: ExportConfig = {\r\n  format: \"tauri\",\r\n  targets: [\"windows\"],\r\n  outputDir: \"./dist\",\r\n  projectName: \"my-app\",\r\n  version: \"1.0.0\",\r\n  includePlugins: true,\r\n  selectedPlugins: [],\r\n  bundlePython: true,\r\n  codeSign: false,\r\n  createInstaller: true,\r\n  installerType: \"msi\",\r\n  minify: true,\r\n  sourceMaps: false,\r\n  environment: \"production\",\r\n};\r\n\r\n/**\r\n * ExportModal component.\r\n *\r\n * A modal dialog for configuring project export settings including\r\n * format, targets, plugins, and build options.\r\n *\r\n * @example\r\n * ```tsx\r\n * <ExportModal\r\n *   isOpen={showExport}\r\n *   onClose={() => setShowExport(false)}\r\n *   onExport={(config) => exportProject(config)}\r\n *   availablePlugins={plugins}\r\n * />\r\n * ```\r\n */\r\nexport const ExportModal = forwardRef<HTMLDivElement, ExportModalProps>(\r\n  (\r\n    {\r\n      isOpen,\r\n      onClose,\r\n      onExport,\r\n      initialConfig,\r\n      availablePlugins = [],\r\n      isExporting = false,\r\n      progress = 0,\r\n      statusMessage,\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    // State\r\n    const [config, setConfig] = useState<ExportConfig>({\r\n      ...defaultConfig,\r\n      ...initialConfig,\r\n    });\r\n    const [activeTab, setActiveTab] = useState<\"general\" | \"plugins\" | \"build\">(\"general\");\r\n\r\n    // Update config\r\n    const updateConfig = useCallback(<K extends keyof ExportConfig>(key: K, value: ExportConfig[K]) => {\r\n      setConfig((prev) => ({ ...prev, [key]: value }));\r\n    }, []);\r\n\r\n    // Toggle target\r\n    const toggleTarget = useCallback((target: BuildTarget) => {\r\n      setConfig((prev) => {\r\n        if (target === \"all\") {\r\n          return { ...prev, targets: [\"all\"] };\r\n        }\r\n        const newTargets = prev.targets.filter((t) => t !== \"all\");\r\n        if (newTargets.includes(target)) {\r\n          return { ...prev, targets: newTargets.filter((t) => t !== target) };\r\n        }\r\n        return { ...prev, targets: [...newTargets, target] };\r\n      });\r\n    }, []);\r\n\r\n    // Toggle plugin\r\n    const togglePlugin = useCallback((pluginId: string) => {\r\n      setConfig((prev) => {\r\n        if (prev.selectedPlugins.includes(pluginId)) {\r\n          return { ...prev, selectedPlugins: prev.selectedPlugins.filter((id) => id !== pluginId) };\r\n        }\r\n        return { ...prev, selectedPlugins: [...prev.selectedPlugins, pluginId] };\r\n      });\r\n    }, []);\r\n\r\n    // Handle export\r\n    const handleExport = useCallback(() => {\r\n      onExport(config);\r\n    }, [config, onExport]);\r\n\r\n    // Handle close\r\n    const handleClose = useCallback(() => {\r\n      if (!isExporting) {\r\n        onClose();\r\n      }\r\n    }, [isExporting, onClose]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    // Tab button styles\r\n    const tabStyles = (isActive: boolean) =>\r\n      [\r\n        \"px-4\",\r\n        \"py-2\",\r\n        \"text-sm\",\r\n        \"font-medium\",\r\n        \"border-b-2\",\r\n        \"transition-colors\",\r\n        \"duration-150\",\r\n        isActive\r\n          ? \"border-primary-500 text-primary-600\"\r\n          : \"border-transparent text-neutral-500 hover:text-neutral-700 hover:border-neutral-300\",\r\n      ].join(\" \");\r\n\r\n    // Input styles\r\n    const inputStyles = [\r\n      \"w-full\",\r\n      \"px-3\",\r\n      \"py-2\",\r\n      \"text-sm\",\r\n      \"bg-white\",\r\n      \"border\",\r\n      \"border-neutral-200\",\r\n      \"rounded-md\",\r\n      \"focus:outline-none\",\r\n      \"focus:ring-2\",\r\n      \"focus:ring-primary-500\",\r\n      \"focus:border-transparent\",\r\n    ].join(\" \");\r\n\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={[\r\n          \"fixed\",\r\n          \"inset-0\",\r\n          \"z-modal\",\r\n          \"flex\",\r\n          \"items-center\",\r\n          \"justify-center\",\r\n          \"p-4\",\r\n          className,\r\n        ].join(\" \")}\r\n        {...props}\r\n      >\r\n        {/* Backdrop */}\r\n        <div\r\n          className=\"absolute inset-0 bg-neutral-900/50\"\r\n          onClick={handleClose}\r\n          aria-hidden=\"true\"\r\n        />\r\n\r\n        {/* Modal */}\r\n        <div className=\"relative bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-neutral-200\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <ExportIcon className=\"h-5 w-5 text-primary-500\" />\r\n              <h2 className=\"text-lg font-semibold text-neutral-900\">Export Project</h2>\r\n            </div>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleClose}\r\n              disabled={isExporting}\r\n              className={[\r\n                \"p-1.5\",\r\n                \"rounded-md\",\r\n                \"text-neutral-400\",\r\n                \"hover:text-neutral-600\",\r\n                \"hover:bg-neutral-100\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n                isExporting && \"opacity-50 cursor-not-allowed\",\r\n              ].join(\" \")}\r\n            >\r\n              <CloseIcon className=\"h-5 w-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Tabs */}\r\n          <div className=\"flex border-b border-neutral-200 px-6\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setActiveTab(\"general\")}\r\n              className={tabStyles(activeTab === \"general\")}\r\n            >\r\n              General\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setActiveTab(\"plugins\")}\r\n              className={tabStyles(activeTab === \"plugins\")}\r\n            >\r\n              Plugins\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setActiveTab(\"build\")}\r\n              className={tabStyles(activeTab === \"build\")}\r\n            >\r\n              Build Options\r\n            </button>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 overflow-auto p-6\">\r\n            {/* General Tab */}\r\n            {activeTab === \"general\" && (\r\n              <div className=\"space-y-6\">\r\n                {/* Project Info */}\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                      Project Name\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={config.projectName}\r\n                      onChange={(e) => updateConfig(\"projectName\", e.target.value)}\r\n                      className={inputStyles}\r\n                      disabled={isExporting}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                      Version\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={config.version}\r\n                      onChange={(e) => updateConfig(\"version\", e.target.value)}\r\n                      placeholder=\"1.0.0\"\r\n                      className={inputStyles}\r\n                      disabled={isExporting}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Output Directory */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                    Output Directory\r\n                  </label>\r\n                  <div className=\"flex gap-2\">\r\n                    <input\r\n                      type=\"text\"\r\n                      value={config.outputDir}\r\n                      onChange={(e) => updateConfig(\"outputDir\", e.target.value)}\r\n                      className={[inputStyles, \"flex-1\"].join(\" \")}\r\n                      disabled={isExporting}\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      className={[\r\n                        \"px-3\",\r\n                        \"py-2\",\r\n                        \"border\",\r\n                        \"border-neutral-200\",\r\n                        \"rounded-md\",\r\n                        \"text-neutral-600\",\r\n                        \"hover:bg-neutral-50\",\r\n                        \"transition-colors\",\r\n                        \"duration-150\",\r\n                      ].join(\" \")}\r\n                      disabled={isExporting}\r\n                    >\r\n                      <FolderIcon className=\"h-5 w-5\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Export Format */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-neutral-700 mb-2\">\r\n                    Export Format\r\n                  </label>\r\n                  <div className=\"grid grid-cols-2 gap-3\">\r\n                    {(Object.keys(formatDescriptions) as ExportFormat[]).map((format) => (\r\n                      <button\r\n                        key={format}\r\n                        type=\"button\"\r\n                        onClick={() => updateConfig(\"format\", format)}\r\n                        disabled={isExporting}\r\n                        className={[\r\n                          \"flex\",\r\n                          \"flex-col\",\r\n                          \"items-start\",\r\n                          \"p-3\",\r\n                          \"border-2\",\r\n                          \"rounded-lg\",\r\n                          \"text-left\",\r\n                          \"transition-all\",\r\n                          \"duration-150\",\r\n                          config.format === format\r\n                            ? \"border-primary-500 bg-primary-50\"\r\n                            : \"border-neutral-200 hover:border-neutral-300\",\r\n                          isExporting && \"opacity-50 cursor-not-allowed\",\r\n                        ].join(\" \")}\r\n                      >\r\n                        <span className=\"text-sm font-medium text-neutral-900\">\r\n                          {formatDescriptions[format].label}\r\n                        </span>\r\n                        <span className=\"text-xs text-neutral-500 mt-0.5\">\r\n                          {formatDescriptions[format].description}\r\n                        </span>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Build Targets */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-neutral-700 mb-2\">\r\n                    Build Targets\r\n                  </label>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {(Object.keys(targetLabels) as BuildTarget[]).map((target) => (\r\n                      <button\r\n                        key={target}\r\n                        type=\"button\"\r\n                        onClick={() => toggleTarget(target)}\r\n                        disabled={isExporting}\r\n                        className={[\r\n                          \"px-3\",\r\n                          \"py-1.5\",\r\n                          \"text-sm\",\r\n                          \"font-medium\",\r\n                          \"rounded-full\",\r\n                          \"border\",\r\n                          \"transition-colors\",\r\n                          \"duration-150\",\r\n                          config.targets.includes(target)\r\n                            ? \"bg-primary-100 border-primary-300 text-primary-700\"\r\n                            : \"bg-white border-neutral-200 text-neutral-600 hover:bg-neutral-50\",\r\n                          isExporting && \"opacity-50 cursor-not-allowed\",\r\n                        ].join(\" \")}\r\n                      >\r\n                        {targetLabels[target]}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Plugins Tab */}\r\n            {activeTab === \"plugins\" && (\r\n              <div className=\"space-y-4\">\r\n                {/* Include plugins toggle */}\r\n                <label className=\"flex items-center gap-3 p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={config.includePlugins}\r\n                    onChange={(e) => updateConfig(\"includePlugins\", e.target.checked)}\r\n                    disabled={isExporting}\r\n                    className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n                  />\r\n                  <div>\r\n                    <span className=\"text-sm font-medium text-neutral-900\">Include Plugins</span>\r\n                    <p className=\"text-xs text-neutral-500\">Bundle selected plugins with export</p>\r\n                  </div>\r\n                </label>\r\n\r\n                {/* Plugin selection */}\r\n                {config.includePlugins && (\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"block text-sm font-medium text-neutral-700\">\r\n                      Select Plugins\r\n                    </label>\r\n                    {availablePlugins.length === 0 ? (\r\n                      <p className=\"text-sm text-neutral-500 italic\">No plugins available</p>\r\n                    ) : (\r\n                      <div className=\"border border-neutral-200 rounded-lg divide-y divide-neutral-100\">\r\n                        {availablePlugins.map((plugin) => (\r\n                          <label\r\n                            key={plugin.id}\r\n                            className={[\r\n                              \"flex\",\r\n                              \"items-center\",\r\n                              \"gap-3\",\r\n                              \"p-3\",\r\n                              \"cursor-pointer\",\r\n                              \"hover:bg-neutral-50\",\r\n                              plugin.required && \"bg-neutral-50\",\r\n                            ].join(\" \")}\r\n                          >\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              checked={config.selectedPlugins.includes(plugin.id) || plugin.required}\r\n                              onChange={() => !plugin.required && togglePlugin(plugin.id)}\r\n                              disabled={isExporting || plugin.required}\r\n                              className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n                            />\r\n                            <span className=\"text-sm text-neutral-900\">{plugin.name}</span>\r\n                            {plugin.required && (\r\n                              <span className=\"px-1.5 py-0.5 text-xs bg-neutral-200 text-neutral-600 rounded\">\r\n                                Required\r\n                              </span>\r\n                            )}\r\n                          </label>\r\n                        ))}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n\r\n                {/* Bundle Python */}\r\n                <label className=\"flex items-center gap-3 p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={config.bundlePython}\r\n                    onChange={(e) => updateConfig(\"bundlePython\", e.target.checked)}\r\n                    disabled={isExporting}\r\n                    className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n                  />\r\n                  <div>\r\n                    <span className=\"text-sm font-medium text-neutral-900\">Bundle Python Runtime</span>\r\n                    <p className=\"text-xs text-neutral-500\">\r\n                      Include Python interpreter (increases bundle size)\r\n                    </p>\r\n                  </div>\r\n                </label>\r\n              </div>\r\n            )}\r\n\r\n            {/* Build Options Tab */}\r\n            {activeTab === \"build\" && (\r\n              <div className=\"space-y-4\">\r\n                {/* Environment */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-neutral-700 mb-2\">\r\n                    Environment\r\n                  </label>\r\n                  <div className=\"flex gap-3\">\r\n                    {([\"development\", \"production\"] as const).map((env) => (\r\n                      <button\r\n                        key={env}\r\n                        type=\"button\"\r\n                        onClick={() => updateConfig(\"environment\", env)}\r\n                        disabled={isExporting}\r\n                        className={[\r\n                          \"flex-1\",\r\n                          \"px-4\",\r\n                          \"py-2\",\r\n                          \"text-sm\",\r\n                          \"font-medium\",\r\n                          \"rounded-lg\",\r\n                          \"border-2\",\r\n                          \"transition-colors\",\r\n                          \"duration-150\",\r\n                          config.environment === env\r\n                            ? \"border-primary-500 bg-primary-50 text-primary-700\"\r\n                            : \"border-neutral-200 text-neutral-600 hover:bg-neutral-50\",\r\n                        ].join(\" \")}\r\n                      >\r\n                        {env.charAt(0).toUpperCase() + env.slice(1)}\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Build options */}\r\n                <div className=\"space-y-3\">\r\n                  <label className=\"flex items-center gap-3 p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={config.minify}\r\n                      onChange={(e) => updateConfig(\"minify\", e.target.checked)}\r\n                      disabled={isExporting}\r\n                      className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n                    />\r\n                    <div>\r\n                      <span className=\"text-sm font-medium text-neutral-900\">Minify Code</span>\r\n                      <p className=\"text-xs text-neutral-500\">Reduce bundle size by minifying</p>\r\n                    </div>\r\n                  </label>\r\n\r\n                  <label className=\"flex items-center gap-3 p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={config.sourceMaps}\r\n                      onChange={(e) => updateConfig(\"sourceMaps\", e.target.checked)}\r\n                      disabled={isExporting}\r\n                      className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n                    />\r\n                    <div>\r\n                      <span className=\"text-sm font-medium text-neutral-900\">Source Maps</span>\r\n                      <p className=\"text-xs text-neutral-500\">Generate source maps for debugging</p>\r\n                    </div>\r\n                  </label>\r\n\r\n                  <label className=\"flex items-center gap-3 p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={config.codeSign}\r\n                      onChange={(e) => updateConfig(\"codeSign\", e.target.checked)}\r\n                      disabled={isExporting}\r\n                      className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n                    />\r\n                    <div>\r\n                      <span className=\"text-sm font-medium text-neutral-900\">Code Signing</span>\r\n                      <p className=\"text-xs text-neutral-500\">Sign executable (requires certificate)</p>\r\n                    </div>\r\n                  </label>\r\n\r\n                  <label className=\"flex items-center gap-3 p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={config.createInstaller}\r\n                      onChange={(e) => updateConfig(\"createInstaller\", e.target.checked)}\r\n                      disabled={isExporting}\r\n                      className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n                    />\r\n                    <div>\r\n                      <span className=\"text-sm font-medium text-neutral-900\">Create Installer</span>\r\n                      <p className=\"text-xs text-neutral-500\">Generate platform-specific installer</p>\r\n                    </div>\r\n                  </label>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Progress bar (when exporting) */}\r\n          {isExporting && (\r\n            <div className=\"px-6 py-3 bg-neutral-50 border-t border-neutral-200\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <span className=\"text-sm font-medium text-neutral-700\">Exporting...</span>\r\n                <span className=\"text-sm text-neutral-500\">{progress}%</span>\r\n              </div>\r\n              <div className=\"h-2 bg-neutral-200 rounded-full overflow-hidden\">\r\n                <div\r\n                  className=\"h-full bg-primary-500 transition-all duration-300\"\r\n                  style={{ width: `${progress}%` }}\r\n                />\r\n              </div>\r\n              {statusMessage && (\r\n                <p className=\"text-xs text-neutral-500 mt-1\">{statusMessage}</p>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Footer */}\r\n          <div className=\"flex items-center justify-end gap-3 px-6 py-4 bg-neutral-50 border-t border-neutral-200\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleClose}\r\n              disabled={isExporting}\r\n              className={[\r\n                \"px-4\",\r\n                \"py-2\",\r\n                \"text-sm\",\r\n                \"font-medium\",\r\n                \"text-neutral-700\",\r\n                \"bg-white\",\r\n                \"border\",\r\n                \"border-neutral-200\",\r\n                \"rounded-lg\",\r\n                \"hover:bg-neutral-50\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n                isExporting && \"opacity-50 cursor-not-allowed\",\r\n              ].join(\" \")}\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleExport}\r\n              disabled={isExporting || config.targets.length === 0}\r\n              className={[\r\n                \"flex\",\r\n                \"items-center\",\r\n                \"gap-2\",\r\n                \"px-4\",\r\n                \"py-2\",\r\n                \"text-sm\",\r\n                \"font-medium\",\r\n                \"text-white\",\r\n                \"bg-primary-600\",\r\n                \"rounded-lg\",\r\n                \"hover:bg-primary-700\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n                (isExporting || config.targets.length === 0) && \"opacity-50 cursor-not-allowed\",\r\n              ].join(\" \")}\r\n            >\r\n              {isExporting ? (\r\n                <>\r\n                  <div className=\"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\r\n                  <span>Exporting...</span>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <ExportIcon className=\"h-4 w-4\" />\r\n                  <span>Export</span>\r\n                </>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nExportModal.displayName = \"ExportModal\";\r\n\r\nexport default ExportModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\FactoryLayout.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":432,"column":28,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":432,"endColumn":30,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[14256,14258],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * D049 - src/components/factory/FactoryLayout.tsx\r\n * =================================================\r\n * Main factory layout component orchestrating all factory panels.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D006, D007, D040-D048 (all Phase 4 components)\r\n *\r\n * Rules:\r\n *   - NO hardcoded colors, spacing, or sizes\r\n *   - ALL styling via Tailwind classes referencing design tokens\r\n *   - Fully typed props with TypeScript\r\n */\r\n\r\nimport React, { forwardRef, useState, useCallback, type HTMLAttributes, type ReactNode } from \"react\";\r\n\r\n/**\r\n * Panel types available in the factory.\r\n */\r\nexport type PanelType =\r\n  | \"plugins\"\r\n  | \"components\"\r\n  | \"tree\"\r\n  | \"canvas\"\r\n  | \"preview\"\r\n  | \"properties\"\r\n  | \"none\";\r\n\r\n/**\r\n * Panel configuration.\r\n */\r\nexport interface PanelConfig {\r\n  /** Panel type */\r\n  type: PanelType;\r\n  /** Whether panel is visible */\r\n  visible: boolean;\r\n  /** Panel width (for side panels) or height (for bottom panels) */\r\n  size?: number;\r\n  /** Minimum size */\r\n  minSize?: number;\r\n  /** Maximum size */\r\n  maxSize?: number;\r\n}\r\n\r\n/**\r\n * Layout preset configurations.\r\n */\r\nexport type LayoutPreset = \"default\" | \"canvas-focus\" | \"preview-focus\" | \"split\";\r\n\r\n/**\r\n * FactoryLayout component props.\r\n */\r\nexport interface FactoryLayoutProps extends Omit<HTMLAttributes<HTMLDivElement>, \"children\"> {\r\n  /** Left sidebar content */\r\n  leftSidebar?: ReactNode;\r\n  /** Right sidebar content */\r\n  rightSidebar?: ReactNode;\r\n  /** Main content (canvas) */\r\n  mainContent?: ReactNode;\r\n  /** Bottom panel content */\r\n  bottomPanel?: ReactNode;\r\n  /** Header content */\r\n  header?: ReactNode;\r\n  /** Initial panel configurations */\r\n  initialPanels?: {\r\n    left?: PanelConfig;\r\n    right?: PanelConfig;\r\n    bottom?: PanelConfig;\r\n  };\r\n  /** Layout preset */\r\n  preset?: LayoutPreset;\r\n  /** Whether panels are resizable */\r\n  resizable?: boolean;\r\n  /** Whether panels are collapsible */\r\n  collapsible?: boolean;\r\n  /** Callback when panel visibility changes */\r\n  onPanelToggle?: (panel: \"left\" | \"right\" | \"bottom\", visible: boolean) => void;\r\n  /** Callback when panel is resized */\r\n  onPanelResize?: (panel: \"left\" | \"right\" | \"bottom\", size: number) => void;\r\n}\r\n\r\n/**\r\n * Chevron icons.\r\n */\r\nconst ChevronLeftIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <polyline points=\"15 18 9 12 15 6\" />\r\n  </svg>\r\n);\r\n\r\nconst ChevronRightIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <polyline points=\"9 18 15 12 9 6\" />\r\n  </svg>\r\n);\r\n\r\nconst ChevronDownIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <polyline points=\"6 9 12 15 18 9\" />\r\n  </svg>\r\n);\r\n\r\nconst ChevronUpIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n    <polyline points=\"18 15 12 9 6 15\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Panel icons.\r\n */\r\nconst _PanelIcons: Record<string, React.FC<{ className?: string }>> = {\r\n  plugins: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <path d=\"M12 2L2 7l10 5 10-5-10-5z\" />\r\n      <path d=\"M2 17l10 5 10-5\" />\r\n      <path d=\"M2 12l10 5 10-5\" />\r\n    </svg>\r\n  ),\r\n  components: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n      <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\r\n    </svg>\r\n  ),\r\n  tree: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <line x1=\"6\" y1=\"3\" x2=\"6\" y2=\"15\" />\r\n      <circle cx=\"18\" cy=\"6\" r=\"3\" />\r\n      <circle cx=\"6\" cy=\"6\" r=\"3\" />\r\n      <path d=\"M6 21c0-4.5 5-4 9-4\" />\r\n      <circle cx=\"18\" cy=\"17\" r=\"3\" />\r\n    </svg>\r\n  ),\r\n  properties: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n      <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\r\n    </svg>\r\n  ),\r\n};\r\n\r\n/**\r\n * Default panel sizes.\r\n */\r\nconst defaultPanelSizes = {\r\n  left: { size: 280, minSize: 200, maxSize: 400 },\r\n  right: { size: 300, minSize: 240, maxSize: 450 },\r\n  bottom: { size: 200, minSize: 120, maxSize: 400 },\r\n};\r\n\r\n/**\r\n * Layout presets.\r\n */\r\nconst layoutPresets: Record<LayoutPreset, { left: boolean; right: boolean; bottom: boolean }> = {\r\n  default: { left: true, right: true, bottom: false },\r\n  \"canvas-focus\": { left: false, right: false, bottom: false },\r\n  \"preview-focus\": { left: false, right: true, bottom: false },\r\n  split: { left: true, right: true, bottom: true },\r\n};\r\n\r\n/**\r\n * FactoryLayout component.\r\n *\r\n * The main layout component for the App Factory, providing a resizable\r\n * panel-based layout with sidebars, main content area, and bottom panel.\r\n *\r\n * @example\r\n * ```tsx\r\n * <FactoryLayout\r\n *   header={<ToolbarHeader />}\r\n *   leftSidebar={<PluginGallery />}\r\n *   mainContent={<CanvasEditor />}\r\n *   rightSidebar={<PropertyInspector />}\r\n *   bottomPanel={<PreviewPanel />}\r\n *   preset=\"default\"\r\n *   resizable\r\n *   collapsible\r\n * />\r\n * ```\r\n */\r\nexport const FactoryLayout = forwardRef<HTMLDivElement, FactoryLayoutProps>(\r\n  (\r\n    {\r\n      leftSidebar,\r\n      rightSidebar,\r\n      mainContent,\r\n      bottomPanel,\r\n      header,\r\n      initialPanels,\r\n      preset = \"default\",\r\n      resizable = true,\r\n      collapsible = true,\r\n      onPanelToggle,\r\n      onPanelResize,\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    // Panel state\r\n    const [leftVisible, setLeftVisible] = useState(\r\n      initialPanels?.left?.visible ?? layoutPresets[preset].left\r\n    );\r\n    const [rightVisible, setRightVisible] = useState(\r\n      initialPanels?.right?.visible ?? layoutPresets[preset].right\r\n    );\r\n    const [bottomVisible, setBottomVisible] = useState(\r\n      initialPanels?.bottom?.visible ?? layoutPresets[preset].bottom\r\n    );\r\n\r\n    const [leftSize, setLeftSize] = useState(\r\n      initialPanels?.left?.size ?? defaultPanelSizes.left.size\r\n    );\r\n    const [rightSize, setRightSize] = useState(\r\n      initialPanels?.right?.size ?? defaultPanelSizes.right.size\r\n    );\r\n    const [bottomSize, setBottomSize] = useState(\r\n      initialPanels?.bottom?.size ?? defaultPanelSizes.bottom.size\r\n    );\r\n\r\n    // Resize state\r\n    const [isResizing, setIsResizing] = useState<\"left\" | \"right\" | \"bottom\" | null>(null);\r\n\r\n    // Toggle panel visibility\r\n    const togglePanel = useCallback(\r\n      (panel: \"left\" | \"right\" | \"bottom\") => {\r\n        switch (panel) {\r\n          case \"left\":\r\n            setLeftVisible((v) => {\r\n              onPanelToggle?.(panel, !v);\r\n              return !v;\r\n            });\r\n            break;\r\n          case \"right\":\r\n            setRightVisible((v) => {\r\n              onPanelToggle?.(panel, !v);\r\n              return !v;\r\n            });\r\n            break;\r\n          case \"bottom\":\r\n            setBottomVisible((v) => {\r\n              onPanelToggle?.(panel, !v);\r\n              return !v;\r\n            });\r\n            break;\r\n        }\r\n      },\r\n      [onPanelToggle]\r\n    );\r\n\r\n    // Handle resize start\r\n    const handleResizeStart = useCallback(\r\n      (panel: \"left\" | \"right\" | \"bottom\") => {\r\n        if (!resizable) return;\r\n        setIsResizing(panel);\r\n      },\r\n      [resizable]\r\n    );\r\n\r\n    // Handle resize move\r\n    const handleResizeMove = useCallback(\r\n      (e: React.MouseEvent) => {\r\n        if (!isResizing) return;\r\n\r\n        const minSize = defaultPanelSizes[isResizing].minSize;\r\n        const maxSize = defaultPanelSizes[isResizing].maxSize;\r\n\r\n        switch (isResizing) {\r\n          case \"left\": {\r\n            const newSize = Math.min(maxSize, Math.max(minSize, e.clientX));\r\n            setLeftSize(newSize);\r\n            onPanelResize?.(isResizing, newSize);\r\n            break;\r\n          }\r\n          case \"right\": {\r\n            const newSize = Math.min(maxSize, Math.max(minSize, window.innerWidth - e.clientX));\r\n            setRightSize(newSize);\r\n            onPanelResize?.(isResizing, newSize);\r\n            break;\r\n          }\r\n          case \"bottom\": {\r\n            const newSize = Math.min(maxSize, Math.max(minSize, window.innerHeight - e.clientY));\r\n            setBottomSize(newSize);\r\n            onPanelResize?.(isResizing, newSize);\r\n            break;\r\n          }\r\n        }\r\n      },\r\n      [isResizing, onPanelResize]\r\n    );\r\n\r\n    // Handle resize end\r\n    const handleResizeEnd = useCallback(() => {\r\n      setIsResizing(null);\r\n    }, []);\r\n\r\n    // Container styles\r\n    const containerStyles = [\r\n      \"flex\",\r\n      \"flex-col\",\r\n      \"h-screen\",\r\n      \"w-screen\",\r\n      \"bg-neutral-100\",\r\n      \"overflow-hidden\",\r\n      isResizing === \"left\" && \"select-none cursor-ew-resize\",\r\n      isResizing === \"right\" && \"select-none cursor-ew-resize\",\r\n      isResizing === \"bottom\" && \"select-none cursor-ns-resize\",\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(\" \");\r\n\r\n    // Sidebar styles\r\n    const sidebarStyles = (visible: boolean, side: \"left\" | \"right\") =>\r\n      [\r\n        \"relative\", // Required for absolute positioned resize handle\r\n        \"flex\",\r\n        \"flex-col\",\r\n        \"bg-white\",\r\n        \"border-neutral-200\",\r\n        \"transition-all\",\r\n        \"duration-200\",\r\n        side === \"left\" ? \"border-r\" : \"border-l\",\r\n        !visible && \"w-0 overflow-hidden\",\r\n      ]\r\n        .filter(Boolean)\r\n        .join(\" \");\r\n\r\n    // Resize handle styles\r\n    // Using w-2 (8px) for better hit target while keeping visual appearance subtle\r\n    const resizeHandleStyles = (orientation: \"vertical\" | \"horizontal\") =>\r\n      [\r\n        \"absolute\",\r\n        \"bg-transparent\",\r\n        \"hover:bg-primary-300/50\",\r\n        \"transition-colors\",\r\n        \"duration-150\",\r\n        \"z-20\",\r\n        orientation === \"vertical\"\r\n          ? \"w-2 h-full top-0 cursor-ew-resize\" // cursor-ew-resize is the double-ended horizontal arrow\r\n          : \"h-2 w-full left-0 cursor-ns-resize\", // cursor-ns-resize is the double-ended vertical arrow\r\n        isResizing && \"bg-primary-400/70\",\r\n      ]\r\n        .filter(Boolean)\r\n        .join(\" \");\r\n\r\n    // Collapse button styles\r\n    const collapseButtonStyles = (_visible: boolean) =>\r\n      [\r\n        \"flex\",\r\n        \"items-center\",\r\n        \"justify-center\",\r\n        \"h-8\",\r\n        \"w-8\",\r\n        \"rounded-md\",\r\n        \"bg-white\",\r\n        \"border\",\r\n        \"border-neutral-200\",\r\n        \"shadow-sm\",\r\n        \"text-neutral-500\",\r\n        \"hover:text-neutral-700\",\r\n        \"hover:bg-neutral-50\",\r\n        \"transition-colors\",\r\n        \"duration-150\",\r\n      ]\r\n        .filter(Boolean)\r\n        .join(\" \");\r\n\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={containerStyles}\r\n        onMouseMove={isResizing ? handleResizeMove : undefined}\r\n        onMouseUp={handleResizeEnd}\r\n        onMouseLeave={handleResizeEnd}\r\n        {...props}\r\n      >\r\n        {/* Header */}\r\n        {header && (\r\n          <div className=\"flex items-center h-12 px-4 bg-white border-b border-neutral-200 shrink-0\" data-ui-ref=\"layout-header\">\r\n            {header}\r\n          </div>\r\n        )}\r\n\r\n        {/* Main content area */}\r\n        <div className=\"flex flex-1 overflow-hidden\">\r\n          {/* Left sidebar */}\r\n          {leftSidebar && (\r\n            <div\r\n              className={sidebarStyles(leftVisible, \"left\")}\r\n              style={{ width: leftVisible ? leftSize : 0 }}\r\n              data-ui-ref=\"layout-sidebar-left\"\r\n            >\r\n              {/* Sidebar content */}\r\n              <div className=\"flex-1 overflow-hidden\">{leftSidebar}</div>\r\n\r\n              {/* Resize handle */}\r\n              {resizable && leftVisible && (\r\n                <div\r\n                  className={[resizeHandleStyles(\"vertical\"), \"right-0\"].join(\" \")}\r\n                  onMouseDown={() => handleResizeStart(\"left\")}\r\n                />\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Left collapse button */}\r\n          {collapsible && leftSidebar && (\r\n            <div className=\"absolute left-0 top-1/2 -translate-y-1/2 z-20 ml-1\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => togglePanel(\"left\")}\r\n                className={collapseButtonStyles(leftVisible)}\r\n                style={{ marginLeft: leftVisible ? leftSize - 12 : 4 }}\r\n                title={leftVisible ? \"Collapse sidebar\" : \"Expand sidebar\"}\r\n              >\r\n                {leftVisible ? (\r\n                  <ChevronLeftIcon className=\"h-4 w-4\" />\r\n                ) : (\r\n                  <ChevronRightIcon className=\"h-4 w-4\" />\r\n                )}\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Center content area */}\r\n          <div className=\"flex flex-col flex-1 overflow-hidden\">\r\n            {/* Main canvas/content */}\r\n            <div className=\"flex-1 overflow-hidden relative\" data-ui-ref=\"layout-center-canvas\">\r\n              {mainContent || (\r\n                <div className=\"flex items-center justify-center h-full text-neutral-400\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"h-16 w-16 mx-auto mb-4 opacity-50\">\r\n                      <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n                        <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n                        <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n                        <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\r\n                      </svg>\r\n                    </div>\r\n                    <p className=\"text-sm\">No content to display</p>\r\n                    <p className=\"text-xs text-neutral-300 mt-1\">\r\n                      Add components from the sidebar\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Bottom panel */}\r\n            {bottomPanel && bottomVisible && (\r\n              <div\r\n                className=\"relative bg-white border-t border-neutral-200 shrink-0\"\r\n                style={{ height: bottomSize }}\r\n                data-ui-ref=\"layout-panel-bottom\"\r\n              >\r\n                {/* Resize handle */}\r\n                {resizable && (\r\n                  <div\r\n                    className={[resizeHandleStyles(\"horizontal\"), \"top-0\"].join(\" \")}\r\n                    onMouseDown={() => handleResizeStart(\"bottom\")}\r\n                  />\r\n                )}\r\n\r\n                {/* Panel content */}\r\n                <div className=\"h-full overflow-hidden\">{bottomPanel}</div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Bottom collapse button */}\r\n            {collapsible && bottomPanel && (\r\n              <div className=\"absolute bottom-0 left-1/2 -translate-x-1/2 z-20 mb-1\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => togglePanel(\"bottom\")}\r\n                  className={collapseButtonStyles(bottomVisible)}\r\n                  style={{ marginBottom: bottomVisible ? bottomSize - 12 : 4 }}\r\n                  title={bottomVisible ? \"Collapse panel\" : \"Expand panel\"}\r\n                >\r\n                  {bottomVisible ? (\r\n                    <ChevronDownIcon className=\"h-4 w-4\" />\r\n                  ) : (\r\n                    <ChevronUpIcon className=\"h-4 w-4\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Right sidebar */}\r\n          {rightSidebar && (\r\n            <div\r\n              className={sidebarStyles(rightVisible, \"right\")}\r\n              style={{ width: rightVisible ? rightSize : 0 }}\r\n              data-ui-ref=\"layout-sidebar-right\"\r\n            >\r\n              {/* Resize handle */}\r\n              {resizable && rightVisible && (\r\n                <div\r\n                  className={[resizeHandleStyles(\"vertical\"), \"left-0\"].join(\" \")}\r\n                  onMouseDown={() => handleResizeStart(\"right\")}\r\n                />\r\n              )}\r\n\r\n              {/* Sidebar content */}\r\n              <div className=\"flex-1 overflow-hidden\">{rightSidebar}</div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Right collapse button */}\r\n          {collapsible && rightSidebar && (\r\n            <div className=\"absolute right-0 top-1/2 -translate-y-1/2 z-20 mr-1\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => togglePanel(\"right\")}\r\n                className={collapseButtonStyles(rightVisible)}\r\n                style={{ marginRight: rightVisible ? rightSize - 12 : 4 }}\r\n                title={rightVisible ? \"Collapse sidebar\" : \"Expand sidebar\"}\r\n              >\r\n                {rightVisible ? (\r\n                  <ChevronRightIcon className=\"h-4 w-4\" />\r\n                ) : (\r\n                  <ChevronLeftIcon className=\"h-4 w-4\" />\r\n                )}\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Status bar */}\r\n        <div className=\"flex items-center justify-between h-6 px-3 bg-neutral-50 border-t border-neutral-200 text-xs text-neutral-500 shrink-0\">\r\n          <span>App Factory</span>\r\n          <div className=\"flex items-center gap-4\">\r\n            <span>\r\n              Panels: {leftVisible ? \"L\" : \"-\"} | {bottomVisible ? \"B\" : \"-\"} |{\" \"}\r\n              {rightVisible ? \"R\" : \"-\"}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nFactoryLayout.displayName = \"FactoryLayout\";\r\n\r\nexport default FactoryLayout;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\LivePreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":59,"column":9,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":59,"endColumn":19},{"ruleId":"react/prop-types","severity":2,"message":"'options' is missing in props validation","line":75,"column":47,"nodeType":"Identifier","messageId":"missingPropType","endLine":75,"endColumn":54},{"ruleId":"react/prop-types","severity":2,"message":"'items' is missing in props validation","line":78,"column":45,"nodeType":"Identifier","messageId":"missingPropType","endLine":78,"endColumn":50},{"ruleId":"react/prop-types","severity":2,"message":"'onClick' is missing in props validation","line":85,"column":39,"nodeType":"Identifier","messageId":"missingPropType","endLine":85,"endColumn":46},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":93,"column":40,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":93,"endColumn":42,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[3546,3548],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\LivePreview.tsx:106:10\n  104 |\n  105 |     return (\n> 106 |         <Component {...props}>\n      |          ^^^^^^^^^ This component is created during render\n  107 |             {children && children.length > 0 ? children : childrenProp}\n  108 |         </Component>\n  109 |     );\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\LivePreview.tsx:67:23\n  65 |     }\n  66 |\n> 67 |     const Component = getComponent(component.type);\n     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ The component is created during render here\n  68 |\n  69 |     // Build props - spread component.props directly\n  70 |     // This preserves all original props like label, placeholder, etc.","line":106,"column":10,"nodeType":null,"endLine":106,"endColumn":19},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":107,"column":14,"nodeType":"Identifier","messageId":"alwaysTruthy","endLine":107,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'screens' conditional could make the dependencies of useMemo Hook (at line 164) change on every render. To fix this, wrap the initialization of 'screens' in its own useMemo() Hook.","line":147,"column":11,"nodeType":"VariableDeclarator","endLine":149,"endColumn":23},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":158,"column":25,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":158,"endColumn":42},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":176,"column":25,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":176,"endColumn":42},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":196,"column":9,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":196,"endColumn":19}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * src/components/factory/LivePreview.tsx\r\n * ======================================\r\n * Recursive component renderer for Live Preview.\r\n * Connects to projectStore to render the current state of UI components.\r\n * Supports hot-loading by reacting to store updates.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D045-D047 (Live preview panel requirements)\r\n */\r\n\r\nimport React, { useMemo, useCallback } from 'react';\r\nimport { useProjectStore, type ProjectComponent } from '../../stores/projectStore';\r\nimport { getComponent } from '../../utils/ComponentRegistry';\r\nimport { mockSelectOptions, mockTabItems, mockEventHandler } from '../../mocks/previewMocks';\r\nimport { demoScreen, demoComponents } from '../../mocks/demoPreviewData';\r\nimport { ThemedCanvasWrapper } from './ThemedCanvasWrapper';\r\n\r\n// =============================================================================\r\n// TYPES\r\n// =============================================================================\r\n\r\ninterface LivePreviewProps {\r\n    /** Screen ID to preview from projectStore */\r\n    screenId?: string;\r\n    /** Direct component ID to preview from projectStore */\r\n    componentId?: string;\r\n    /** \r\n     * Enable demo mode: renders demo components when no screenId/componentId provided.\r\n     * REPLACE_WITH_PRODUCTION: Set to false when using real project data.\r\n     */\r\n    useDemoMode?: boolean;\r\n    /** Callback when user interacts with a preview component */\r\n    onInteract?: (eventName: string, componentId: string, args: unknown[]) => void;\r\n    /** Additional CSS classes */\r\n    className?: string;\r\n}\r\n\r\ninterface LivePreviewChildProps {\r\n    componentId: string;\r\n    components: Record<string, ProjectComponent>;\r\n    onInteract: (eventName: string, componentId: string, args: unknown[]) => void;\r\n}\r\n\r\n// =============================================================================\r\n// CHILD COMPONENT (Internal recursive renderer)\r\n// =============================================================================\r\n\r\n/**\r\n * Internal child renderer for recursion.\r\n * Uses passed components instead of connecting to store for each child.\r\n */\r\nconst LivePreviewChild: React.FC<LivePreviewChildProps> = ({\r\n    componentId,\r\n    components,\r\n    onInteract\r\n}) => {\r\n    const component = components[componentId];\r\n    if (!component) {\r\n        return (\r\n            <div className=\"text-xs text-error-500\">\r\n                Missing: {componentId}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const Component = getComponent(component.type);\r\n\r\n    // Build props - spread component.props directly\r\n    // This preserves all original props like label, placeholder, etc.\r\n    const props: Record<string, unknown> = { ...component.props };\r\n\r\n    // DUMMY_DATA_START: Mock data injection for preview\r\n    // Inject Mock Data if needed based on component type\r\n    if (component.type === 'select' && !props.options) {\r\n        props.options = mockSelectOptions;\r\n    }\r\n    if (component.type === 'tabs' && !props.items) {\r\n        props.items = mockTabItems;\r\n    }\r\n    // DUMMY_DATA_END\r\n\r\n    // For buttons, add a click handler that logs interaction\r\n    if (component.type === 'button') {\r\n        const originalOnClick = props.onClick as (() => void) | undefined;\r\n        props.onClick = () => {\r\n            onInteract('click', component.id, []);\r\n            originalOnClick?.();\r\n        };\r\n    }\r\n\r\n    // Render children recursively\r\n    const children = component.children?.map(childId => (\r\n        <LivePreviewChild\r\n            key={childId}\r\n            componentId={childId}\r\n            components={components}\r\n            onInteract={onInteract}\r\n        />\r\n    ));\r\n\r\n    // Use children prop for text content (like button text)\r\n    const childrenProp = props.children;\r\n\r\n    return (\r\n        <Component {...props}>\r\n            {children && children.length > 0 ? children : childrenProp}\r\n        </Component>\r\n    );\r\n};\r\n\r\n// =============================================================================\r\n// MAIN COMPONENT\r\n// =============================================================================\r\n\r\n/**\r\n * LivePreview component.\r\n * \r\n * Recursively renders components from the project store or demo data.\r\n * Fully interactive - all components are functional (inputs accept text, \r\n * buttons are clickable, etc.)\r\n * \r\n * @example\r\n * ```tsx\r\n * // Render from project store\r\n * <LivePreview screenId=\"main-screen\" />\r\n * \r\n * // Render demo content\r\n * <LivePreview useDemoMode />\r\n * \r\n * // Render specific component\r\n * <LivePreview componentId=\"my-component\" />\r\n * ```\r\n */\r\nexport const LivePreview: React.FC<LivePreviewProps> = ({\r\n    screenId,\r\n    componentId,\r\n    useDemoMode = false,\r\n    onInteract,\r\n    className = ''\r\n}) => {\r\n    // Connect to store\r\n    const storeScreens = useProjectStore((state) => state.screens);\r\n    const storeComponents = useProjectStore((state) => state.components);\r\n\r\n    // Determine data source: store or demo\r\n    const screens = useDemoMode && Object.keys(storeScreens).length === 0\r\n        ? { [demoScreen.id]: demoScreen }\r\n        : storeScreens;\r\n\r\n    const components: Record<string, ProjectComponent> = useDemoMode && Object.keys(storeComponents).length === 0\r\n        ? demoComponents\r\n        : storeComponents;\r\n\r\n    // Determine root component ID\r\n    const rootId = useMemo(() => {\r\n        if (componentId) return componentId;\r\n        if (screenId && screens[screenId]) return screens[screenId].rootComponentId;\r\n        // In demo mode with no ID, use demo screen's root\r\n        if (useDemoMode && !screenId && !componentId) {\r\n            return demoScreen.rootComponentId;\r\n        }\r\n        return null;\r\n    }, [screenId, componentId, screens, useDemoMode]);\r\n\r\n    // Create interaction handler\r\n    const handleInteract = useCallback((eventName: string, compId: string, args: unknown[]) => {\r\n        // Log to console for preview debugging\r\n        mockEventHandler(eventName, compId, ...args);\r\n        // Call external handler if provided\r\n        onInteract?.(eventName, compId, args);\r\n    }, [onInteract]);\r\n\r\n    // If no root, show appropriate message\r\n    if (!rootId) {\r\n        if (screenId && screens[screenId] && !screens[screenId].rootComponentId) {\r\n            return (\r\n                <div className=\"flex items-center justify-center p-8 text-neutral-400 border-2 border-dashed border-neutral-200 rounded-lg\">\r\n                    Empty Screen (No Root Component)\r\n                </div>\r\n            );\r\n        }\r\n        if (!useDemoMode) {\r\n            return (\r\n                <div className=\"flex flex-col items-center justify-center p-8 text-neutral-400 border-2 border-dashed border-neutral-200 rounded-lg\">\r\n                    <p className=\"text-sm\">No content to preview</p>\r\n                    <p className=\"text-xs mt-1\">Select a screen or enable demo mode</p>\r\n                </div>\r\n            );\r\n        }\r\n        return null;\r\n    }\r\n\r\n    // Get component data\r\n    const component = components[rootId];\r\n    if (!component) {\r\n        return (\r\n            <div className=\"p-4 text-error-500 bg-error-50 rounded-lg border border-error-200\">\r\n                Component not found: <code className=\"font-mono\">{rootId}</code>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Render the component tree with theme applied\r\n    return (\r\n        <ThemedCanvasWrapper className={className} applyBackground={false} data-ui-ref=\"component-live-preview\">\r\n            <LivePreviewChild\r\n                componentId={rootId}\r\n                components={components}\r\n                onInteract={handleInteract}\r\n            />\r\n        </ThemedCanvasWrapper>\r\n    );\r\n};\r\n\r\nexport default LivePreview;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\PluginCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MoreIcon' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":183,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":183,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SettingsIcon' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":203,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":203,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'InfoIcon' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":222,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":222,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleConfigure' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":363,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":363,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleInfo' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":369,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":369,"endColumn":21},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":482,"column":44,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":482,"endColumn":46,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[15173,15175],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":498,"column":44,"nodeType":"MemberExpression","messageId":"invalidType","endLine":498,"endColumn":62}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D041 - src/components/factory/PluginCard.tsx\n * =============================================\n * Individual plugin card component for gallery display.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D040 (PluginGallery.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n *   - Reusable standalone card component\n */\n\nimport React, { forwardRef, type HTMLAttributes } from \"react\";\n\n/**\n * Plugin status enumeration.\n */\nexport type PluginStatus = \"loaded\" | \"unloaded\" | \"error\" | \"loading\";\n\n/**\n * Plugin contract type.\n */\nexport type PluginContract = \"tts\" | \"stt\" | \"llm\" | \"memory\" | \"tool\" | \"custom\";\n\n/**\n * Plugin information interface.\n */\nexport interface PluginInfo {\n  /** Unique plugin identifier */\n  id: string;\n  /** Display name */\n  name: string;\n  /** Plugin version */\n  version: string;\n  /** Short description */\n  description: string;\n  /** Contract type */\n  contract: PluginContract;\n  /** Current status */\n  status: PluginStatus;\n  /** Plugin author */\n  author?: string;\n  /** Plugin icon URL */\n  icon?: string;\n  /** Whether plugin is built-in */\n  builtIn?: boolean;\n  /** Tags for filtering */\n  tags?: string[];\n  /** Last updated timestamp */\n  lastUpdated?: string;\n  /** Health status (0-100) */\n  healthScore?: number;\n  /** Dependencies */\n  dependencies?: string[];\n}\n\n/**\n * Card size variants.\n */\nexport type CardSize = \"sm\" | \"md\" | \"lg\";\n\n/**\n * Contract color mapping.\n */\nconst contractColors: Record<PluginContract, string> = {\n  tts: \"bg-primary-100 text-primary-700 border-primary-200\",\n  stt: \"bg-success-50 text-success-700 border-success-200\",\n  llm: \"bg-warning-50 text-warning-700 border-warning-200\",\n  memory: \"bg-info-50 text-info-700 border-info-200\",\n  tool: \"bg-neutral-100 text-neutral-700 border-neutral-200\",\n  custom: \"bg-neutral-50 text-neutral-600 border-neutral-200\",\n};\n\n/**\n * Contract icon mapping.\n */\nconst contractIcons: Record<PluginContract, React.FC<{ className?: string }>> = {\n  tts: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\" />\n      <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\n      <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n      <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n    </svg>\n  ),\n  stt: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n      <path d=\"M15.54 8.46a5 5 0 0 1 0 7.07\" />\n      <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14\" />\n    </svg>\n  ),\n  llm: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 2L2 7l10 5 10-5-10-5z\" />\n      <path d=\"M2 17l10 5 10-5\" />\n      <path d=\"M2 12l10 5 10-5\" />\n    </svg>\n  ),\n  memory: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <ellipse cx=\"12\" cy=\"5\" rx=\"9\" ry=\"3\" />\n      <path d=\"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3\" />\n      <path d=\"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5\" />\n    </svg>\n  ),\n  tool: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\" />\n    </svg>\n  ),\n  custom: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <circle cx=\"12\" cy=\"12\" r=\"3\" />\n      <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\n    </svg>\n  ),\n};\n\n/**\n * Status indicator colors.\n */\nconst statusColors: Record<PluginStatus, string> = {\n  loaded: \"bg-success-500\",\n  unloaded: \"bg-neutral-400\",\n  error: \"bg-error-500\",\n  loading: \"bg-warning-500 animate-pulse\",\n};\n\n/**\n * Status display labels.\n */\nconst statusLabels: Record<PluginStatus, string> = {\n  loaded: \"Active\",\n  unloaded: \"Inactive\",\n  error: \"Error\",\n  loading: \"Loading\",\n};\n\n/**\n * Size configurations.\n */\nconst sizeConfigs: Record<CardSize, { padding: string; iconSize: string; titleSize: string }> = {\n  sm: { padding: \"p-3\", iconSize: \"h-8 w-8\", titleSize: \"text-sm\" },\n  md: { padding: \"p-4\", iconSize: \"h-10 w-10\", titleSize: \"text-base\" },\n  lg: { padding: \"p-5\", iconSize: \"h-12 w-12\", titleSize: \"text-lg\" },\n};\n\n/**\n * PluginCard component props.\n */\nexport interface PluginCardProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\"> {\n  /** Plugin information */\n  plugin: PluginInfo;\n  /** Whether card is selected */\n  isSelected?: boolean;\n  /** Card size variant */\n  size?: CardSize;\n  /** Whether to show full details */\n  showDetails?: boolean;\n  /** Whether to show action buttons */\n  showActions?: boolean;\n  /** Whether card is interactive (clickable) */\n  interactive?: boolean;\n  /** Callback when card is clicked */\n  onSelect?: (plugin: PluginInfo) => void;\n  /** Callback when load is requested */\n  onLoad?: (plugin: PluginInfo) => void;\n  /** Callback when unload is requested */\n  onUnload?: (plugin: PluginInfo) => void;\n  /** Callback when configure is requested */\n  onConfigure?: (plugin: PluginInfo) => void;\n  /** Callback when info is requested */\n  onInfo?: (plugin: PluginInfo) => void;\n}\n\n/**\n * More actions icon.\n */\nconst MoreIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"1\" />\n    <circle cx=\"19\" cy=\"12\" r=\"1\" />\n    <circle cx=\"5\" cy=\"12\" r=\"1\" />\n  </svg>\n);\n\n/**\n * Settings icon.\n */\nconst SettingsIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\n  </svg>\n);\n\n/**\n * Info icon.\n */\nconst InfoIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\" />\n    <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" />\n  </svg>\n);\n\n/**\n * Load/Download icon.\n */\nconst LoadIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n    <polyline points=\"7 10 12 15 17 10\" />\n    <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n  </svg>\n);\n\n/**\n * Unload/Stop icon.\n */\nconst UnloadIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" rx=\"2\" />\n  </svg>\n);\n\n/**\n * PluginCard component.\n *\n * A standalone card component for displaying plugin information.\n * Supports multiple sizes, selection states, and action buttons.\n *\n * @example\n * ```tsx\n * <PluginCard\n *   plugin={pluginInfo}\n *   isSelected={selectedId === pluginInfo.id}\n *   onSelect={(plugin) => setSelectedId(plugin.id)}\n *   onLoad={(plugin) => loadPlugin(plugin.id)}\n *   showActions\n * />\n * ```\n */\nexport const PluginCard = forwardRef<HTMLDivElement, PluginCardProps>(\n  (\n    {\n      plugin,\n      isSelected = false,\n      size = \"md\",\n      showDetails = true,\n      showActions = true,\n      interactive = true,\n      onSelect,\n      onLoad,\n      onUnload,\n      onConfigure,\n      onInfo,\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    const sizeConfig = sizeConfigs[size];\n    const ContractIcon = contractIcons[plugin.contract];\n\n    // Card container styles\n    const cardStyles = [\n      \"group\",\n      \"relative\",\n      \"bg-white\",\n      \"border\",\n      \"rounded-lg\",\n      \"overflow-hidden\",\n      \"transition-all\",\n      \"duration-150\",\n      sizeConfig.padding,\n      interactive && \"cursor-pointer\",\n      isSelected\n        ? \"border-primary-500 ring-2 ring-primary-100 shadow-md\"\n        : \"border-neutral-200 hover:border-neutral-300 hover:shadow-sm\",\n      className,\n    ]\n      .filter(Boolean)\n      .join(\" \");\n\n    // Handle card click\n    const handleClick = (e: React.MouseEvent) => {\n      if (!interactive) return;\n      e.preventDefault();\n      onSelect?.(plugin);\n    };\n\n    // Handle keyboard navigation\n    const handleKeyDown = (e: React.KeyboardEvent) => {\n      if (!interactive) return;\n      if (e.key === \"Enter\" || e.key === \" \") {\n        e.preventDefault();\n        onSelect?.(plugin);\n      }\n    };\n\n    // Handle load/unload action\n    const handleToggleLoad = (e: React.MouseEvent) => {\n      e.stopPropagation();\n      if (plugin.status === \"loaded\") {\n        onUnload?.(plugin);\n      } else if (plugin.status === \"unloaded\") {\n        onLoad?.(plugin);\n      }\n    };\n\n    // Handle configure\n    const handleConfigure = (e: React.MouseEvent) => {\n      e.stopPropagation();\n      onConfigure?.(plugin);\n    };\n\n    // Handle info\n    const handleInfo = (e: React.MouseEvent) => {\n      e.stopPropagation();\n      onInfo?.(plugin);\n    };\n\n    return (\n      <div\n        ref={ref}\n        className={cardStyles}\n        onClick={handleClick}\n        onKeyDown={handleKeyDown}\n        role={interactive ? \"button\" : undefined}\n        tabIndex={interactive ? 0 : undefined}\n        aria-selected={isSelected}\n        {...props}\n      >\n        {/* Header with icon and status */}\n        <div className=\"flex items-start gap-3\">\n          {/* Plugin icon */}\n          <div\n            className={[\n              \"flex\",\n              \"items-center\",\n              \"justify-center\",\n              \"rounded-lg\",\n              \"shrink-0\",\n              contractColors[plugin.contract],\n              sizeConfig.iconSize,\n            ].join(\" \")}\n          >\n            {plugin.icon ? (\n              <img\n                src={plugin.icon}\n                alt={`${plugin.name} icon`}\n                className=\"h-full w-full object-contain p-1\"\n              />\n            ) : (\n              <ContractIcon className=\"h-5 w-5\" />\n            )}\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 min-w-0\">\n            {/* Name and version */}\n            <div className=\"flex items-center gap-2\">\n              <h3\n                className={[\n                  \"font-semibold\",\n                  \"text-neutral-900\",\n                  \"truncate\",\n                  sizeConfig.titleSize,\n                ].join(\" \")}\n              >\n                {plugin.name}\n              </h3>\n              <span className=\"text-xs text-neutral-400 shrink-0\">v{plugin.version}</span>\n              {plugin.builtIn && (\n                <span className=\"px-1.5 py-0.5 text-xs font-medium bg-neutral-100 text-neutral-500 rounded\">\n                  Built-in\n                </span>\n              )}\n            </div>\n\n            {/* Contract badge and status */}\n            <div className=\"flex items-center gap-2 mt-1\">\n              <span\n                className={[\n                  \"inline-flex\",\n                  \"items-center\",\n                  \"px-2\",\n                  \"py-0.5\",\n                  \"text-xs\",\n                  \"font-medium\",\n                  \"rounded\",\n                  \"border\",\n                  contractColors[plugin.contract],\n                ].join(\" \")}\n              >\n                {plugin.contract.toUpperCase()}\n              </span>\n              <div className=\"flex items-center gap-1\">\n                <div\n                  className={[\"h-2\", \"w-2\", \"rounded-full\", statusColors[plugin.status]].join(\" \")}\n                />\n                <span className=\"text-xs text-neutral-500\">{statusLabels[plugin.status]}</span>\n              </div>\n            </div>\n\n            {/* Description */}\n            {showDetails && (\n              <p className=\"text-sm text-neutral-600 mt-2 line-clamp-2\">{plugin.description}</p>\n            )}\n\n            {/* Tags */}\n            {showDetails && plugin.tags && plugin.tags.length > 0 && (\n              <div className=\"flex flex-wrap gap-1 mt-2\">\n                {plugin.tags.slice(0, 3).map((tag) => (\n                  <span\n                    key={tag}\n                    className=\"px-1.5 py-0.5 text-xs bg-neutral-100 text-neutral-600 rounded\"\n                  >\n                    {tag}\n                  </span>\n                ))}\n                {plugin.tags.length > 3 && (\n                  <span className=\"px-1.5 py-0.5 text-xs text-neutral-400\">\n                    +{plugin.tags.length - 3}\n                  </span>\n                )}\n              </div>\n            )}\n\n            {/* Author and health */}\n            {showDetails && (plugin.author || plugin.healthScore !== undefined) && (\n              <div className=\"flex items-center gap-4 mt-2 text-xs text-neutral-500\">\n                {plugin.author && <span>by {plugin.author}</span>}\n                {plugin.healthScore !== undefined && (\n                  <div className=\"flex items-center gap-1\">\n                    <div className=\"h-1.5 w-16 bg-neutral-200 rounded-full overflow-hidden\">\n                      <div\n                        className={[\n                          \"h-full\",\n                          \"rounded-full\",\n                          plugin.healthScore >= 80\n                            ? \"bg-success-500\"\n                            : plugin.healthScore >= 50\n                              ? \"bg-warning-500\"\n                              : \"bg-error-500\",\n                        ].join(\" \")}\n                        style={{ width: `${plugin.healthScore}%` }}\n                      />\n                    </div>\n                    <span>{plugin.healthScore}%</span>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Status indicator (absolute positioned) */}\n          <div\n            className={[\n              \"absolute\",\n              \"top-3\",\n              \"right-3\",\n              \"h-2.5\",\n              \"w-2.5\",\n              \"rounded-full\",\n              \"border-2\",\n              \"border-white\",\n              \"shadow-sm\",\n              statusColors[plugin.status],\n            ].join(\" \")}\n            title={statusLabels[plugin.status]}\n          />\n\n          {/* Permanent Load/Unload icon button */}\n          {showActions && (\n            <button\n              type=\"button\"\n              onClick={handleToggleLoad}\n              disabled={plugin.status === \"loading\" || plugin.status === \"error\"}\n              className={[\n                \"absolute\",\n                \"bottom-3\",\n                \"right-3\",\n                \"p-1.5\",\n                \"rounded-md\",\n                \"transition-colors\",\n                \"duration-150\",\n                plugin.status === \"loaded\"\n                  ? \"text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100\"\n                  : \"text-primary-500 hover:text-primary-700 hover:bg-primary-50\",\n                (plugin.status === \"loading\" || plugin.status === \"error\") &&\n                \"opacity-50 cursor-not-allowed\",\n              ].join(\" \")}\n              title={plugin.status === \"loaded\" ? \"Unload plugin\" : \"Load plugin\"}\n            >\n              {plugin.status === \"loaded\" ? (\n                <UnloadIcon className=\"h-5 w-5\" />\n              ) : plugin.status === \"loading\" ? (\n                <LoadIcon className=\"h-5 w-5 animate-pulse\" />\n              ) : (\n                <LoadIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          )}\n        </div>\n\n      </div>\n    );\n  }\n);\n\nPluginCard.displayName = \"PluginCard\";\n\n/**\n * Compact plugin card variant for list views.\n */\nexport interface PluginCardCompactProps\n  extends Omit<PluginCardProps, \"showDetails\" | \"showActions\" | \"size\"> {\n  /** Show quick action button */\n  showQuickAction?: boolean;\n}\n\nexport const PluginCardCompact = forwardRef<HTMLDivElement, PluginCardCompactProps>(\n  ({ plugin, isSelected, showQuickAction = true, onSelect, onLoad, onUnload, className = \"\", ...props }, ref) => {\n    const ContractIcon = contractIcons[plugin.contract];\n\n    const cardStyles = [\n      \"flex\",\n      \"items-center\",\n      \"gap-3\",\n      \"p-3\",\n      \"bg-white\",\n      \"border\",\n      \"rounded-lg\",\n      \"cursor-pointer\",\n      \"transition-all\",\n      \"duration-150\",\n      isSelected\n        ? \"border-primary-500 bg-primary-50\"\n        : \"border-neutral-200 hover:border-neutral-300\",\n      className,\n    ].join(\" \");\n\n    const handleClick = () => onSelect?.(plugin);\n\n    const handleAction = (e: React.MouseEvent) => {\n      e.stopPropagation();\n      if (plugin.status === \"loaded\") {\n        onUnload?.(plugin);\n      } else {\n        onLoad?.(plugin);\n      }\n    };\n\n    return (\n      <div\n        ref={ref}\n        className={cardStyles}\n        onClick={handleClick}\n        role=\"button\"\n        tabIndex={0}\n        {...props}\n      >\n        {/* Icon */}\n        <div\n          className={[\n            \"flex\",\n            \"items-center\",\n            \"justify-center\",\n            \"h-8\",\n            \"w-8\",\n            \"rounded-md\",\n            \"shrink-0\",\n            contractColors[plugin.contract],\n          ].join(\" \")}\n        >\n          <ContractIcon className=\"h-4 w-4\" />\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-sm font-medium text-neutral-900 truncate\">{plugin.name}</span>\n            <span className=\"text-xs text-neutral-400\">v{plugin.version}</span>\n          </div>\n          <span className=\"text-xs text-neutral-500\">{plugin.contract.toUpperCase()}</span>\n        </div>\n\n        {/* Status */}\n        <div\n          className={[\"h-2\", \"w-2\", \"rounded-full\", \"shrink-0\", statusColors[plugin.status]].join(\n            \" \"\n          )}\n        />\n\n        {/* Quick action */}\n        {showQuickAction && (\n          <button\n            type=\"button\"\n            onClick={handleAction}\n            disabled={plugin.status === \"loading\"}\n            className={[\n              \"px-2\",\n              \"py-1\",\n              \"text-xs\",\n              \"font-medium\",\n              \"rounded\",\n              \"transition-colors\",\n              \"duration-150\",\n              \"shrink-0\",\n              plugin.status === \"loaded\"\n                ? \"bg-neutral-100 text-neutral-600 hover:bg-neutral-200\"\n                : \"bg-primary-100 text-primary-700 hover:bg-primary-200\",\n            ].join(\" \")}\n          >\n            {plugin.status === \"loaded\" ? \"Stop\" : \"Start\"}\n          </button>\n        )}\n      </div>\n    );\n  }\n);\n\nPluginCardCompact.displayName = \"PluginCardCompact\";\n\nexport default PluginCard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\PluginConfigPanel.tsx","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":35,"column":15,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":35,"endColumn":54,"fix":{"range":[1225,1264],"text":"{ value: string; label: string }[]"}},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value || ''' will use Object's default stringification format ('[object Object]') when stringified.","line":231,"column":43,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":231,"endColumn":54},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":231,"column":49,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":231,"endColumn":51,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[9432,9434],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value || ''' will use Object's default stringification format ('[object Object]') when stringified.","line":253,"column":39,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":253,"endColumn":50},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":253,"column":45,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":253,"endColumn":47,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[10610,10612],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\r\n * PluginConfigPanel - Plugin Configuration Editor\r\n * =================================================\r\n * Displays and allows editing of plugin configuration options.\r\n * Shows when a plugin is selected from the Blueprint panel or plugin gallery.\r\n *\r\n * Features:\r\n * - Display plugin name, version, and contract type\r\n * - Render configuration options based on PluginConfigOption type\r\n * - Support input types: string, number, boolean, select, path\r\n * - Show description/help text for each option\r\n * - Apply and Reset to defaults buttons\r\n */\r\n\r\nimport React, { useState, useCallback, useMemo } from 'react';\r\n\r\n// ============================================================================\r\n// TYPES\r\n// ============================================================================\r\n\r\nexport interface PluginConfigOption {\r\n    /** Option key */\r\n    key: string;\r\n    /** Display label */\r\n    label: string;\r\n    /** Option type */\r\n    type: 'string' | 'number' | 'boolean' | 'select' | 'path';\r\n    /** Current value */\r\n    value: unknown;\r\n    /** Default value */\r\n    defaultValue: unknown;\r\n    /** Description/help text */\r\n    description?: string;\r\n    /** Options for select type */\r\n    options?: Array<{ value: string; label: string }>;\r\n    /** Validation constraints */\r\n    validation?: {\r\n        min?: number;\r\n        max?: number;\r\n        pattern?: string;\r\n        required?: boolean;\r\n    };\r\n}\r\n\r\nexport interface PluginConfigInfo {\r\n    id: string;\r\n    name: string;\r\n    version: string;\r\n    contract: string;\r\n    description?: string;\r\n    config: PluginConfigOption[];\r\n}\r\n\r\nexport interface PluginConfigPanelProps {\r\n    /** Plugin to configure */\r\n    plugin: PluginConfigInfo | null;\r\n    /** Callback when config value changes */\r\n    onChange?: (key: string, value: unknown) => void;\r\n    /** Callback when all config is applied */\r\n    onApply?: (config: Record<string, unknown>) => void;\r\n    /** Callback to reset all values to defaults */\r\n    onReset?: () => void;\r\n    /** Callback to close/deselect plugin */\r\n    onClose?: () => void;\r\n    /** Whether the panel is read-only */\r\n    readOnly?: boolean;\r\n    /** Additional CSS classes */\r\n    className?: string;\r\n}\r\n\r\n// ============================================================================\r\n// ICONS\r\n// ============================================================================\r\n\r\nconst PluginIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"2\">\r\n        <path d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\r\n    </svg>\r\n);\r\n\r\nconst CloseIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"2\">\r\n        <path d=\"M6 18L18 6M6 6l12 12\" />\r\n    </svg>\r\n);\r\n\r\nconst RefreshIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"2\">\r\n        <path d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n    </svg>\r\n);\r\n\r\n// ============================================================================\r\n// CONTRACT COLORS\r\n// ============================================================================\r\n\r\nconst contractColors: Record<string, string> = {\r\n    llm: 'bg-blue-100 text-blue-700 border-blue-200',\r\n    tts: 'bg-purple-100 text-purple-700 border-purple-200',\r\n    stt: 'bg-green-100 text-green-700 border-green-200',\r\n    memory: 'bg-amber-100 text-amber-700 border-amber-200',\r\n    database: 'bg-cyan-100 text-cyan-700 border-cyan-200',\r\n    default: 'bg-neutral-100 text-neutral-700 border-neutral-200',\r\n};\r\n\r\n// ============================================================================\r\n// MAIN COMPONENT\r\n// ============================================================================\r\n\r\nexport const PluginConfigPanel: React.FC<PluginConfigPanelProps> = ({\r\n    plugin,\r\n    onChange,\r\n    onApply,\r\n    onReset,\r\n    onClose,\r\n    readOnly = false,\r\n    className = '',\r\n}) => {\r\n    // Track local changes before applying\r\n    const [localValues, setLocalValues] = useState<Record<string, unknown>>({});\r\n    const [hasChanges, setHasChanges] = useState(false);\r\n\r\n    // Initialize local values from plugin config\r\n    const currentValues = useMemo(() => {\r\n        if (!plugin) return {};\r\n        const values: Record<string, unknown> = {};\r\n        plugin.config.forEach((opt) => {\r\n            values[opt.key] = localValues[opt.key] ?? opt.value;\r\n        });\r\n        return values;\r\n    }, [plugin, localValues]);\r\n\r\n    // Handle value change\r\n    const handleChange = useCallback((key: string, value: unknown) => {\r\n        setLocalValues((prev) => ({ ...prev, [key]: value }));\r\n        setHasChanges(true);\r\n        onChange?.(key, value);\r\n    }, [onChange]);\r\n\r\n    // Handle apply all\r\n    const handleApply = useCallback(() => {\r\n        if (!plugin) return;\r\n        onApply?.(currentValues);\r\n        setHasChanges(false);\r\n    }, [plugin, currentValues, onApply]);\r\n\r\n    // Handle reset to defaults\r\n    const handleReset = useCallback(() => {\r\n        if (!plugin) return;\r\n        const defaults: Record<string, unknown> = {};\r\n        plugin.config.forEach((opt) => {\r\n            defaults[opt.key] = opt.defaultValue;\r\n        });\r\n        setLocalValues(defaults);\r\n        setHasChanges(true);\r\n        onReset?.();\r\n    }, [plugin, onReset]);\r\n\r\n    // Get contract color\r\n    const getContractColor = (contract: string) => {\r\n        return contractColors[contract.toLowerCase()] || contractColors.default;\r\n    };\r\n\r\n    // Render empty state\r\n    if (!plugin) {\r\n        return (\r\n            <div className={`flex flex-col items-center justify-center h-full p-6 text-center ${className}`}>\r\n                <div className=\"w-16 h-16 rounded-full bg-neutral-100 flex items-center justify-center mb-4\">\r\n                    <PluginIcon className=\"w-8 h-8 text-neutral-400\" />\r\n                </div>\r\n                <p className=\"text-sm text-neutral-500\">Select a plugin to view its configuration</p>\r\n                <p className=\"text-xs text-neutral-400 mt-1\">Click on a plugin slot in the Blueprint panel</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Render config option input based on type\r\n    const renderInput = (option: PluginConfigOption) => {\r\n        const value = currentValues[option.key];\r\n\r\n        switch (option.type) {\r\n            case 'boolean':\r\n                return (\r\n                    <label className=\"relative inline-flex items-center cursor-pointer\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={Boolean(value)}\r\n                            onChange={(e) => handleChange(option.key, e.target.checked)}\r\n                            disabled={readOnly}\r\n                            className=\"sr-only peer\"\r\n                        />\r\n                        <div className=\"w-9 h-5 bg-neutral-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-neutral-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary-500\" />\r\n                    </label>\r\n                );\r\n\r\n            case 'select':\r\n                return (\r\n                    <select\r\n                        value={String(value)}\r\n                        onChange={(e) => handleChange(option.key, e.target.value)}\r\n                        disabled={readOnly}\r\n                        className=\"w-full px-3 py-1.5 text-sm border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-primary-300 focus:border-primary-500 disabled:bg-neutral-100 disabled:cursor-not-allowed\"\r\n                    >\r\n                        {option.options?.map((opt) => (\r\n                            <option key={opt.value} value={opt.value}>\r\n                                {opt.label}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                );\r\n\r\n            case 'number':\r\n                return (\r\n                    <input\r\n                        type=\"number\"\r\n                        value={Number(value) || 0}\r\n                        onChange={(e) => handleChange(option.key, parseFloat(e.target.value))}\r\n                        disabled={readOnly}\r\n                        min={option.validation?.min}\r\n                        max={option.validation?.max}\r\n                        step={option.validation?.min !== undefined && option.validation.min < 1 ? 0.1 : 1}\r\n                        className=\"w-full px-3 py-1.5 text-sm border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-primary-300 focus:border-primary-500 disabled:bg-neutral-100 disabled:cursor-not-allowed\"\r\n                    />\r\n                );\r\n\r\n            case 'path':\r\n                return (\r\n                    <div className=\"flex gap-2\">\r\n                        <input\r\n                            type=\"text\"\r\n                            value={String(value || '')}\r\n                            onChange={(e) => handleChange(option.key, e.target.value)}\r\n                            disabled={readOnly}\r\n                            placeholder=\"Enter path...\"\r\n                            className=\"flex-1 px-3 py-1.5 text-sm border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-primary-300 focus:border-primary-500 disabled:bg-neutral-100 disabled:cursor-not-allowed font-mono text-xs\"\r\n                        />\r\n                        <button\r\n                            type=\"button\"\r\n                            disabled={readOnly}\r\n                            className=\"px-2 py-1.5 text-xs bg-neutral-100 border border-neutral-300 rounded-md hover:bg-neutral-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            title=\"Browse...\"\r\n                        >\r\n                            ­ƒôü\r\n                        </button>\r\n                    </div>\r\n                );\r\n\r\n            case 'string':\r\n            default:\r\n                return (\r\n                    <input\r\n                        type=\"text\"\r\n                        value={String(value || '')}\r\n                        onChange={(e) => handleChange(option.key, e.target.value)}\r\n                        disabled={readOnly}\r\n                        placeholder={`Enter ${option.label.toLowerCase()}...`}\r\n                        className=\"w-full px-3 py-1.5 text-sm border border-neutral-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-primary-300 focus:border-primary-500 disabled:bg-neutral-100 disabled:cursor-not-allowed\"\r\n                    />\r\n                );\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={`flex flex-col h-full ${className}`}>\r\n            {/* Header */}\r\n            <div className=\"p-3 border-b border-neutral-200 bg-neutral-50\">\r\n                <div className=\"flex items-start justify-between gap-2\">\r\n                    <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <h3 className=\"text-sm font-semibold text-neutral-800 truncate\">{plugin.name}</h3>\r\n                            <span className={`px-1.5 py-0.5 text-[10px] font-medium rounded border ${getContractColor(plugin.contract)}`}>\r\n                                {plugin.contract.toUpperCase()}\r\n                            </span>\r\n                        </div>\r\n                        <p className=\"text-xs text-neutral-500 mt-0.5\">v{plugin.version}</p>\r\n                    </div>\r\n                    {onClose && (\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            className=\"p-1 rounded hover:bg-neutral-200 transition-colors\"\r\n                            title=\"Close\"\r\n                        >\r\n                            <CloseIcon className=\"w-4 h-4 text-neutral-500\" />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n                {plugin.description && (\r\n                    <p className=\"text-xs text-neutral-600 mt-2 line-clamp-2\">{plugin.description}</p>\r\n                )}\r\n            </div>\r\n\r\n            {/* Configuration Options */}\r\n            <div className=\"flex-1 overflow-auto p-3\">\r\n                {plugin.config.length === 0 ? (\r\n                    <div className=\"text-center py-8 text-neutral-400\">\r\n                        <p className=\"text-sm\">No configuration options available</p>\r\n                        <p className=\"text-xs mt-1\">This plugin uses default settings</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"space-y-4\">\r\n                        {plugin.config.map((option) => (\r\n                            <div key={option.key} className=\"space-y-1.5\">\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <label className=\"text-xs font-medium text-neutral-700\">\r\n                                        {option.label}\r\n                                        {option.validation?.required && (\r\n                                            <span className=\"text-red-500 ml-0.5\">*</span>\r\n                                        )}\r\n                                    </label>\r\n                                    {option.type === 'boolean' && renderInput(option)}\r\n                                </div>\r\n                                {option.type !== 'boolean' && renderInput(option)}\r\n                                {option.description && (\r\n                                    <p className=\"text-[10px] text-neutral-500\">{option.description}</p>\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Footer Actions */}\r\n            {!readOnly && plugin.config.length > 0 && (\r\n                <div className=\"p-3 border-t border-neutral-200 bg-neutral-50 space-y-2\">\r\n                    <div className=\"flex gap-2\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={handleApply}\r\n                            disabled={!hasChanges}\r\n                            className=\"flex-1 px-3 py-1.5 text-xs font-medium bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                        >\r\n                            Apply Changes\r\n                        </button>\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={handleReset}\r\n                            className=\"px-3 py-1.5 text-xs font-medium bg-neutral-100 text-neutral-700 rounded-md hover:bg-neutral-200 transition-colors flex items-center gap-1\"\r\n                            title=\"Reset to defaults\"\r\n                        >\r\n                            <RefreshIcon className=\"w-3 h-3\" />\r\n                            Reset\r\n                        </button>\r\n                    </div>\r\n                    {hasChanges && (\r\n                        <p className=\"text-[10px] text-amber-600 text-center\">\r\n                            You have unsaved changes\r\n                        </p>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nPluginConfigPanel.displayName = 'PluginConfigPanel';\r\n\r\nexport default PluginConfigPanel;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\PluginGallery.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":372,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":372,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[9935,9937],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":372,"column":76,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":372,"endColumn":78,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[9970,9972],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":449,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":449,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[12102,12104],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D040 - src/components/factory/PluginGallery.tsx\n * ================================================\n * Plugin gallery grid component for displaying available plugins.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D014 (Panel.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { forwardRef, useState, useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Plugin status enumeration.\n */\nexport type PluginStatus = \"loaded\" | \"unloaded\" | \"error\" | \"loading\";\n\n/**\n * Plugin contract type.\n */\nexport type PluginContract = \"tts\" | \"stt\" | \"llm\" | \"memory\" | \"tool\" | \"custom\";\n\n/**\n * Plugin information interface.\n */\nexport interface PluginInfo {\n  /** Unique plugin identifier */\n  id: string;\n  /** Display name */\n  name: string;\n  /** Plugin version */\n  version: string;\n  /** Short description */\n  description: string;\n  /** Contract type */\n  contract: PluginContract;\n  /** Current status */\n  status: PluginStatus;\n  /** Plugin author */\n  author?: string;\n  /** Plugin icon URL or component */\n  icon?: string;\n  /** Whether plugin is built-in */\n  builtIn?: boolean;\n  /** Tags for filtering */\n  tags?: string[];\n  /** Last updated timestamp */\n  lastUpdated?: string;\n}\n\n/**\n * Gallery filter options.\n */\nexport interface GalleryFilters {\n  /** Filter by status */\n  status?: PluginStatus | \"all\";\n  /** Filter by contract type */\n  contract?: PluginContract | \"all\";\n  /** Search query */\n  search?: string;\n  /** Show only built-in plugins */\n  builtInOnly?: boolean;\n}\n\n/**\n * Gallery sort options.\n */\nexport type GallerySortBy = \"name\" | \"status\" | \"contract\" | \"lastUpdated\";\nexport type GallerySortOrder = \"asc\" | \"desc\";\n\n/**\n * Gallery view mode.\n */\nexport type GalleryViewMode = \"grid\" | \"list\";\n\n/**\n * Contract color mapping.\n */\nconst contractColors: Record<PluginContract, string> = {\n  tts: \"bg-primary-100 text-primary-700 border-primary-200\",\n  stt: \"bg-success-50 text-success-700 border-success-200\",\n  llm: \"bg-warning-50 text-warning-700 border-warning-200\",\n  memory: \"bg-info-50 text-info-700 border-info-200\",\n  tool: \"bg-neutral-100 text-neutral-700 border-neutral-200\",\n  custom: \"bg-neutral-50 text-neutral-600 border-neutral-200\",\n};\n\n/**\n * Status indicator colors.\n */\nconst statusColors: Record<PluginStatus, string> = {\n  loaded: \"bg-success-500\",\n  unloaded: \"bg-neutral-400\",\n  error: \"bg-error-500\",\n  loading: \"bg-warning-500 animate-pulse\",\n};\n\n/**\n * Status display labels.\n */\nconst statusLabels: Record<PluginStatus, string> = {\n  loaded: \"Loaded\",\n  unloaded: \"Not Loaded\",\n  error: \"Error\",\n  loading: \"Loading...\",\n};\n\n/**\n * PluginGallery component props.\n */\nexport interface PluginGalleryProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\" | \"onLoad\"> {\n  /** Array of plugins to display */\n  plugins: PluginInfo[];\n  /** Currently selected plugin ID */\n  selectedId?: string;\n  /** Callback when a plugin is selected */\n  onSelect?: (plugin: PluginInfo) => void;\n  /** Callback when load is requested */\n  onLoad?: (plugin: PluginInfo) => void;\n  /** Callback when unload is requested */\n  onUnload?: (plugin: PluginInfo) => void;\n  /** Initial filters */\n  initialFilters?: GalleryFilters;\n  /** Initial sort settings */\n  initialSort?: { by: GallerySortBy; order: GallerySortOrder };\n  /** Initial view mode */\n  initialViewMode?: GalleryViewMode;\n  /** Whether to show filter controls */\n  showFilters?: boolean;\n  /** Whether to show search input */\n  showSearch?: boolean;\n  /** Whether to show view mode toggle */\n  showViewToggle?: boolean;\n  /** Empty state message */\n  emptyMessage?: string;\n  /** Loading state */\n  isLoading?: boolean;\n  /** Grid columns for grid view */\n  gridColumns?: 2 | 3 | 4;\n}\n\n/**\n * Filter icon component.\n */\nconst FilterIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polygon points=\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\" />\n  </svg>\n);\n\n/**\n * Grid icon component.\n */\nconst GridIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\n    <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\n  </svg>\n);\n\n/**\n * List icon component.\n */\nconst ListIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"8\" y1=\"6\" x2=\"21\" y2=\"6\" />\n    <line x1=\"8\" y1=\"12\" x2=\"21\" y2=\"12\" />\n    <line x1=\"8\" y1=\"18\" x2=\"21\" y2=\"18\" />\n    <line x1=\"3\" y1=\"6\" x2=\"3.01\" y2=\"6\" />\n    <line x1=\"3\" y1=\"12\" x2=\"3.01\" y2=\"12\" />\n    <line x1=\"3\" y1=\"18\" x2=\"3.01\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Search icon component.\n */\nconst SearchIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n    <path d=\"m21 21-4.3-4.3\" />\n  </svg>\n);\n\n/**\n * Load/Download icon component.\n */\nconst LoadIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n    <polyline points=\"7 10 12 15 17 10\" />\n    <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n  </svg>\n);\n\n/**\n * Unload/Stop icon component.\n */\nconst UnloadIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" rx=\"2\" />\n  </svg>\n);\n\n/**\n * Grid column class mapping.\n */\nconst gridColumnClasses: Record<number, string> = {\n  2: \"grid-cols-1 sm:grid-cols-2\",\n  3: \"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3\",\n  4: \"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\",\n};\n\n/**\n * PluginGallery component.\n *\n * Displays a grid or list of available plugins with filtering,\n * searching, and sorting capabilities.\n *\n * @example\n * ```tsx\n * <PluginGallery\n *   plugins={pluginList}\n *   selectedId=\"tts_kokoro\"\n *   onSelect={(plugin) => console.log(\"Selected:\", plugin)}\n *   onLoad={(plugin) => loadPlugin(plugin.id)}\n *   showFilters\n *   showSearch\n * />\n * ```\n */\nexport const PluginGallery = forwardRef<HTMLDivElement, PluginGalleryProps>(\n  (\n    {\n      plugins,\n      selectedId,\n      onSelect,\n      onLoad,\n      onUnload,\n      initialFilters = { status: \"all\", contract: \"all\", search: \"\" },\n      initialSort = { by: \"name\", order: \"asc\" },\n      initialViewMode = \"grid\",\n      showFilters = true,\n      showSearch = true,\n      showViewToggle = true,\n      emptyMessage = \"No plugins found\",\n      isLoading = false,\n      gridColumns = 3,\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    // State\n    const [filters, setFilters] = useState<GalleryFilters>(initialFilters);\n    const [sortBy] = useState<GallerySortBy>(initialSort.by);\n    const [sortOrder] = useState<GallerySortOrder>(initialSort.order);\n    const [viewMode, setViewMode] = useState<GalleryViewMode>(initialViewMode);\n    const [showFilterPanel, setShowFilterPanel] = useState(false);\n\n    // Filter and sort plugins\n    const filteredPlugins = useMemo(() => {\n      let result = [...plugins];\n\n      // Apply status filter\n      if (filters.status && filters.status !== \"all\") {\n        result = result.filter((p) => p.status === filters.status);\n      }\n\n      // Apply contract filter\n      if (filters.contract && filters.contract !== \"all\") {\n        result = result.filter((p) => p.contract === filters.contract);\n      }\n\n      // Apply built-in filter\n      if (filters.builtInOnly) {\n        result = result.filter((p) => p.builtIn);\n      }\n\n      // Apply search filter\n      if (filters.search) {\n        const searchLower = filters.search.toLowerCase();\n        result = result.filter(\n          (p) =>\n            p.name.toLowerCase().includes(searchLower) ||\n            p.description.toLowerCase().includes(searchLower) ||\n            p.id.toLowerCase().includes(searchLower) ||\n            p.tags?.some((t) => t.toLowerCase().includes(searchLower))\n        );\n      }\n\n      // Apply sorting\n      result.sort((a, b) => {\n        let comparison = 0;\n        switch (sortBy) {\n          case \"name\":\n            comparison = a.name.localeCompare(b.name);\n            break;\n          case \"status\":\n            comparison = a.status.localeCompare(b.status);\n            break;\n          case \"contract\":\n            comparison = a.contract.localeCompare(b.contract);\n            break;\n          case \"lastUpdated\":\n            comparison = (a.lastUpdated || \"\").localeCompare(b.lastUpdated || \"\");\n            break;\n        }\n        return sortOrder === \"asc\" ? comparison : -comparison;\n      });\n\n      return result;\n    }, [plugins, filters, sortBy, sortOrder]);\n\n    // Handle search input\n    const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      setFilters((prev) => ({ ...prev, search: e.target.value }));\n    };\n\n    // Handle filter changes\n    const handleStatusFilter = (status: PluginStatus | \"all\") => {\n      setFilters((prev) => ({ ...prev, status }));\n    };\n\n    const handleContractFilter = (contract: PluginContract | \"all\") => {\n      setFilters((prev) => ({ ...prev, contract }));\n    };\n\n    // Container styles\n    const containerStyles = [\"flex\", \"flex-col\", \"gap-4\", className]\n      .filter(Boolean)\n      .join(\" \");\n\n    // Toolbar styles\n    const toolbarStyles = [\n      \"flex\",\n      \"flex-wrap\",\n      \"items-center\",\n      \"gap-3\",\n      \"p-3\",\n      \"bg-neutral-50\",\n      \"border\",\n      \"border-neutral-200\",\n      \"rounded-lg\",\n    ].join(\" \");\n\n    // Grid/list container styles\n    const contentStyles =\n      viewMode === \"grid\"\n        ? [\"grid\", \"gap-4\", gridColumnClasses[gridColumns]].join(\" \")\n        : [\"flex\", \"flex-col\", \"gap-2\"].join(\" \");\n\n    // Empty state styles\n    const emptyStyles = [\n      \"flex\",\n      \"flex-col\",\n      \"items-center\",\n      \"justify-center\",\n      \"py-12\",\n      \"text-neutral-500\",\n    ].join(\" \");\n\n    // Loading state styles\n    const loadingStyles = [\n      \"flex\",\n      \"items-center\",\n      \"justify-center\",\n      \"py-12\",\n    ].join(\" \");\n\n    return (\n      <div ref={ref} className={containerStyles} {...props}>\n        {/* Toolbar */}\n        {(showSearch || showFilters || showViewToggle) && (\n          <div className={toolbarStyles}>\n            {/* Search */}\n            {showSearch && (\n              <div className=\"relative flex-1 min-w-48\">\n                <SearchIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\" />\n                <input\n                  type=\"text\"\n                  placeholder=\"Search plugins...\"\n                  value={filters.search || \"\"}\n                  onChange={handleSearchChange}\n                  className={[\n                    \"w-full\",\n                    \"pl-9\",\n                    \"pr-4\",\n                    \"py-2\",\n                    \"text-sm\",\n                    \"bg-white\",\n                    \"border\",\n                    \"border-neutral-200\",\n                    \"rounded-md\",\n                    \"focus:outline-none\",\n                    \"focus:ring-2\",\n                    \"focus:ring-primary-500\",\n                    \"focus:border-transparent\",\n                    \"placeholder:text-neutral-400\",\n                  ].join(\" \")}\n                />\n              </div>\n            )}\n\n            {/* Filter toggle */}\n            {showFilters && (\n              <button\n                type=\"button\"\n                onClick={() => setShowFilterPanel(!showFilterPanel)}\n                className={[\n                  \"flex\",\n                  \"items-center\",\n                  \"gap-2\",\n                  \"px-3\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"font-medium\",\n                  \"rounded-md\",\n                  \"border\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                  showFilterPanel\n                    ? \"bg-primary-50 border-primary-200 text-primary-700\"\n                    : \"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50\",\n                ].join(\" \")}\n              >\n                <FilterIcon className=\"h-4 w-4\" />\n                <span>Filters</span>\n              </button>\n            )}\n\n            {/* View mode toggle */}\n            {showViewToggle && (\n              <div className=\"flex border border-neutral-200 rounded-md overflow-hidden\">\n                <button\n                  type=\"button\"\n                  onClick={() => setViewMode(\"grid\")}\n                  className={[\n                    \"p-2\",\n                    \"transition-colors\",\n                    \"duration-150\",\n                    viewMode === \"grid\"\n                      ? \"bg-primary-50 text-primary-600\"\n                      : \"bg-white text-neutral-500 hover:bg-neutral-50\",\n                  ].join(\" \")}\n                  aria-label=\"Grid view\"\n                >\n                  <GridIcon className=\"h-4 w-4\" />\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setViewMode(\"list\")}\n                  className={[\n                    \"p-2\",\n                    \"border-l\",\n                    \"border-neutral-200\",\n                    \"transition-colors\",\n                    \"duration-150\",\n                    viewMode === \"list\"\n                      ? \"bg-primary-50 text-primary-600\"\n                      : \"bg-white text-neutral-500 hover:bg-neutral-50\",\n                  ].join(\" \")}\n                  aria-label=\"List view\"\n                >\n                  <ListIcon className=\"h-4 w-4\" />\n                </button>\n              </div>\n            )}\n\n            {/* Plugin count */}\n            <span className=\"text-sm text-neutral-500 ml-auto\">\n              {filteredPlugins.length} plugin{filteredPlugins.length !== 1 ? \"s\" : \"\"}\n            </span>\n          </div>\n        )}\n\n        {/* Filter panel (collapsible) */}\n        {showFilters && showFilterPanel && (\n          <div className=\"flex flex-wrap gap-4 p-4 bg-white border border-neutral-200 rounded-lg\">\n            {/* Status filter */}\n            <div className=\"flex flex-col gap-2\">\n              <label className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide\">\n                Status\n              </label>\n              <div className=\"flex flex-wrap gap-1\">\n                {([\"all\", \"loaded\", \"unloaded\", \"error\"] as const).map((status) => (\n                  <button\n                    key={status}\n                    type=\"button\"\n                    onClick={() => handleStatusFilter(status)}\n                    className={[\n                      \"px-3\",\n                      \"py-1\",\n                      \"text-xs\",\n                      \"font-medium\",\n                      \"rounded-full\",\n                      \"border\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      filters.status === status\n                        ? \"bg-primary-100 border-primary-300 text-primary-700\"\n                        : \"bg-white border-neutral-200 text-neutral-600 hover:bg-neutral-50\",\n                    ].join(\" \")}\n                  >\n                    {status === \"all\" ? \"All\" : statusLabels[status]}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Contract filter */}\n            <div className=\"flex flex-col gap-2\">\n              <label className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide\">\n                Contract\n              </label>\n              <div className=\"flex flex-wrap gap-1\">\n                {([\"all\", \"tts\", \"stt\", \"llm\", \"memory\", \"tool\", \"custom\"] as const).map(\n                  (contract) => (\n                    <button\n                      key={contract}\n                      type=\"button\"\n                      onClick={() => handleContractFilter(contract)}\n                      className={[\n                        \"px-3\",\n                        \"py-1\",\n                        \"text-xs\",\n                        \"font-medium\",\n                        \"rounded-full\",\n                        \"border\",\n                        \"transition-colors\",\n                        \"duration-150\",\n                        filters.contract === contract\n                          ? \"bg-primary-100 border-primary-300 text-primary-700\"\n                          : \"bg-white border-neutral-200 text-neutral-600 hover:bg-neutral-50\",\n                      ].join(\" \")}\n                    >\n                      {contract === \"all\" ? \"All\" : contract.toUpperCase()}\n                    </button>\n                  )\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Loading state */}\n        {isLoading && (\n          <div className={loadingStyles}>\n            <div className=\"flex items-center gap-3 text-neutral-500\">\n              <div className=\"h-5 w-5 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\n              <span>Loading plugins...</span>\n            </div>\n          </div>\n        )}\n\n        {/* Empty state */}\n        {!isLoading && filteredPlugins.length === 0 && (\n          <div className={emptyStyles}>\n            <div className=\"h-12 w-12 mb-4 text-neutral-300\">\n              <GridIcon className=\"h-full w-full\" />\n            </div>\n            <p className=\"text-neutral-500\">{emptyMessage}</p>\n            {filters.search && (\n              <p className=\"text-sm text-neutral-400 mt-1\">\n                Try adjusting your search or filters\n              </p>\n            )}\n          </div>\n        )}\n\n        {/* Plugin grid/list */}\n        {!isLoading && filteredPlugins.length > 0 && (\n          <div className={contentStyles}>\n            {filteredPlugins.map((plugin) => (\n              <PluginGalleryItem\n                key={plugin.id}\n                plugin={plugin}\n                isSelected={selectedId === plugin.id}\n                viewMode={viewMode}\n                onSelect={() => onSelect?.(plugin)}\n                onLoad={() => onLoad?.(plugin)}\n                onUnload={() => onUnload?.(plugin)}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  }\n);\n\nPluginGallery.displayName = \"PluginGallery\";\n\n/**\n * Internal gallery item component.\n */\ninterface PluginGalleryItemProps {\n  plugin: PluginInfo;\n  isSelected: boolean;\n  viewMode: GalleryViewMode;\n  onSelect?: () => void;\n  onLoad?: () => void;\n  onUnload?: () => void;\n}\n\nconst PluginGalleryItem: React.FC<PluginGalleryItemProps> = ({\n  plugin,\n  isSelected,\n  viewMode,\n  onSelect,\n  onLoad,\n  onUnload,\n}) => {\n  const isGrid = viewMode === \"grid\";\n\n  const itemStyles = [\n    \"group\",\n    \"relative\",\n    \"bg-white\",\n    \"border\",\n    \"rounded-lg\",\n    \"cursor-pointer\",\n    \"transition-all\",\n    \"duration-150\",\n    isSelected\n      ? \"border-primary-500 ring-2 ring-primary-100\"\n      : \"border-neutral-200 hover:border-neutral-300 hover:shadow-sm\",\n    isGrid ? \"p-4\" : \"p-3 flex items-center gap-4\",\n  ].join(\" \");\n\n  const handleClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    onSelect?.();\n  };\n\n  const handleAction = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (plugin.status === \"loaded\") {\n      onUnload?.();\n    } else if (plugin.status === \"unloaded\") {\n      onLoad?.();\n    }\n  };\n\n  return (\n    <div className={itemStyles} onClick={handleClick} role=\"button\" tabIndex={0} title={plugin.description}>\n      {/* Status indicator */}\n      <div\n        className={[\n          \"absolute\",\n          \"top-3\",\n          \"right-3\",\n          \"h-2\",\n          \"w-2\",\n          \"rounded-full\",\n          statusColors[plugin.status],\n        ].join(\" \")}\n        title={statusLabels[plugin.status]}\n      />\n\n      {/* Content */}\n      <div className={isGrid ? \"\" : \"flex-1 min-w-0\"}>\n        {/* Contract badge */}\n        <span\n          className={[\n            \"inline-flex\",\n            \"items-center\",\n            \"px-2\",\n            \"py-0.5\",\n            \"text-xs\",\n            \"font-medium\",\n            \"rounded\",\n            \"border\",\n            contractColors[plugin.contract],\n            isGrid ? \"mb-2\" : \"\",\n          ].join(\" \")}\n        >\n          {plugin.contract.toUpperCase()}\n        </span>\n\n        {/* Name and version */}\n        <div className={isGrid ? \"mt-2\" : \"mt-1\"}>\n          <h4 className=\"text-sm font-semibold text-neutral-900 truncate\">\n            {plugin.name}\n            {plugin.builtIn && (\n              <span className=\"ml-1 text-xs font-normal text-neutral-400\">(built-in)</span>\n            )}\n          </h4>\n          <span className=\"text-xs text-neutral-500\">v{plugin.version}</span>\n        </div>\n\n        {/* Description */}\n        <p\n          className={[\n            \"text-sm\",\n            \"text-neutral-600\",\n            \"mt-1\",\n            isGrid ? \"line-clamp-2\" : \"truncate\",\n          ].join(\" \")}\n        >\n          {plugin.description}\n        </p>\n      </div>\n\n      {/* Permanent Load/Unload icon button */}\n      <button\n        type=\"button\"\n        onClick={handleAction}\n        disabled={plugin.status === \"loading\" || plugin.status === \"error\"}\n        className={[\n          \"p-1.5\",\n          \"rounded-md\",\n          \"transition-colors\",\n          \"duration-150\",\n          isGrid ? \"absolute bottom-3 right-3\" : \"shrink-0\",\n          plugin.status === \"loaded\"\n            ? \"text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100\"\n            : \"text-primary-500 hover:text-primary-700 hover:bg-primary-50\",\n          (plugin.status === \"loading\" || plugin.status === \"error\") &&\n          \"opacity-50 cursor-not-allowed\",\n        ].join(\" \")}\n        title={plugin.status === \"loaded\" ? \"Unload plugin\" : \"Load plugin\"}\n      >\n        {plugin.status === \"loaded\" ? (\n          <UnloadIcon className=\"h-5 w-5\" />\n        ) : plugin.status === \"loading\" ? (\n          <LoadIcon className=\"h-5 w-5 animate-pulse\" />\n        ) : (\n          <LoadIcon className=\"h-5 w-5\" />\n        )}\n      </button>\n    </div>\n  );\n};\n\nexport default PluginGallery;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\PreviewPanel.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":357,"column":35,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":357,"endColumn":37,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[10260,10262],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":490,"column":50,"nodeType":"Identifier","messageId":"invalidType","endLine":490,"endColumn":55},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":667,"column":36,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":667,"endColumn":38,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[20169,20171],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":688,"column":39,"nodeType":"Identifier","messageId":"invalidType","endLine":688,"endColumn":43},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a ternary expression, as it is simpler to read.","line":695,"column":18,"nodeType":"ConditionalExpression","messageId":"preferNullishOverTernary","endLine":695,"endColumn":75,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[21222,21279],"text":"children ?? <LivePreview screenId={screenId} />"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * D044 - src/components/factory/PreviewPanel.tsx\r\n * ================================================\r\n * Live preview panel for displaying component/screen previews.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\r\n *\r\n * Rules:\r\n *   - NO hardcoded colors, spacing, or sizes\r\n *   - ALL styling via Tailwind classes referencing design tokens\r\n *   - Fully typed props with TypeScript\r\n */\r\n\r\nimport React, { forwardRef, useState, useCallback, type HTMLAttributes, type ReactNode } from \"react\";\r\n\r\n/**\r\n * Preview device types.\r\n */\r\nexport type DeviceType = \"desktop\" | \"tablet\" | \"mobile\" | \"custom\";\r\n\r\n/**\r\n * Preview orientation.\r\n */\r\nexport type Orientation = \"portrait\" | \"landscape\";\r\n\r\n/**\r\n * Preview theme mode.\r\n */\r\nexport type ThemeMode = \"light\" | \"dark\" | \"system\";\r\n\r\n/**\r\n * Device preset configurations.\r\n */\r\nexport interface DevicePreset {\r\n  /** Device name */\r\n  name: string;\r\n  /** Width in pixels */\r\n  width: number;\r\n  /** Height in pixels */\r\n  height: number;\r\n  /** Device type */\r\n  type: DeviceType;\r\n}\r\n\r\n/**\r\n * Built-in device presets.\r\n */\r\nconst devicePresets: DevicePreset[] = [\r\n  { name: \"Desktop\", width: 1920, height: 1080, type: \"desktop\" },\r\n  { name: \"Laptop\", width: 1366, height: 768, type: \"desktop\" },\r\n  { name: \"iPad Pro\", width: 1024, height: 1366, type: \"tablet\" },\r\n  { name: \"iPad\", width: 768, height: 1024, type: \"tablet\" },\r\n  { name: \"iPhone 14 Pro\", width: 393, height: 852, type: \"mobile\" },\r\n  { name: \"iPhone SE\", width: 375, height: 667, type: \"mobile\" },\r\n];\r\n\r\n/**\r\n * PreviewPanel component props.\r\n */\r\nimport { LivePreview } from \"./LivePreview\";\r\nimport { ThemedCanvasWrapper } from \"./ThemedCanvasWrapper\";\r\n\r\nexport interface PreviewPanelProps extends Omit<HTMLAttributes<HTMLDivElement>, \"children\"> {\r\n  /** Content to preview (direct children) */\r\n  children?: ReactNode;\r\n  /** Screen ID to preview (using LivePreview) */\r\n  screenId?: string;\r\n  /** Initial device preset index */\r\n  initialDevice?: number;\r\n  /** Initial zoom level (0.25 - 2) */\r\n  initialZoom?: number;\r\n  /** Initial theme mode */\r\n  initialTheme?: ThemeMode;\r\n  /** Initial orientation */\r\n  initialOrientation?: Orientation;\r\n  /** Whether to show device selector */\r\n  showDeviceSelector?: boolean;\r\n  /** Whether to show zoom controls */\r\n  showZoomControls?: boolean;\r\n  /** Whether to show theme toggle */\r\n  showThemeToggle?: boolean;\r\n  /** Whether to show orientation toggle */\r\n  showOrientationToggle?: boolean;\r\n  /** Whether to show refresh button */\r\n  showRefresh?: boolean;\r\n  /** Whether to show fullscreen button */\r\n  showFullscreen?: boolean;\r\n  /** Custom device presets */\r\n  customPresets?: DevicePreset[];\r\n  /** Callback when zoom changes */\r\n  onZoomChange?: (zoom: number) => void;\r\n  /** Callback when device changes */\r\n  onDeviceChange?: (device: DevicePreset) => void;\r\n  /** Callback when theme changes */\r\n  onThemeChange?: (theme: ThemeMode) => void;\r\n  /** Callback when refresh is requested */\r\n  onRefresh?: () => void;\r\n  /** Empty state message */\r\n  emptyMessage?: string;\r\n  /** Loading state */\r\n  isLoading?: boolean;\r\n}\r\n\r\n/**\r\n * Zoom in icon.\r\n */\r\nconst ZoomInIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\r\n    <line x1=\"11\" y1=\"8\" x2=\"11\" y2=\"14\" />\r\n    <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Zoom out icon.\r\n */\r\nconst ZoomOutIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\r\n    <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Refresh icon.\r\n */\r\nconst RefreshIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <polyline points=\"23 4 23 10 17 10\" />\r\n    <polyline points=\"1 20 1 14 7 14\" />\r\n    <path d=\"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Fullscreen icon.\r\n */\r\nconst FullscreenIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <polyline points=\"15 3 21 3 21 9\" />\r\n    <polyline points=\"9 21 3 21 3 15\" />\r\n    <line x1=\"21\" y1=\"3\" x2=\"14\" y2=\"10\" />\r\n    <line x1=\"3\" y1=\"21\" x2=\"10\" y2=\"14\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Sun icon (light mode).\r\n */\r\nconst SunIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <circle cx=\"12\" cy=\"12\" r=\"5\" />\r\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" />\r\n    <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" />\r\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" />\r\n    <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" />\r\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" />\r\n    <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" />\r\n    <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" />\r\n    <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Moon icon (dark mode).\r\n */\r\nconst MoonIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Rotate icon.\r\n */\r\nconst RotateIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\" ry=\"2\" />\r\n    <path d=\"M9 9h6v6\" />\r\n    <path d=\"M15 9l-6 6\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Device type icons.\r\n */\r\nconst deviceTypeIcons: Record<DeviceType, React.FC<{ className?: string }>> = {\r\n  desktop: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\" />\r\n      <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\" />\r\n    </svg>\r\n  ),\r\n  tablet: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"4\" y=\"2\" width=\"16\" height=\"20\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"12\" y1=\"18\" x2=\"12.01\" y2=\"18\" />\r\n    </svg>\r\n  ),\r\n  mobile: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"5\" y=\"2\" width=\"14\" height=\"20\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"12\" y1=\"18\" x2=\"12.01\" y2=\"18\" />\r\n    </svg>\r\n  ),\r\n  custom: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n      <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\r\n    </svg>\r\n  ),\r\n};\r\n\r\n/**\r\n * Empty state icon.\r\n */\r\nconst EmptyIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n    <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" />\r\n    <polyline points=\"21 15 16 10 5 21\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * PreviewPanel component.\r\n *\r\n * A live preview panel for displaying component/screen previews\r\n * with device simulation, zoom controls, and theme switching.\r\n *\r\n * @example\r\n * ```tsx\r\n * <PreviewPanel\r\n *   showDeviceSelector\r\n *   showZoomControls\r\n *   showThemeToggle\r\n *   initialDevice={0}\r\n *   initialZoom={1}\r\n * >\r\n *   <MyComponent />\r\n * </PreviewPanel>\r\n * ```\r\n */\r\nexport const PreviewPanel = forwardRef<HTMLDivElement, PreviewPanelProps>(\r\n  (\r\n    {\r\n      children,\r\n      screenId,\r\n      initialDevice = 0,\r\n      initialZoom = 1,\r\n      initialTheme = \"light\",\r\n      initialOrientation = \"portrait\",\r\n      showDeviceSelector = true,\r\n      showZoomControls = true,\r\n      showThemeToggle = true,\r\n      showOrientationToggle = true,\r\n      showRefresh = true,\r\n      showFullscreen = false,\r\n      customPresets,\r\n      onZoomChange,\r\n      onDeviceChange,\r\n      onThemeChange,\r\n      onRefresh,\r\n      emptyMessage = \"No preview available\",\r\n      isLoading = false,\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    // State\r\n    const [currentDeviceIndex, setCurrentDeviceIndex] = useState(initialDevice);\r\n    const [zoom, setZoom] = useState(initialZoom);\r\n    const [theme, setTheme] = useState<ThemeMode>(initialTheme);\r\n    const [orientation, setOrientation] = useState<Orientation>(initialOrientation);\r\n    const [isFullscreen, setIsFullscreen] = useState(false);\r\n\r\n    // Use custom presets if provided, otherwise use built-in\r\n    const presets = customPresets || devicePresets;\r\n    const currentDevice = presets[currentDeviceIndex] || presets[0];\r\n\r\n    // Calculate effective dimensions based on orientation\r\n    const effectiveWidth =\r\n      orientation === \"landscape\" && currentDevice.type !== \"desktop\"\r\n        ? currentDevice.height\r\n        : currentDevice.width;\r\n    const effectiveHeight =\r\n      orientation === \"landscape\" && currentDevice.type !== \"desktop\"\r\n        ? currentDevice.width\r\n        : currentDevice.height;\r\n\r\n    // Zoom controls\r\n    const handleZoomIn = useCallback(() => {\r\n      const newZoom = Math.min(zoom + 0.25, 2);\r\n      setZoom(newZoom);\r\n      onZoomChange?.(newZoom);\r\n    }, [zoom, onZoomChange]);\r\n\r\n    const handleZoomOut = useCallback(() => {\r\n      const newZoom = Math.max(zoom - 0.25, 0.25);\r\n      setZoom(newZoom);\r\n      onZoomChange?.(newZoom);\r\n    }, [zoom, onZoomChange]);\r\n\r\n    const handleZoomReset = useCallback(() => {\r\n      setZoom(1);\r\n      onZoomChange?.(1);\r\n    }, [onZoomChange]);\r\n\r\n    // Device change\r\n    const handleDeviceChange = useCallback(\r\n      (index: number) => {\r\n        setCurrentDeviceIndex(index);\r\n        onDeviceChange?.(presets[index]);\r\n      },\r\n      [presets, onDeviceChange]\r\n    );\r\n\r\n    // Theme toggle\r\n    const handleThemeToggle = useCallback(() => {\r\n      const newTheme = theme === \"light\" ? \"dark\" : \"light\";\r\n      setTheme(newTheme);\r\n      onThemeChange?.(newTheme);\r\n    }, [theme, onThemeChange]);\r\n\r\n    // Orientation toggle\r\n    const handleOrientationToggle = useCallback(() => {\r\n      setOrientation((prev) => (prev === \"portrait\" ? \"landscape\" : \"portrait\"));\r\n    }, []);\r\n\r\n    // Refresh\r\n    const handleRefresh = useCallback(() => {\r\n      onRefresh?.();\r\n    }, [onRefresh]);\r\n\r\n    // Container styles\r\n    const containerStyles = [\r\n      \"flex\",\r\n      \"flex-col\",\r\n      \"h-full\",\r\n      \"bg-neutral-100\",\r\n      \"rounded-lg\",\r\n      \"overflow-hidden\",\r\n      isFullscreen && \"fixed inset-0 z-modal\",\r\n      className,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(\" \");\r\n\r\n    // Toolbar styles\r\n    const toolbarStyles = [\r\n      \"flex\",\r\n      \"items-center\",\r\n      \"gap-2\",\r\n      \"p-2\",\r\n      \"bg-white\",\r\n      \"border-b\",\r\n      \"border-neutral-200\",\r\n    ].join(\" \");\r\n\r\n    // Preview area styles\r\n    const previewAreaStyles = [\r\n      \"flex-1\",\r\n      \"flex\",\r\n      \"items-center\",\r\n      \"justify-center\",\r\n      \"overflow-auto\",\r\n      \"p-6\",\r\n    ].join(\" \");\r\n\r\n    // Device frame styles\r\n    const deviceFrameStyles = [\r\n      \"relative\",\r\n      \"bg-white\",\r\n      \"border\",\r\n      \"border-neutral-300\",\r\n      \"rounded-lg\",\r\n      \"shadow-lg\",\r\n      \"overflow-hidden\",\r\n      \"transition-all\",\r\n      \"duration-300\",\r\n    ].join(\" \");\r\n\r\n    // Get device icon\r\n    const DeviceIcon = deviceTypeIcons[currentDevice.type];\r\n\r\n    return (\r\n      <div ref={ref} className={containerStyles} {...props}>\r\n        {/* Toolbar */}\r\n        <div className={toolbarStyles}>\r\n          {/* Device selector */}\r\n          {showDeviceSelector && (\r\n            <div className=\"flex items-center gap-1\">\r\n              <DeviceIcon className=\"h-4 w-4 text-neutral-500\" />\r\n              <select\r\n                value={currentDeviceIndex}\r\n                onChange={(e) => handleDeviceChange(Number(e.target.value))}\r\n                className={[\r\n                  \"px-2\",\r\n                  \"py-1\",\r\n                  \"text-sm\",\r\n                  \"bg-neutral-50\",\r\n                  \"border\",\r\n                  \"border-neutral-200\",\r\n                  \"rounded-md\",\r\n                  \"focus:outline-none\",\r\n                  \"focus:ring-2\",\r\n                  \"focus:ring-primary-500\",\r\n                ].join(\" \")}\r\n              >\r\n                {presets.map((preset, index) => (\r\n                  <option key={`${preset.name}-${index}`} value={index}>\r\n                    {preset.name} ({preset.width}x{preset.height})\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          )}\r\n\r\n          {/* Orientation toggle */}\r\n          {showOrientationToggle && currentDevice.type !== \"desktop\" && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleOrientationToggle}\r\n              className={[\r\n                \"p-1.5\",\r\n                \"rounded-md\",\r\n                \"text-neutral-500\",\r\n                \"hover:text-neutral-700\",\r\n                \"hover:bg-neutral-100\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n              ].join(\" \")}\r\n              title={`Switch to ${orientation === \"portrait\" ? \"landscape\" : \"portrait\"}`}\r\n            >\r\n              <RotateIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n\r\n          {/* Spacer */}\r\n          <div className=\"flex-1\" />\r\n\r\n          {/* Zoom controls */}\r\n          {showZoomControls && (\r\n            <div className=\"flex items-center gap-1 border border-neutral-200 rounded-md overflow-hidden\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleZoomOut}\r\n                disabled={zoom <= 0.25}\r\n                className={[\r\n                  \"p-1.5\",\r\n                  \"text-neutral-500\",\r\n                  \"hover:text-neutral-700\",\r\n                  \"hover:bg-neutral-100\",\r\n                  \"transition-colors\",\r\n                  \"duration-150\",\r\n                  \"disabled:opacity-50\",\r\n                  \"disabled:cursor-not-allowed\",\r\n                ].join(\" \")}\r\n                title=\"Zoom out\"\r\n              >\r\n                <ZoomOutIcon className=\"h-4 w-4\" />\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleZoomReset}\r\n                className={[\r\n                  \"px-2\",\r\n                  \"py-1\",\r\n                  \"text-xs\",\r\n                  \"font-medium\",\r\n                  \"text-neutral-600\",\r\n                  \"hover:bg-neutral-100\",\r\n                  \"min-w-12\",\r\n                  \"text-center\",\r\n                ].join(\" \")}\r\n                title=\"Reset zoom\"\r\n              >\r\n                {Math.round(zoom * 100)}%\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleZoomIn}\r\n                disabled={zoom >= 2}\r\n                className={[\r\n                  \"p-1.5\",\r\n                  \"text-neutral-500\",\r\n                  \"hover:text-neutral-700\",\r\n                  \"hover:bg-neutral-100\",\r\n                  \"transition-colors\",\r\n                  \"duration-150\",\r\n                  \"disabled:opacity-50\",\r\n                  \"disabled:cursor-not-allowed\",\r\n                ].join(\" \")}\r\n                title=\"Zoom in\"\r\n              >\r\n                <ZoomInIcon className=\"h-4 w-4\" />\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Theme toggle */}\r\n          {showThemeToggle && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleThemeToggle}\r\n              className={[\r\n                \"p-1.5\",\r\n                \"rounded-md\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n                theme === \"dark\"\r\n                  ? \"bg-neutral-800 text-yellow-400\"\r\n                  : \"text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100\",\r\n              ].join(\" \")}\r\n              title={`Switch to ${theme === \"light\" ? \"dark\" : \"light\"} mode`}\r\n            >\r\n              {theme === \"dark\" ? (\r\n                <MoonIcon className=\"h-4 w-4\" />\r\n              ) : (\r\n                <SunIcon className=\"h-4 w-4\" />\r\n              )}\r\n            </button>\r\n          )}\r\n\r\n          {/* Refresh button */}\r\n          {showRefresh && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleRefresh}\r\n              className={[\r\n                \"p-1.5\",\r\n                \"rounded-md\",\r\n                \"text-neutral-500\",\r\n                \"hover:text-neutral-700\",\r\n                \"hover:bg-neutral-100\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n              ].join(\" \")}\r\n              title=\"Refresh preview\"\r\n            >\r\n              <RefreshIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n\r\n          {/* Fullscreen button */}\r\n          {showFullscreen && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setIsFullscreen(!isFullscreen)}\r\n              className={[\r\n                \"p-1.5\",\r\n                \"rounded-md\",\r\n                \"text-neutral-500\",\r\n                \"hover:text-neutral-700\",\r\n                \"hover:bg-neutral-100\",\r\n                \"transition-colors\",\r\n                \"duration-150\",\r\n              ].join(\" \")}\r\n              title={isFullscreen ? \"Exit fullscreen\" : \"Fullscreen\"}\r\n            >\r\n              <FullscreenIcon className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Preview area */}\r\n        <div className={previewAreaStyles}>\r\n          {/* Loading state */}\r\n          {isLoading && (\r\n            <div className=\"flex items-center gap-3 text-neutral-500\">\r\n              <div className=\"h-5 w-5 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\r\n              <span>Loading preview...</span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Empty state */}\r\n          {!isLoading && !children && !screenId && (\r\n            <div className=\"flex flex-col items-center justify-center text-neutral-400\">\r\n              <EmptyIcon className=\"h-16 w-16 mb-4\" />\r\n              <p className=\"text-neutral-500\">{emptyMessage}</p>\r\n              <p className=\"text-sm text-neutral-400 mt-1\">\r\n                Select a component or screen to preview\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Device frame with content */}\r\n          {!isLoading && (children || screenId) && (\r\n            <div\r\n              className={deviceFrameStyles}\r\n              style={{\r\n                width: effectiveWidth * zoom,\r\n                height: effectiveHeight * zoom,\r\n              }}\r\n            >\r\n              {/* Device notch for mobile */}\r\n              {currentDevice.type === \"mobile\" && orientation === \"portrait\" && (\r\n                <div className=\"absolute top-0 left-1/2 -translate-x-1/2 w-24 h-6 bg-neutral-900 rounded-b-xl z-10\" />\r\n              )}\r\n\r\n              {/* Content container with theme applied */}\r\n              <ThemedCanvasWrapper\r\n                className={[\r\n                  \"absolute\",\r\n                  \"inset-0\",\r\n                  \"overflow-auto\",\r\n                ].join(\" \")}\r\n                style={{\r\n                  transform: `scale(${zoom})`,\r\n                  transformOrigin: \"top left\",\r\n                  width: effectiveWidth,\r\n                  height: effectiveHeight,\r\n                }}\r\n                applyBackground\r\n              >\r\n                {children ? children : <LivePreview screenId={screenId} />}\r\n              </ThemedCanvasWrapper>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Status bar */}\r\n        <div className=\"flex items-center justify-between px-3 py-1.5 bg-neutral-50 border-t border-neutral-200 text-xs text-neutral-500\">\r\n          <span>\r\n            {currentDevice.name} ÔÇó {effectiveWidth}├ù{effectiveHeight}px\r\n          </span>\r\n          <span>{theme === \"dark\" ? \"Dark\" : \"Light\"} mode</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nPreviewPanel.displayName = \"PreviewPanel\";\r\n\r\nexport default PreviewPanel;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\PropertyInspector.tsx","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":53,"column":13,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":53,"endColumn":53,"fix":{"range":[1321,1361],"text":"{ label: string; value: unknown }[]"}},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":227,"column":25,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":227,"endColumn":36},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value ?? \"#000000\"' will use Object's default stringification format ('[object Object]') when stringified.","line":269,"column":27,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":269,"endColumn":45},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":276,"column":27,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":276,"endColumn":38},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":288,"column":25,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":288,"endColumn":36},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":303,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":303,"endColumn":64,"suggestions":[{"messageId":"addBrackets","fix":{"range":[8272,9665],"text":"{ const selectedValues = Array.isArray(value) ? value : [];\r\n      return (\r\n        <div className=\"flex flex-wrap gap-1\">\r\n          {options?.map((opt) => {\r\n            const isSelected = selectedValues.includes(opt.value);\r\n            return (\r\n              <button\r\n                key={String(opt.value)}\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  if (isDisabled) return;\r\n                  const newValues = isSelected\r\n                    ? selectedValues.filter((v) => v !== opt.value)\r\n                    : [...selectedValues, opt.value];\r\n                  onChange(newValues);\r\n                }}\r\n                disabled={isDisabled}\r\n                className={[\r\n                  \"px-2\",\r\n                  \"py-1\",\r\n                  \"text-xs\",\r\n                  \"font-medium\",\r\n                  \"rounded\",\r\n                  \"border\",\r\n                  \"transition-colors\",\r\n                  \"duration-150\",\r\n                  isSelected\r\n                    ? \"bg-primary-100 border-primary-300 text-primary-700\"\r\n                    : \"bg-white border-neutral-200 text-neutral-600 hover:bg-neutral-50\",\r\n                  isDisabled && \"opacity-50 cursor-not-allowed\",\r\n                ].join(\" \")}\r\n              >\r\n                {opt.label}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n      ); }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe spread of an `any` value in an array.","line":316,"column":24,"nodeType":"SpreadElement","messageId":"unsafeArraySpread","endLine":316,"endColumn":41},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":346,"column":86,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":346,"endColumn":97},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":372,"column":25,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":372,"endColumn":36},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":707,"column":77,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21291,21312],"text":"No properties match &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21291,21312],"text":"No properties match &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21291,21312],"text":"No properties match &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21291,21312],"text":"No properties match &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":707,"column":91,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21325,21326],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21325,21326],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21325,21326],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21325,21326],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":716,"column":20,"nodeType":"CallExpression","messageId":"invalidType","endLine":716,"endColumn":100},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":716,"column":118,"nodeType":"MemberExpression","messageId":"invalidType","endLine":716,"endColumn":135},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":717,"column":20,"nodeType":"MemberExpression","messageId":"invalidType","endLine":717,"endColumn":37}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\r\n * D046 - src/components/factory/PropertyInspector.tsx\r\n * =====================================================\r\n * Property editor panel for inspecting and editing component properties.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\r\n *\r\n * Rules:\r\n *   - NO hardcoded colors, spacing, or sizes\r\n *   - ALL styling via Tailwind classes referencing design tokens\r\n *   - Fully typed props with TypeScript\r\n */\r\n\r\nimport React, { forwardRef, useState, useCallback, type HTMLAttributes } from \"react\";\r\n\r\n/**\r\n * Property types.\r\n */\r\nexport type PropertyType =\r\n  | \"string\"\r\n  | \"number\"\r\n  | \"boolean\"\r\n  | \"color\"\r\n  | \"select\"\r\n  | \"multiselect\"\r\n  | \"object\"\r\n  | \"array\"\r\n  | \"function\"\r\n  | \"node\";\r\n\r\n/**\r\n * Property definition.\r\n */\r\nexport interface PropertyDefinition {\r\n  /** Property key */\r\n  key: string;\r\n  /** Display label */\r\n  label: string;\r\n  /** Property type */\r\n  type: PropertyType;\r\n  /** Current value */\r\n  value: unknown;\r\n  /** Default value */\r\n  defaultValue?: unknown;\r\n  /** Description */\r\n  description?: string;\r\n  /** Whether required */\r\n  required?: boolean;\r\n  /** Whether readonly */\r\n  readonly?: boolean;\r\n  /** Options for select/multiselect */\r\n  options?: Array<{ label: string; value: unknown }>;\r\n  /** Min value for numbers */\r\n  min?: number;\r\n  /** Max value for numbers */\r\n  max?: number;\r\n  /** Step for numbers */\r\n  step?: number;\r\n  /** Placeholder text */\r\n  placeholder?: string;\r\n  /** Category for grouping */\r\n  category?: string;\r\n  /** Nested properties for object type */\r\n  properties?: PropertyDefinition[];\r\n}\r\n\r\n/**\r\n * Property group.\r\n */\r\nexport interface PropertyGroup {\r\n  /** Group name */\r\n  name: string;\r\n  /** Whether collapsed */\r\n  collapsed?: boolean;\r\n  /** Properties in this group */\r\n  properties: PropertyDefinition[];\r\n}\r\n\r\n/**\r\n * Selected element info.\r\n */\r\nexport interface SelectedElementInfo {\r\n  /** Element ID */\r\n  id: string;\r\n  /** Element name */\r\n  name: string;\r\n  /** Element type */\r\n  type: string;\r\n  /** Component ID (if applicable) */\r\n  componentId?: string;\r\n}\r\n\r\n/**\r\n * PropertyInspector component props.\r\n */\r\nexport interface PropertyInspectorProps extends HTMLAttributes<HTMLDivElement> {\r\n  /** Selected element info */\r\n  selectedElement?: SelectedElementInfo;\r\n  /** Property definitions or groups */\r\n  properties?: PropertyDefinition[] | PropertyGroup[];\r\n  /** Whether properties are grouped */\r\n  grouped?: boolean;\r\n  /** Callback when a property value changes */\r\n  onChange?: (key: string, value: unknown) => void;\r\n  /** Callback when property is reset to default */\r\n  onReset?: (key: string) => void;\r\n  /** Empty state message */\r\n  emptyMessage?: string;\r\n  /** Whether editing is enabled */\r\n  editable?: boolean;\r\n  /** Show search */\r\n  showSearch?: boolean;\r\n}\r\n\r\n/**\r\n * Chevron icon.\r\n */\r\nconst ChevronIcon: React.FC<{ className?: string; direction?: \"up\" | \"down\" }> = ({\r\n  className,\r\n  direction = \"down\",\r\n}) => (\r\n  <svg\r\n    className={[className, direction === \"up\" && \"rotate-180\"].filter(Boolean).join(\" \")}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <polyline points=\"6 9 12 15 18 9\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Reset icon.\r\n */\r\nconst ResetIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <path d=\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\" />\r\n    <path d=\"M3 3v5h5\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Search icon.\r\n */\r\nconst SearchIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n    <path d=\"m21 21-4.3-4.3\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Property type badges.\r\n */\r\nconst typeBadges: Record<PropertyType, { label: string; color: string }> = {\r\n  string: { label: \"str\", color: \"bg-success-100 text-success-700\" },\r\n  number: { label: \"num\", color: \"bg-primary-100 text-primary-700\" },\r\n  boolean: { label: \"bool\", color: \"bg-warning-100 text-warning-700\" },\r\n  color: { label: \"color\", color: \"bg-info-100 text-info-700\" },\r\n  select: { label: \"enum\", color: \"bg-neutral-100 text-neutral-700\" },\r\n  multiselect: { label: \"multi\", color: \"bg-neutral-100 text-neutral-700\" },\r\n  object: { label: \"obj\", color: \"bg-error-100 text-error-700\" },\r\n  array: { label: \"arr\", color: \"bg-error-100 text-error-700\" },\r\n  function: { label: \"fn\", color: \"bg-neutral-200 text-neutral-600\" },\r\n  node: { label: \"node\", color: \"bg-neutral-200 text-neutral-600\" },\r\n};\r\n\r\n/**\r\n * Property input component.\r\n */\r\ninterface PropertyInputProps {\r\n  property: PropertyDefinition;\r\n  onChange: (value: unknown) => void;\r\n  editable: boolean;\r\n}\r\n\r\nconst PropertyInput: React.FC<PropertyInputProps> = ({ property, onChange, editable }) => {\r\n  const { type, value, options, min, max, step, placeholder, readonly } = property;\r\n  const isDisabled = !editable || readonly;\r\n\r\n  const inputStyles = [\r\n    \"w-full\",\r\n    \"px-2\",\r\n    \"py-1\",\r\n    \"text-sm\",\r\n    \"bg-white\",\r\n    \"border\",\r\n    \"border-neutral-200\",\r\n    \"rounded\",\r\n    \"focus:outline-none\",\r\n    \"focus:ring-2\",\r\n    \"focus:ring-primary-500\",\r\n    \"focus:border-transparent\",\r\n    isDisabled && \"bg-neutral-50 text-neutral-500 cursor-not-allowed\",\r\n  ]\r\n    .filter(Boolean)\r\n    .join(\" \");\r\n\r\n  switch (type) {\r\n    case \"string\":\r\n      return (\r\n        <input\r\n          type=\"text\"\r\n          value={String(value ?? \"\")}\r\n          onChange={(e) => onChange(e.target.value)}\r\n          placeholder={placeholder}\r\n          disabled={isDisabled}\r\n          className={inputStyles}\r\n        />\r\n      );\r\n\r\n    case \"number\":\r\n      return (\r\n        <input\r\n          type=\"number\"\r\n          value={Number(value ?? 0)}\r\n          onChange={(e) => onChange(Number(e.target.value))}\r\n          min={min}\r\n          max={max}\r\n          step={step ?? 1}\r\n          placeholder={placeholder}\r\n          disabled={isDisabled}\r\n          className={inputStyles}\r\n        />\r\n      );\r\n\r\n    case \"boolean\":\r\n      return (\r\n        <label className=\"flex items-center gap-2 cursor-pointer\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={Boolean(value)}\r\n            onChange={(e) => onChange(e.target.checked)}\r\n            disabled={isDisabled}\r\n            className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\r\n          />\r\n          <span className=\"text-sm text-neutral-600\">{value ? \"true\" : \"false\"}</span>\r\n        </label>\r\n      );\r\n\r\n    case \"color\":\r\n      return (\r\n        <div className=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"color\"\r\n            value={String(value ?? \"#000000\")}\r\n            onChange={(e) => onChange(e.target.value)}\r\n            disabled={isDisabled}\r\n            className=\"h-8 w-8 rounded border border-neutral-200 cursor-pointer\"\r\n          />\r\n          <input\r\n            type=\"text\"\r\n            value={String(value ?? \"\")}\r\n            onChange={(e) => onChange(e.target.value)}\r\n            placeholder=\"#000000\"\r\n            disabled={isDisabled}\r\n            className={[inputStyles, \"flex-1\"].join(\" \")}\r\n          />\r\n        </div>\r\n      );\r\n\r\n    case \"select\":\r\n      return (\r\n        <select\r\n          value={String(value ?? \"\")}\r\n          onChange={(e) => onChange(e.target.value)}\r\n          disabled={isDisabled}\r\n          className={inputStyles}\r\n        >\r\n          <option value=\"\">Select...</option>\r\n          {options?.map((opt) => (\r\n            <option key={String(opt.value)} value={String(opt.value)}>\r\n              {opt.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      );\r\n\r\n    case \"multiselect\":\r\n      const selectedValues = Array.isArray(value) ? value : [];\r\n      return (\r\n        <div className=\"flex flex-wrap gap-1\">\r\n          {options?.map((opt) => {\r\n            const isSelected = selectedValues.includes(opt.value);\r\n            return (\r\n              <button\r\n                key={String(opt.value)}\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  if (isDisabled) return;\r\n                  const newValues = isSelected\r\n                    ? selectedValues.filter((v) => v !== opt.value)\r\n                    : [...selectedValues, opt.value];\r\n                  onChange(newValues);\r\n                }}\r\n                disabled={isDisabled}\r\n                className={[\r\n                  \"px-2\",\r\n                  \"py-1\",\r\n                  \"text-xs\",\r\n                  \"font-medium\",\r\n                  \"rounded\",\r\n                  \"border\",\r\n                  \"transition-colors\",\r\n                  \"duration-150\",\r\n                  isSelected\r\n                    ? \"bg-primary-100 border-primary-300 text-primary-700\"\r\n                    : \"bg-white border-neutral-200 text-neutral-600 hover:bg-neutral-50\",\r\n                  isDisabled && \"opacity-50 cursor-not-allowed\",\r\n                ].join(\" \")}\r\n              >\r\n                {opt.label}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n      );\r\n\r\n    case \"object\":\r\n    case \"array\":\r\n      return (\r\n        <textarea\r\n          value={typeof value === \"object\" ? JSON.stringify(value, null, 2) : String(value ?? \"\")}\r\n          onChange={(e) => {\r\n            try {\r\n              onChange(JSON.parse(e.target.value));\r\n            } catch {\r\n              // Invalid JSON, don't update\r\n            }\r\n          }}\r\n          placeholder={type === \"object\" ? \"{}\" : \"[]\"}\r\n          disabled={isDisabled}\r\n          className={[inputStyles, \"font-mono\", \"text-xs\", \"h-20\", \"resize-y\"].join(\" \")}\r\n        />\r\n      );\r\n\r\n    case \"function\":\r\n    case \"node\":\r\n      return (\r\n        <div className=\"px-2 py-1 text-sm text-neutral-400 italic bg-neutral-50 rounded border border-neutral-200\">\r\n          {type === \"function\" ? \"(function)\" : \"(ReactNode)\"}\r\n        </div>\r\n      );\r\n\r\n    default:\r\n      return (\r\n        <input\r\n          type=\"text\"\r\n          value={String(value ?? \"\")}\r\n          onChange={(e) => onChange(e.target.value)}\r\n          disabled={isDisabled}\r\n          className={inputStyles}\r\n        />\r\n      );\r\n  }\r\n};\r\n\r\n/**\r\n * Single property row.\r\n */\r\ninterface PropertyRowProps {\r\n  property: PropertyDefinition;\r\n  onChange: (key: string, value: unknown) => void;\r\n  onReset?: (key: string) => void;\r\n  editable: boolean;\r\n}\r\n\r\nconst PropertyRow: React.FC<PropertyRowProps> = ({ property, onChange, onReset, editable }) => {\r\n  const hasChanged = property.defaultValue !== undefined && property.value !== property.defaultValue;\r\n  const badge = typeBadges[property.type];\r\n\r\n  return (\r\n    <div className=\"flex flex-col gap-1 py-2 border-b border-neutral-100 last:border-b-0\">\r\n      {/* Label row */}\r\n      <div className=\"flex items-center gap-2\">\r\n        <span\r\n          className={[\"px-1\", \"text-xs\", \"font-mono\", \"rounded\", badge.color].join(\" \")}\r\n        >\r\n          {badge.label}\r\n        </span>\r\n        <span className=\"text-sm font-medium text-neutral-700 flex-1\">\r\n          {property.label}\r\n          {property.required && <span className=\"text-error-500 ml-0.5\">*</span>}\r\n        </span>\r\n        {hasChanged && onReset && editable && (\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => onReset(property.key)}\r\n            className=\"p-0.5 text-neutral-400 hover:text-neutral-600\"\r\n            title=\"Reset to default\"\r\n          >\r\n            <ResetIcon className=\"h-3 w-3\" />\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Input */}\r\n      <PropertyInput\r\n        property={property}\r\n        onChange={(value) => onChange(property.key, value)}\r\n        editable={editable}\r\n      />\r\n\r\n      {/* Description */}\r\n      {property.description && (\r\n        <p className=\"text-xs text-neutral-400\">{property.description}</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n/**\r\n * Property group component.\r\n */\r\ninterface PropertyGroupComponentProps {\r\n  group: PropertyGroup;\r\n  onChange: (key: string, value: unknown) => void;\r\n  onReset?: (key: string) => void;\r\n  editable: boolean;\r\n  searchQuery?: string;\r\n}\r\n\r\nconst PropertyGroupComponent: React.FC<PropertyGroupComponentProps> = ({\r\n  group,\r\n  onChange,\r\n  onReset,\r\n  editable,\r\n  searchQuery,\r\n}) => {\r\n  const [isCollapsed, setIsCollapsed] = useState(group.collapsed ?? false);\r\n\r\n  // Filter properties by search\r\n  const filteredProperties = searchQuery\r\n    ? group.properties.filter(\r\n        (p) =>\r\n          p.label.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n          p.key.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n          p.description?.toLowerCase().includes(searchQuery.toLowerCase())\r\n      )\r\n    : group.properties;\r\n\r\n  if (filteredProperties.length === 0) return null;\r\n\r\n  return (\r\n    <div className=\"border border-neutral-200 rounded-lg overflow-hidden\">\r\n      {/* Group header */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => setIsCollapsed(!isCollapsed)}\r\n        className={[\r\n          \"flex\",\r\n          \"items-center\",\r\n          \"w-full\",\r\n          \"px-3\",\r\n          \"py-2\",\r\n          \"text-sm\",\r\n          \"font-medium\",\r\n          \"text-neutral-700\",\r\n          \"bg-neutral-50\",\r\n          \"hover:bg-neutral-100\",\r\n          \"transition-colors\",\r\n          \"duration-150\",\r\n        ].join(\" \")}\r\n      >\r\n        <ChevronIcon\r\n          className=\"h-4 w-4 mr-2 text-neutral-400 transition-transform duration-150\"\r\n          direction={isCollapsed ? \"down\" : \"up\"}\r\n        />\r\n        {group.name}\r\n        <span className=\"ml-auto text-xs text-neutral-400\">\r\n          {filteredProperties.length} prop{filteredProperties.length !== 1 ? \"s\" : \"\"}\r\n        </span>\r\n      </button>\r\n\r\n      {/* Group content */}\r\n      {!isCollapsed && (\r\n        <div className=\"px-3 py-1 bg-white\">\r\n          {filteredProperties.map((prop) => (\r\n            <PropertyRow\r\n              key={prop.key}\r\n              property={prop}\r\n              onChange={onChange}\r\n              onReset={onReset}\r\n              editable={editable}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n/**\r\n * PropertyInspector component.\r\n *\r\n * A panel for inspecting and editing component/element properties\r\n * with support for various input types, grouping, and search.\r\n *\r\n * @example\r\n * ```tsx\r\n * <PropertyInspector\r\n *   selectedElement={{ id: \"1\", name: \"Button\", type: \"component\" }}\r\n *   properties={[\r\n *     { key: \"label\", label: \"Label\", type: \"string\", value: \"Click me\" },\r\n *     { key: \"disabled\", label: \"Disabled\", type: \"boolean\", value: false },\r\n *   ]}\r\n *   onChange={(key, value) => updateProperty(key, value)}\r\n *   editable\r\n * />\r\n * ```\r\n */\r\nexport const PropertyInspector = forwardRef<HTMLDivElement, PropertyInspectorProps>(\r\n  (\r\n    {\r\n      selectedElement,\r\n      properties = [],\r\n      grouped = false,\r\n      onChange,\r\n      onReset,\r\n      emptyMessage = \"Select an element to view its properties\",\r\n      editable = true,\r\n      showSearch = true,\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n\r\n    // Handle property change\r\n    const handleChange = useCallback(\r\n      (key: string, value: unknown) => {\r\n        onChange?.(key, value);\r\n      },\r\n      [onChange]\r\n    );\r\n\r\n    // Handle reset\r\n    const handleReset = useCallback(\r\n      (key: string) => {\r\n        onReset?.(key);\r\n      },\r\n      [onReset]\r\n    );\r\n\r\n    // Check if properties are grouped\r\n    const isGrouped = grouped || (properties.length > 0 && \"properties\" in properties[0]);\r\n\r\n    // Filter flat properties by search\r\n    const filteredFlatProperties =\r\n      !isGrouped && searchQuery\r\n        ? (properties as PropertyDefinition[]).filter(\r\n            (p) =>\r\n              p.label.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n              p.key.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n              p.description?.toLowerCase().includes(searchQuery.toLowerCase())\r\n          )\r\n        : (properties as PropertyDefinition[]);\r\n\r\n    // Container styles\r\n    const containerStyles = [\r\n      \"flex\",\r\n      \"flex-col\",\r\n      \"h-full\",\r\n      \"bg-white\",\r\n      \"border\",\r\n      \"border-neutral-200\",\r\n      \"rounded-lg\",\r\n      \"overflow-hidden\",\r\n      className,\r\n    ].join(\" \");\r\n\r\n    return (\r\n      <div ref={ref} className={containerStyles} {...props}>\r\n        {/* Header */}\r\n        <div className=\"px-3 py-2 bg-neutral-50 border-b border-neutral-200\">\r\n          <h3 className=\"text-sm font-semibold text-neutral-900\">Properties</h3>\r\n          {selectedElement && (\r\n            <p className=\"text-xs text-neutral-500 mt-0.5\">\r\n              {selectedElement.name} ({selectedElement.type})\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Search */}\r\n        {showSearch && properties.length > 0 && (\r\n          <div className=\"px-3 py-2 border-b border-neutral-100\">\r\n            <div className=\"relative\">\r\n              <SearchIcon className=\"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search properties...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className={[\r\n                  \"w-full\",\r\n                  \"pl-8\",\r\n                  \"pr-3\",\r\n                  \"py-1.5\",\r\n                  \"text-sm\",\r\n                  \"bg-neutral-50\",\r\n                  \"border\",\r\n                  \"border-neutral-200\",\r\n                  \"rounded-md\",\r\n                  \"focus:outline-none\",\r\n                  \"focus:ring-2\",\r\n                  \"focus:ring-primary-500\",\r\n                  \"focus:border-transparent\",\r\n                  \"placeholder:text-neutral-400\",\r\n                ].join(\" \")}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-auto p-3\">\r\n          {/* Empty state */}\r\n          {!selectedElement && (\r\n            <div className=\"flex flex-col items-center justify-center h-full text-center py-8\">\r\n              <div className=\"h-12 w-12 mb-3 text-neutral-300\">\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n                  <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n                  <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\r\n                </svg>\r\n              </div>\r\n              <p className=\"text-sm text-neutral-500\">{emptyMessage}</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* No properties */}\r\n          {selectedElement && properties.length === 0 && (\r\n            <div className=\"text-center py-8\">\r\n              <p className=\"text-sm text-neutral-500\">No properties available</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Grouped properties */}\r\n          {selectedElement && isGrouped && (\r\n            <div className=\"flex flex-col gap-3\">\r\n              {(properties as PropertyGroup[]).map((group) => (\r\n                <PropertyGroupComponent\r\n                  key={group.name}\r\n                  group={group}\r\n                  onChange={handleChange}\r\n                  onReset={handleReset}\r\n                  editable={editable}\r\n                  searchQuery={searchQuery}\r\n                />\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* Flat properties */}\r\n          {selectedElement && !isGrouped && filteredFlatProperties.length > 0 && (\r\n            <div className=\"flex flex-col\">\r\n              {filteredFlatProperties.map((prop) => (\r\n                <PropertyRow\r\n                  key={prop.key}\r\n                  property={prop}\r\n                  onChange={handleChange}\r\n                  onReset={handleReset}\r\n                  editable={editable}\r\n                />\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* No search results */}\r\n          {selectedElement &&\r\n            searchQuery &&\r\n            ((isGrouped &&\r\n              (properties as PropertyGroup[]).every(\r\n                (g) =>\r\n                  !g.properties.some(\r\n                    (p) =>\r\n                      p.label.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                      p.key.toLowerCase().includes(searchQuery.toLowerCase())\r\n                  )\r\n              )) ||\r\n              (!isGrouped && filteredFlatProperties.length === 0)) && (\r\n              <div className=\"text-center py-8\">\r\n                <p className=\"text-sm text-neutral-500\">No properties match \"{searchQuery}\"</p>\r\n              </div>\r\n            )}\r\n        </div>\r\n\r\n        {/* Footer with stats */}\r\n        {selectedElement && properties.length > 0 && (\r\n          <div className=\"px-3 py-1.5 bg-neutral-50 border-t border-neutral-200 text-xs text-neutral-500\">\r\n            {isGrouped\r\n              ? `${(properties as PropertyGroup[]).reduce((acc, g) => acc + g.properties.length, 0)} properties in ${properties.length} groups`\r\n              : `${properties.length} properties`}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nPropertyInspector.displayName = \"PropertyInspector\";\r\n\r\nexport default PropertyInspector;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ScreenTree.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":429,"column":34,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":429,"endColumn":48},{"ruleId":"@typescript-eslint/no-non-null-assertion","severity":2,"message":"Forbidden non-null assertion.","line":501,"column":12,"nodeType":"TSNonNullExpression","messageId":"noNonNull","endLine":501,"endColumn":26,"suggestions":[{"messageId":"suggestOptionalChain","fix":{"range":[14615,14616],"text":"?"},"desc":"Consider using the optional chain operator `?.` instead. This operator includes runtime checks, so it is safer than the compile-only non-null assertion operator."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onDelete' is defined but never used. Allowed unused args must match /^_/u.","line":553,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":553,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onRename' is defined but never used. Allowed unused args must match /^_/u.","line":554,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":554,"endColumn":15},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":684,"column":44,"nodeType":"MemberExpression","messageId":"invalidType","endLine":684,"endColumn":62}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * D048 - src/components/factory/ScreenTree.tsx\r\n * ==============================================\r\n * Screen/widget tree view for hierarchical structure display.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\r\n *\r\n * Rules:\r\n *   - NO hardcoded colors, spacing, or sizes\r\n *   - ALL styling via Tailwind classes referencing design tokens\r\n *   - Fully typed props with TypeScript\r\n */\r\n\r\nimport React, { forwardRef, useState, useCallback, type HTMLAttributes } from \"react\";\r\n\r\n/**\r\n * Tree node types.\r\n */\r\nexport type TreeNodeType = \"screen\" | \"widget\" | \"container\" | \"component\" | \"slot\";\r\n\r\n/**\r\n * Tree node definition.\r\n */\r\nexport interface TreeNode {\r\n  /** Unique node ID */\r\n  id: string;\r\n  /** Display name */\r\n  name: string;\r\n  /** Node type */\r\n  type: TreeNodeType;\r\n  /** Child nodes */\r\n  children?: TreeNode[];\r\n  /** Whether node is expanded */\r\n  expanded?: boolean;\r\n  /** Whether node is locked */\r\n  locked?: boolean;\r\n  /** Whether node is visible */\r\n  visible?: boolean;\r\n  /** Whether node is droppable */\r\n  droppable?: boolean;\r\n  /** Component/plugin reference */\r\n  componentRef?: string;\r\n  /** Additional metadata */\r\n  meta?: Record<string, unknown>;\r\n}\r\n\r\n/**\r\n * ScreenTree component props.\r\n */\r\nexport interface ScreenTreeProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\"> {\r\n  /** Tree data */\r\n  nodes: TreeNode[];\r\n  /** Selected node IDs */\r\n  selectedIds?: string[];\r\n  /** Callback when node is selected */\r\n  onSelect?: (ids: string[]) => void;\r\n  /** Callback when node is expanded/collapsed */\r\n  onToggle?: (id: string, expanded: boolean) => void;\r\n  /** Callback when node visibility changes */\r\n  onVisibilityChange?: (id: string, visible: boolean) => void;\r\n  /** Callback when node lock changes */\r\n  onLockChange?: (id: string, locked: boolean) => void;\r\n  /** Callback when node is moved (drag & drop) */\r\n  onMove?: (nodeId: string, targetId: string, position: \"before\" | \"after\" | \"inside\") => void;\r\n  /** Callback when node is deleted */\r\n  onDelete?: (id: string) => void;\r\n  /** Callback when node is renamed */\r\n  onRename?: (id: string, name: string) => void;\r\n  /** Whether editing is enabled */\r\n  editable?: boolean;\r\n  /** Whether drag and drop is enabled */\r\n  draggable?: boolean;\r\n  /** Show search input */\r\n  showSearch?: boolean;\r\n  /** Show visibility toggles */\r\n  showVisibility?: boolean;\r\n  /** Show lock toggles */\r\n  showLock?: boolean;\r\n  /** Empty message */\r\n  emptyMessage?: string;\r\n}\r\n\r\n/**\r\n * Chevron icon.\r\n */\r\nconst ChevronIcon: React.FC<{ className?: string; expanded?: boolean }> = ({\r\n  className,\r\n  expanded,\r\n}) => (\r\n  <svg\r\n    className={[className, \"transition-transform duration-150\", expanded && \"rotate-90\"]\r\n      .filter(Boolean)\r\n      .join(\" \")}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <polyline points=\"9 18 15 12 9 6\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Eye icon (visible).\r\n */\r\nconst EyeIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\r\n    <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Eye off icon (hidden).\r\n */\r\nconst EyeOffIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <path d=\"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24\" />\r\n    <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Lock icon.\r\n */\r\nconst LockIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\r\n    <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Unlock icon.\r\n */\r\nconst UnlockIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\r\n    <path d=\"M7 11V7a5 5 0 0 1 9.9-1\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Search icon.\r\n */\r\nconst SearchIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n  <svg\r\n    className={className}\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    strokeWidth=\"2\"\r\n    strokeLinecap=\"round\"\r\n    strokeLinejoin=\"round\"\r\n  >\r\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n    <path d=\"m21 21-4.3-4.3\" />\r\n  </svg>\r\n);\r\n\r\n/**\r\n * Node type icons.\r\n */\r\nconst nodeTypeIcons: Record<TreeNodeType, React.FC<{ className?: string }>> = {\r\n  screen: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\" />\r\n      <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\" />\r\n    </svg>\r\n  ),\r\n  widget: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n      <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n      <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\r\n    </svg>\r\n  ),\r\n  container: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n      <rect x=\"7\" y=\"7\" width=\"10\" height=\"10\" rx=\"1\" ry=\"1\" />\r\n    </svg>\r\n  ),\r\n  component: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <polygon points=\"12 2 22 8.5 22 15.5 12 22 2 15.5 2 8.5 12 2\" />\r\n      <line x1=\"12\" y1=\"22\" x2=\"12\" y2=\"15.5\" />\r\n      <polyline points=\"22 8.5 12 15.5 2 8.5\" />\r\n    </svg>\r\n  ),\r\n  slot: ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" strokeDasharray=\"4 2\" />\r\n      <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\" />\r\n      <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\" />\r\n    </svg>\r\n  ),\r\n};\r\n\r\n/**\r\n * Node type colors.\r\n */\r\nconst nodeTypeColors: Record<TreeNodeType, string> = {\r\n  screen: \"text-primary-500\",\r\n  widget: \"text-success-500\",\r\n  container: \"text-warning-500\",\r\n  component: \"text-info-500\",\r\n  slot: \"text-neutral-400\",\r\n};\r\n\r\n/**\r\n * Tree node row component.\r\n */\r\ninterface TreeNodeRowProps {\r\n  node: TreeNode;\r\n  level: number;\r\n  selectedIds: string[];\r\n  editable: boolean;\r\n  draggable: boolean;\r\n  showVisibility: boolean;\r\n  showLock: boolean;\r\n  onSelect: (ids: string[]) => void;\r\n  onToggle: (id: string, expanded: boolean) => void;\r\n  onVisibilityChange?: (id: string, visible: boolean) => void;\r\n  onLockChange?: (id: string, locked: boolean) => void;\r\n  onMove?: (nodeId: string, targetId: string, position: \"before\" | \"after\" | \"inside\") => void;\r\n  searchQuery?: string;\r\n}\r\n\r\nconst TreeNodeRow: React.FC<TreeNodeRowProps> = ({\r\n  node,\r\n  level,\r\n  selectedIds,\r\n  editable,\r\n  draggable,\r\n  showVisibility,\r\n  showLock,\r\n  onSelect,\r\n  onToggle,\r\n  onVisibilityChange,\r\n  onLockChange,\r\n  onMove,\r\n  searchQuery,\r\n}) => {\r\n  const [isDragOver, setIsDragOver] = useState(false);\r\n  const [dropPosition, setDropPosition] = useState<\"before\" | \"after\" | \"inside\" | null>(null);\r\n\r\n  const isSelected = selectedIds.includes(node.id);\r\n  const hasChildren = node.children && node.children.length > 0;\r\n  const isExpanded = node.expanded ?? true;\r\n  const isVisible = node.visible ?? true;\r\n  const isLocked = node.locked ?? false;\r\n\r\n  const NodeIcon = nodeTypeIcons[node.type];\r\n\r\n  // Check if node matches search\r\n  const matchesSearch =\r\n    !searchQuery || node.name.toLowerCase().includes(searchQuery.toLowerCase());\r\n\r\n  // Handle click\r\n  const handleClick = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.stopPropagation();\r\n      if (e.shiftKey) {\r\n        // Multi-select\r\n        if (isSelected) {\r\n          onSelect(selectedIds.filter((id) => id !== node.id));\r\n        } else {\r\n          onSelect([...selectedIds, node.id]);\r\n        }\r\n      } else {\r\n        onSelect([node.id]);\r\n      }\r\n    },\r\n    [node.id, isSelected, selectedIds, onSelect]\r\n  );\r\n\r\n  // Handle toggle\r\n  const handleToggle = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.stopPropagation();\r\n      onToggle(node.id, !isExpanded);\r\n    },\r\n    [node.id, isExpanded, onToggle]\r\n  );\r\n\r\n  // Handle visibility toggle\r\n  const handleVisibility = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.stopPropagation();\r\n      onVisibilityChange?.(node.id, !isVisible);\r\n    },\r\n    [node.id, isVisible, onVisibilityChange]\r\n  );\r\n\r\n  // Handle lock toggle\r\n  const handleLock = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.stopPropagation();\r\n      onLockChange?.(node.id, !isLocked);\r\n    },\r\n    [node.id, isLocked, onLockChange]\r\n  );\r\n\r\n  // Drag handlers\r\n  const handleDragStart = useCallback(\r\n    (e: React.DragEvent) => {\r\n      if (!draggable) return;\r\n      e.dataTransfer.setData(\"text/plain\", node.id);\r\n      e.dataTransfer.effectAllowed = \"move\";\r\n    },\r\n    [draggable, node.id]\r\n  );\r\n\r\n  const handleDragOver = useCallback(\r\n    (e: React.DragEvent) => {\r\n      if (!draggable || !node.droppable) return;\r\n      e.preventDefault();\r\n      e.dataTransfer.dropEffect = \"move\";\r\n      setIsDragOver(true);\r\n\r\n      // Determine drop position based on mouse position\r\n      const rect = (e.target as HTMLElement).getBoundingClientRect();\r\n      const y = e.clientY - rect.top;\r\n      const height = rect.height;\r\n\r\n      if (y < height * 0.25) {\r\n        setDropPosition(\"before\");\r\n      } else if (y > height * 0.75) {\r\n        setDropPosition(\"after\");\r\n      } else {\r\n        setDropPosition(\"inside\");\r\n      }\r\n    },\r\n    [draggable, node.droppable]\r\n  );\r\n\r\n  const handleDragLeave = useCallback(() => {\r\n    setIsDragOver(false);\r\n    setDropPosition(null);\r\n  }, []);\r\n\r\n  const handleDrop = useCallback(\r\n    (e: React.DragEvent) => {\r\n      e.preventDefault();\r\n      setIsDragOver(false);\r\n      setDropPosition(null);\r\n\r\n      const draggedId = e.dataTransfer.getData(\"text/plain\");\r\n      if (draggedId && draggedId !== node.id && dropPosition) {\r\n        onMove?.(draggedId, node.id, dropPosition);\r\n      }\r\n    },\r\n    [node.id, dropPosition, onMove]\r\n  );\r\n\r\n  if (!matchesSearch && !hasChildren) return null;\r\n\r\n  const rowStyles = [\r\n    \"group\",\r\n    \"flex\",\r\n    \"items-center\",\r\n    \"gap-1\",\r\n    \"h-8\",\r\n    \"px-2\",\r\n    \"rounded-md\",\r\n    \"cursor-pointer\",\r\n    \"transition-colors\",\r\n    \"duration-150\",\r\n    isSelected ? \"bg-primary-100 text-primary-900\" : \"hover:bg-neutral-100\",\r\n    !isVisible && \"opacity-50\",\r\n    isDragOver && dropPosition === \"inside\" && \"ring-2 ring-primary-500 ring-inset\",\r\n  ]\r\n    .filter(Boolean)\r\n    .join(\" \");\r\n\r\n  return (\r\n    <div>\r\n      {/* Drop indicator (before) */}\r\n      {isDragOver && dropPosition === \"before\" && (\r\n        <div className=\"h-0.5 bg-primary-500 mx-2 rounded-full\" />\r\n      )}\r\n\r\n      {/* Node row */}\r\n      <div\r\n        className={rowStyles}\r\n        style={{ paddingLeft: `${level * 16 + 8}px` }}\r\n        onClick={handleClick}\r\n        draggable={draggable && !isLocked}\r\n        onDragStart={handleDragStart}\r\n        onDragOver={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onDrop={handleDrop}\r\n      >\r\n        {/* Expand/collapse button */}\r\n        <button\r\n          type=\"button\"\r\n          onClick={handleToggle}\r\n          className={[\r\n            \"p-0.5\",\r\n            \"rounded\",\r\n            \"hover:bg-neutral-200\",\r\n            !hasChildren && \"invisible\",\r\n          ].join(\" \")}\r\n        >\r\n          <ChevronIcon className=\"h-3 w-3 text-neutral-400\" expanded={isExpanded} />\r\n        </button>\r\n\r\n        {/* Node icon */}\r\n        <NodeIcon className={[\"h-4 w-4\", nodeTypeColors[node.type]].join(\" \")} />\r\n\r\n        {/* Node name */}\r\n        <span className=\"flex-1 text-sm truncate\">{node.name}</span>\r\n\r\n        {/* Action buttons (show on hover) */}\r\n        <div className=\"flex items-center gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity duration-150\">\r\n          {/* Visibility toggle */}\r\n          {showVisibility && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleVisibility}\r\n              className=\"p-1 rounded hover:bg-neutral-200\"\r\n              title={isVisible ? \"Hide\" : \"Show\"}\r\n            >\r\n              {isVisible ? (\r\n                <EyeIcon className=\"h-3.5 w-3.5 text-neutral-400\" />\r\n              ) : (\r\n                <EyeOffIcon className=\"h-3.5 w-3.5 text-neutral-400\" />\r\n              )}\r\n            </button>\r\n          )}\r\n\r\n          {/* Lock toggle */}\r\n          {showLock && editable && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleLock}\r\n              className=\"p-1 rounded hover:bg-neutral-200\"\r\n              title={isLocked ? \"Unlock\" : \"Lock\"}\r\n            >\r\n              {isLocked ? (\r\n                <LockIcon className=\"h-3.5 w-3.5 text-neutral-400\" />\r\n              ) : (\r\n                <UnlockIcon className=\"h-3.5 w-3.5 text-neutral-400\" />\r\n              )}\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Drop indicator (after) */}\r\n      {isDragOver && dropPosition === \"after\" && (\r\n        <div className=\"h-0.5 bg-primary-500 mx-2 rounded-full\" />\r\n      )}\r\n\r\n      {/* Children */}\r\n      {hasChildren && isExpanded && (\r\n        <div>\r\n          {node.children!.map((child) => (\r\n            <TreeNodeRow\r\n              key={child.id}\r\n              node={child}\r\n              level={level + 1}\r\n              selectedIds={selectedIds}\r\n              editable={editable}\r\n              draggable={draggable}\r\n              showVisibility={showVisibility}\r\n              showLock={showLock}\r\n              onSelect={onSelect}\r\n              onToggle={onToggle}\r\n              onVisibilityChange={onVisibilityChange}\r\n              onLockChange={onLockChange}\r\n              onMove={onMove}\r\n              searchQuery={searchQuery}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n/**\r\n * ScreenTree component.\r\n *\r\n * A hierarchical tree view for displaying and managing screens,\r\n * widgets, and components with drag-and-drop support.\r\n *\r\n * @example\r\n * ```tsx\r\n * <ScreenTree\r\n *   nodes={screenHierarchy}\r\n *   selectedIds={[selectedId]}\r\n *   onSelect={(ids) => setSelectedId(ids[0])}\r\n *   onMove={(nodeId, targetId, pos) => moveNode(nodeId, targetId, pos)}\r\n *   editable\r\n *   draggable\r\n * />\r\n * ```\r\n */\r\nexport const ScreenTree = forwardRef<HTMLDivElement, ScreenTreeProps>(\r\n  (\r\n    {\r\n      nodes,\r\n      selectedIds = [],\r\n      onSelect,\r\n      onToggle,\r\n      onVisibilityChange,\r\n      onLockChange,\r\n      onMove,\r\n      onDelete,\r\n      onRename,\r\n      editable = true,\r\n      draggable = true,\r\n      showSearch = true,\r\n      showVisibility = true,\r\n      showLock = true,\r\n      emptyMessage = \"No screens or widgets\",\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n\r\n    // Handle select\r\n    const handleSelect = useCallback(\r\n      (ids: string[]) => {\r\n        onSelect?.(ids);\r\n      },\r\n      [onSelect]\r\n    );\r\n\r\n    // Handle toggle\r\n    const handleToggle = useCallback(\r\n      (id: string, expanded: boolean) => {\r\n        onToggle?.(id, expanded);\r\n      },\r\n      [onToggle]\r\n    );\r\n\r\n    // Count total nodes\r\n    const countNodes = (nodeList: TreeNode[]): number => {\r\n      return nodeList.reduce((acc, node) => {\r\n        return acc + 1 + (node.children ? countNodes(node.children) : 0);\r\n      }, 0);\r\n    };\r\n\r\n    const totalNodes = countNodes(nodes);\r\n\r\n    // Container styles\r\n    const containerStyles = [\r\n      \"flex\",\r\n      \"flex-col\",\r\n      \"h-full\",\r\n      \"bg-white\",\r\n      \"border\",\r\n      \"border-neutral-200\",\r\n      \"rounded-lg\",\r\n      \"overflow-hidden\",\r\n      className,\r\n    ].join(\" \");\r\n\r\n    return (\r\n      <div ref={ref} className={containerStyles} {...props}>\r\n        {/* Header */}\r\n        <div className=\"px-3 py-2 bg-neutral-50 border-b border-neutral-200\">\r\n          <h3 className=\"text-sm font-semibold text-neutral-900\">Structure</h3>\r\n        </div>\r\n\r\n        {/* Search */}\r\n        {showSearch && nodes.length > 0 && (\r\n          <div className=\"px-3 py-2 border-b border-neutral-100\">\r\n            <div className=\"relative\">\r\n              <SearchIcon className=\"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className={[\r\n                  \"w-full\",\r\n                  \"pl-8\",\r\n                  \"pr-3\",\r\n                  \"py-1.5\",\r\n                  \"text-sm\",\r\n                  \"bg-neutral-50\",\r\n                  \"border\",\r\n                  \"border-neutral-200\",\r\n                  \"rounded-md\",\r\n                  \"focus:outline-none\",\r\n                  \"focus:ring-2\",\r\n                  \"focus:ring-primary-500\",\r\n                  \"focus:border-transparent\",\r\n                  \"placeholder:text-neutral-400\",\r\n                ].join(\" \")}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Tree content */}\r\n        <div className=\"flex-1 overflow-auto p-2\">\r\n          {/* Empty state */}\r\n          {nodes.length === 0 && (\r\n            <div className=\"flex flex-col items-center justify-center h-full text-center py-8\">\r\n              <div className=\"h-12 w-12 mb-3 text-neutral-300\">\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n                  <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n                  <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\r\n                </svg>\r\n              </div>\r\n              <p className=\"text-sm text-neutral-500\">{emptyMessage}</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Tree nodes */}\r\n          {nodes.map((node) => (\r\n            <TreeNodeRow\r\n              key={node.id}\r\n              node={node}\r\n              level={0}\r\n              selectedIds={selectedIds}\r\n              editable={editable}\r\n              draggable={draggable}\r\n              showVisibility={showVisibility}\r\n              showLock={showLock}\r\n              onSelect={handleSelect}\r\n              onToggle={handleToggle}\r\n              onVisibilityChange={onVisibilityChange}\r\n              onLockChange={onLockChange}\r\n              onMove={onMove}\r\n              searchQuery={searchQuery}\r\n            />\r\n          ))}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"px-3 py-1.5 bg-neutral-50 border-t border-neutral-200 text-xs text-neutral-500\">\r\n          {totalNodes} item{totalNodes !== 1 ? \"s\" : \"\"}\r\n          {selectedIds.length > 0 && ` ÔÇó ${selectedIds.length} selected`}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nScreenTree.displayName = \"ScreenTree\";\r\n\r\nexport default ScreenTree;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\TemplateComponentRenderer.tsx","messages":[{"ruleId":"react/prop-types","severity":2,"message":"'label' is missing in props validation","line":46,"column":26,"nodeType":"Identifier","messageId":"missingPropType","endLine":46,"endColumn":31},{"ruleId":"react/prop-types","severity":2,"message":"'placeholder' is missing in props validation","line":47,"column":32,"nodeType":"Identifier","messageId":"missingPropType","endLine":47,"endColumn":43},{"ruleId":"react/prop-types","severity":2,"message":"'variant' is missing in props validation","line":48,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":48,"endColumn":35},{"ruleId":"react/prop-types","severity":2,"message":"'backgroundColor' is missing in props validation","line":49,"column":36,"nodeType":"Identifier","messageId":"missingPropType","endLine":49,"endColumn":51},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\TemplateComponentRenderer.tsx:61:18\n  59 |         return (\n  60 |             <div className={`w-full h-full ${baseClasses} overflow-hidden`}>\n> 61 |                 <RegisteredComponent {...props} />\n     |                  ^^^^^^^^^^^^^^^^^^^ This component is created during render\n  62 |             </div>\n  63 |         );\n  64 |     }\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\TemplateComponentRenderer.tsx:58:37\n  56 |     if (isComponentRegistered(componentId)) {\n  57 |         // console.log(`[TemplateComponentRenderer] Rendering registered component: ${componentId}`, props);\n> 58 |         const RegisteredComponent = getComponent(componentId);\n     |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^ The component is created during render here\n  59 |         return (\n  60 |             <div className={`w-full h-full ${baseClasses} overflow-hidden`}>\n  61 |                 <RegisteredComponent {...props} />","line":61,"column":18,"nodeType":null,"endLine":61,"endColumn":37},{"ruleId":"react/prop-types","severity":2,"message":"'icon' is missing in props validation","line":75,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":75,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'icon' is missing in props validation","line":80,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":80,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'icon' is missing in props validation","line":85,"column":38,"nodeType":"Identifier","messageId":"missingPropType","endLine":85,"endColumn":42},{"ruleId":"react/prop-types","severity":2,"message":"'icon' is missing in props validation","line":94,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":94,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'options' is missing in props validation","line":122,"column":46,"nodeType":"Identifier","messageId":"missingPropType","endLine":122,"endColumn":53},{"ruleId":"react/prop-types","severity":2,"message":"'options' is missing in props validation","line":122,"column":64,"nodeType":"Identifier","messageId":"missingPropType","endLine":122,"endColumn":71},{"ruleId":"react/prop-types","severity":2,"message":"'options.map' is missing in props validation","line":122,"column":72,"nodeType":"Identifier","messageId":"missingPropType","endLine":122,"endColumn":75},{"ruleId":"react/prop-types","severity":2,"message":"'type' is missing in props validation","line":197,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":197,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'description' is missing in props validation","line":202,"column":79,"nodeType":"Identifier","messageId":"missingPropType","endLine":202,"endColumn":90},{"ruleId":"react/prop-types","severity":2,"message":"'type' is missing in props validation","line":204,"column":31,"nodeType":"Identifier","messageId":"missingPropType","endLine":204,"endColumn":35},{"ruleId":"react/prop-types","severity":2,"message":"'active' is missing in props validation","line":218,"column":148,"nodeType":"Identifier","messageId":"missingPropType","endLine":218,"endColumn":154},{"ruleId":"react/prop-types","severity":2,"message":"'active' is missing in props validation","line":232,"column":152,"nodeType":"Identifier","messageId":"missingPropType","endLine":232,"endColumn":158},{"ruleId":"react/prop-types","severity":2,"message":"'text' is missing in props validation","line":243,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":243,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'text' is missing in props validation","line":250,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":250,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'status' is missing in props validation","line":258,"column":67,"nodeType":"Identifier","messageId":"missingPropType","endLine":258,"endColumn":73},{"ruleId":"react/prop-types","severity":2,"message":"'fallback' is missing in props validation","line":305,"column":32,"nodeType":"Identifier","messageId":"missingPropType","endLine":305,"endColumn":40},{"ruleId":"react/prop-types","severity":2,"message":"'icon' is missing in props validation","line":319,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":319,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'icon' is missing in props validation","line":324,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":324,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'icon' is missing in props validation","line":329,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":329,"endColumn":32},{"ruleId":"react/prop-types","severity":2,"message":"'sender' is missing in props validation","line":340,"column":71,"nodeType":"Identifier","messageId":"missingPropType","endLine":340,"endColumn":77},{"ruleId":"react/prop-types","severity":2,"message":"'message' is missing in props validation","line":344,"column":51,"nodeType":"Identifier","messageId":"missingPropType","endLine":344,"endColumn":58},{"ruleId":"react/prop-types","severity":2,"message":"'timestamp' is missing in props validation","line":345,"column":28,"nodeType":"Identifier","messageId":"missingPropType","endLine":345,"endColumn":37},{"ruleId":"react/prop-types","severity":2,"message":"'timestamp' is missing in props validation","line":346,"column":84,"nodeType":"Identifier","messageId":"missingPropType","endLine":346,"endColumn":93}],"suppressedMessages":[],"errorCount":28,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * src/components/factory/TemplateComponentRenderer.tsx\r\n * ====================================================\r\n * Renders styled representations of template component types.\r\n * Extracted from CanvasEditor.tsx for reuse in thumbnails.\r\n */\r\n\r\nimport React from \"react\";\r\nimport { resolveColor } from \"../../utils/tokenMap\";\r\nimport { getComponent, isComponentRegistered } from \"../../utils/ComponentRegistry\";\r\nimport type { CanvasElementType } from \"./canvasTypes\";\r\n\r\n/**\r\n * Element type colors - EDIT mode only.\r\n * Only borders - NO backgrounds, so TemplateComponentRenderer colors show through.\r\n */\r\nexport const elementTypeColors: Record<CanvasElementType, string> = {\r\n    component: \"border-primary-400\",\r\n    container: \"border-neutral-400\",\r\n    text: \"border-success-400\",\r\n    image: \"border-warning-400\",\r\n    spacer: \"border-neutral-300 border-dashed\",\r\n};\r\n\r\nexport interface TemplateComponentRendererProps {\r\n    componentId: string;\r\n    props?: Record<string, unknown>;\r\n    bounds: { width: number; height: number };\r\n    demoMode?: boolean;\r\n}\r\n\r\n/**\r\n * Template component renderer.\r\n * Renders styled representations of template component types (EUR-1.1.10).\r\n * These are visual previews of what the final component would look like.\r\n */\r\nexport const TemplateComponentRenderer: React.FC<TemplateComponentRendererProps> = ({\r\n    componentId,\r\n    props = {},\r\n    // bounds,\r\n    demoMode = false\r\n}) => {\r\n    const baseClasses = demoMode ? \"\" : \"pointer-events-none\";\r\n\r\n    // Extract common props\r\n    const label = (props.label as string) || \"\";\r\n    const placeholder = (props.placeholder as string) || \"\";\r\n    const variant = (props.variant as string) || \"default\";\r\n    const backgroundColor = (props.backgroundColor as string) || \"\";\r\n\r\n    // Resolve hex colors to design tokens\r\n    const resolvedBg = resolveColor(backgroundColor, \"\");\r\n    // const _resolvedBorderColor = resolveBorder(props.borderBottom as string) || resolveBorder(props.borderTop as string);\r\n\r\n    // Check if component is in registry (for external/dynamic components like mui-button)\r\n    if (isComponentRegistered(componentId)) {\r\n        // console.log(`[TemplateComponentRenderer] Rendering registered component: ${componentId}`, props);\r\n        const RegisteredComponent = getComponent(componentId);\r\n        return (\r\n            <div className={`w-full h-full ${baseClasses} overflow-hidden`}>\r\n                <RegisteredComponent {...props} />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Render based on component type\r\n    switch (componentId) {\r\n        // Buttons\r\n        case \"button_primary\":\r\n            return (\r\n                <button\r\n                    className={`w-full h-full flex items-center justify-center gap-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-lg text-sm transition-colors ${baseClasses}`}\r\n                    style={{ backgroundColor: variant === \"ghost\" ? \"transparent\" : undefined }}\r\n                >\r\n                    {props.icon === \"send\" && (\r\n                        <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" /><polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\r\n                        </svg>\r\n                    )}\r\n                    {props.icon === \"settings\" && (\r\n                        <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <circle cx=\"12\" cy=\"12\" r=\"3\" /><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\r\n                        </svg>\r\n                    )}\r\n                    {label || (props.icon ? \"\" : \"+ New Chat\")}\r\n                </button>\r\n            );\r\n\r\n        case \"button_secondary\":\r\n            return (\r\n                <button\r\n                    className={`w-full h-full flex items-center justify-center gap-2 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 font-medium rounded-lg text-sm border border-neutral-300 transition-colors ${baseClasses}`}\r\n                >\r\n                    {props.icon === \"refresh\" && (\r\n                        <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <polyline points=\"23 4 23 10 17 10\" /><path d=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\" />\r\n                        </svg>\r\n                    )}\r\n                    {label || \"Refresh\"}\r\n                </button>\r\n            );\r\n\r\n        // Text Inputs\r\n        case \"input_text\":\r\n            return (\r\n                <div className={`w-full h-full flex items-center ${baseClasses}`}>\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder={placeholder || \"Enter text...\"}\r\n                        className=\"w-full h-full px-3 py-2 bg-white border border-neutral-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n                        readOnly={!demoMode}\r\n                    />\r\n                </div>\r\n            );\r\n\r\n        // Select/Dropdown\r\n        case \"select_dropdown\":\r\n            return (\r\n                <div className={`w-full h-full flex items-center ${baseClasses}`}>\r\n                    <select className=\"w-full h-full px-3 py-2 bg-white border border-neutral-300 rounded-lg text-sm appearance-none cursor-pointer\">\r\n                        <option>{placeholder || \"Select...\"}</option>\r\n                        {Array.isArray(props.options) && props.options.map((opt, i) => (\r\n                            <option key={i}>{String(opt)}</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n            );\r\n\r\n        // Containers\r\n        case \"container_sidebar\":\r\n            return (\r\n                <div\r\n                    className={`w-full h-full ${baseClasses}`}\r\n                    style={{ backgroundColor: resolvedBg || \"var(--color-neutral-900)\" }}\r\n                />\r\n            );\r\n\r\n        case \"container_header\":\r\n        case \"container_footer\":\r\n            return (\r\n                <div\r\n                    className={`w-full h-full ${baseClasses}`}\r\n                    style={{\r\n                        backgroundColor: resolvedBg || \"var(--bg-primary)\",\r\n                        borderBottom: componentId === \"container_header\" ? \"1px solid var(--border-primary)\" : undefined,\r\n                        borderTop: componentId === \"container_footer\" ? \"1px solid var(--border-primary)\" : undefined,\r\n                    }}\r\n                />\r\n            );\r\n\r\n        case \"container_fluid\":\r\n        case \"container_card\":\r\n            return (\r\n                <div\r\n                    className={`w-full h-full ${baseClasses}`}\r\n                    style={{\r\n                        backgroundColor: resolvedBg || \"var(--color-neutral-50)\",\r\n                        borderRadius: componentId === \"container_card\" ? \"12px\" : undefined,\r\n                        boxShadow: componentId === \"container_card\" ? \"var(--shadow-md)\" : undefined,\r\n                    }}\r\n                />\r\n            );\r\n\r\n        // List\r\n        case \"list_standard\":\r\n            return (\r\n                <div className={`w-full h-full flex flex-col gap-1 p-2 ${baseClasses}`}>\r\n                    {[1, 2, 3, 4, 5].map(i => (\r\n                        <div key={i} className=\"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-white/10 cursor-pointer transition-colors\">\r\n                            <div className=\"w-6 h-6 rounded-full bg-neutral-500/30\" />\r\n                            <div className=\"flex-1\">\r\n                                <div className=\"h-3 w-24 bg-neutral-500/30 rounded\" />\r\n                                <div className=\"h-2 w-16 bg-neutral-500/20 rounded mt-1\" />\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            );\r\n\r\n        // Tree View\r\n        case \"tree_view\":\r\n            return (\r\n                <div className={`w-full h-full flex flex-col gap-1 p-2 text-neutral-300 text-sm ${baseClasses}`}>\r\n                    <div className=\"flex items-center gap-2 px-2 py-1\"><span>­ƒôü</span> public</div>\r\n                    <div className=\"flex items-center gap-2 px-2 py-1 pl-6\"><span>­ƒôü</span> tables</div>\r\n                    <div className=\"flex items-center gap-2 px-2 py-1 pl-10\"><span>­ƒôä</span> users</div>\r\n                    <div className=\"flex items-center gap-2 px-2 py-1 pl-10\"><span>­ƒôä</span> orders</div>\r\n                    <div className=\"flex items-center gap-2 px-2 py-1 pl-10\"><span>­ƒôä</span> products</div>\r\n                </div>\r\n            );\r\n\r\n        // Form Group\r\n        case \"form_group\":\r\n            return (\r\n                <div className={`w-full h-full flex flex-col gap-2 ${baseClasses}`}>\r\n                    <label className=\"text-sm font-medium text-neutral-700\">{label || \"Field Label\"}</label>\r\n                    {props.type === \"toggle\" ? (\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-5 bg-primary-500 rounded-full relative\">\r\n                                <div className=\"absolute right-0.5 top-0.5 w-4 h-4 bg-white rounded-full shadow\" />\r\n                            </div>\r\n                            <span className=\"text-xs text-neutral-500\">{props.description as string}</span>\r\n                        </div>\r\n                    ) : props.type === \"select\" ? (\r\n                        <select className=\"px-3 py-2 border border-neutral-300 rounded-lg text-sm\">\r\n                            <option>Select...</option>\r\n                        </select>\r\n                    ) : (\r\n                        <input type=\"text\" className=\"px-3 py-2 border border-neutral-300 rounded-lg text-sm\" placeholder={placeholder} />\r\n                    )}\r\n                </div>\r\n            );\r\n\r\n        // Navigation Item\r\n        case \"nav_item\":\r\n            return (\r\n                <div\r\n                    className={`w-full h-full flex items-center gap-3 px-3 rounded-lg text-sm font-medium transition-colors cursor-pointer ${props.active ? \"bg-primary-100 text-primary-700\" : \"text-neutral-600 hover:bg-neutral-100\"\r\n                        } ${baseClasses}`}\r\n                >\r\n                    <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                        <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n                    </svg>\r\n                    {label || \"Nav Item\"}\r\n                </div>\r\n            );\r\n\r\n        // Tab Item\r\n        case \"tab_item\":\r\n            return (\r\n                <div\r\n                    className={`w-full h-full flex items-center justify-center text-sm font-medium rounded-md transition-colors cursor-pointer ${props.active ? \"bg-white text-neutral-900 shadow-sm\" : \"text-neutral-500 hover:text-neutral-700\"\r\n                        } ${baseClasses}`}\r\n                >\r\n                    {label || \"Tab\"}\r\n                </div>\r\n            );\r\n\r\n        // Headings\r\n        case \"text_heading\":\r\n            return (\r\n                <div className={`w-full h-full flex items-center text-lg font-semibold text-neutral-900 ${baseClasses}`}>\r\n                    {props.text as string || \"Heading\"}\r\n                </div>\r\n            );\r\n\r\n        case \"text_label\":\r\n            return (\r\n                <div className={`w-full h-full flex items-center text-xs text-neutral-500 ${baseClasses}`}>\r\n                    {props.text as string || \"Label text\"}\r\n                </div>\r\n            );\r\n\r\n        // Badge/Status\r\n        case \"badge_status\":\r\n            return (\r\n                <div className={`w-full h-full flex items-center gap-1.5 ${baseClasses}`}>\r\n                    <div className={`w-2 h-2 rounded-full ${props.status === \"connected\" ? \"bg-success-500\" : \"bg-neutral-400\"}`} />\r\n                    <span className=\"text-xs font-medium text-neutral-300\">{label || \"Status\"}</span>\r\n                </div>\r\n            );\r\n\r\n        // Code Editor\r\n        case \"code_editor\":\r\n            return (\r\n                <div className={`w-full h-full bg-[#1e1e1e] p-3 font-mono text-xs text-neutral-300 ${baseClasses}`}>\r\n                    <div className=\"text-purple-400\">SELECT</div>\r\n                    <div className=\"pl-4 text-neutral-300\">*</div>\r\n                    <div className=\"text-purple-400\">FROM</div>\r\n                    <div className=\"pl-4 text-yellow-400\">users</div>\r\n                    <div className=\"text-purple-400\">LIMIT</div>\r\n                    <div className=\"pl-4 text-orange-400\">100</div>\r\n                    <div className=\"text-neutral-500\">;</div>\r\n                </div>\r\n            );\r\n\r\n        // Data Table\r\n        case \"data_table\":\r\n            return (\r\n                <div className={`w-full h-full bg-white overflow-hidden ${baseClasses}`}>\r\n                    <div className=\"grid grid-cols-4 bg-neutral-100 text-xs font-medium text-neutral-600 border-b\">\r\n                        <div className=\"px-3 py-2\">ID</div>\r\n                        <div className=\"px-3 py-2\">Name</div>\r\n                        <div className=\"px-3 py-2\">Email</div>\r\n                        <div className=\"px-3 py-2\">Status</div>\r\n                    </div>\r\n                    {[1, 2, 3, 4, 5].map(i => (\r\n                        <div key={i} className=\"grid grid-cols-4 text-xs text-neutral-700 border-b border-neutral-100\">\r\n                            <div className=\"px-3 py-2\">{i}</div>\r\n                            <div className=\"px-3 py-2\">User {i}</div>\r\n                            <div className=\"px-3 py-2\">user{i}@example.com</div>\r\n                            <div className=\"px-3 py-2\">\r\n                                <span className=\"px-1.5 py-0.5 bg-success-100 text-success-700 rounded text-[10px]\">Active</span>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            );\r\n\r\n        // Avatar\r\n        case \"avatar\":\r\n            return (\r\n                <div className={`w-full h-full flex items-center justify-center ${baseClasses}`}>\r\n                    <div className=\"w-8 h-8 rounded-full bg-primary-500 text-white flex items-center justify-center text-xs font-semibold\">\r\n                        {props.fallback as string || \"AI\"}\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n        // Icon Button\r\n        case \"button_icon\":\r\n            return (\r\n                <button\r\n                    className={`w-full h-full flex items-center justify-center rounded-full transition-colors ${variant === \"primary\"\r\n                        ? \"bg-primary-500 hover:bg-primary-600 text-white\"\r\n                        : \"text-neutral-500 hover:bg-neutral-100\"\r\n                        } ${baseClasses}`}\r\n                >\r\n                    {props.icon === \"send\" && (\r\n                        <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" /><polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\r\n                        </svg>\r\n                    )}\r\n                    {props.icon === \"minimize\" && (\r\n                        <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\r\n                        </svg>\r\n                    )}\r\n                    {props.icon === \"x\" && (\r\n                        <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" /><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n                        </svg>\r\n                    )}\r\n                </button>\r\n            );\r\n\r\n        // Chat Bubble\r\n        case \"chat_bubble\":\r\n            return (\r\n                <div className={`w-full h-full p-3 rounded-lg ${props.sender === \"assistant\"\r\n                    ? \"bg-neutral-100 text-neutral-800\"\r\n                    : \"bg-primary-500 text-white\"\r\n                    } ${baseClasses}`}>\r\n                    <p className=\"text-sm\">{props.message as string || \"Message text\"}</p>\r\n                    {props.timestamp && (\r\n                        <span className=\"text-[10px] opacity-70 mt-1 block\">{props.timestamp as string}</span>\r\n                    )}\r\n                </div>\r\n            );\r\n\r\n        // Chip/Tag\r\n        case \"chip\":\r\n            return (\r\n                <div\r\n                    className={`w-full h-full flex items-center justify-center px-3 py-1 rounded-full text-xs font-medium border cursor-pointer transition-colors ${variant === \"outline\"\r\n                        ? \"border-neutral-300 text-neutral-600 hover:bg-neutral-100\"\r\n                        : \"bg-primary-100 text-primary-700 border-primary-200\"\r\n                        } ${baseClasses}`}\r\n                >\r\n                    {label || \"Chip\"}\r\n                </div>\r\n            );\r\n\r\n        // Default fallback - show component type name\r\n        default:\r\n            return (\r\n                <div className={`w-full h-full flex items-center justify-center text-xs text-neutral-400 bg-neutral-50 ${baseClasses}`}>\r\n                    {componentId}\r\n                </div>\r\n            );\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\ThemedCanvasWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\canvasTypes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\factory\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\gallery\\GalleryManager.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":466,"column":47,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":466,"endColumn":49,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[12241,12243],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":610,"column":45,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":610,"endColumn":47,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[16445,16447],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":718,"column":10,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":718,"endColumn":12,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[19409,19411],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":739,"column":30,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":739,"endColumn":32,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[19867,19869],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":748,"column":49,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":748,"endColumn":51,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[20070,20072],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":777,"column":32,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":777,"endColumn":34,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[20718,20720],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":788,"column":34,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":788,"endColumn":36,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[21091,21093],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":797,"column":36,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":797,"endColumn":38,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[21423,21425],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":809,"column":38,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":809,"endColumn":40,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[21824,21826],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":815,"column":37,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":815,"endColumn":39,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22040,22042],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":824,"column":34,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":824,"endColumn":36,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22295,22297],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":835,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":835,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22654,22656],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1053,"column":31,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1053,"endColumn":33,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[29121,29123],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1053,"column":52,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1053,"endColumn":54,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[29142,29144],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1055,"column":28,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1055,"endColumn":30,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[29204,29206],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1055,"column":46,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1055,"endColumn":48,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[29222,29224],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/require-await","severity":2,"message":"Async arrow function has no 'await' expression.","line":1064,"column":45,"nodeType":"ArrowFunctionExpression","messageId":"missingAwait","endLine":1064,"endColumn":47,"suggestions":[{"messageId":"removeAsync","fix":{"range":[29422,29428],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1154,"column":27,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1154,"endColumn":41},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1193,"column":29,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1193,"endColumn":49},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1204,"column":29,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1204,"endColumn":51},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1269,"column":25,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1269,"endColumn":39},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1287,"column":25,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1287,"endColumn":72},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1304,"column":25,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1304,"endColumn":72},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1322,"column":16,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1322,"endColumn":28},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":1338,"column":46,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":1338,"endColumn":60}],"suppressedMessages":[],"errorCount":25,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D074 - src/components/gallery/GalleryManager.tsx\n * =================================================\n * Gallery CRUD management interface for plugins and components.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D010, D011, D012, D014, D015\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport React, { useState, useCallback, useMemo } from \"react\";\nimport { Button } from \"../ui/Button\";\nimport { Input } from \"../ui/Input\";\nimport { Select, type SelectOption } from \"../ui/Select\";\nimport { Panel } from \"../ui/Panel\";\nimport { Modal } from \"../ui/Modal\";\n\n/**\n * Gallery item status.\n */\nexport type GalleryItemStatus = \"active\" | \"draft\" | \"archived\" | \"deprecated\";\n\n/**\n * Gallery item type.\n */\nexport type GalleryItemType = \"plugin\" | \"component\" | \"template\" | \"contract\";\n\n/**\n * Gallery item structure.\n */\nexport interface GalleryItem {\n  /** Unique item identifier */\n  id: string;\n  /** Item name */\n  name: string;\n  /** Item description */\n  description: string;\n  /** Item type */\n  type: GalleryItemType;\n  /** Item status */\n  status: GalleryItemStatus;\n  /** Category/tag */\n  category: string;\n  /** Version string */\n  version: string;\n  /** Author/creator */\n  author: string;\n  /** Creation date */\n  createdAt: Date;\n  /** Last update date */\n  updatedAt: Date;\n  /** Thumbnail/preview image URL */\n  thumbnail?: string;\n  /** Tags for search */\n  tags: string[];\n  /** Download/install count */\n  downloads?: number;\n  /** Rating (0-5) */\n  rating?: number;\n  /** Additional metadata */\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Gallery manager props.\n */\nexport interface GalleryManagerProps {\n  /** Array of gallery items */\n  items: GalleryItem[];\n  /** Callback when item is created */\n  onCreate?: (item: Omit<GalleryItem, \"id\" | \"createdAt\" | \"updatedAt\">) => Promise<GalleryItem>;\n  /** Callback when item is updated */\n  onUpdate?: (id: string, updates: Partial<GalleryItem>) => Promise<GalleryItem>;\n  /** Callback when item is deleted */\n  onDelete?: (id: string) => Promise<void>;\n  /** Callback when item is selected */\n  onSelect?: (item: GalleryItem) => void;\n  /** Callback when item is installed/added */\n  onInstall?: (item: GalleryItem) => Promise<void>;\n  /** Callback for batch install of multiple items */\n  onBatchInstall?: (items: GalleryItem[]) => Promise<void>;\n  /** Callback for batch uninstall of multiple items */\n  onBatchUninstall?: (items: GalleryItem[]) => Promise<void>;\n  /** Callback when import is requested */\n  onImport?: () => void;\n  /** Available categories */\n  categories?: SelectOption[];\n  /** Whether in read-only mode */\n  readOnly?: boolean;\n  /** Whether multi-select mode is enabled */\n  multiSelect?: boolean;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * Default categories.\n */\nconst defaultCategories: SelectOption[] = [\n  { value: \"all\", label: \"All Categories\" },\n  { value: \"tts\", label: \"Text-to-Speech\" },\n  { value: \"stt\", label: \"Speech-to-Text\" },\n  { value: \"llm\", label: \"Language Models\" },\n  { value: \"vision\", label: \"Computer Vision\" },\n  { value: \"audio\", label: \"Audio Processing\" },\n  { value: \"ui\", label: \"UI Components\" },\n  { value: \"utility\", label: \"Utilities\" },\n];\n\n/**\n * Status options.\n */\nconst statusOptions: SelectOption[] = [\n  { value: \"all\", label: \"All Statuses\" },\n  { value: \"active\", label: \"Active\" },\n  { value: \"draft\", label: \"Draft\" },\n  { value: \"archived\", label: \"Archived\" },\n  { value: \"deprecated\", label: \"Deprecated\" },\n];\n\n/**\n * Type options.\n */\nconst typeOptions: SelectOption[] = [\n  { value: \"all\", label: \"All Types\" },\n  { value: \"plugin\", label: \"Plugins\" },\n  { value: \"component\", label: \"Components\" },\n  { value: \"template\", label: \"Templates\" },\n  { value: \"contract\", label: \"Contracts\" },\n];\n\n/**\n * Sort options.\n */\nconst sortOptions: SelectOption[] = [\n  { value: \"name-asc\", label: \"Name (A-Z)\" },\n  { value: \"name-desc\", label: \"Name (Z-A)\" },\n  { value: \"updated-desc\", label: \"Recently Updated\" },\n  { value: \"updated-asc\", label: \"Oldest Updated\" },\n  { value: \"downloads-desc\", label: \"Most Downloads\" },\n  { value: \"rating-desc\", label: \"Highest Rated\" },\n];\n\n/**\n * Search icon.\n */\nconst SearchIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n  </svg>\n);\n\n/**\n * Plus icon.\n */\nconst PlusIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Edit icon.\n */\nconst EditIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" />\n    <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" />\n  </svg>\n);\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Download icon.\n */\nconst DownloadIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n    <polyline points=\"7 10 12 15 17 10\" />\n    <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n  </svg>\n);\n\n/**\n * Grid icon.\n */\nconst GridIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\n    <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\n  </svg>\n);\n\n/**\n * List icon.\n */\nconst ListIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"8\" y1=\"6\" x2=\"21\" y2=\"6\" />\n    <line x1=\"8\" y1=\"12\" x2=\"21\" y2=\"12\" />\n    <line x1=\"8\" y1=\"18\" x2=\"21\" y2=\"18\" />\n    <line x1=\"3\" y1=\"6\" x2=\"3.01\" y2=\"6\" />\n    <line x1=\"3\" y1=\"12\" x2=\"3.01\" y2=\"12\" />\n    <line x1=\"3\" y1=\"18\" x2=\"3.01\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Import/Upload icon.\n */\nconst ImportIcon: React.FC = () => (\n  <svg\n    className=\"h-4 w-4\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n    <polyline points=\"17 8 12 3 7 8\" />\n    <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" />\n  </svg>\n);\n\n/**\n * Checkbox unchecked icon.\n */\nconst CheckboxIcon: React.FC<{ checked: boolean }> = ({ checked }) => (\n  <div\n    className={[\n      \"h-5 w-5 rounded border-2 flex items-center justify-center transition-colors\",\n      checked\n        ? \"bg-primary-500 border-primary-500 text-white\"\n        : \"bg-white border-neutral-300 hover:border-primary-400\",\n    ].join(\" \")}\n  >\n    {checked && (\n      <svg\n        className=\"h-3 w-3\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 24 24\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeWidth=\"3\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      >\n        <polyline points=\"20 6 9 17 4 12\" />\n      </svg>\n    )}\n  </div>\n);\n\n/**\n * Star icon for ratings.\n */\nconst StarIcon: React.FC<{ filled: boolean }> = ({ filled }) => (\n  <svg\n    className={`h-4 w-4 ${filled ? \"text-warning-500 fill-warning-500\" : \"text-neutral-300\"}`}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill={filled ? \"currentColor\" : \"none\"}\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polygon points=\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\" />\n  </svg>\n);\n\n/**\n * Rating display component.\n */\nconst RatingDisplay: React.FC<{ rating: number }> = ({ rating }) => (\n  <div className=\"flex items-center gap-0.5\">\n    {[1, 2, 3, 4, 5].map((star) => (\n      <StarIcon key={star} filled={star <= rating} />\n    ))}\n  </div>\n);\n\n/**\n * Status badge component.\n */\nconst StatusBadge: React.FC<{ status: GalleryItemStatus }> = ({ status }) => {\n  const styles = {\n    active: \"bg-success-100 text-success-700 border-success-200\",\n    draft: \"bg-neutral-100 text-neutral-700 border-neutral-200\",\n    archived: \"bg-neutral-100 text-neutral-500 border-neutral-200\",\n    deprecated: \"bg-warning-100 text-warning-700 border-warning-200\",\n  };\n\n  return (\n    <span\n      className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${styles[status]}`}\n    >\n      {status.charAt(0).toUpperCase() + status.slice(1)}\n    </span>\n  );\n};\n\n/**\n * Type badge component.\n */\nconst TypeBadge: React.FC<{ type: GalleryItemType }> = ({ type }) => {\n  const styles = {\n    plugin: \"bg-primary-100 text-primary-700\",\n    component: \"bg-info-100 text-info-700\",\n    template: \"bg-success-100 text-success-700\",\n    contract: \"bg-warning-100 text-warning-700\",\n  };\n\n  return (\n    <span\n      className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${styles[type]}`}\n    >\n      {type.charAt(0).toUpperCase() + type.slice(1)}\n    </span>\n  );\n};\n\n/**\n * Gallery item card component (grid view).\n */\nconst ItemCard: React.FC<{\n  item: GalleryItem;\n  onSelect?: () => void;\n  onEdit?: () => void;\n  onDelete?: () => void;\n  onInstall?: () => void;\n  readOnly?: boolean;\n  isSelected?: boolean;\n  onToggleSelect?: () => void;\n  showCheckbox?: boolean;\n}> = ({ item, onSelect, onEdit, onDelete, onInstall, readOnly, isSelected, onToggleSelect, showCheckbox }) => {\n  return (\n    <div\n      className={[\n        \"group\",\n        \"bg-white\",\n        \"border\",\n        \"rounded-lg\",\n        \"overflow-hidden\",\n        \"hover:shadow-md\",\n        \"transition-all\",\n        \"duration-200\",\n        isSelected ? \"border-primary-500 ring-2 ring-primary-200\" : \"border-neutral-200 hover:border-primary-300\",\n        onSelect ? \"cursor-pointer\" : \"\",\n      ].join(\" \")}\n      onClick={onSelect}\n    >\n      {/* Thumbnail */}\n      <div className=\"aspect-video bg-neutral-100 relative\">\n        {item.thumbnail ? (\n          <img\n            src={item.thumbnail}\n            alt={item.name}\n            className=\"w-full h-full object-cover\"\n          />\n        ) : (\n          <div className=\"absolute inset-0 flex items-center justify-center text-neutral-400\">\n            <GridIcon />\n          </div>\n        )}\n        {/* Checkbox for multi-select */}\n        {showCheckbox && (\n          <div\n            className=\"absolute top-2 left-2 z-10\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onToggleSelect?.();\n            }}\n          >\n            <CheckboxIcon checked={isSelected || false} />\n          </div>\n        )}\n        <div className={[\"absolute top-2 flex gap-1\", showCheckbox ? \"left-9\" : \"left-2\"].join(\" \")}>\n          <TypeBadge type={item.type} />\n        </div>\n        <div className=\"absolute top-2 right-2\">\n          <StatusBadge status={item.status} />\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"p-4\">\n        <h3 className=\"text-sm font-semibold text-neutral-900 truncate\">\n          {item.name}\n        </h3>\n        <p className=\"text-xs text-neutral-500 mt-0.5\">v{item.version}</p>\n        <p className=\"text-sm text-neutral-600 mt-2 line-clamp-2\">\n          {item.description}\n        </p>\n\n        {/* Tags */}\n        {item.tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-1 mt-3\">\n            {item.tags.slice(0, 3).map((tag) => (\n              <span\n                key={tag}\n                className=\"px-1.5 py-0.5 bg-neutral-100 text-neutral-600 text-xs rounded\"\n              >\n                {tag}\n              </span>\n            ))}\n            {item.tags.length > 3 && (\n              <span className=\"text-xs text-neutral-400\">\n                +{item.tags.length - 3}\n              </span>\n            )}\n          </div>\n        )}\n\n        {/* Stats */}\n        <div className=\"flex items-center justify-between mt-3 pt-3 border-t border-neutral-100\">\n          <div className=\"flex items-center gap-3 text-xs text-neutral-500\">\n            {item.downloads !== undefined && (\n              <span className=\"flex items-center gap-1\">\n                <DownloadIcon />\n                {item.downloads.toLocaleString()}\n              </span>\n            )}\n            {item.rating !== undefined && <RatingDisplay rating={item.rating} />}\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex items-center gap-2 mt-3 opacity-0 group-hover:opacity-100 transition-opacity\">\n          {onInstall && (\n            <Button\n              variant=\"primary\"\n              size=\"xs\"\n              onClick={(e) => {\n                e.stopPropagation();\n                onInstall();\n              }}\n              leftIcon={<DownloadIcon />}\n            >\n              Install\n            </Button>\n          )}\n          {!readOnly && onEdit && (\n            <Button\n              variant=\"ghost\"\n              size=\"xs\"\n              onClick={(e) => {\n                e.stopPropagation();\n                onEdit();\n              }}\n              iconOnly\n              aria-label=\"Edit\"\n            >\n              <EditIcon />\n            </Button>\n          )}\n          {!readOnly && onDelete && (\n            <Button\n              variant=\"ghost\"\n              size=\"xs\"\n              onClick={(e) => {\n                e.stopPropagation();\n                onDelete();\n              }}\n              iconOnly\n              aria-label=\"Delete\"\n              className=\"text-error-500 hover:text-error-600\"\n            >\n              <TrashIcon />\n            </Button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n/**\n * Gallery item row component (list view).\n */\nconst ItemRow: React.FC<{\n  item: GalleryItem;\n  onSelect?: () => void;\n  onEdit?: () => void;\n  onDelete?: () => void;\n  onInstall?: () => void;\n  readOnly?: boolean;\n  isSelected?: boolean;\n  onToggleSelect?: () => void;\n  showCheckbox?: boolean;\n}> = ({ item, onSelect, onEdit, onDelete, onInstall, readOnly, isSelected, onToggleSelect, showCheckbox }) => {\n  return (\n    <div\n      className={[\n        \"flex\",\n        \"items-center\",\n        \"gap-4\",\n        \"p-4\",\n        \"bg-white\",\n        \"border\",\n        \"rounded-lg\",\n        \"hover:bg-neutral-50\",\n        \"transition-all\",\n        \"duration-200\",\n        isSelected ? \"border-primary-500 ring-2 ring-primary-200\" : \"border-neutral-200 hover:border-primary-300\",\n        onSelect ? \"cursor-pointer\" : \"\",\n      ].join(\" \")}\n      onClick={onSelect}\n    >\n      {/* Checkbox for multi-select */}\n      {showCheckbox && (\n        <div\n          className=\"shrink-0\"\n          onClick={(e) => {\n            e.stopPropagation();\n            onToggleSelect?.();\n          }}\n        >\n          <CheckboxIcon checked={isSelected || false} />\n        </div>\n      )}\n\n      {/* Thumbnail */}\n      <div className=\"w-16 h-16 bg-neutral-100 rounded-lg overflow-hidden shrink-0\">\n        {item.thumbnail ? (\n          <img\n            src={item.thumbnail}\n            alt={item.name}\n            className=\"w-full h-full object-cover\"\n          />\n        ) : (\n          <div className=\"w-full h-full flex items-center justify-center text-neutral-400\">\n            <GridIcon />\n          </div>\n        )}\n      </div>\n\n      {/* Content */}\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center gap-2\">\n          <h3 className=\"text-sm font-semibold text-neutral-900 truncate\">\n            {item.name}\n          </h3>\n          <TypeBadge type={item.type} />\n          <StatusBadge status={item.status} />\n        </div>\n        <p className=\"text-xs text-neutral-500 mt-0.5\">\n          v{item.version} by {item.author}\n        </p>\n        <p className=\"text-sm text-neutral-600 mt-1 line-clamp-1\">\n          {item.description}\n        </p>\n      </div>\n\n      {/* Stats */}\n      <div className=\"flex items-center gap-4 shrink-0\">\n        {item.downloads !== undefined && (\n          <span className=\"flex items-center gap-1 text-xs text-neutral-500\">\n            <DownloadIcon />\n            {item.downloads.toLocaleString()}\n          </span>\n        )}\n        {item.rating !== undefined && <RatingDisplay rating={item.rating} />}\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex items-center gap-2 shrink-0\">\n        {onInstall && (\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onInstall();\n            }}\n            leftIcon={<DownloadIcon />}\n          >\n            Install\n          </Button>\n        )}\n        {!readOnly && onEdit && (\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onEdit();\n            }}\n            iconOnly\n            aria-label=\"Edit\"\n          >\n            <EditIcon />\n          </Button>\n        )}\n        {!readOnly && onDelete && (\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onDelete();\n            }}\n            iconOnly\n            aria-label=\"Delete\"\n            className=\"text-error-500 hover:text-error-600\"\n          >\n            <TrashIcon />\n          </Button>\n        )}\n      </div>\n    </div>\n  );\n};\n\n/**\n * Item form modal for create/edit.\n */\nconst ItemFormModal: React.FC<{\n  isOpen: boolean;\n  onClose: () => void;\n  item?: GalleryItem;\n  onSave: (data: Partial<GalleryItem>) => void;\n  categories: SelectOption[];\n  isLoading?: boolean;\n}> = ({ isOpen, onClose, item, onSave, categories, isLoading }) => {\n  const [formData, setFormData] = useState<Partial<GalleryItem>>(\n    item || {\n      name: \"\",\n      description: \"\",\n      type: \"plugin\",\n      status: \"draft\",\n      category: \"\",\n      version: \"1.0.0\",\n      author: \"\",\n      tags: [],\n    }\n  );\n  const [tagInput, setTagInput] = useState(\"\");\n\n  const handleSave = () => {\n    onSave(formData);\n  };\n\n  const addTag = () => {\n    if (tagInput.trim() && !formData.tags?.includes(tagInput.trim())) {\n      setFormData((prev) => ({\n        ...prev,\n        tags: [...(prev.tags || []), tagInput.trim()],\n      }));\n      setTagInput(\"\");\n    }\n  };\n\n  const removeTag = (tag: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      tags: prev.tags?.filter((t) => t !== tag) || [],\n    }));\n  };\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title={item ? \"Edit Item\" : \"Create New Item\"}\n      size=\"lg\"\n      footer={\n        <>\n          <Button variant=\"secondary\" onClick={onClose}>\n            Cancel\n          </Button>\n          <Button\n            variant=\"primary\"\n            onClick={handleSave}\n            loading={isLoading}\n            disabled={!formData.name?.trim()}\n          >\n            {item ? \"Save Changes\" : \"Create\"}\n          </Button>\n        </>\n      }\n    >\n      <div className=\"space-y-4\">\n        <Input\n          label=\"Name\"\n          value={formData.name || \"\"}\n          onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}\n          placeholder=\"My Plugin\"\n          fullWidth\n          isRequired\n        />\n\n        <div className=\"grid grid-cols-2 gap-4\">\n          <Select\n            label=\"Type\"\n            options={typeOptions.filter((o) => o.value !== \"all\")}\n            value={formData.type || \"plugin\"}\n            onChange={(e) =>\n              setFormData((prev) => ({ ...prev, type: e.target.value as GalleryItemType }))\n            }\n            fullWidth\n          />\n          <Select\n            label=\"Status\"\n            options={statusOptions.filter((o) => o.value !== \"all\")}\n            value={formData.status || \"draft\"}\n            onChange={(e) =>\n              setFormData((prev) => ({ ...prev, status: e.target.value as GalleryItemStatus }))\n            }\n            fullWidth\n          />\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-4\">\n          <Select\n            label=\"Category\"\n            options={categories.filter((o) => o.value !== \"all\")}\n            value={formData.category || \"\"}\n            onChange={(e) => setFormData((prev) => ({ ...prev, category: e.target.value }))}\n            fullWidth\n          />\n          <Input\n            label=\"Version\"\n            value={formData.version || \"\"}\n            onChange={(e) => setFormData((prev) => ({ ...prev, version: e.target.value }))}\n            placeholder=\"1.0.0\"\n            fullWidth\n          />\n        </div>\n\n        <Input\n          label=\"Author\"\n          value={formData.author || \"\"}\n          onChange={(e) => setFormData((prev) => ({ ...prev, author: e.target.value }))}\n          placeholder=\"Your Name\"\n          fullWidth\n        />\n\n        <div>\n          <label className=\"block text-sm font-medium text-neutral-700 mb-1.5\">\n            Description\n          </label>\n          <textarea\n            value={formData.description || \"\"}\n            onChange={(e) =>\n              setFormData((prev) => ({ ...prev, description: e.target.value }))\n            }\n            placeholder=\"Describe your item...\"\n            rows={3}\n            className={[\n              \"w-full\",\n              \"px-4\",\n              \"py-2\",\n              \"text-base\",\n              \"text-neutral-900\",\n              \"placeholder:text-neutral-400\",\n              \"border\",\n              \"border-neutral-300\",\n              \"rounded-md\",\n              \"focus:outline-none\",\n              \"focus:ring-2\",\n              \"focus:ring-primary-500\",\n              \"focus:border-primary-500\",\n              \"resize-none\",\n            ].join(\" \")}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-neutral-700 mb-1.5\">\n            Tags\n          </label>\n          <div className=\"flex items-center gap-2\">\n            <Input\n              value={tagInput}\n              onChange={(e) => setTagInput(e.target.value)}\n              placeholder=\"Add tag\"\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") {\n                  e.preventDefault();\n                  addTag();\n                }\n              }}\n              fullWidth\n            />\n            <Button variant=\"secondary\" onClick={addTag}>\n              Add\n            </Button>\n          </div>\n          {formData.tags && formData.tags.length > 0 && (\n            <div className=\"flex flex-wrap gap-2 mt-2\">\n              {formData.tags.map((tag) => (\n                <span\n                  key={tag}\n                  className=\"inline-flex items-center gap-1 px-2 py-1 bg-neutral-100 text-neutral-700 text-sm rounded\"\n                >\n                  {tag}\n                  <button\n                    type=\"button\"\n                    onClick={() => removeTag(tag)}\n                    className=\"text-neutral-400 hover:text-neutral-600\"\n                  >\n                    &times;\n                  </button>\n                </span>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\n/**\n * GalleryManager component.\n *\n * A comprehensive gallery management interface for plugins, components,\n * templates, and contracts with CRUD operations, filtering, and search.\n *\n * @example\n * ```tsx\n * <GalleryManager\n *   items={galleryItems}\n *   onCreate={async (item) => {\n *     return await api.createItem(item);\n *   }}\n *   onUpdate={async (id, updates) => {\n *     return await api.updateItem(id, updates);\n *   }}\n *   onDelete={async (id) => {\n *     await api.deleteItem(id);\n *   }}\n *   onSelect={(item) => openItemDetails(item)}\n * />\n * ```\n */\nexport const GalleryManager: React.FC<GalleryManagerProps> = ({\n  items,\n  onCreate,\n  onUpdate,\n  onDelete,\n  onSelect,\n  onInstall,\n  onBatchInstall,\n  onBatchUninstall,\n  onImport,\n  categories = defaultCategories,\n  readOnly = false,\n  multiSelect = false,\n  className = \"\",\n}) => {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState(\"all\");\n  const [selectedType, setSelectedType] = useState(\"all\");\n  const [selectedStatus, setSelectedStatus] = useState(\"all\");\n  const [sortBy, setSortBy] = useState(\"updated-desc\");\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const [editingItem, setEditingItem] = useState<GalleryItem | undefined>();\n  const [deleteConfirmItem, setDeleteConfirmItem] = useState<GalleryItem | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Multi-select state\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());\n\n  // Toggle item selection\n  const handleToggleSelect = useCallback((itemId: string) => {\n    setSelectedIds((prev) => {\n      const next = new Set(prev);\n      if (next.has(itemId)) {\n        next.delete(itemId);\n      } else {\n        next.add(itemId);\n      }\n      return next;\n    });\n  }, []);\n\n  // Select all visible items\n  const handleSelectAll = useCallback(() => {\n    const allIds = items.map((item) => item.id);\n    setSelectedIds(new Set(allIds));\n  }, [items]);\n\n  // Clear selection\n  const handleClearSelection = useCallback(() => {\n    setSelectedIds(new Set());\n  }, []);\n\n  // Get selected items\n  const selectedItems = useMemo(() => {\n    return items.filter((item) => selectedIds.has(item.id));\n  }, [items, selectedIds]);\n\n  // Batch install handler\n  const handleBatchInstall = useCallback(async () => {\n    if (selectedItems.length === 0 || !onBatchInstall) return;\n    setIsLoading(true);\n    try {\n      await onBatchInstall(selectedItems);\n      setSelectedIds(new Set());\n    } finally {\n      setIsLoading(false);\n    }\n  }, [selectedItems, onBatchInstall]);\n\n  // Batch uninstall handler\n  const handleBatchUninstall = useCallback(async () => {\n    if (selectedItems.length === 0 || !onBatchUninstall) return;\n    setIsLoading(true);\n    try {\n      await onBatchUninstall(selectedItems);\n      setSelectedIds(new Set());\n    } finally {\n      setIsLoading(false);\n    }\n  }, [selectedItems, onBatchUninstall]);\n\n  // Filter and sort items\n  const filteredItems = useMemo(() => {\n    let result = [...items];\n\n    // Search filter\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      result = result.filter(\n        (item) =>\n          item.name.toLowerCase().includes(query) ||\n          item.description.toLowerCase().includes(query) ||\n          item.tags.some((tag) => tag.toLowerCase().includes(query))\n      );\n    }\n\n    // Category filter\n    if (selectedCategory !== \"all\") {\n      result = result.filter((item) => item.category === selectedCategory);\n    }\n\n    // Type filter\n    if (selectedType !== \"all\") {\n      result = result.filter((item) => item.type === selectedType);\n    }\n\n    // Status filter\n    if (selectedStatus !== \"all\") {\n      result = result.filter((item) => item.status === selectedStatus);\n    }\n\n    // Sort\n    result.sort((a, b) => {\n      switch (sortBy) {\n        case \"name-asc\":\n          return a.name.localeCompare(b.name);\n        case \"name-desc\":\n          return b.name.localeCompare(a.name);\n        case \"updated-desc\":\n          return b.updatedAt.getTime() - a.updatedAt.getTime();\n        case \"updated-asc\":\n          return a.updatedAt.getTime() - b.updatedAt.getTime();\n        case \"downloads-desc\":\n          return (b.downloads || 0) - (a.downloads || 0);\n        case \"rating-desc\":\n          return (b.rating || 0) - (a.rating || 0);\n        default:\n          return 0;\n      }\n    });\n\n    return result;\n  }, [items, searchQuery, selectedCategory, selectedType, selectedStatus, sortBy]);\n\n  const handleCreate = useCallback(async () => {\n    setEditingItem(undefined);\n    setIsFormOpen(true);\n  }, []);\n\n  const handleEdit = useCallback((item: GalleryItem) => {\n    setEditingItem(item);\n    setIsFormOpen(true);\n  }, []);\n\n  const handleSave = useCallback(\n    async (data: Partial<GalleryItem>) => {\n      setIsLoading(true);\n      try {\n        if (editingItem && onUpdate) {\n          await onUpdate(editingItem.id, data);\n        } else if (onCreate) {\n          await onCreate(data as Omit<GalleryItem, \"id\" | \"createdAt\" | \"updatedAt\">);\n        }\n        setIsFormOpen(false);\n        setEditingItem(undefined);\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [editingItem, onCreate, onUpdate]\n  );\n\n  const handleDelete = useCallback(async () => {\n    if (!deleteConfirmItem || !onDelete) return;\n    setIsLoading(true);\n    try {\n      await onDelete(deleteConfirmItem.id);\n      setDeleteConfirmItem(null);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [deleteConfirmItem, onDelete]);\n\n  const containerStyles = [\"space-y-4\", className].filter(Boolean).join(\" \");\n\n  return (\n    <div className={containerStyles}>\n      {/* Header/Toolbar */}\n      <Panel variant=\"default\" padding=\"md\" radius=\"lg\">\n        <div className=\"space-y-4\">\n          {/* Search and actions row */}\n          <div className=\"flex items-center gap-4\">\n            <div className=\"flex-1\">\n              <Input\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                placeholder=\"Search gallery...\"\n                leftElement={<SearchIcon />}\n                fullWidth\n              />\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"}\n                size=\"sm\"\n                iconOnly\n                onClick={() => setViewMode(\"grid\")}\n                aria-label=\"Grid view\"\n              >\n                <GridIcon />\n              </Button>\n              <Button\n                variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"}\n                size=\"sm\"\n                iconOnly\n                onClick={() => setViewMode(\"list\")}\n                aria-label=\"List view\"\n              >\n                <ListIcon />\n              </Button>\n              {onImport && (\n                <Button\n                  variant=\"secondary\"\n                  size=\"sm\"\n                  onClick={onImport}\n                  leftIcon={<ImportIcon />}\n                >\n                  Import\n                </Button>\n              )}\n              {!readOnly && onCreate && (\n                <Button\n                  variant=\"primary\"\n                  size=\"sm\"\n                  onClick={handleCreate}\n                  leftIcon={<PlusIcon />}\n                >\n                  Add New\n                </Button>\n              )}\n            </div>\n          </div>\n\n          {/* Batch actions toolbar - shown when items are selected */}\n          {multiSelect && selectedIds.size > 0 && (\n            <div className=\"flex items-center gap-4 p-3 bg-primary-50 border border-primary-200 rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm font-medium text-primary-700\">\n                  {selectedIds.size} item{selectedIds.size !== 1 ? \"s\" : \"\"} selected\n                </span>\n                <Button\n                  variant=\"ghost\"\n                  size=\"xs\"\n                  onClick={handleClearSelection}\n                  className=\"text-primary-600\"\n                >\n                  Clear\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  size=\"xs\"\n                  onClick={handleSelectAll}\n                  className=\"text-primary-600\"\n                >\n                  Select All\n                </Button>\n              </div>\n              <div className=\"flex-1\" />\n              <div className=\"flex items-center gap-2\">\n                {onBatchInstall && (\n                  <Button\n                    variant=\"primary\"\n                    size=\"sm\"\n                    onClick={handleBatchInstall}\n                    loading={isLoading}\n                    leftIcon={<DownloadIcon />}\n                  >\n                    Install ({selectedIds.size})\n                  </Button>\n                )}\n                {onBatchUninstall && (\n                  <Button\n                    variant=\"secondary\"\n                    size=\"sm\"\n                    onClick={handleBatchUninstall}\n                    loading={isLoading}\n                  >\n                    Uninstall ({selectedIds.size})\n                  </Button>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Filters row */}\n          <div className=\"flex items-center gap-4\">\n            <Select\n              options={categories}\n              value={selectedCategory}\n              onChange={(e) => setSelectedCategory(e.target.value)}\n              size=\"sm\"\n            />\n            <Select\n              options={typeOptions}\n              value={selectedType}\n              onChange={(e) => setSelectedType(e.target.value)}\n              size=\"sm\"\n            />\n            <Select\n              options={statusOptions}\n              value={selectedStatus}\n              onChange={(e) => setSelectedStatus(e.target.value)}\n              size=\"sm\"\n            />\n            <div className=\"flex-1\" />\n            <Select\n              options={sortOptions}\n              value={sortBy}\n              onChange={(e) => setSortBy(e.target.value)}\n              size=\"sm\"\n            />\n          </div>\n        </div>\n      </Panel>\n\n      {/* Results summary */}\n      <div className=\"flex items-center justify-between text-sm text-neutral-600\">\n        <span>\n          Showing {filteredItems.length} of {items.length} items\n        </span>\n      </div>\n\n      {/* Items grid/list */}\n      {filteredItems.length === 0 ? (\n        <Panel variant=\"default\" padding=\"lg\" radius=\"lg\">\n          <div className=\"text-center py-12\">\n            <div className=\"text-neutral-400 mb-2\">\n              <GridIcon />\n            </div>\n            <h3 className=\"text-lg font-semibold text-neutral-900\">No items found</h3>\n            <p className=\"text-sm text-neutral-500 mt-1\">\n              {searchQuery\n                ? \"Try adjusting your search or filters\"\n                : \"Get started by adding your first item\"}\n            </p>\n            {!readOnly && onCreate && !searchQuery && (\n              <Button\n                variant=\"primary\"\n                size=\"md\"\n                onClick={handleCreate}\n                leftIcon={<PlusIcon />}\n                className=\"mt-4\"\n              >\n                Add First Item\n              </Button>\n            )}\n          </div>\n        </Panel>\n      ) : viewMode === \"grid\" ? (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n          {filteredItems.map((item) => (\n            <ItemCard\n              key={item.id}\n              item={item}\n              onSelect={onSelect ? () => onSelect(item) : undefined}\n              onEdit={onUpdate ? () => handleEdit(item) : undefined}\n              onDelete={onDelete ? () => setDeleteConfirmItem(item) : undefined}\n              onInstall={onInstall ? () => onInstall(item) : undefined}\n              readOnly={readOnly}\n              isSelected={selectedIds.has(item.id)}\n              onToggleSelect={() => handleToggleSelect(item.id)}\n              showCheckbox={multiSelect}\n            />\n          ))}\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {filteredItems.map((item) => (\n            <ItemRow\n              key={item.id}\n              item={item}\n              onSelect={onSelect ? () => onSelect(item) : undefined}\n              onEdit={onUpdate ? () => handleEdit(item) : undefined}\n              onDelete={onDelete ? () => setDeleteConfirmItem(item) : undefined}\n              onInstall={onInstall ? () => onInstall(item) : undefined}\n              readOnly={readOnly}\n              isSelected={selectedIds.has(item.id)}\n              onToggleSelect={() => handleToggleSelect(item.id)}\n              showCheckbox={multiSelect}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Create/Edit modal */}\n      <ItemFormModal\n        isOpen={isFormOpen}\n        onClose={() => {\n          setIsFormOpen(false);\n          setEditingItem(undefined);\n        }}\n        item={editingItem}\n        onSave={handleSave}\n        categories={categories}\n        isLoading={isLoading}\n      />\n\n      {/* Delete confirmation modal */}\n      <Modal\n        isOpen={!!deleteConfirmItem}\n        onClose={() => setDeleteConfirmItem(null)}\n        title=\"Delete Item\"\n        size=\"sm\"\n        footer={\n          <>\n            <Button variant=\"secondary\" onClick={() => setDeleteConfirmItem(null)}>\n              Cancel\n            </Button>\n            <Button variant=\"danger\" onClick={handleDelete} loading={isLoading}>\n              Delete\n            </Button>\n          </>\n        }\n      >\n        <p className=\"text-neutral-700\">\n          Are you sure you want to delete <strong>{deleteConfirmItem?.name}</strong>?\n          This action cannot be undone.\n        </p>\n      </Modal>\n    </div>\n  );\n};\n\nGalleryManager.displayName = \"GalleryManager\";\n\nexport default GalleryManager;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\gallery\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\AddSlotModal.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\AddSlotModal.tsx:218:7\n  216 |   useEffect(() => {\n  217 |     if (isOpen) {\n> 218 |       setName(\"\");\n      |       ^^^^^^^ Avoid calling setState() directly within an effect\n  219 |       setContract(\"\");\n  220 |       setDescription(\"\");\n  221 |       setPosition(defaultPosition);","line":218,"column":7,"nodeType":null,"endLine":218,"endColumn":14},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":398,"column":32,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":398,"endColumn":52},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":461,"column":34,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":461,"endColumn":68}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D067 - src/components/project/AddSlotModal.tsx\n * ===============================================\n * Modal for adding a new component/plugin slot to a project.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D011 (Input.tsx), D012 (Select.tsx), D014 (Modal.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\n\n/**\n * Slot configuration options.\n */\nexport interface SlotConfig {\n  name: string;\n  contract: string;\n  description?: string;\n  position: \"header\" | \"sidebar\" | \"main\" | \"footer\" | \"overlay\" | \"custom\";\n  isRequired: boolean;\n  isMultiple: boolean;\n  priority: number;\n  defaultPluginId?: string;\n  fallbackPluginId?: string;\n}\n\n/**\n * Available contract type.\n */\nexport interface ContractType {\n  id: string;\n  name: string;\n  description: string;\n  methods: string[];\n  availablePlugins: number;\n}\n\n/**\n * AddSlotModal component props.\n */\nexport interface AddSlotModalProps {\n  /** Whether the modal is open */\n  isOpen: boolean;\n  /** Callback when modal should close */\n  onClose: () => void;\n  /** Callback when slot is created */\n  onCreateSlot: (config: SlotConfig) => void;\n  /** Available contract types */\n  contractTypes: ContractType[];\n  /** Existing slot names (for validation) */\n  existingSlotNames?: string[];\n  /** Default position */\n  defaultPosition?: SlotConfig[\"position\"];\n  /** Default priority */\n  defaultPriority?: number;\n}\n\n/**\n * Close icon.\n */\nconst CloseIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Info icon.\n */\nconst InfoIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\" />\n    <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" />\n  </svg>\n);\n\n/**\n * Alert icon.\n */\nconst AlertIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" />\n    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" />\n    <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\n  </svg>\n);\n\n/**\n * Contract type icons.\n */\nconst ContractIcons: Record<string, React.FC<{ className?: string }>> = {\n  tts: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\" />\n      <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\n      <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n      <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n    </svg>\n  ),\n  stt: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n      <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07\" />\n    </svg>\n  ),\n  llm: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n    </svg>\n  ),\n  mcp: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\" ry=\"2\" />\n      <rect x=\"9\" y=\"9\" width=\"6\" height=\"6\" />\n      <line x1=\"9\" y1=\"1\" x2=\"9\" y2=\"4\" />\n      <line x1=\"15\" y1=\"1\" x2=\"15\" y2=\"4\" />\n      <line x1=\"9\" y1=\"20\" x2=\"9\" y2=\"23\" />\n      <line x1=\"15\" y1=\"20\" x2=\"15\" y2=\"23\" />\n      <line x1=\"20\" y1=\"9\" x2=\"23\" y2=\"9\" />\n      <line x1=\"20\" y1=\"14\" x2=\"23\" y2=\"14\" />\n      <line x1=\"1\" y1=\"9\" x2=\"4\" y2=\"9\" />\n      <line x1=\"1\" y1=\"14\" x2=\"4\" y2=\"14\" />\n    </svg>\n  ),\n  default: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"12 2 2 7 12 12 22 7 12 2\" />\n      <polyline points=\"2 17 12 22 22 17\" />\n      <polyline points=\"2 12 12 17 22 12\" />\n    </svg>\n  ),\n};\n\n/**\n * Position labels and descriptions.\n */\nconst positionOptions = [\n  { value: \"header\", label: \"Header\", description: \"Top of the screen\" },\n  { value: \"sidebar\", label: \"Sidebar\", description: \"Side panel area\" },\n  { value: \"main\", label: \"Main\", description: \"Primary content area\" },\n  { value: \"footer\", label: \"Footer\", description: \"Bottom of the screen\" },\n  { value: \"overlay\", label: \"Overlay\", description: \"Floating over content\" },\n  { value: \"custom\", label: \"Custom\", description: \"Custom positioning\" },\n] as const;\n\n/**\n * Contract colors.\n */\nconst contractColors: Record<string, string> = {\n  tts: \"border-primary-200 bg-primary-50 text-primary-700\",\n  stt: \"border-success-200 bg-success-50 text-success-700\",\n  llm: \"border-warning-200 bg-warning-50 text-warning-700\",\n  mcp: \"border-info-200 bg-info-50 text-info-700\",\n  default: \"border-neutral-200 bg-neutral-50 text-neutral-700\",\n};\n\n/**\n * AddSlotModal component.\n *\n * Modal dialog for creating a new plugin slot with configuration options.\n *\n * @example\n * ```tsx\n * <AddSlotModal\n *   isOpen={isOpen}\n *   onClose={() => setIsOpen(false)}\n *   onCreateSlot={(config) => createSlot(config)}\n *   contractTypes={availableContracts}\n *   existingSlotNames={currentSlotNames}\n * />\n * ```\n */\nexport const AddSlotModal: React.FC<AddSlotModalProps> = ({\n  isOpen,\n  onClose,\n  onCreateSlot,\n  contractTypes,\n  existingSlotNames = [],\n  defaultPosition = \"main\",\n  defaultPriority = 0,\n}) => {\n  // Form state\n  const [name, setName] = useState(\"\");\n  const [contract, setContract] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [position, setPosition] = useState<SlotConfig[\"position\"]>(defaultPosition);\n  const [isRequired, setIsRequired] = useState(false);\n  const [isMultiple, setIsMultiple] = useState(false);\n  const [priority, setPriority] = useState(defaultPriority);\n\n  // Current step (0: contract, 1: details)\n  const [step, setStep] = useState(0);\n\n  // Validation errors\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Reset form when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setName(\"\");\n      setContract(\"\");\n      setDescription(\"\");\n      setPosition(defaultPosition);\n      setIsRequired(false);\n      setIsMultiple(false);\n      setPriority(defaultPriority);\n      setStep(0);\n      setErrors({});\n    }\n  }, [isOpen, defaultPosition, defaultPriority]);\n\n  // Selected contract type\n  const selectedContract = useMemo(\n    () => contractTypes.find((c) => c.id === contract),\n    [contractTypes, contract]\n  );\n\n  // Validate name\n  const validateName = useCallback(\n    (value: string) => {\n      if (!value.trim()) {\n        return \"Name is required\";\n      }\n      if (!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(value)) {\n        return \"Name must start with a letter and contain only letters, numbers, and underscores\";\n      }\n      if (existingSlotNames.includes(value)) {\n        return \"A slot with this name already exists\";\n      }\n      return \"\";\n    },\n    [existingSlotNames]\n  );\n\n  // Handle name change\n  const handleNameChange = useCallback(\n    (value: string) => {\n      setName(value);\n      const error = validateName(value);\n      setErrors((prev) => ({ ...prev, name: error }));\n    },\n    [validateName]\n  );\n\n  // Handle contract selection\n  const handleContractSelect = useCallback((contractId: string) => {\n    setContract(contractId);\n    setStep(1);\n  }, []);\n\n  // Handle create\n  const handleCreate = useCallback(() => {\n    // Validate\n    const nameError = validateName(name);\n    if (nameError) {\n      setErrors({ name: nameError });\n      return;\n    }\n\n    // Create slot config\n    const config: SlotConfig = {\n      name,\n      contract,\n      description: description || undefined,\n      position,\n      isRequired,\n      isMultiple,\n      priority,\n    };\n\n    onCreateSlot(config);\n    onClose();\n  }, [name, contract, description, position, isRequired, isMultiple, priority, validateName, onCreateSlot, onClose]);\n\n  // Handle back\n  const handleBack = useCallback(() => {\n    setStep(0);\n    setContract(\"\");\n  }, []);\n\n  // Handle close\n  const handleClose = useCallback(() => {\n    onClose();\n  }, [onClose]);\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") {\n        handleClose();\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleEscape);\n    return () => document.removeEventListener(\"keydown\", handleEscape);\n  }, [isOpen, handleClose]);\n\n  // Prevent body scroll\n  useEffect(() => {\n    if (isOpen) {\n      const originalOverflow = document.body.style.overflow;\n      document.body.style.overflow = \"hidden\";\n      return () => {\n        document.body.style.overflow = originalOverflow;\n      };\n    }\n  }, [isOpen]);\n\n  if (!isOpen) return null;\n\n  const modalContent = (\n    <div\n      className={[\n        \"fixed\",\n        \"inset-0\",\n        \"z-modal\",\n        \"flex\",\n        \"items-center\",\n        \"justify-center\",\n        \"p-4\",\n        \"bg-black/50\",\n        \"backdrop-blur-sm\",\n      ].join(\" \")}\n      onClick={handleClose}\n    >\n      <div\n        className={[\n          \"w-full\",\n          \"max-w-lg\",\n          \"bg-white\",\n          \"rounded-lg\",\n          \"shadow-xl\",\n          \"overflow-hidden\",\n        ].join(\" \")}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-neutral-200\">\n          <div>\n            <h2 className=\"text-lg font-semibold text-neutral-900\">\n              Add Plugin Slot\n            </h2>\n            <p className=\"text-sm text-neutral-500\">\n              {step === 0 ? \"Select a contract type\" : \"Configure slot details\"}\n            </p>\n          </div>\n          <button\n            type=\"button\"\n            onClick={handleClose}\n            className={[\n              \"p-1\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              \"hover:text-neutral-600\",\n              \"hover:bg-neutral-100\",\n              \"transition-colors\",\n              \"duration-150\",\n            ].join(\" \")}\n          >\n            <CloseIcon className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6\">\n          {step === 0 ? (\n            /* Step 1: Contract selection */\n            <div className=\"space-y-3\">\n              {contractTypes.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <InfoIcon className=\"mx-auto h-12 w-12 text-neutral-300\" />\n                  <p className=\"mt-2 text-sm text-neutral-500\">\n                    No contract types available\n                  </p>\n                </div>\n              ) : (\n                contractTypes.map((ct) => {\n                  const Icon = ContractIcons[ct.id] || ContractIcons.default;\n                  const colors = contractColors[ct.id] || contractColors.default;\n\n                  return (\n                    <button\n                      key={ct.id}\n                      type=\"button\"\n                      onClick={() => handleContractSelect(ct.id)}\n                      className={[\n                        \"w-full\",\n                        \"flex\",\n                        \"items-start\",\n                        \"gap-4\",\n                        \"p-4\",\n                        \"rounded-lg\",\n                        \"border-2\",\n                        \"text-left\",\n                        \"transition-all\",\n                        \"duration-150\",\n                        \"hover:shadow-md\",\n                        contract === ct.id\n                          ? \"border-primary-500 bg-primary-50\"\n                          : \"border-neutral-200 hover:border-neutral-300\",\n                      ].join(\" \")}\n                    >\n                      <div\n                        className={[\n                          \"flex\",\n                          \"items-center\",\n                          \"justify-center\",\n                          \"h-12\",\n                          \"w-12\",\n                          \"rounded-lg\",\n                          \"border\",\n                          colors,\n                        ].join(\" \")}\n                      >\n                        <Icon className=\"h-6 w-6\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"text-sm font-semibold text-neutral-900\">\n                          {ct.name}\n                        </h3>\n                        <p className=\"text-xs text-neutral-500 mt-0.5\">\n                          {ct.description}\n                        </p>\n                        <div className=\"mt-2 flex items-center gap-3 text-xs text-neutral-400\">\n                          <span>{ct.methods.length} methods</span>\n                          <span>{ct.availablePlugins} plugins available</span>\n                        </div>\n                      </div>\n                    </button>\n                  );\n                })\n              )}\n            </div>\n          ) : (\n            /* Step 2: Details configuration */\n            <div className=\"space-y-4\">\n              {/* Selected contract badge */}\n              {selectedContract && (\n                <div className=\"flex items-center gap-2 p-3 bg-neutral-50 rounded-lg\">\n                  {(() => {\n                    const Icon = ContractIcons[selectedContract.id] || ContractIcons.default;\n                    return <Icon className=\"h-5 w-5 text-neutral-500\" />;\n                  })()}\n                  <span className=\"text-sm font-medium text-neutral-700\">\n                    {selectedContract.name}\n                  </span>\n                  <button\n                    type=\"button\"\n                    onClick={handleBack}\n                    className=\"ml-auto text-xs text-primary-600 hover:text-primary-700\"\n                  >\n                    Change\n                  </button>\n                </div>\n              )}\n\n              {/* Name input */}\n              <div>\n                <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                  Slot Name <span className=\"text-error-500\">*</span>\n                </label>\n                <input\n                  type=\"text\"\n                  value={name}\n                  onChange={(e) => handleNameChange(e.target.value)}\n                  placeholder=\"my_slot_name\"\n                  className={[\n                    \"w-full\",\n                    \"px-3\",\n                    \"py-2\",\n                    \"text-sm\",\n                    \"bg-white\",\n                    \"border\",\n                    errors.name ? \"border-error-500\" : \"border-neutral-300\",\n                    \"rounded-md\",\n                    \"focus:outline-none\",\n                    \"focus:ring-2\",\n                    errors.name ? \"focus:ring-error-500\" : \"focus:ring-primary-500\",\n                  ].join(\" \")}\n                />\n                {errors.name && (\n                  <p className=\"mt-1 text-xs text-error-600 flex items-center gap-1\">\n                    <AlertIcon className=\"h-3 w-3\" />\n                    {errors.name}\n                  </p>\n                )}\n              </div>\n\n              {/* Description */}\n              <div>\n                <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                  Description\n                </label>\n                <textarea\n                  value={description}\n                  onChange={(e) => setDescription(e.target.value)}\n                  placeholder=\"Optional description of this slot's purpose\"\n                  rows={2}\n                  className={[\n                    \"w-full\",\n                    \"px-3\",\n                    \"py-2\",\n                    \"text-sm\",\n                    \"bg-white\",\n                    \"border\",\n                    \"border-neutral-300\",\n                    \"rounded-md\",\n                    \"focus:outline-none\",\n                    \"focus:ring-2\",\n                    \"focus:ring-primary-500\",\n                  ].join(\" \")}\n                />\n              </div>\n\n              {/* Position */}\n              <div>\n                <label className=\"block text-sm font-medium text-neutral-700 mb-2\">\n                  Position\n                </label>\n                <div className=\"grid grid-cols-3 gap-2\">\n                  {positionOptions.map((opt) => (\n                    <button\n                      key={opt.value}\n                      type=\"button\"\n                      onClick={() => setPosition(opt.value)}\n                      className={[\n                        \"px-3\",\n                        \"py-2\",\n                        \"text-sm\",\n                        \"rounded-md\",\n                        \"border\",\n                        \"transition-colors\",\n                        \"duration-150\",\n                        position === opt.value\n                          ? \"border-primary-500 bg-primary-50 text-primary-700\"\n                          : \"border-neutral-200 text-neutral-700 hover:border-neutral-300\",\n                      ].join(\" \")}\n                    >\n                      {opt.label}\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Priority */}\n              <div>\n                <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                  Priority\n                </label>\n                <input\n                  type=\"number\"\n                  value={priority}\n                  onChange={(e) => setPriority(parseInt(e.target.value, 10) || 0)}\n                  min={0}\n                  max={100}\n                  className={[\n                    \"w-24\",\n                    \"px-3\",\n                    \"py-2\",\n                    \"text-sm\",\n                    \"bg-white\",\n                    \"border\",\n                    \"border-neutral-300\",\n                    \"rounded-md\",\n                    \"focus:outline-none\",\n                    \"focus:ring-2\",\n                    \"focus:ring-primary-500\",\n                  ].join(\" \")}\n                />\n                <p className=\"mt-1 text-xs text-neutral-400\">\n                  Lower numbers = higher priority (rendered first)\n                </p>\n              </div>\n\n              {/* Flags */}\n              <div className=\"flex items-center gap-6\">\n                <label className=\"flex items-center gap-2 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={isRequired}\n                    onChange={(e) => setIsRequired(e.target.checked)}\n                    className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\n                  />\n                  <span className=\"text-sm text-neutral-700\">Required</span>\n                </label>\n\n                <label className=\"flex items-center gap-2 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={isMultiple}\n                    onChange={(e) => setIsMultiple(e.target.checked)}\n                    className=\"h-4 w-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\n                  />\n                  <span className=\"text-sm text-neutral-700\">Allow Multiple</span>\n                </label>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-t border-neutral-200 bg-neutral-50\">\n          {step === 0 ? (\n            <button\n              type=\"button\"\n              onClick={handleClose}\n              className={[\n                \"px-4\",\n                \"py-2\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-neutral-700\",\n                \"bg-white\",\n                \"border\",\n                \"border-neutral-300\",\n                \"rounded-md\",\n                \"hover:bg-neutral-50\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              Cancel\n            </button>\n          ) : (\n            <>\n              <button\n                type=\"button\"\n                onClick={handleBack}\n                className={[\n                  \"px-4\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"font-medium\",\n                  \"text-neutral-700\",\n                  \"bg-white\",\n                  \"border\",\n                  \"border-neutral-300\",\n                  \"rounded-md\",\n                  \"hover:bg-neutral-50\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                ].join(\" \")}\n              >\n                Back\n              </button>\n\n              <button\n                type=\"button\"\n                onClick={handleCreate}\n                disabled={!name.trim() || !!errors.name}\n                className={[\n                  \"inline-flex\",\n                  \"items-center\",\n                  \"gap-2\",\n                  \"px-4\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"font-medium\",\n                  \"text-white\",\n                  \"bg-primary-600\",\n                  \"rounded-md\",\n                  \"hover:bg-primary-700\",\n                  \"disabled:opacity-50\",\n                  \"disabled:cursor-not-allowed\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                ].join(\" \")}\n              >\n                <CheckIcon className=\"h-4 w-4\" />\n                Create Slot\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n\n  return createPortal(modalContent, document.body);\n};\n\nAddSlotModal.displayName = \"AddSlotModal\";\n\nexport default AddSlotModal;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\ComponentEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'prop.value ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":395,"column":26,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":395,"endColumn":42},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'prop.value ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":415,"column":27,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":415,"endColumn":43},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":710,"column":105,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":710,"endColumn":107,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22653,22655],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D064 - src/components/project/ComponentEditor.tsx\n * ==================================================\n * Component for editing frontend components in a project.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D011 (Input.tsx), D012 (Select.tsx), D014 (Panel.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Component property definition.\n */\nexport interface ComponentProperty {\n  name: string;\n  type: \"string\" | \"number\" | \"boolean\" | \"color\" | \"select\" | \"object\" | \"array\";\n  value: unknown;\n  defaultValue?: unknown;\n  description?: string;\n  required?: boolean;\n  options?: { value: string; label: string }[];\n  min?: number;\n  max?: number;\n}\n\n/**\n * Component event definition.\n */\nexport interface ComponentEvent {\n  name: string;\n  description?: string;\n  params?: { name: string; type: string }[];\n}\n\n/**\n * Component style definition.\n */\nexport interface ComponentStyle {\n  property: string;\n  value: string;\n  isCustom?: boolean;\n}\n\n/**\n * Editable component structure.\n */\nexport interface EditableComponent {\n  id: string;\n  name: string;\n  displayName: string;\n  type: string;\n  category: \"ui\" | \"layout\" | \"form\" | \"data\" | \"media\" | \"custom\";\n  properties: ComponentProperty[];\n  events: ComponentEvent[];\n  styles: ComponentStyle[];\n  children?: string[];\n  parentId?: string;\n  isLocked?: boolean;\n  isVisible?: boolean;\n}\n\n/**\n * ComponentEditor component props.\n */\nexport interface ComponentEditorProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n  /** Component being edited */\n  component: EditableComponent;\n  /** Callback when property changes */\n  onPropertyChange?: (propertyName: string, value: unknown) => void;\n  /** Callback when style changes */\n  onStyleChange?: (styleProp: string, value: string) => void;\n  /** Callback when event handler changes */\n  onEventChange?: (eventName: string, handler: string) => void;\n  /** Callback when component is deleted */\n  onDelete?: () => void;\n  /** Callback when component is duplicated */\n  onDuplicate?: () => void;\n  /** Callback when component visibility is toggled */\n  onToggleVisibility?: () => void;\n  /** Callback when component lock is toggled */\n  onToggleLock?: () => void;\n  /** Whether component is read-only */\n  readOnly?: boolean;\n}\n\n/**\n * Category icons.\n */\nconst CategoryIcons: Record<EditableComponent[\"category\"], React.FC<{ className?: string }>> = {\n  ui: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n    </svg>\n  ),\n  layout: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\n      <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\" />\n    </svg>\n  ),\n  form: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <line x1=\"7\" y1=\"8\" x2=\"17\" y2=\"8\" />\n      <line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"12\" />\n      <line x1=\"7\" y1=\"16\" x2=\"13\" y2=\"16\" />\n    </svg>\n  ),\n  data: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <ellipse cx=\"12\" cy=\"5\" rx=\"9\" ry=\"3\" />\n      <path d=\"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3\" />\n      <path d=\"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5\" />\n    </svg>\n  ),\n  media: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" />\n      <polyline points=\"21 15 16 10 5 21\" />\n    </svg>\n  ),\n  custom: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"12 2 2 7 12 12 22 7 12 2\" />\n      <polyline points=\"2 17 12 22 22 17\" />\n      <polyline points=\"2 12 12 17 22 12\" />\n    </svg>\n  ),\n};\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Copy icon.\n */\nconst CopyIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\" />\n    <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\" />\n  </svg>\n);\n\n/**\n * Eye icon.\n */\nconst EyeIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\n    <circle cx=\"12\" cy=\"12\" r=\"3\" />\n  </svg>\n);\n\n/**\n * Eye off icon.\n */\nconst EyeOffIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24\" />\n    <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\" />\n  </svg>\n);\n\n/**\n * Lock icon.\n */\nconst LockIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\n    <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" />\n  </svg>\n);\n\n/**\n * Unlock icon.\n */\nconst UnlockIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\n    <path d=\"M7 11V7a5 5 0 0 1 9.9-1\" />\n  </svg>\n);\n\n/**\n * Chevron down icon.\n */\nconst ChevronDownIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"6 9 12 15 18 9\" />\n  </svg>\n);\n\n/**\n * Category colors.\n */\nconst categoryColors: Record<EditableComponent[\"category\"], string> = {\n  ui: \"bg-primary-100 text-primary-700\",\n  layout: \"bg-success-50 text-success-700\",\n  form: \"bg-warning-50 text-warning-700\",\n  data: \"bg-info-50 text-info-700\",\n  media: \"bg-purple-50 text-purple-700\",\n  custom: \"bg-neutral-100 text-neutral-700\",\n};\n\n/**\n * ComponentEditor component.\n *\n * Provides an interface for editing component properties, styles, and events.\n *\n * @example\n * ```tsx\n * <ComponentEditor\n *   component={selectedComponent}\n *   onPropertyChange={(name, value) => updateProperty(name, value)}\n *   onStyleChange={(prop, value) => updateStyle(prop, value)}\n *   onDelete={() => deleteComponent()}\n * />\n * ```\n */\nexport const ComponentEditor: React.FC<ComponentEditorProps> = ({\n  component,\n  onPropertyChange,\n  onStyleChange,\n  onEventChange,\n  onDelete,\n  onDuplicate,\n  onToggleVisibility,\n  onToggleLock,\n  readOnly = false,\n  className = \"\",\n  ...props\n}) => {\n  // Active tab\n  const [activeTab, setActiveTab] = useState<\"properties\" | \"styles\" | \"events\">(\"properties\");\n\n  // Collapsed sections\n  const [collapsedSections, setCollapsedSections] = useState<Set<string>>(new Set());\n\n  // Toggle section\n  const toggleSection = useCallback((section: string) => {\n    setCollapsedSections((prev) => {\n      const next = new Set(prev);\n      if (next.has(section)) {\n        next.delete(section);\n      } else {\n        next.add(section);\n      }\n      return next;\n    });\n  }, []);\n\n  // Group properties by category\n  const groupedProperties = useMemo(() => {\n    const groups: Record<string, ComponentProperty[]> = {\n      required: [],\n      optional: [],\n    };\n    component.properties.forEach((prop) => {\n      if (prop.required) {\n        groups.required.push(prop);\n      } else {\n        groups.optional.push(prop);\n      }\n    });\n    return groups;\n  }, [component.properties]);\n\n  // Get category icon\n  const CategoryIcon = CategoryIcons[component.category];\n\n  // Render property input\n  const renderPropertyInput = (prop: ComponentProperty) => {\n    const baseInputStyles = [\n      \"w-full\",\n      \"px-3\",\n      \"py-1.5\",\n      \"text-sm\",\n      \"bg-white\",\n      \"border\",\n      \"border-neutral-300\",\n      \"rounded-md\",\n      \"focus:outline-none\",\n      \"focus:ring-2\",\n      \"focus:ring-primary-500\",\n      \"disabled:bg-neutral-50\",\n      \"disabled:cursor-not-allowed\",\n    ].join(\" \");\n\n    switch (prop.type) {\n      case \"boolean\":\n        return (\n          <label className=\"flex items-center gap-2 cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={Boolean(prop.value)}\n              onChange={(e) => onPropertyChange?.(prop.name, e.target.checked)}\n              disabled={readOnly || component.isLocked}\n              className={[\n                \"h-4\",\n                \"w-4\",\n                \"rounded\",\n                \"border-neutral-300\",\n                \"text-primary-600\",\n                \"focus:ring-primary-500\",\n              ].join(\" \")}\n            />\n            <span className=\"text-sm text-neutral-600\">\n              {prop.value ? \"Enabled\" : \"Disabled\"}\n            </span>\n          </label>\n        );\n\n      case \"number\":\n        return (\n          <input\n            type=\"number\"\n            value={Number(prop.value) || 0}\n            onChange={(e) => onPropertyChange?.(prop.name, parseFloat(e.target.value))}\n            min={prop.min}\n            max={prop.max}\n            disabled={readOnly || component.isLocked}\n            className={baseInputStyles}\n          />\n        );\n\n      case \"color\":\n        return (\n          <div className=\"flex items-center gap-2\">\n            <input\n              type=\"color\"\n              value={String(prop.value) || \"#000000\"}\n              onChange={(e) => onPropertyChange?.(prop.name, e.target.value)}\n              disabled={readOnly || component.isLocked}\n              className={[\n                \"h-8\",\n                \"w-8\",\n                \"rounded\",\n                \"border\",\n                \"border-neutral-300\",\n                \"cursor-pointer\",\n                \"disabled:cursor-not-allowed\",\n              ].join(\" \")}\n            />\n            <input\n              type=\"text\"\n              value={String(prop.value) || \"\"}\n              onChange={(e) => onPropertyChange?.(prop.name, e.target.value)}\n              disabled={readOnly || component.isLocked}\n              className={[baseInputStyles, \"flex-1\"].join(\" \")}\n              placeholder=\"#000000\"\n            />\n          </div>\n        );\n\n      case \"select\":\n        return (\n          <select\n            value={String(prop.value) || \"\"}\n            onChange={(e) => onPropertyChange?.(prop.name, e.target.value)}\n            disabled={readOnly || component.isLocked}\n            className={baseInputStyles}\n          >\n            <option value=\"\">Select...</option>\n            {prop.options?.map((opt) => (\n              <option key={opt.value} value={opt.value}>\n                {opt.label}\n              </option>\n            ))}\n          </select>\n        );\n\n      case \"object\":\n      case \"array\":\n        return (\n          <textarea\n            value={\n              typeof prop.value === \"object\"\n                ? JSON.stringify(prop.value, null, 2)\n                : String(prop.value ?? \"\")\n            }\n            onChange={(e) => {\n              try {\n                onPropertyChange?.(prop.name, JSON.parse(e.target.value));\n              } catch {\n                // Keep as string if invalid JSON\n              }\n            }}\n            disabled={readOnly || component.isLocked}\n            rows={3}\n            className={[baseInputStyles, \"font-mono text-xs\"].join(\" \")}\n            placeholder={prop.type === \"object\" ? \"{}\" : \"[]\"}\n          />\n        );\n\n      default:\n        return (\n          <input\n            type=\"text\"\n            value={String(prop.value ?? \"\")}\n            onChange={(e) => onPropertyChange?.(prop.name, e.target.value)}\n            disabled={readOnly || component.isLocked}\n            className={baseInputStyles}\n            placeholder={prop.description}\n          />\n        );\n    }\n  };\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"h-full\",\n    \"bg-white\",\n    \"overflow-hidden\",\n    className,\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Header */}\n      <div className=\"p-4 border-b border-neutral-200 bg-neutral-50\">\n        <div className=\"flex items-center gap-3\">\n          <div\n            className={[\n              \"flex\",\n              \"items-center\",\n              \"justify-center\",\n              \"h-10\",\n              \"w-10\",\n              \"rounded-lg\",\n              categoryColors[component.category],\n            ].join(\" \")}\n          >\n            <CategoryIcon className=\"h-5 w-5\" />\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-sm font-semibold text-neutral-900 truncate\">\n              {component.displayName}\n            </h3>\n            <p className=\"text-xs text-neutral-500\">\n              {component.type} ÔÇó {component.category}\n            </p>\n          </div>\n        </div>\n\n        {/* Action buttons */}\n        <div className=\"mt-3 flex items-center gap-1\">\n          <button\n            type=\"button\"\n            onClick={onToggleVisibility}\n            disabled={readOnly}\n            className={[\n              \"p-1.5\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              component.isVisible === false\n                ? \"bg-warning-50 text-warning-600\"\n                : \"hover:bg-neutral-100 hover:text-neutral-600\",\n              \"transition-colors\",\n              \"duration-150\",\n              \"disabled:opacity-50\",\n            ].join(\" \")}\n            title={component.isVisible === false ? \"Show\" : \"Hide\"}\n          >\n            {component.isVisible === false ? (\n              <EyeOffIcon className=\"h-4 w-4\" />\n            ) : (\n              <EyeIcon className=\"h-4 w-4\" />\n            )}\n          </button>\n\n          <button\n            type=\"button\"\n            onClick={onToggleLock}\n            disabled={readOnly}\n            className={[\n              \"p-1.5\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              component.isLocked\n                ? \"bg-error-50 text-error-600\"\n                : \"hover:bg-neutral-100 hover:text-neutral-600\",\n              \"transition-colors\",\n              \"duration-150\",\n              \"disabled:opacity-50\",\n            ].join(\" \")}\n            title={component.isLocked ? \"Unlock\" : \"Lock\"}\n          >\n            {component.isLocked ? (\n              <LockIcon className=\"h-4 w-4\" />\n            ) : (\n              <UnlockIcon className=\"h-4 w-4\" />\n            )}\n          </button>\n\n          <div className=\"flex-1\" />\n\n          <button\n            type=\"button\"\n            onClick={onDuplicate}\n            disabled={readOnly}\n            className={[\n              \"p-1.5\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              \"hover:bg-neutral-100\",\n              \"hover:text-neutral-600\",\n              \"transition-colors\",\n              \"duration-150\",\n              \"disabled:opacity-50\",\n            ].join(\" \")}\n            title=\"Duplicate\"\n          >\n            <CopyIcon className=\"h-4 w-4\" />\n          </button>\n\n          <button\n            type=\"button\"\n            onClick={onDelete}\n            disabled={readOnly || component.isLocked}\n            className={[\n              \"p-1.5\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              \"hover:bg-error-50\",\n              \"hover:text-error-600\",\n              \"transition-colors\",\n              \"duration-150\",\n              \"disabled:opacity-50\",\n            ].join(\" \")}\n            title=\"Delete\"\n          >\n            <TrashIcon className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex border-b border-neutral-200\">\n        {([\"properties\", \"styles\", \"events\"] as const).map((tab) => (\n          <button\n            key={tab}\n            type=\"button\"\n            onClick={() => setActiveTab(tab)}\n            className={[\n              \"flex-1\",\n              \"px-4\",\n              \"py-2\",\n              \"text-sm\",\n              \"font-medium\",\n              \"border-b-2\",\n              \"transition-colors\",\n              \"duration-150\",\n              activeTab === tab\n                ? \"border-primary-600 text-primary-600\"\n                : \"border-transparent text-neutral-500 hover:text-neutral-700\",\n            ].join(\" \")}\n          >\n            {tab.charAt(0).toUpperCase() + tab.slice(1)}\n          </button>\n        ))}\n      </div>\n\n      {/* Content */}\n      <div className=\"flex-1 overflow-y-auto\">\n        {activeTab === \"properties\" && (\n          <div className=\"p-4 space-y-4\">\n            {Object.entries(groupedProperties).map(\n              ([group, props]) =>\n                props.length > 0 && (\n                  <div key={group}>\n                    <button\n                      type=\"button\"\n                      onClick={() => toggleSection(`props-${group}`)}\n                      className={[\n                        \"flex\",\n                        \"items-center\",\n                        \"justify-between\",\n                        \"w-full\",\n                        \"py-2\",\n                        \"text-xs\",\n                        \"font-semibold\",\n                        \"text-neutral-500\",\n                        \"uppercase\",\n                        \"tracking-wider\",\n                      ].join(\" \")}\n                    >\n                      {group} ({props.length})\n                      <ChevronDownIcon\n                        className={[\n                          \"h-4\",\n                          \"w-4\",\n                          \"transition-transform\",\n                          \"duration-200\",\n                          collapsedSections.has(`props-${group}`) ? \"\" : \"rotate-180\",\n                        ].join(\" \")}\n                      />\n                    </button>\n\n                    {!collapsedSections.has(`props-${group}`) && (\n                      <div className=\"space-y-3\">\n                        {props.map((prop) => (\n                          <div key={prop.name}>\n                            <label className=\"flex items-center gap-1 text-sm font-medium text-neutral-700 mb-1\">\n                              {prop.name}\n                              {prop.required && (\n                                <span className=\"text-error-500\">*</span>\n                              )}\n                            </label>\n                            {renderPropertyInput(prop)}\n                            {prop.description && (\n                              <p className=\"mt-1 text-xs text-neutral-400\">\n                                {prop.description}\n                              </p>\n                            )}\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                )\n            )}\n\n            {component.properties.length === 0 && (\n              <p className=\"text-sm text-neutral-500 italic text-center py-4\">\n                No properties defined\n              </p>\n            )}\n          </div>\n        )}\n\n        {activeTab === \"styles\" && (\n          <div className=\"p-4 space-y-3\">\n            {component.styles.map((style) => (\n              <div key={style.property}>\n                <label className=\"flex items-center gap-1 text-sm font-medium text-neutral-700 mb-1\">\n                  {style.property}\n                  {style.isCustom && (\n                    <span className=\"px-1 py-0.5 text-xs bg-neutral-100 text-neutral-500 rounded\">\n                      custom\n                    </span>\n                  )}\n                </label>\n                <input\n                  type=\"text\"\n                  value={style.value}\n                  onChange={(e) => onStyleChange?.(style.property, e.target.value)}\n                  disabled={readOnly || component.isLocked}\n                  className={[\n                    \"w-full\",\n                    \"px-3\",\n                    \"py-1.5\",\n                    \"text-sm\",\n                    \"font-mono\",\n                    \"bg-white\",\n                    \"border\",\n                    \"border-neutral-300\",\n                    \"rounded-md\",\n                    \"focus:outline-none\",\n                    \"focus:ring-2\",\n                    \"focus:ring-primary-500\",\n                    \"disabled:bg-neutral-50\",\n                    \"disabled:cursor-not-allowed\",\n                  ].join(\" \")}\n                />\n              </div>\n            ))}\n\n            {component.styles.length === 0 && (\n              <p className=\"text-sm text-neutral-500 italic text-center py-4\">\n                No styles defined\n              </p>\n            )}\n          </div>\n        )}\n\n        {activeTab === \"events\" && (\n          <div className=\"p-4 space-y-3\">\n            {component.events.map((event) => (\n              <div key={event.name}>\n                <label className=\"flex items-center gap-2 text-sm font-medium text-neutral-700 mb-1\">\n                  <span className=\"text-primary-600\">@</span>\n                  {event.name}\n                </label>\n                {event.description && (\n                  <p className=\"text-xs text-neutral-500 mb-1\">\n                    {event.description}\n                  </p>\n                )}\n                <textarea\n                  placeholder={`// Handle ${event.name}\\n(${event.params?.map((p) => p.name).join(\", \") || \"\"}) => {\\n  \\n}`}\n                  onChange={(e) => onEventChange?.(event.name, e.target.value)}\n                  disabled={readOnly || component.isLocked}\n                  rows={3}\n                  className={[\n                    \"w-full\",\n                    \"px-3\",\n                    \"py-1.5\",\n                    \"text-sm\",\n                    \"font-mono\",\n                    \"bg-white\",\n                    \"border\",\n                    \"border-neutral-300\",\n                    \"rounded-md\",\n                    \"focus:outline-none\",\n                    \"focus:ring-2\",\n                    \"focus:ring-primary-500\",\n                    \"disabled:bg-neutral-50\",\n                    \"disabled:cursor-not-allowed\",\n                  ].join(\" \")}\n                />\n              </div>\n            ))}\n\n            {component.events.length === 0 && (\n              <p className=\"text-sm text-neutral-500 italic text-center py-4\">\n                No events defined\n              </p>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nComponentEditor.displayName = \"ComponentEditor\";\n\nexport default ComponentEditor;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\PluginSlotManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":303,"column":11,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":303,"endColumn":33},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":336,"column":18,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":336,"endColumn":41},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":851,"column":16,"nodeType":"MemberExpression","messageId":"invalidType","endLine":851,"endColumn":28},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":852,"column":16,"nodeType":"MemberExpression","messageId":"invalidType","endLine":852,"endColumn":36},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":852,"column":43,"nodeType":"MemberExpression","messageId":"invalidType","endLine":852,"endColumn":55}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D066 - src/components/project/PluginSlotManager.tsx\n * ====================================================\n * Component for managing plugin slots within a project.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D014 (Panel.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Plugin slot configuration.\n */\nexport interface PluginSlot {\n  id: string;\n  name: string;\n  contract: string;\n  description?: string;\n  assignedPluginId?: string;\n  assignedPluginName?: string;\n  assignedPluginVersion?: string;\n  isRequired: boolean;\n  isMultiple: boolean;\n  fallbackPluginId?: string;\n  position: \"header\" | \"sidebar\" | \"main\" | \"footer\" | \"overlay\" | \"custom\";\n  priority: number;\n  status: \"empty\" | \"assigned\" | \"error\" | \"disabled\";\n  lastAssigned?: Date;\n}\n\n/**\n * Available plugin for assignment.\n */\nexport interface AvailablePlugin {\n  id: string;\n  name: string;\n  displayName: string;\n  contract: string;\n  version: string;\n  status: \"loaded\" | \"unloaded\" | \"error\";\n  isCompatible: boolean;\n  incompatibilityReason?: string;\n}\n\n/**\n * PluginSlotManager component props.\n */\nexport interface PluginSlotManagerProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\"> {\n  /** Available slots */\n  slots: PluginSlot[];\n  /** Available plugins for assignment */\n  availablePlugins: AvailablePlugin[];\n  /** Currently selected slot ID */\n  selectedSlotId?: string;\n  /** Callback when slot is selected */\n  onSelectSlot?: (slot: PluginSlot) => void;\n  /** Callback when plugin is assigned to slot */\n  onAssignPlugin?: (slotId: string, pluginId: string) => void;\n  /** Callback when plugin is unassigned from slot */\n  onUnassignPlugin?: (slotId: string) => void;\n  /** Callback when slot is added */\n  onAddSlot?: () => void;\n  /** Callback when slot is removed */\n  onRemoveSlot?: (slotId: string) => void;\n  /** Callback when swap plugin is requested */\n  onSwapPlugin?: (slotId: string) => void;\n  /** Callback when slot priority is changed */\n  onChangePriority?: (slotId: string, direction: \"up\" | \"down\") => void;\n  /** Whether manager is read-only */\n  readOnly?: boolean;\n  /** Filter by contract type */\n  contractFilter?: string;\n  /** Filter by position */\n  positionFilter?: string;\n}\n\n/**\n * Contract icons.\n */\nconst ContractIcons: Record<string, React.FC<{ className?: string }>> = {\n  tts: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\" />\n      <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\n      <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n      <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n    </svg>\n  ),\n  stt: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n      <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07\" />\n    </svg>\n  ),\n  llm: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n    </svg>\n  ),\n  mcp: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\" ry=\"2\" />\n      <rect x=\"9\" y=\"9\" width=\"6\" height=\"6\" />\n      <line x1=\"9\" y1=\"1\" x2=\"9\" y2=\"4\" />\n      <line x1=\"15\" y1=\"1\" x2=\"15\" y2=\"4\" />\n      <line x1=\"9\" y1=\"20\" x2=\"9\" y2=\"23\" />\n      <line x1=\"15\" y1=\"20\" x2=\"15\" y2=\"23\" />\n      <line x1=\"20\" y1=\"9\" x2=\"23\" y2=\"9\" />\n      <line x1=\"20\" y1=\"14\" x2=\"23\" y2=\"14\" />\n      <line x1=\"1\" y1=\"9\" x2=\"4\" y2=\"9\" />\n      <line x1=\"1\" y1=\"14\" x2=\"4\" y2=\"14\" />\n    </svg>\n  ),\n  default: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"12 2 2 7 12 12 22 7 12 2\" />\n      <polyline points=\"2 17 12 22 22 17\" />\n      <polyline points=\"2 12 12 17 22 12\" />\n    </svg>\n  ),\n};\n\n/**\n * Plus icon.\n */\nconst PlusIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Swap icon.\n */\nconst SwapIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"17 1 21 5 17 9\" />\n    <path d=\"M3 11V9a4 4 0 0 1 4-4h14\" />\n    <polyline points=\"7 23 3 19 7 15\" />\n    <path d=\"M21 13v2a4 4 0 0 1-4 4H3\" />\n  </svg>\n);\n\n/**\n * Chevron up icon.\n */\nconst ChevronUpIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"18 15 12 9 6 15\" />\n  </svg>\n);\n\n/**\n * Chevron down icon.\n */\nconst ChevronDownIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"6 9 12 15 18 9\" />\n  </svg>\n);\n\n/**\n * Link icon.\n */\nconst LinkIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\" />\n    <path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\" />\n  </svg>\n);\n\n/**\n * Unlink icon.\n */\nconst UnlinkIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M18.84 12.25l1.72-1.71a5 5 0 0 0-7.07-7.07l-1.72 1.71\" />\n    <path d=\"M5.16 11.75l-1.72 1.71a5 5 0 0 0 7.07 7.07l1.72-1.71\" />\n    <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\" />\n  </svg>\n);\n\n/**\n * Contract colors.\n */\nconst contractColors: Record<string, string> = {\n  tts: \"bg-primary-100 text-primary-700 border-primary-200\",\n  stt: \"bg-success-50 text-success-700 border-success-200\",\n  llm: \"bg-warning-50 text-warning-700 border-warning-200\",\n  mcp: \"bg-info-50 text-info-700 border-info-200\",\n  default: \"bg-neutral-100 text-neutral-700 border-neutral-200\",\n};\n\n/**\n * Status colors.\n */\nconst statusColors: Record<PluginSlot[\"status\"], string> = {\n  empty: \"border-neutral-300 bg-neutral-50\",\n  assigned: \"border-success-300 bg-success-50\",\n  error: \"border-error-300 bg-error-50\",\n  disabled: \"border-neutral-200 bg-neutral-100 opacity-60\",\n};\n\n/**\n * Status labels.\n */\nconst statusLabels: Record<PluginSlot[\"status\"], string> = {\n  empty: \"Empty\",\n  assigned: \"Assigned\",\n  error: \"Error\",\n  disabled: \"Disabled\",\n};\n\n/**\n * Position labels.\n */\nconst positionLabels: Record<PluginSlot[\"position\"], string> = {\n  header: \"Header\",\n  sidebar: \"Sidebar\",\n  main: \"Main\",\n  footer: \"Footer\",\n  overlay: \"Overlay\",\n  custom: \"Custom\",\n};\n\n/**\n * PluginSlotManager component.\n *\n * Manages plugin slots allowing assignment, swapping, and configuration\n * of plugins within the project.\n *\n * @example\n * ```tsx\n * <PluginSlotManager\n *   slots={projectSlots}\n *   availablePlugins={loadedPlugins}\n *   selectedSlotId={selectedSlot}\n *   onSelectSlot={(slot) => setSelectedSlot(slot.id)}\n *   onAssignPlugin={(slotId, pluginId) => assignPlugin(slotId, pluginId)}\n *   onSwapPlugin={(slotId) => showSwapModal(slotId)}\n * />\n * ```\n */\nexport const PluginSlotManager: React.FC<PluginSlotManagerProps> = ({\n  slots,\n  availablePlugins,\n  selectedSlotId,\n  onSelectSlot,\n  onAssignPlugin,\n  onUnassignPlugin,\n  onAddSlot,\n  onRemoveSlot,\n  onSwapPlugin,\n  onChangePriority,\n  readOnly = false,\n  contractFilter,\n  positionFilter,\n  className = \"\",\n  ...props\n}) => {\n  // View mode\n  const [viewMode, setViewMode] = useState<\"list\" | \"grid\">(\"list\");\n\n  // Expanded slot details\n  const [expandedSlotId, setExpandedSlotId] = useState<string | null>(null);\n\n  // Filter slots\n  const filteredSlots = useMemo(() => {\n    return slots.filter((slot) => {\n      if (contractFilter && slot.contract !== contractFilter) return false;\n      if (positionFilter && slot.position !== positionFilter) return false;\n      return true;\n    });\n  }, [slots, contractFilter, positionFilter]);\n\n  // Sort by priority\n  const sortedSlots = useMemo(() => {\n    return [...filteredSlots].sort((a, b) => a.priority - b.priority);\n  }, [filteredSlots]);\n\n  // Group by position\n  const _groupedSlots = useMemo(() => {\n    const groups: Record<string, PluginSlot[]> = {};\n    sortedSlots.forEach((slot) => {\n      if (!groups[slot.position]) {\n        groups[slot.position] = [];\n      }\n      groups[slot.position].push(slot);\n    });\n    return groups;\n  }, [sortedSlots]);\n\n  // Get compatible plugins for a slot\n  const getCompatiblePlugins = useCallback(\n    (slot: PluginSlot) => {\n      return availablePlugins.filter(\n        (plugin) => plugin.contract === slot.contract && plugin.isCompatible\n      );\n    },\n    [availablePlugins]\n  );\n\n  // Handle slot click\n  const handleSlotClick = useCallback(\n    (slot: PluginSlot) => {\n      onSelectSlot?.(slot);\n    },\n    [onSelectSlot]\n  );\n\n  // Toggle slot expansion\n  const toggleSlotExpansion = useCallback((slotId: string) => {\n    setExpandedSlotId((prev) => (prev === slotId ? null : slotId));\n  }, []);\n\n  // Get contract icon\n  const getContractIcon = (contract: string) => {\n    const Icon = ContractIcons[contract] || ContractIcons.default;\n    return Icon;\n  };\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"h-full\",\n    \"bg-white\",\n    \"rounded-lg\",\n    \"border\",\n    \"border-neutral-200\",\n    \"overflow-hidden\",\n    className,\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Header */}\n      <div className=\"p-4 border-b border-neutral-200 bg-neutral-50\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"text-sm font-semibold text-neutral-900\">\n            Plugin Slots\n          </h3>\n          <div className=\"flex items-center gap-2\">\n            {/* View toggle */}\n            <div className=\"flex rounded-md border border-neutral-300 overflow-hidden\">\n              <button\n                type=\"button\"\n                onClick={() => setViewMode(\"list\")}\n                className={[\n                  \"px-2\",\n                  \"py-1\",\n                  viewMode === \"list\"\n                    ? \"bg-neutral-200 text-neutral-900\"\n                    : \"bg-white text-neutral-500 hover:bg-neutral-50\",\n                ].join(\" \")}\n              >\n                <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                  <line x1=\"8\" y1=\"6\" x2=\"21\" y2=\"6\" />\n                  <line x1=\"8\" y1=\"12\" x2=\"21\" y2=\"12\" />\n                  <line x1=\"8\" y1=\"18\" x2=\"21\" y2=\"18\" />\n                  <line x1=\"3\" y1=\"6\" x2=\"3.01\" y2=\"6\" />\n                  <line x1=\"3\" y1=\"12\" x2=\"3.01\" y2=\"12\" />\n                  <line x1=\"3\" y1=\"18\" x2=\"3.01\" y2=\"18\" />\n                </svg>\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setViewMode(\"grid\")}\n                className={[\n                  \"px-2\",\n                  \"py-1\",\n                  viewMode === \"grid\"\n                    ? \"bg-neutral-200 text-neutral-900\"\n                    : \"bg-white text-neutral-500 hover:bg-neutral-50\",\n                ].join(\" \")}\n              >\n                <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                  <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\n                  <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\n                  <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\n                  <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\n                </svg>\n              </button>\n            </div>\n\n            {/* Add slot button */}\n            <button\n              type=\"button\"\n              onClick={onAddSlot}\n              disabled={readOnly}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"gap-1\",\n                \"px-3\",\n                \"py-1.5\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-white\",\n                \"bg-primary-600\",\n                \"rounded-md\",\n                \"hover:bg-primary-700\",\n                \"disabled:opacity-50\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n              Add Slot\n            </button>\n          </div>\n        </div>\n\n        {/* Stats */}\n        <div className=\"flex gap-4 text-xs text-neutral-500\">\n          <span>{slots.length} total slots</span>\n          <span>{slots.filter((s) => s.status === \"assigned\").length} assigned</span>\n          <span>{slots.filter((s) => s.status === \"empty\").length} empty</span>\n        </div>\n      </div>\n\n      {/* Slot list */}\n      <div className=\"flex-1 overflow-y-auto\">\n        {sortedSlots.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center p-12 text-center\">\n            <LinkIcon className=\"h-12 w-12 text-neutral-300 mb-4\" />\n            <p className=\"text-sm text-neutral-500 mb-4\">\n              No plugin slots defined. Add a slot to connect plugins.\n            </p>\n            {!readOnly && (\n              <button\n                type=\"button\"\n                onClick={onAddSlot}\n                className={[\n                  \"inline-flex\",\n                  \"items-center\",\n                  \"gap-1\",\n                  \"px-4\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"font-medium\",\n                  \"text-white\",\n                  \"bg-primary-600\",\n                  \"rounded-md\",\n                  \"hover:bg-primary-700\",\n                ].join(\" \")}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n                Add First Slot\n              </button>\n            )}\n          </div>\n        ) : viewMode === \"list\" ? (\n          <ul className=\"divide-y divide-neutral-100\">\n            {sortedSlots.map((slot, index) => {\n              const ContractIcon = getContractIcon(slot.contract);\n              const isExpanded = expandedSlotId === slot.id;\n              const compatiblePlugins = getCompatiblePlugins(slot);\n\n              return (\n                <li key={slot.id}>\n                  <div\n                    role=\"button\"\n                    tabIndex={0}\n                    onClick={() => handleSlotClick(slot)}\n                    onKeyDown={(e) => e.key === \"Enter\" && handleSlotClick(slot)}\n                    className={[\n                      \"p-4\",\n                      \"cursor-pointer\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      selectedSlotId === slot.id\n                        ? \"bg-primary-50\"\n                        : \"hover:bg-neutral-50\",\n                    ].join(\" \")}\n                  >\n                    <div className=\"flex items-start gap-3\">\n                      {/* Contract icon */}\n                      <div\n                        className={[\n                          \"flex\",\n                          \"items-center\",\n                          \"justify-center\",\n                          \"h-10\",\n                          \"w-10\",\n                          \"rounded-lg\",\n                          \"border\",\n                          contractColors[slot.contract] || contractColors.default,\n                        ].join(\" \")}\n                      >\n                        <ContractIcon className=\"h-5 w-5\" />\n                      </div>\n\n                      {/* Slot info */}\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center gap-2\">\n                          <h4 className=\"text-sm font-medium text-neutral-900 truncate\">\n                            {slot.name}\n                          </h4>\n                          {slot.isRequired && (\n                            <span className=\"px-1.5 py-0.5 text-xs font-medium bg-error-50 text-error-700 rounded\">\n                              Required\n                            </span>\n                          )}\n                          {slot.isMultiple && (\n                            <span className=\"px-1.5 py-0.5 text-xs font-medium bg-info-50 text-info-700 rounded\">\n                              Multiple\n                            </span>\n                          )}\n                        </div>\n\n                        {slot.description && (\n                          <p className=\"mt-0.5 text-xs text-neutral-500 truncate\">\n                            {slot.description}\n                          </p>\n                        )}\n\n                        <div className=\"mt-2 flex items-center gap-3 text-xs text-neutral-400\">\n                          <span className=\"uppercase font-medium\">\n                            {slot.contract}\n                          </span>\n                          <span>{positionLabels[slot.position]}</span>\n                          <span>Priority: {slot.priority}</span>\n                        </div>\n\n                        {/* Assigned plugin */}\n                        {slot.assignedPluginId && (\n                          <div className=\"mt-2 flex items-center gap-2\">\n                            <LinkIcon className=\"h-3.5 w-3.5 text-success-500\" />\n                            <span className=\"text-sm text-neutral-700\">\n                              {slot.assignedPluginName}\n                            </span>\n                            <span className=\"text-xs text-neutral-400\">\n                              v{slot.assignedPluginVersion}\n                            </span>\n                          </div>\n                        )}\n                      </div>\n\n                      {/* Status badge */}\n                      <div className=\"flex flex-col items-end gap-2\">\n                        <span\n                          className={[\n                            \"px-2\",\n                            \"py-1\",\n                            \"text-xs\",\n                            \"font-medium\",\n                            \"rounded-full\",\n                            \"border\",\n                            statusColors[slot.status],\n                          ].join(\" \")}\n                        >\n                          {statusLabels[slot.status]}\n                        </span>\n\n                        {/* Actions */}\n                        <div className=\"flex items-center gap-1\">\n                          {slot.assignedPluginId ? (\n                            <>\n                              <button\n                                type=\"button\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  onSwapPlugin?.(slot.id);\n                                }}\n                                disabled={readOnly}\n                                className={[\n                                  \"p-1\",\n                                  \"rounded\",\n                                  \"text-neutral-400\",\n                                  \"hover:text-primary-600\",\n                                  \"hover:bg-primary-50\",\n                                  \"disabled:opacity-50\",\n                                ].join(\" \")}\n                                title=\"Swap plugin\"\n                              >\n                                <SwapIcon className=\"h-4 w-4\" />\n                              </button>\n                              <button\n                                type=\"button\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  onUnassignPlugin?.(slot.id);\n                                }}\n                                disabled={readOnly}\n                                className={[\n                                  \"p-1\",\n                                  \"rounded\",\n                                  \"text-neutral-400\",\n                                  \"hover:text-error-600\",\n                                  \"hover:bg-error-50\",\n                                  \"disabled:opacity-50\",\n                                ].join(\" \")}\n                                title=\"Unassign plugin\"\n                              >\n                                <UnlinkIcon className=\"h-4 w-4\" />\n                              </button>\n                            </>\n                          ) : (\n                            <button\n                              type=\"button\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                toggleSlotExpansion(slot.id);\n                              }}\n                              disabled={readOnly || compatiblePlugins.length === 0}\n                              className={[\n                                \"p-1\",\n                                \"rounded\",\n                                \"text-neutral-400\",\n                                \"hover:text-success-600\",\n                                \"hover:bg-success-50\",\n                                \"disabled:opacity-50\",\n                              ].join(\" \")}\n                              title=\"Assign plugin\"\n                            >\n                              <LinkIcon className=\"h-4 w-4\" />\n                            </button>\n                          )}\n\n                          {/* Priority buttons */}\n                          <button\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              onChangePriority?.(slot.id, \"up\");\n                            }}\n                            disabled={readOnly || index === 0}\n                            className={[\n                              \"p-1\",\n                              \"rounded\",\n                              \"text-neutral-400\",\n                              \"hover:text-neutral-600\",\n                              \"hover:bg-neutral-100\",\n                              \"disabled:opacity-50\",\n                            ].join(\" \")}\n                            title=\"Move up\"\n                          >\n                            <ChevronUpIcon className=\"h-4 w-4\" />\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              onChangePriority?.(slot.id, \"down\");\n                            }}\n                            disabled={readOnly || index === sortedSlots.length - 1}\n                            className={[\n                              \"p-1\",\n                              \"rounded\",\n                              \"text-neutral-400\",\n                              \"hover:text-neutral-600\",\n                              \"hover:bg-neutral-100\",\n                              \"disabled:opacity-50\",\n                            ].join(\" \")}\n                            title=\"Move down\"\n                          >\n                            <ChevronDownIcon className=\"h-4 w-4\" />\n                          </button>\n\n                          <button\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              onRemoveSlot?.(slot.id);\n                            }}\n                            disabled={readOnly || slot.isRequired}\n                            className={[\n                              \"p-1\",\n                              \"rounded\",\n                              \"text-neutral-400\",\n                              \"hover:text-error-600\",\n                              \"hover:bg-error-50\",\n                              \"disabled:opacity-50\",\n                            ].join(\" \")}\n                            title=\"Remove slot\"\n                          >\n                            <TrashIcon className=\"h-4 w-4\" />\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Expanded: Plugin selector */}\n                    {isExpanded && (\n                      <div className=\"mt-4 p-3 bg-neutral-50 rounded-lg\">\n                        <p className=\"text-xs font-medium text-neutral-500 mb-2\">\n                          Available Plugins ({compatiblePlugins.length})\n                        </p>\n                        {compatiblePlugins.length === 0 ? (\n                          <p className=\"text-sm text-neutral-400 italic\">\n                            No compatible plugins available\n                          </p>\n                        ) : (\n                          <div className=\"space-y-1\">\n                            {compatiblePlugins.map((plugin) => (\n                              <button\n                                key={plugin.id}\n                                type=\"button\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  onAssignPlugin?.(slot.id, plugin.id);\n                                  setExpandedSlotId(null);\n                                }}\n                                disabled={plugin.status !== \"loaded\"}\n                                className={[\n                                  \"w-full\",\n                                  \"flex\",\n                                  \"items-center\",\n                                  \"justify-between\",\n                                  \"p-2\",\n                                  \"text-left\",\n                                  \"rounded\",\n                                  \"bg-white\",\n                                  \"border\",\n                                  \"border-neutral-200\",\n                                  \"hover:border-primary-300\",\n                                  \"hover:bg-primary-50\",\n                                  \"disabled:opacity-50\",\n                                  \"disabled:cursor-not-allowed\",\n                                  \"transition-colors\",\n                                  \"duration-150\",\n                                ].join(\" \")}\n                              >\n                                <div>\n                                  <span className=\"text-sm font-medium text-neutral-900\">\n                                    {plugin.displayName}\n                                  </span>\n                                  <span className=\"ml-2 text-xs text-neutral-400\">\n                                    v{plugin.version}\n                                  </span>\n                                </div>\n                                <span\n                                  className={[\n                                    \"h-2\",\n                                    \"w-2\",\n                                    \"rounded-full\",\n                                    plugin.status === \"loaded\" && \"bg-success-500\",\n                                    plugin.status === \"unloaded\" && \"bg-neutral-400\",\n                                    plugin.status === \"error\" && \"bg-error-500\",\n                                  ]\n                                    .filter(Boolean)\n                                    .join(\" \")}\n                                />\n                              </button>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </li>\n              );\n            })}\n          </ul>\n        ) : (\n          /* Grid view */\n          <div className=\"p-4 grid grid-cols-2 lg:grid-cols-3 gap-4\">\n            {sortedSlots.map((slot) => {\n              const ContractIcon = getContractIcon(slot.contract);\n\n              return (\n                <div\n                  key={slot.id}\n                  role=\"button\"\n                  tabIndex={0}\n                  onClick={() => handleSlotClick(slot)}\n                  onKeyDown={(e) => e.key === \"Enter\" && handleSlotClick(slot)}\n                  className={[\n                    \"p-4\",\n                    \"rounded-lg\",\n                    \"border-2\",\n                    \"cursor-pointer\",\n                    \"transition-all\",\n                    \"duration-150\",\n                    selectedSlotId === slot.id\n                      ? \"border-primary-500 shadow-md\"\n                      : \"border-neutral-200 hover:border-neutral-300\",\n                    statusColors[slot.status],\n                  ].join(\" \")}\n                >\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div\n                      className={[\n                        \"p-2\",\n                        \"rounded-lg\",\n                        \"border\",\n                        contractColors[slot.contract] || contractColors.default,\n                      ].join(\" \")}\n                    >\n                      <ContractIcon className=\"h-5 w-5\" />\n                    </div>\n                    <span\n                      className={[\n                        \"h-2\",\n                        \"w-2\",\n                        \"rounded-full\",\n                        slot.status === \"assigned\" && \"bg-success-500\",\n                        slot.status === \"empty\" && \"bg-neutral-400\",\n                        slot.status === \"error\" && \"bg-error-500\",\n                        slot.status === \"disabled\" && \"bg-neutral-300\",\n                      ]\n                        .filter(Boolean)\n                        .join(\" \")}\n                    />\n                  </div>\n\n                  <h4 className=\"text-sm font-medium text-neutral-900 truncate\">\n                    {slot.name}\n                  </h4>\n\n                  <p className=\"text-xs text-neutral-500 mt-1 uppercase\">\n                    {slot.contract}\n                  </p>\n\n                  {slot.assignedPluginName && (\n                    <p className=\"text-xs text-success-600 mt-2 truncate\">\n                      {slot.assignedPluginName}\n                    </p>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Footer */}\n      <div className=\"px-4 py-2 border-t border-neutral-200 bg-neutral-50 text-xs text-neutral-500\">\n        {filteredSlots.length === slots.length\n          ? `${slots.length} slot${slots.length === 1 ? \"\" : \"s\"}`\n          : `${filteredSlots.length} of ${slots.length} slots`}\n        {\" ÔÇó \"}\n        {availablePlugins.filter((p) => p.status === \"loaded\").length} plugins available\n      </div>\n    </div>\n  );\n};\n\nPluginSlotManager.displayName = \"PluginSlotManager\";\n\nexport default PluginSlotManager;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\ProjectLoader.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":268,"column":45,"nodeType":"Identifier","messageId":"invalidType","endLine":268,"endColumn":52},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":270,"column":44,"nodeType":"Identifier","messageId":"invalidType","endLine":270,"endColumn":49},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":273,"column":27,"nodeType":"Identifier","messageId":"invalidType","endLine":273,"endColumn":31},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":274,"column":28,"nodeType":"CallExpression","messageId":"invalidType","endLine":274,"endColumn":48},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":327,"column":54,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":327,"endColumn":56,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[9113,9115],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":752,"column":18,"nodeType":"MemberExpression","messageId":"invalidType","endLine":752,"endColumn":33},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":753,"column":18,"nodeType":"MemberExpression","messageId":"invalidType","endLine":753,"endColumn":41},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":753,"column":48,"nodeType":"MemberExpression","messageId":"invalidType","endLine":753,"endColumn":63}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D063 - src/components/project/ProjectLoader.tsx\n * ================================================\n * Component for loading and managing existing projects.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D011 (Input.tsx), D014 (Panel.tsx), D015 (Modal.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Project metadata structure.\n */\nexport interface ProjectInfo {\n  id: string;\n  name: string;\n  path: string;\n  description?: string;\n  version: string;\n  createdAt: Date;\n  updatedAt: Date;\n  plugins: ProjectPluginInfo[];\n  screens: ProjectScreenInfo[];\n  thumbnail?: string;\n  status: \"ready\" | \"loading\" | \"error\" | \"outdated\";\n}\n\n/**\n * Plugin info within a project.\n */\nexport interface ProjectPluginInfo {\n  id: string;\n  name: string;\n  contract: string;\n  version: string;\n  enabled: boolean;\n}\n\n/**\n * Screen info within a project.\n */\nexport interface ProjectScreenInfo {\n  id: string;\n  name: string;\n  route: string;\n  componentCount: number;\n}\n\n/**\n * ProjectLoader component props.\n */\nexport interface ProjectLoaderProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\"> {\n  /** Available projects */\n  projects: ProjectInfo[];\n  /** Currently selected project ID */\n  selectedProjectId?: string;\n  /** Callback when project is selected */\n  onSelectProject?: (project: ProjectInfo) => void;\n  /** Callback when project is opened */\n  onOpenProject?: (project: ProjectInfo) => void;\n  /** Callback when project is deleted */\n  onDeleteProject?: (project: ProjectInfo) => void;\n  /** Callback when browse for project is clicked */\n  onBrowseProject?: () => void;\n  /** Callback when new project is requested */\n  onNewProject?: () => void;\n  /** Callback when settings is requested */\n  onToggleSettings?: () => void;\n  /** Whether loading projects */\n  isLoading?: boolean;\n  /** Loading error message */\n  errorMessage?: string;\n}\n\n/**\n * Folder icon.\n */\nconst FolderIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\" />\n  </svg>\n);\n\n/**\n * Plus icon.\n */\nconst PlusIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Folder open icon.\n */\nconst FolderOpenIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2v1\" />\n    <path d=\"M5 12h14l-2 7H7l-2-7z\" />\n  </svg>\n);\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n    <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" />\n    <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" />\n  </svg>\n);\n\n/**\n * External link icon.\n */\nconst ExternalLinkIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\" />\n    <polyline points=\"15 3 21 3 21 9\" />\n    <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\" />\n  </svg>\n);\n\n/**\n * Clock icon.\n */\nconst ClockIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <polyline points=\"12 6 12 12 16 14\" />\n  </svg>\n);\n\n/**\n * Alert circle icon.\n */\nconst AlertCircleIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" />\n    <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\" />\n  </svg>\n);\n\n/**\n * Settings icon.\n */\nconst SettingsIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\n  </svg>\n);\n\n/**\n * Status badge colors.\n */\nconst statusColors: Record<ProjectInfo[\"status\"], string> = {\n  ready: \"bg-success-50 text-success-700 border-success-200\",\n  loading: \"bg-warning-50 text-warning-700 border-warning-200\",\n  error: \"bg-error-50 text-error-700 border-error-200\",\n  outdated: \"bg-info-50 text-info-700 border-info-200\",\n};\n\n/**\n * Status labels.\n */\nconst statusLabels: Record<ProjectInfo[\"status\"], string> = {\n  ready: \"Ready\",\n  loading: \"Loading\",\n  error: \"Error\",\n  outdated: \"Outdated\",\n};\n\n/**\n * Format date for display.\n */\nconst formatDate = (date: Date): string => {\n  const now = new Date();\n  const diff = now.getTime() - date.getTime();\n  const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n\n  if (days === 0) {\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    if (hours === 0) {\n      const minutes = Math.floor(diff / (1000 * 60));\n      return minutes <= 1 ? \"Just now\" : `${minutes} minutes ago`;\n    }\n    return hours === 1 ? \"1 hour ago\" : `${hours} hours ago`;\n  }\n  if (days === 1) return \"Yesterday\";\n  if (days < 7) return `${days} days ago`;\n  if (days < 30) return `${Math.floor(days / 7)} weeks ago`;\n  return date.toLocaleDateString();\n};\n\n/**\n * ProjectLoader component.\n *\n * Displays a list of available projects with options to load, create,\n * or browse for existing projects.\n *\n * @example\n * ```tsx\n * <ProjectLoader\n *   projects={availableProjects}\n *   selectedProjectId={selectedId}\n *   onSelectProject={(project) => setSelectedId(project.id)}\n *   onOpenProject={(project) => loadProject(project)}\n *   onNewProject={() => showNewProjectWizard()}\n *   onBrowseProject={() => openFilePicker()}\n *   onToggleSettings={() => toggleSettings()}\n * />\n * ```\n */\nexport const ProjectLoader: React.FC<ProjectLoaderProps> = ({\n  projects,\n  selectedProjectId,\n  onSelectProject,\n  onOpenProject,\n  onDeleteProject,\n  onBrowseProject,\n  onNewProject,\n  onToggleSettings,\n  isLoading = false,\n  errorMessage,\n  className = \"\",\n  ...props\n}) => {\n  // Search filter\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  // Delete confirmation\n  const [deleteConfirmId, setDeleteConfirmId] = useState<string | null>(null);\n\n  // Visible projects count (pagination/truncation)\n  const [visibleCount, setVisibleCount] = useState(5);\n\n  // Filtered projects\n  const filteredProjects = useMemo(() => {\n    if (!searchQuery.trim()) return projects;\n    const query = searchQuery.toLowerCase();\n    return projects.filter(\n      (p) =>\n        p.name.toLowerCase().includes(query) ||\n        p.description?.toLowerCase().includes(query) ||\n        p.path.toLowerCase().includes(query)\n    );\n  }, [projects, searchQuery]);\n\n  // Sort by updated date (most recent first)\n  const sortedProjects = useMemo(() => {\n    return [...filteredProjects].sort(\n      (a, b) => b.updatedAt.getTime() - a.updatedAt.getTime()\n    );\n  }, [filteredProjects]);\n\n  // Handle project selection\n  const handleSelect = useCallback(\n    (project: ProjectInfo) => {\n      onSelectProject?.(project);\n    },\n    [onSelectProject]\n  );\n\n  // Handle project open\n  const handleOpen = useCallback(\n    (project: ProjectInfo) => {\n      if (project.status !== \"error\") {\n        onOpenProject?.(project);\n      }\n    },\n    [onOpenProject]\n  );\n\n  // Handle delete confirmation\n  const handleDeleteConfirm = useCallback(\n    (project: ProjectInfo) => {\n      onDeleteProject?.(project);\n      setDeleteConfirmId(null);\n    },\n    [onDeleteProject]\n  );\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"h-full\",\n    \"bg-white\",\n    \"rounded-lg\",\n    \"border\",\n    \"border-neutral-200\",\n    \"overflow-hidden\",\n    className,\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Header */}\n      <div className=\"p-4 border-b border-neutral-200 bg-neutral-50\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-lg font-semibold text-neutral-900\">Projects</h2>\n          <div className=\"flex items-center gap-2\">\n            {onToggleSettings && (\n              <button\n                type=\"button\"\n                onClick={onToggleSettings}\n                className={[\n                  \"inline-flex\",\n                  \"items-center\",\n                  \"justify-center\",\n                  \"h-8\",\n                  \"w-8\",\n                  \"text-neutral-500\",\n                  \"bg-white\",\n                  \"border\",\n                  \"border-neutral-300\",\n                  \"rounded-md\",\n                  \"hover:bg-neutral-50\",\n                  \"hover:text-neutral-700\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                ].join(\" \")}\n                title=\"Settings\"\n              >\n                <SettingsIcon className=\"h-4 w-4\" />\n              </button>\n            )}\n            <button\n              type=\"button\"\n              onClick={onBrowseProject}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"gap-1.5\",\n                \"px-3\",\n                \"py-1.5\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-neutral-700\",\n                \"bg-white\",\n                \"border\",\n                \"border-neutral-300\",\n                \"rounded-md\",\n                \"hover:bg-neutral-50\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              <FolderOpenIcon className=\"h-4 w-4\" />\n              Browse\n            </button>\n            <button\n              type=\"button\"\n              onClick={onNewProject}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"gap-1.5\",\n                \"px-3\",\n                \"py-1.5\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-white\",\n                \"bg-primary-600\",\n                \"rounded-md\",\n                \"hover:bg-primary-700\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n              New Project\n            </button>\n          </div>\n        </div>\n\n        {/* Search input */}\n        <div className=\"relative\">\n          <svg\n            className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n          >\n            <circle cx=\"11\" cy=\"11\" r=\"8\" />\n            <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n          </svg>\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search projects...\"\n            className={[\n              \"w-full\",\n              \"pl-10\",\n              \"pr-4\",\n              \"py-2\",\n              \"text-sm\",\n              \"bg-white\",\n              \"border\",\n              \"border-neutral-300\",\n              \"rounded-md\",\n              \"focus:outline-none\",\n              \"focus:ring-2\",\n              \"focus:ring-primary-500\",\n              \"focus:border-primary-500\",\n            ].join(\" \")}\n          />\n        </div>\n      </div>\n\n      {/* Error message */}\n      {errorMessage && (\n        <div className=\"p-4 bg-error-50 border-b border-error-200\">\n          <div className=\"flex items-center gap-2 text-error-700\">\n            <AlertCircleIcon className=\"h-5 w-5 shrink-0\" />\n            <p className=\"text-sm\">{errorMessage}</p>\n          </div>\n        </div>\n      )}\n\n      {/* Project list */}\n      <div className=\"flex-1 overflow-y-auto\">\n        {isLoading ? (\n          <div className=\"flex items-center justify-center p-12\">\n            <div className=\"h-8 w-8 border-2 border-primary-600 border-t-transparent rounded-full animate-spin\" />\n          </div>\n        ) : sortedProjects.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center p-12 text-center\">\n            <FolderIcon className=\"h-16 w-16 text-neutral-300 mb-4\" />\n            <p className=\"text-sm text-neutral-500 mb-4\">\n              {searchQuery\n                ? \"No projects match your search\"\n                : \"No projects yet. Create a new project or browse for an existing one.\"}\n            </p>\n            {!searchQuery && (\n              <button\n                type=\"button\"\n                onClick={onNewProject}\n                className={[\n                  \"inline-flex\",\n                  \"items-center\",\n                  \"gap-1.5\",\n                  \"px-4\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"font-medium\",\n                  \"text-white\",\n                  \"bg-primary-600\",\n                  \"rounded-md\",\n                  \"hover:bg-primary-700\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                ].join(\" \")}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n                Create Your First Project\n              </button>\n            )}\n          </div>\n        ) : (\n          <div className=\"flex flex-col\">\n            <ul className=\"divide-y divide-neutral-100\">\n              {sortedProjects.slice(0, visibleCount).map((project) => (\n                <li key={project.id}>\n                  <div\n                    role=\"button\"\n                    tabIndex={0}\n                    onClick={() => handleSelect(project)}\n                    onDoubleClick={() => handleOpen(project)}\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") handleOpen(project);\n                      if (e.key === \" \") handleSelect(project);\n                    }}\n                    className={[\n                      \"px-4\",\n                      \"py-2\",\n                      \"cursor-pointer\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      selectedProjectId === project.id\n                        ? \"bg-primary-50\"\n                        : \"hover:bg-neutral-50\",\n                      \"focus:outline-none\",\n                      \"focus:bg-primary-50\",\n                    ].join(\" \")}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {/* Thumbnail or folder icon - reduced size */}\n                      <div\n                        className={[\n                          \"flex\",\n                          \"items-center\",\n                          \"justify-center\",\n                          \"h-8\",\n                          \"w-8\",\n                          \"rounded-md\",\n                          \"bg-neutral-100\",\n                          \"shrink-0\",\n                        ].join(\" \")}\n                      >\n                        {project.thumbnail ? (\n                          <img\n                            src={project.thumbnail}\n                            alt={project.name}\n                            className=\"h-full w-full object-cover rounded-md\"\n                          />\n                        ) : (\n                          <FolderIcon className=\"h-4 w-4 text-neutral-400\" />\n                        )}\n                      </div>\n\n                      {/* Project info - condensed layout */}\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center gap-2\">\n                          <h3 className=\"text-sm font-medium text-neutral-900 truncate\">\n                            {project.name}\n                          </h3>\n                          <span\n                            className={[\n                              \"px-1.5\",\n                              \"py-0.5\",\n                              \"text-xs\",\n                              \"font-medium\",\n                              \"rounded\",\n                              \"border\",\n                              statusColors[project.status],\n                            ].join(\" \")}\n                          >\n                            {statusLabels[project.status]}\n                          </span>\n                        </div>\n\n                        {project.description && (\n                          <p className=\"text-xs text-neutral-500 truncate\">\n                            {project.description}\n                          </p>\n                        )}\n\n                        <div className=\"flex items-center gap-3 text-xs text-neutral-400\">\n                          <span className=\"flex items-center gap-1\">\n                            <ClockIcon className=\"h-3 w-3\" />\n                            {formatDate(project.updatedAt)}\n                          </span>\n                          <span>v{project.version}</span>\n                          <span>{project.plugins.length} plugins</span>\n                          <span>{project.screens.length} screens</span>\n                        </div>\n                      </div>\n\n                      {/* Actions */}\n                      <div className=\"flex items-center gap-1 shrink-0\">\n                        <button\n                          type=\"button\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleOpen(project);\n                          }}\n                          disabled={project.status === \"error\"}\n                          className={[\n                            \"p-1.5\",\n                            \"rounded-md\",\n                            \"text-neutral-400\",\n                            \"hover:text-primary-600\",\n                            \"hover:bg-primary-50\",\n                            \"disabled:opacity-50\",\n                            \"disabled:cursor-not-allowed\",\n                            \"transition-colors\",\n                            \"duration-150\",\n                          ].join(\" \")}\n                          title=\"Open project\"\n                        >\n                          <ExternalLinkIcon className=\"h-4 w-4\" />\n                        </button>\n\n                        {deleteConfirmId === project.id ? (\n                          <div className=\"flex items-center gap-1 ml-1\">\n                            <button\n                              type=\"button\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                handleDeleteConfirm(project);\n                              }}\n                              className={[\n                                \"px-2\",\n                                \"py-0.5\",\n                                \"text-xs\",\n                                \"font-medium\",\n                                \"text-white\",\n                                \"bg-error-600\",\n                                \"rounded\",\n                                \"hover:bg-error-700\",\n                                \"transition-colors\",\n                                \"duration-150\",\n                              ].join(\" \")}\n                            >\n                              Delete\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                setDeleteConfirmId(null);\n                              }}\n                              className={[\n                                \"px-2\",\n                                \"py-0.5\",\n                                \"text-xs\",\n                                \"font-medium\",\n                                \"text-neutral-600\",\n                                \"bg-neutral-100\",\n                                \"rounded\",\n                                \"hover:bg-neutral-200\",\n                                \"transition-colors\",\n                                \"duration-150\",\n                              ].join(\" \")}\n                            >\n                              Cancel\n                            </button>\n                          </div>\n                        ) : (\n                          <button\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              setDeleteConfirmId(project.id);\n                            }}\n                            className={[\n                              \"p-1.5\",\n                              \"rounded-md\",\n                              \"text-neutral-400\",\n                              \"hover:text-error-600\",\n                              \"hover:bg-error-50\",\n                              \"transition-colors\",\n                              \"duration-150\",\n                            ].join(\" \")}\n                            title=\"Delete project\"\n                          >\n                            <TrashIcon className=\"h-4 w-4\" />\n                          </button>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                </li>\n              ))}\n            </ul>\n            {sortedProjects.length > visibleCount && (\n              <button\n                type=\"button\"\n                onClick={() => setVisibleCount((prev) => prev + 5)}\n                className=\"w-full py-3 text-sm font-medium text-primary-600 hover:text-primary-700 hover:bg-primary-50 transition-colors border-t border-neutral-100\"\n              >\n                See more ({sortedProjects.length - visibleCount} remaining)\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Footer with stats */}\n      {projects.length > 0 && (\n        <div className=\"px-4 py-2 border-t border-neutral-200 bg-neutral-50 text-xs text-neutral-500\">\n          {filteredProjects.length === projects.length\n            ? `${projects.length} project${projects.length === 1 ? \"\" : \"s\"}`\n            : `${filteredProjects.length} of ${projects.length} projects`}\n        </div>\n      )}\n    </div>\n  );\n};\n\nProjectLoader.displayName = \"ProjectLoader\";\n\nexport default ProjectLoader;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\ScreenEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'availableScreens' is assigned a value but never used. Allowed unused args must match /^_/u.","line":282,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":282,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onWidgetResize' is defined but never used. Allowed unused args must match /^_/u.","line":288,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":288,"endColumn":17},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":817,"column":48,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":817,"endColumn":50,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[28023,28025],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":847,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":847,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[29040,29042],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D065 - src/components/project/ScreenEditor.tsx\n * ===============================================\n * Component for editing screens and widgets in a project.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D011 (Input.tsx), D014 (Panel.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, type HTMLAttributes } from \"react\";\n\n/**\n * Widget slot definition.\n */\nexport interface WidgetSlot {\n  id: string;\n  name: string;\n  pluginId?: string;\n  pluginType?: string;\n  position: { x: number; y: number };\n  size: { width: number; height: number };\n  constraints?: {\n    minWidth?: number;\n    maxWidth?: number;\n    minHeight?: number;\n    maxHeight?: number;\n  };\n  isRequired?: boolean;\n}\n\n/**\n * Screen route configuration.\n */\nexport interface ScreenRoute {\n  path: string;\n  params?: { name: string; type: string; required: boolean }[];\n  guards?: string[];\n}\n\n/**\n * Screen metadata.\n */\nexport interface ScreenMeta {\n  title: string;\n  description?: string;\n  keywords?: string[];\n  icon?: string;\n}\n\n/**\n * Editable screen structure.\n */\nexport interface EditableScreen {\n  id: string;\n  name: string;\n  displayName: string;\n  type: \"page\" | \"modal\" | \"drawer\" | \"widget\" | \"overlay\";\n  route: ScreenRoute;\n  meta: ScreenMeta;\n  layout: \"single\" | \"split\" | \"grid\" | \"stack\" | \"custom\";\n  widgets: WidgetSlot[];\n  parentId?: string;\n  isDefault?: boolean;\n  isProtected?: boolean;\n}\n\n/**\n * ScreenEditor component props.\n */\nexport interface ScreenEditorProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n  /** Screen being edited */\n  screen: EditableScreen;\n  /** Available screens for navigation */\n  availableScreens?: EditableScreen[];\n  /** Callback when screen property changes */\n  onPropertyChange?: (property: string, value: unknown) => void;\n  /** Callback when widget is selected */\n  onWidgetSelect?: (widget: WidgetSlot) => void;\n  /** Callback when widget is added */\n  onWidgetAdd?: (position: { x: number; y: number }) => void;\n  /** Callback when widget is removed */\n  onWidgetRemove?: (widgetId: string) => void;\n  /** Callback when widget is moved */\n  onWidgetMove?: (widgetId: string, position: { x: number; y: number }) => void;\n  /** Callback when widget is resized */\n  onWidgetResize?: (widgetId: string, size: { width: number; height: number }) => void;\n  /** Callback when screen is deleted */\n  onDelete?: () => void;\n  /** Callback when screen is duplicated */\n  onDuplicate?: () => void;\n  /** Currently selected widget ID */\n  selectedWidgetId?: string;\n  /** Whether in preview mode */\n  previewMode?: boolean;\n  /** Whether screen is read-only */\n  readOnly?: boolean;\n  /** Grid snap size */\n  gridSize?: number;\n  /** Whether to show grid */\n  showGrid?: boolean;\n}\n\n/**\n * Screen type icons.\n */\nconst ScreenTypeIcons: Record<EditableScreen[\"type\"], React.FC<{ className?: string }>> = {\n  page: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" />\n      <polyline points=\"14 2 14 8 20 8\" />\n    </svg>\n  ),\n  modal: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <line x1=\"9\" y1=\"3\" x2=\"9\" y2=\"21\" />\n    </svg>\n  ),\n  drawer: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\n      <line x1=\"3\" y1=\"15\" x2=\"21\" y2=\"15\" />\n    </svg>\n  ),\n  widget: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\n      <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\n      <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\n      <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\n    </svg>\n  ),\n  overlay: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <rect x=\"7\" y=\"7\" width=\"10\" height=\"10\" rx=\"1\" ry=\"1\" />\n    </svg>\n  ),\n};\n\n/**\n * Layout icons.\n */\nconst LayoutIcons: Record<EditableScreen[\"layout\"], React.FC<{ className?: string }>> = {\n  single: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n    </svg>\n  ),\n  split: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"21\" />\n    </svg>\n  ),\n  grid: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\" />\n      <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"21\" />\n    </svg>\n  ),\n  stack: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n      <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\n      <line x1=\"3\" y1=\"15\" x2=\"21\" y2=\"15\" />\n    </svg>\n  ),\n  custom: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"3\" width=\"7\" height=\"9\" rx=\"1\" />\n      <rect x=\"14\" y=\"3\" width=\"7\" height=\"5\" rx=\"1\" />\n      <rect x=\"14\" y=\"12\" width=\"7\" height=\"9\" rx=\"1\" />\n      <rect x=\"3\" y=\"16\" width=\"7\" height=\"5\" rx=\"1\" />\n    </svg>\n  ),\n};\n\n/**\n * Plus icon.\n */\nconst PlusIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Copy icon.\n */\nconst CopyIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\" />\n    <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\" />\n  </svg>\n);\n\n/**\n * Eye icon.\n */\nconst _EyeIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\n    <circle cx=\"12\" cy=\"12\" r=\"3\" />\n  </svg>\n);\n\n/**\n * Grid icon.\n */\nconst GridIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\n    <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\n    <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\n  </svg>\n);\n\n/**\n * Move icon.\n */\nconst MoveIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"5 9 2 12 5 15\" />\n    <polyline points=\"9 5 12 2 15 5\" />\n    <polyline points=\"15 19 12 22 9 19\" />\n    <polyline points=\"19 9 22 12 19 15\" />\n    <line x1=\"2\" y1=\"12\" x2=\"22\" y2=\"12\" />\n    <line x1=\"12\" y1=\"2\" x2=\"12\" y2=\"22\" />\n  </svg>\n);\n\n/**\n * Screen type colors.\n */\nconst screenTypeColors: Record<EditableScreen[\"type\"], string> = {\n  page: \"bg-primary-100 text-primary-700\",\n  modal: \"bg-warning-50 text-warning-700\",\n  drawer: \"bg-success-50 text-success-700\",\n  widget: \"bg-info-50 text-info-700\",\n  overlay: \"bg-purple-50 text-purple-700\",\n};\n\n/**\n * ScreenEditor component.\n *\n * Provides an interface for editing screens and their widget layouts.\n *\n * @example\n * ```tsx\n * <ScreenEditor\n *   screen={selectedScreen}\n *   onPropertyChange={(prop, value) => updateScreen(prop, value)}\n *   onWidgetSelect={(widget) => setSelectedWidget(widget)}\n *   onWidgetAdd={(pos) => addWidget(pos)}\n *   selectedWidgetId={selectedWidgetId}\n * />\n * ```\n */\nexport const ScreenEditor: React.FC<ScreenEditorProps> = ({\n  screen,\n  availableScreens = [],\n  onPropertyChange,\n  onWidgetSelect,\n  onWidgetAdd,\n  onWidgetRemove,\n  onWidgetMove,\n  onWidgetResize,\n  onDelete,\n  onDuplicate,\n  selectedWidgetId,\n  previewMode = false,\n  readOnly = false,\n  gridSize = 20,\n  showGrid: initialShowGrid = true,\n  className = \"\",\n  ...props\n}) => {\n  // Active tab\n  const [activeTab, setActiveTab] = useState<\"layout\" | \"route\" | \"meta\">(\"layout\");\n\n  // Show grid\n  const [showGrid, setShowGrid] = useState(initialShowGrid);\n\n  // Dragging state\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragWidget, setDragWidget] = useState<string | null>(null);\n\n  // Get screen type icon\n  const ScreenTypeIcon = ScreenTypeIcons[screen.type];\n  const _LayoutIcon = LayoutIcons[screen.layout];\n\n  // Handle canvas click for adding widgets\n  const handleCanvasClick = useCallback(\n    (e: React.MouseEvent<HTMLDivElement>) => {\n      if (readOnly || previewMode) return;\n\n      const rect = e.currentTarget.getBoundingClientRect();\n      const x = Math.round((e.clientX - rect.left) / gridSize) * gridSize;\n      const y = Math.round((e.clientY - rect.top) / gridSize) * gridSize;\n\n      // Only add if clicking empty space\n      if (e.target === e.currentTarget) {\n        onWidgetAdd?.({ x, y });\n      }\n    },\n    [readOnly, previewMode, gridSize, onWidgetAdd]\n  );\n\n  // Handle widget drag start\n  const handleWidgetDragStart = useCallback(\n    (widgetId: string) => {\n      if (readOnly) return;\n      setIsDragging(true);\n      setDragWidget(widgetId);\n    },\n    [readOnly]\n  );\n\n  // Handle widget drag end\n  const handleWidgetDragEnd = useCallback(\n    (e: React.MouseEvent<HTMLDivElement>, widgetId: string) => {\n      if (!isDragging || dragWidget !== widgetId) return;\n\n      const rect = e.currentTarget.parentElement?.getBoundingClientRect();\n      if (rect) {\n        const x = Math.round((e.clientX - rect.left) / gridSize) * gridSize;\n        const y = Math.round((e.clientY - rect.top) / gridSize) * gridSize;\n        onWidgetMove?.(widgetId, { x, y });\n      }\n\n      setIsDragging(false);\n      setDragWidget(null);\n    },\n    [isDragging, dragWidget, gridSize, onWidgetMove]\n  );\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"h-full\",\n    \"bg-white\",\n    \"overflow-hidden\",\n    className,\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Header */}\n      <div className=\"p-4 border-b border-neutral-200 bg-neutral-50\">\n        <div className=\"flex items-center gap-3\">\n          <div\n            className={[\n              \"flex\",\n              \"items-center\",\n              \"justify-center\",\n              \"h-10\",\n              \"w-10\",\n              \"rounded-lg\",\n              screenTypeColors[screen.type],\n            ].join(\" \")}\n          >\n            <ScreenTypeIcon className=\"h-5 w-5\" />\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-sm font-semibold text-neutral-900 truncate\">\n              {screen.displayName}\n            </h3>\n            <p className=\"text-xs text-neutral-500\">\n              {screen.type} ÔÇó {screen.layout} layout ÔÇó {screen.widgets.length} widgets\n            </p>\n          </div>\n        </div>\n\n        {/* Action buttons */}\n        <div className=\"mt-3 flex items-center gap-1\">\n          <button\n            type=\"button\"\n            onClick={() => setShowGrid(!showGrid)}\n            className={[\n              \"p-1.5\",\n              \"rounded-md\",\n              showGrid\n                ? \"bg-primary-50 text-primary-600\"\n                : \"text-neutral-400 hover:bg-neutral-100 hover:text-neutral-600\",\n              \"transition-colors\",\n              \"duration-150\",\n            ].join(\" \")}\n            title={showGrid ? \"Hide grid\" : \"Show grid\"}\n          >\n            <GridIcon className=\"h-4 w-4\" />\n          </button>\n\n          <div className=\"flex-1\" />\n\n          <button\n            type=\"button\"\n            onClick={onDuplicate}\n            disabled={readOnly}\n            className={[\n              \"p-1.5\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              \"hover:bg-neutral-100\",\n              \"hover:text-neutral-600\",\n              \"transition-colors\",\n              \"duration-150\",\n              \"disabled:opacity-50\",\n            ].join(\" \")}\n            title=\"Duplicate screen\"\n          >\n            <CopyIcon className=\"h-4 w-4\" />\n          </button>\n\n          <button\n            type=\"button\"\n            onClick={onDelete}\n            disabled={readOnly || screen.isDefault}\n            className={[\n              \"p-1.5\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              \"hover:bg-error-50\",\n              \"hover:text-error-600\",\n              \"transition-colors\",\n              \"duration-150\",\n              \"disabled:opacity-50\",\n            ].join(\" \")}\n            title=\"Delete screen\"\n          >\n            <TrashIcon className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex border-b border-neutral-200\">\n        {([\"layout\", \"route\", \"meta\"] as const).map((tab) => (\n          <button\n            key={tab}\n            type=\"button\"\n            onClick={() => setActiveTab(tab)}\n            className={[\n              \"flex-1\",\n              \"px-4\",\n              \"py-2\",\n              \"text-sm\",\n              \"font-medium\",\n              \"border-b-2\",\n              \"transition-colors\",\n              \"duration-150\",\n              activeTab === tab\n                ? \"border-primary-600 text-primary-600\"\n                : \"border-transparent text-neutral-500 hover:text-neutral-700\",\n            ].join(\" \")}\n          >\n            {tab.charAt(0).toUpperCase() + tab.slice(1)}\n          </button>\n        ))}\n      </div>\n\n      {/* Content */}\n      <div className=\"flex-1 overflow-hidden\">\n        {activeTab === \"layout\" && (\n          <div className=\"h-full flex flex-col\">\n            {/* Layout type selector */}\n            <div className=\"p-4 border-b border-neutral-100\">\n              <label className=\"block text-xs font-medium text-neutral-500 mb-2\">\n                Layout Type\n              </label>\n              <div className=\"flex gap-2\">\n                {(Object.keys(LayoutIcons) as EditableScreen[\"layout\"][]).map((layout) => {\n                  const Icon = LayoutIcons[layout];\n                  return (\n                    <button\n                      key={layout}\n                      type=\"button\"\n                      onClick={() => onPropertyChange?.(\"layout\", layout)}\n                      disabled={readOnly}\n                      className={[\n                        \"flex\",\n                        \"flex-col\",\n                        \"items-center\",\n                        \"gap-1\",\n                        \"p-2\",\n                        \"rounded-md\",\n                        \"border\",\n                        \"transition-colors\",\n                        \"duration-150\",\n                        screen.layout === layout\n                          ? \"border-primary-500 bg-primary-50 text-primary-700\"\n                          : \"border-neutral-200 text-neutral-500 hover:border-neutral-300\",\n                        \"disabled:opacity-50\",\n                      ].join(\" \")}\n                      title={layout}\n                    >\n                      <Icon className=\"h-5 w-5\" />\n                      <span className=\"text-xs capitalize\">{layout}</span>\n                    </button>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Widget canvas */}\n            <div className=\"flex-1 p-4 overflow-auto\">\n              <div\n                className={[\n                  \"relative\",\n                  \"w-full\",\n                  \"h-64\",\n                  \"rounded-lg\",\n                  \"border-2\",\n                  \"border-dashed\",\n                  \"border-neutral-300\",\n                  showGrid ? \"bg-[url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2220%22%20height%3D%2220%22%3E%3Crect%20fill%3D%22%23f9fafb%22%20width%3D%2220%22%20height%3D%2220%22/%3E%3Cpath%20d%3D%22M%200%200%20L%2020%200%20L%2020%2020%22%20fill%3D%22none%22%20stroke%3D%22%23e5e7eb%22%20stroke-width%3D%221%22/%3E%3C/svg%3E')]\" : \"bg-neutral-50\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                ].join(\" \")}\n                onClick={handleCanvasClick}\n              >\n                {screen.widgets.length === 0 ? (\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <PlusIcon className=\"mx-auto h-8 w-8 text-neutral-300\" />\n                      <p className=\"mt-2 text-sm text-neutral-400\">\n                        Click to add a widget slot\n                      </p>\n                    </div>\n                  </div>\n                ) : (\n                  screen.widgets.map((widget) => (\n                    <div\n                      key={widget.id}\n                      role=\"button\"\n                      tabIndex={0}\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        onWidgetSelect?.(widget);\n                      }}\n                      onMouseDown={() => handleWidgetDragStart(widget.id)}\n                      onMouseUp={(e) => handleWidgetDragEnd(e, widget.id)}\n                      className={[\n                        \"absolute\",\n                        \"flex\",\n                        \"flex-col\",\n                        \"items-center\",\n                        \"justify-center\",\n                        \"rounded-md\",\n                        \"border-2\",\n                        \"cursor-move\",\n                        \"transition-shadow\",\n                        \"duration-150\",\n                        selectedWidgetId === widget.id\n                          ? \"border-primary-500 bg-primary-50 shadow-md\"\n                          : \"border-neutral-300 bg-white hover:border-neutral-400\",\n                        widget.pluginId ? \"\" : \"border-dashed\",\n                      ].join(\" \")}\n                      style={{\n                        left: widget.position.x,\n                        top: widget.position.y,\n                        width: widget.size.width,\n                        height: widget.size.height,\n                      }}\n                    >\n                      <MoveIcon className=\"h-4 w-4 text-neutral-400\" />\n                      <span className=\"mt-1 text-xs text-neutral-500 truncate max-w-full px-2\">\n                        {widget.name}\n                      </span>\n                      {widget.pluginType && (\n                        <span className=\"text-xs text-neutral-400\">\n                          {widget.pluginType}\n                        </span>\n                      )}\n\n                      {/* Remove button */}\n                      {selectedWidgetId === widget.id && !readOnly && (\n                        <button\n                          type=\"button\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            onWidgetRemove?.(widget.id);\n                          }}\n                          className={[\n                            \"absolute\",\n                            \"-top-2\",\n                            \"-right-2\",\n                            \"p-1\",\n                            \"rounded-full\",\n                            \"bg-error-500\",\n                            \"text-white\",\n                            \"shadow-sm\",\n                            \"hover:bg-error-600\",\n                          ].join(\" \")}\n                        >\n                          <TrashIcon className=\"h-3 w-3\" />\n                        </button>\n                      )}\n                    </div>\n                  ))\n                )}\n              </div>\n            </div>\n\n            {/* Widget list */}\n            <div className=\"p-4 border-t border-neutral-100\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-xs font-medium text-neutral-500\">\n                  Widgets ({screen.widgets.length})\n                </span>\n                <button\n                  type=\"button\"\n                  onClick={() => onWidgetAdd?.({ x: 0, y: 0 })}\n                  disabled={readOnly}\n                  className={[\n                    \"inline-flex\",\n                    \"items-center\",\n                    \"gap-1\",\n                    \"px-2\",\n                    \"py-1\",\n                    \"text-xs\",\n                    \"text-primary-600\",\n                    \"hover:bg-primary-50\",\n                    \"rounded\",\n                    \"transition-colors\",\n                    \"duration-150\",\n                    \"disabled:opacity-50\",\n                  ].join(\" \")}\n                >\n                  <PlusIcon className=\"h-3 w-3\" />\n                  Add Widget\n                </button>\n              </div>\n              <div className=\"space-y-1 max-h-32 overflow-y-auto\">\n                {screen.widgets.map((widget) => (\n                  <button\n                    key={widget.id}\n                    type=\"button\"\n                    onClick={() => onWidgetSelect?.(widget)}\n                    className={[\n                      \"w-full\",\n                      \"flex\",\n                      \"items-center\",\n                      \"gap-2\",\n                      \"px-2\",\n                      \"py-1.5\",\n                      \"text-left\",\n                      \"rounded\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      selectedWidgetId === widget.id\n                        ? \"bg-primary-50 text-primary-700\"\n                        : \"hover:bg-neutral-50 text-neutral-700\",\n                    ].join(\" \")}\n                  >\n                    <span className=\"text-sm truncate\">{widget.name}</span>\n                    {widget.isRequired && (\n                      <span className=\"text-error-500 text-xs\">*</span>\n                    )}\n                    {widget.pluginType && (\n                      <span className=\"ml-auto text-xs text-neutral-400\">\n                        {widget.pluginType}\n                      </span>\n                    )}\n                  </button>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {activeTab === \"route\" && (\n          <div className=\"p-4 space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                Path\n              </label>\n              <input\n                type=\"text\"\n                value={screen.route.path}\n                onChange={(e) =>\n                  onPropertyChange?.(\"route\", { ...screen.route, path: e.target.value })\n                }\n                disabled={readOnly}\n                className={[\n                  \"w-full\",\n                  \"px-3\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"font-mono\",\n                  \"bg-white\",\n                  \"border\",\n                  \"border-neutral-300\",\n                  \"rounded-md\",\n                  \"focus:outline-none\",\n                  \"focus:ring-2\",\n                  \"focus:ring-primary-500\",\n                  \"disabled:bg-neutral-50\",\n                ].join(\" \")}\n                placeholder=\"/path/:param\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                Route Parameters\n              </label>\n              {screen.route.params && screen.route.params.length > 0 ? (\n                <div className=\"space-y-2\">\n                  {screen.route.params.map((param, index) => (\n                    <div\n                      key={index}\n                      className=\"flex items-center gap-2 p-2 bg-neutral-50 rounded\"\n                    >\n                      <span className=\"text-sm font-mono text-primary-600\">\n                        :{param.name}\n                      </span>\n                      <span className=\"text-xs text-neutral-400\">\n                        ({param.type})\n                      </span>\n                      {param.required && (\n                        <span className=\"text-error-500 text-xs\">required</span>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-sm text-neutral-500 italic\">\n                  No route parameters defined\n                </p>\n              )}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                Guards\n              </label>\n              {screen.route.guards && screen.route.guards.length > 0 ? (\n                <div className=\"flex flex-wrap gap-1\">\n                  {screen.route.guards.map((guard) => (\n                    <span\n                      key={guard}\n                      className=\"px-2 py-0.5 text-xs bg-warning-50 text-warning-700 rounded\"\n                    >\n                      {guard}\n                    </span>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-sm text-neutral-500 italic\">\n                  No guards configured\n                </p>\n              )}\n            </div>\n          </div>\n        )}\n\n        {activeTab === \"meta\" && (\n          <div className=\"p-4 space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                Title\n              </label>\n              <input\n                type=\"text\"\n                value={screen.meta.title}\n                onChange={(e) =>\n                  onPropertyChange?.(\"meta\", { ...screen.meta, title: e.target.value })\n                }\n                disabled={readOnly}\n                className={[\n                  \"w-full\",\n                  \"px-3\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"bg-white\",\n                  \"border\",\n                  \"border-neutral-300\",\n                  \"rounded-md\",\n                  \"focus:outline-none\",\n                  \"focus:ring-2\",\n                  \"focus:ring-primary-500\",\n                  \"disabled:bg-neutral-50\",\n                ].join(\" \")}\n                placeholder=\"Screen title\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                Description\n              </label>\n              <textarea\n                value={screen.meta.description || \"\"}\n                onChange={(e) =>\n                  onPropertyChange?.(\"meta\", { ...screen.meta, description: e.target.value })\n                }\n                disabled={readOnly}\n                rows={3}\n                className={[\n                  \"w-full\",\n                  \"px-3\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"bg-white\",\n                  \"border\",\n                  \"border-neutral-300\",\n                  \"rounded-md\",\n                  \"focus:outline-none\",\n                  \"focus:ring-2\",\n                  \"focus:ring-primary-500\",\n                  \"disabled:bg-neutral-50\",\n                ].join(\" \")}\n                placeholder=\"Screen description for SEO and accessibility\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\n                Icon\n              </label>\n              <input\n                type=\"text\"\n                value={screen.meta.icon || \"\"}\n                onChange={(e) =>\n                  onPropertyChange?.(\"meta\", { ...screen.meta, icon: e.target.value })\n                }\n                disabled={readOnly}\n                className={[\n                  \"w-full\",\n                  \"px-3\",\n                  \"py-2\",\n                  \"text-sm\",\n                  \"bg-white\",\n                  \"border\",\n                  \"border-neutral-300\",\n                  \"rounded-md\",\n                  \"focus:outline-none\",\n                  \"focus:ring-2\",\n                  \"focus:ring-primary-500\",\n                  \"disabled:bg-neutral-50\",\n                ].join(\" \")}\n                placeholder=\"Icon name or path\"\n              />\n            </div>\n\n            <div className=\"pt-4 border-t border-neutral-200\">\n              <div className=\"flex items-center gap-4\">\n                <label className=\"flex items-center gap-2\">\n                  <input\n                    type=\"checkbox\"\n                    checked={screen.isDefault}\n                    onChange={(e) => onPropertyChange?.(\"isDefault\", e.target.checked)}\n                    disabled={readOnly}\n                    className=\"h-4 w-4 rounded border-neutral-300 text-primary-600\"\n                  />\n                  <span className=\"text-sm text-neutral-700\">Default screen</span>\n                </label>\n\n                <label className=\"flex items-center gap-2\">\n                  <input\n                    type=\"checkbox\"\n                    checked={screen.isProtected}\n                    onChange={(e) => onPropertyChange?.(\"isProtected\", e.target.checked)}\n                    disabled={readOnly}\n                    className=\"h-4 w-4 rounded border-neutral-300 text-primary-600\"\n                  />\n                  <span className=\"text-sm text-neutral-700\">Protected route</span>\n                </label>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nScreenEditor.displayName = \"ScreenEditor\";\n\nexport default ScreenEditor;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\SwapPluginModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'showDetails' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":228,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":228,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'selectedPlugin' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":271,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":271,"endColumn":23},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":619,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":619,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[19669,19671],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":626,"column":27,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":626,"endColumn":43},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":690,"column":23,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":690,"endColumn":35}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D068 - src/components/project/SwapPluginModal.tsx\n * ==================================================\n * Modal for hot-swapping plugins in a slot.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D014 (Modal.tsx), D066 (PluginSlotManager.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\n\n/**\n * Plugin info for swap selection.\n */\nexport interface SwapPluginInfo {\n  id: string;\n  name: string;\n  displayName: string;\n  contract: string;\n  version: string;\n  description?: string;\n  status: \"loaded\" | \"unloaded\" | \"loading\" | \"error\";\n  isCompatible: boolean;\n  incompatibilityReason?: string;\n  lastUpdated?: Date;\n  author?: string;\n  dependencies?: string[];\n  features?: string[];\n}\n\n/**\n * Current slot info.\n */\nexport interface SwapSlotInfo {\n  id: string;\n  name: string;\n  contract: string;\n  currentPluginId?: string;\n  currentPluginName?: string;\n  currentPluginVersion?: string;\n  isRequired: boolean;\n}\n\n/**\n * Swap result.\n */\nexport interface SwapResult {\n  success: boolean;\n  previousPluginId?: string;\n  newPluginId: string;\n  error?: string;\n  rollbackAvailable?: boolean;\n}\n\n/**\n * SwapPluginModal component props.\n */\nexport interface SwapPluginModalProps {\n  /** Whether the modal is open */\n  isOpen: boolean;\n  /** Callback when modal should close */\n  onClose: () => void;\n  /** Slot to swap plugin for */\n  slot: SwapSlotInfo;\n  /** Available plugins for this slot */\n  availablePlugins: SwapPluginInfo[];\n  /** Callback when plugin is swapped */\n  onSwap: (slotId: string, newPluginId: string) => Promise<SwapResult>;\n  /** Callback when rollback is requested */\n  onRollback?: (slotId: string) => Promise<boolean>;\n  /** Whether swap is in progress */\n  isSwapping?: boolean;\n}\n\n/**\n * Close icon.\n */\nconst CloseIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Swap icon.\n */\nconst SwapIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"17 1 21 5 17 9\" />\n    <path d=\"M3 11V9a4 4 0 0 1 4-4h14\" />\n    <polyline points=\"7 23 3 19 7 15\" />\n    <path d=\"M21 13v2a4 4 0 0 1-4 4H3\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Check circle icon.\n */\nconst CheckCircleIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" />\n    <polyline points=\"22 4 12 14.01 9 11.01\" />\n  </svg>\n);\n\n/**\n * Alert icon.\n */\nconst AlertIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" />\n    <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\" />\n  </svg>\n);\n\n/**\n * Undo icon.\n */\nconst UndoIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M3 7v6h6\" />\n    <path d=\"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13\" />\n  </svg>\n);\n\n/**\n * Search icon.\n */\nconst SearchIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n  </svg>\n);\n\n/**\n * Info icon.\n */\nconst InfoIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\" />\n    <line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" />\n  </svg>\n);\n\n/**\n * Status colors.\n */\nconst statusColors: Record<SwapPluginInfo[\"status\"], string> = {\n  loaded: \"bg-success-500\",\n  unloaded: \"bg-neutral-400\",\n  loading: \"bg-warning-500 animate-pulse\",\n  error: \"bg-error-500\",\n};\n\n/**\n * Status labels.\n */\nconst statusLabels: Record<SwapPluginInfo[\"status\"], string> = {\n  loaded: \"Loaded\",\n  unloaded: \"Not Loaded\",\n  loading: \"Loading\",\n  error: \"Error\",\n};\n\n/**\n * SwapPluginModal component.\n *\n * Modal for hot-swapping plugins in a slot with compatibility checking\n * and rollback support.\n *\n * @example\n * ```tsx\n * <SwapPluginModal\n *   isOpen={isOpen}\n *   onClose={() => setIsOpen(false)}\n *   slot={selectedSlot}\n *   availablePlugins={compatiblePlugins}\n *   onSwap={async (slotId, pluginId) => {\n *     const result = await swapPlugin(slotId, pluginId);\n *     return result;\n *   }}\n *   onRollback={async (slotId) => {\n *     return await rollbackSwap(slotId);\n *   }}\n * />\n * ```\n */\nexport const SwapPluginModal: React.FC<SwapPluginModalProps> = ({\n  isOpen,\n  onClose,\n  slot,\n  availablePlugins,\n  onSwap,\n  onRollback,\n  isSwapping: externalIsSwapping = false,\n}) => {\n  // Search query\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  // Selected plugin\n  const [selectedPluginId, setSelectedPluginId] = useState<string | null>(null);\n\n  // Swap state\n  const [isSwapping, setIsSwapping] = useState(false);\n  const [swapResult, setSwapResult] = useState<SwapResult | null>(null);\n\n  // Show details panel\n  const [showDetails, setShowDetails] = useState<string | null>(null);\n\n  // Reset state when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setSearchQuery(\"\");\n      setSelectedPluginId(null);\n      setSwapResult(null);\n      setShowDetails(null);\n    }\n  }, [isOpen]);\n\n  // Filter plugins\n  const filteredPlugins = useMemo(() => {\n    if (!searchQuery.trim()) return availablePlugins;\n\n    const query = searchQuery.toLowerCase();\n    return availablePlugins.filter(\n      (p) =>\n        p.name.toLowerCase().includes(query) ||\n        p.displayName.toLowerCase().includes(query) ||\n        p.description?.toLowerCase().includes(query)\n    );\n  }, [availablePlugins, searchQuery]);\n\n  // Sort plugins: compatible first, then by status, then by name\n  const sortedPlugins = useMemo(() => {\n    return [...filteredPlugins].sort((a, b) => {\n      // Compatible first\n      if (a.isCompatible !== b.isCompatible) {\n        return a.isCompatible ? -1 : 1;\n      }\n      // Loaded first\n      if (a.status !== b.status) {\n        const statusOrder = { loaded: 0, loading: 1, unloaded: 2, error: 3 };\n        return statusOrder[a.status] - statusOrder[b.status];\n      }\n      // Then by name\n      return a.displayName.localeCompare(b.displayName);\n    });\n  }, [filteredPlugins]);\n\n  // Selected plugin details\n  const selectedPlugin = useMemo(\n    () => availablePlugins.find((p) => p.id === selectedPluginId),\n    [availablePlugins, selectedPluginId]\n  );\n\n  // Handle swap\n  const handleSwap = useCallback(async () => {\n    if (!selectedPluginId) return;\n\n    setIsSwapping(true);\n    setSwapResult(null);\n\n    try {\n      const result = await onSwap(slot.id, selectedPluginId);\n      setSwapResult(result);\n\n      if (result.success) {\n        // Auto-close after successful swap\n        setTimeout(() => {\n          onClose();\n        }, 1500);\n      }\n    } catch (error) {\n      setSwapResult({\n        success: false,\n        newPluginId: selectedPluginId,\n        error: error instanceof Error ? error.message : \"Unknown error occurred\",\n      });\n    } finally {\n      setIsSwapping(false);\n    }\n  }, [selectedPluginId, slot.id, onSwap, onClose]);\n\n  // Handle rollback\n  const handleRollback = useCallback(async () => {\n    if (!onRollback || !swapResult?.rollbackAvailable) return;\n\n    setIsSwapping(true);\n\n    try {\n      const success = await onRollback(slot.id);\n      if (success) {\n        setSwapResult(null);\n        setSelectedPluginId(null);\n      }\n    } finally {\n      setIsSwapping(false);\n    }\n  }, [onRollback, swapResult, slot.id]);\n\n  // Handle close\n  const handleClose = useCallback(() => {\n    if (!isSwapping && !externalIsSwapping) {\n      onClose();\n    }\n  }, [isSwapping, externalIsSwapping, onClose]);\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\" && !isSwapping && !externalIsSwapping) {\n        handleClose();\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleEscape);\n    return () => document.removeEventListener(\"keydown\", handleEscape);\n  }, [isOpen, isSwapping, externalIsSwapping, handleClose]);\n\n  // Prevent body scroll\n  useEffect(() => {\n    if (isOpen) {\n      const originalOverflow = document.body.style.overflow;\n      document.body.style.overflow = \"hidden\";\n      return () => {\n        document.body.style.overflow = originalOverflow;\n      };\n    }\n  }, [isOpen]);\n\n  if (!isOpen) return null;\n\n  const modalContent = (\n    <div\n      className={[\n        \"fixed\",\n        \"inset-0\",\n        \"z-modal\",\n        \"flex\",\n        \"items-center\",\n        \"justify-center\",\n        \"p-4\",\n        \"bg-black/50\",\n        \"backdrop-blur-sm\",\n      ].join(\" \")}\n      onClick={handleClose}\n    >\n      <div\n        className={[\n          \"w-full\",\n          \"max-w-2xl\",\n          \"bg-white\",\n          \"rounded-lg\",\n          \"shadow-xl\",\n          \"overflow-hidden\",\n          \"flex\",\n          \"flex-col\",\n          \"max-h-[80vh]\",\n        ].join(\" \")}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-neutral-200 shrink-0\">\n          <div>\n            <h2 className=\"text-lg font-semibold text-neutral-900\">\n              Swap Plugin\n            </h2>\n            <p className=\"text-sm text-neutral-500\">\n              Select a plugin to swap into <span className=\"font-medium\">{slot.name}</span>\n            </p>\n          </div>\n          <button\n            type=\"button\"\n            onClick={handleClose}\n            disabled={isSwapping || externalIsSwapping}\n            className={[\n              \"p-1\",\n              \"rounded-md\",\n              \"text-neutral-400\",\n              \"hover:text-neutral-600\",\n              \"hover:bg-neutral-100\",\n              \"disabled:opacity-50\",\n              \"transition-colors\",\n              \"duration-150\",\n            ].join(\" \")}\n          >\n            <CloseIcon className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        {/* Current plugin info */}\n        {slot.currentPluginId && (\n          <div className=\"px-6 py-3 bg-neutral-50 border-b border-neutral-200 shrink-0\">\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-xs font-medium text-neutral-500 uppercase\">\n                Current:\n              </span>\n              <span className=\"text-sm font-medium text-neutral-900\">\n                {slot.currentPluginName}\n              </span>\n              <span className=\"text-xs text-neutral-400\">\n                v{slot.currentPluginVersion}\n              </span>\n            </div>\n          </div>\n        )}\n\n        {/* Search */}\n        <div className=\"px-6 py-3 border-b border-neutral-100 shrink-0\">\n          <div className=\"relative\">\n            <SearchIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\" />\n            <input\n              type=\"text\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              placeholder=\"Search plugins...\"\n              disabled={isSwapping}\n              className={[\n                \"w-full\",\n                \"pl-10\",\n                \"pr-4\",\n                \"py-2\",\n                \"text-sm\",\n                \"bg-white\",\n                \"border\",\n                \"border-neutral-300\",\n                \"rounded-md\",\n                \"focus:outline-none\",\n                \"focus:ring-2\",\n                \"focus:ring-primary-500\",\n                \"disabled:bg-neutral-50\",\n              ].join(\" \")}\n            />\n          </div>\n        </div>\n\n        {/* Plugin list */}\n        <div className=\"flex-1 overflow-y-auto\">\n          {sortedPlugins.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center p-12 text-center\">\n              <InfoIcon className=\"h-12 w-12 text-neutral-300 mb-4\" />\n              <p className=\"text-sm text-neutral-500\">\n                {searchQuery\n                  ? \"No plugins match your search\"\n                  : \"No compatible plugins available\"}\n              </p>\n            </div>\n          ) : (\n            <ul className=\"divide-y divide-neutral-100\">\n              {sortedPlugins.map((plugin) => {\n                const isSelected = selectedPluginId === plugin.id;\n                const isCurrent = plugin.id === slot.currentPluginId;\n                const canSelect = plugin.isCompatible && plugin.status === \"loaded\" && !isCurrent;\n\n                return (\n                  <li key={plugin.id}>\n                    <button\n                      type=\"button\"\n                      onClick={() => canSelect && setSelectedPluginId(plugin.id)}\n                      disabled={!canSelect || isSwapping}\n                      className={[\n                        \"w-full\",\n                        \"p-4\",\n                        \"text-left\",\n                        \"transition-colors\",\n                        \"duration-150\",\n                        isSelected\n                          ? \"bg-primary-50\"\n                          : canSelect\n                            ? \"hover:bg-neutral-50\"\n                            : \"\",\n                        !canSelect && \"opacity-60 cursor-not-allowed\",\n                      ].join(\" \")}\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        {/* Selection indicator */}\n                        <div\n                          className={[\n                            \"flex\",\n                            \"items-center\",\n                            \"justify-center\",\n                            \"h-5\",\n                            \"w-5\",\n                            \"rounded-full\",\n                            \"border-2\",\n                            \"shrink-0\",\n                            \"mt-0.5\",\n                            isSelected\n                              ? \"border-primary-500 bg-primary-500\"\n                              : \"border-neutral-300\",\n                          ].join(\" \")}\n                        >\n                          {isSelected && <CheckIcon className=\"h-3 w-3 text-white\" />}\n                        </div>\n\n                        {/* Plugin info */}\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2\">\n                            <h4 className=\"text-sm font-medium text-neutral-900 truncate\">\n                              {plugin.displayName}\n                            </h4>\n                            <span className=\"text-xs text-neutral-400\">\n                              v{plugin.version}\n                            </span>\n                            {isCurrent && (\n                              <span className=\"px-1.5 py-0.5 text-xs font-medium bg-info-50 text-info-700 rounded\">\n                                Current\n                              </span>\n                            )}\n                          </div>\n\n                          {plugin.description && (\n                            <p className=\"mt-0.5 text-xs text-neutral-500 line-clamp-2\">\n                              {plugin.description}\n                            </p>\n                          )}\n\n                          {!plugin.isCompatible && plugin.incompatibilityReason && (\n                            <p className=\"mt-1 text-xs text-error-600 flex items-center gap-1\">\n                              <AlertIcon className=\"h-3 w-3\" />\n                              {plugin.incompatibilityReason}\n                            </p>\n                          )}\n\n                          {plugin.features && plugin.features.length > 0 && (\n                            <div className=\"mt-2 flex flex-wrap gap-1\">\n                              {plugin.features.slice(0, 3).map((feature) => (\n                                <span\n                                  key={feature}\n                                  className=\"px-1.5 py-0.5 text-xs bg-neutral-100 text-neutral-600 rounded\"\n                                >\n                                  {feature}\n                                </span>\n                              ))}\n                              {plugin.features.length > 3 && (\n                                <span className=\"text-xs text-neutral-400\">\n                                  +{plugin.features.length - 3} more\n                                </span>\n                              )}\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Status indicator */}\n                        <div className=\"flex flex-col items-end gap-1 shrink-0\">\n                          <span\n                            className={[\n                              \"h-2\",\n                              \"w-2\",\n                              \"rounded-full\",\n                              statusColors[plugin.status],\n                            ].join(\" \")}\n                            title={statusLabels[plugin.status]}\n                          />\n                          <span className=\"text-xs text-neutral-400\">\n                            {statusLabels[plugin.status]}\n                          </span>\n                        </div>\n                      </div>\n                    </button>\n                  </li>\n                );\n              })}\n            </ul>\n          )}\n        </div>\n\n        {/* Result message */}\n        {swapResult && (\n          <div\n            className={[\n              \"px-6\",\n              \"py-3\",\n              \"border-t\",\n              \"shrink-0\",\n              swapResult.success\n                ? \"bg-success-50 border-success-200\"\n                : \"bg-error-50 border-error-200\",\n            ].join(\" \")}\n          >\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                {swapResult.success ? (\n                  <CheckCircleIcon className=\"h-5 w-5 text-success-600\" />\n                ) : (\n                  <AlertIcon className=\"h-5 w-5 text-error-600\" />\n                )}\n                <p\n                  className={[\n                    \"text-sm\",\n                    \"font-medium\",\n                    swapResult.success ? \"text-success-700\" : \"text-error-700\",\n                  ].join(\" \")}\n                >\n                  {swapResult.success\n                    ? \"Plugin swapped successfully!\"\n                    : swapResult.error || \"Failed to swap plugin\"}\n                </p>\n              </div>\n\n              {swapResult.rollbackAvailable && onRollback && (\n                <button\n                  type=\"button\"\n                  onClick={handleRollback}\n                  disabled={isSwapping}\n                  className={[\n                    \"inline-flex\",\n                    \"items-center\",\n                    \"gap-1\",\n                    \"px-3\",\n                    \"py-1.5\",\n                    \"text-sm\",\n                    \"font-medium\",\n                    \"text-neutral-700\",\n                    \"bg-white\",\n                    \"border\",\n                    \"border-neutral-300\",\n                    \"rounded-md\",\n                    \"hover:bg-neutral-50\",\n                    \"disabled:opacity-50\",\n                  ].join(\" \")}\n                >\n                  <UndoIcon className=\"h-4 w-4\" />\n                  Rollback\n                </button>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-t border-neutral-200 bg-neutral-50 shrink-0\">\n          <div className=\"text-xs text-neutral-500\">\n            {sortedPlugins.length} plugin{sortedPlugins.length === 1 ? \"\" : \"s\"} available\n            {slot.isRequired && (\n              <span className=\"ml-2 text-error-500\">\n                This slot is required\n              </span>\n            )}\n          </div>\n\n          <div className=\"flex items-center gap-3\">\n            <button\n              type=\"button\"\n              onClick={handleClose}\n              disabled={isSwapping || externalIsSwapping}\n              className={[\n                \"px-4\",\n                \"py-2\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-neutral-700\",\n                \"bg-white\",\n                \"border\",\n                \"border-neutral-300\",\n                \"rounded-md\",\n                \"hover:bg-neutral-50\",\n                \"disabled:opacity-50\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              Cancel\n            </button>\n\n            <button\n              type=\"button\"\n              onClick={handleSwap}\n              disabled={!selectedPluginId || isSwapping || externalIsSwapping || !!swapResult}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"gap-2\",\n                \"px-4\",\n                \"py-2\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-white\",\n                \"bg-primary-600\",\n                \"rounded-md\",\n                \"hover:bg-primary-700\",\n                \"disabled:opacity-50\",\n                \"disabled:cursor-not-allowed\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              {isSwapping || externalIsSwapping ? (\n                <>\n                  <div className=\"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                  Swapping...\n                </>\n              ) : (\n                <>\n                  <SwapIcon className=\"h-4 w-4\" />\n                  Swap Plugin\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  return createPortal(modalContent, document.body);\n};\n\nSwapPluginModal.displayName = \"SwapPluginModal\";\n\nexport default SwapPluginModal;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\project\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\templates\\TemplateBrowser.tsx","messages":[{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":146,"column":55,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":146,"endColumn":67},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":178,"column":20,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":178,"endColumn":30},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":179,"column":13,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":179,"endColumn":25},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":182,"column":13,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":182,"endColumn":25},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":189,"column":24,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":189,"endColumn":40},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":189,"column":37,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":189,"endColumn":39,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[7239,7241],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":190,"column":24,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":190,"endColumn":40},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":190,"column":37,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":190,"endColumn":39,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[7286,7288],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":191,"column":28,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":191,"endColumn":48},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":191,"column":41,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":191,"endColumn":43,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[7337,7339],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":192,"column":29,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":192,"endColumn":50},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":192,"column":42,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":192,"endColumn":44,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[7395,7397],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":254,"column":23,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":254,"endColumn":36},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":290,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":290,"endColumn":28,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[11624,11624],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[11624,11624],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":334,"column":24,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":334,"endColumn":40},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":334,"column":37,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":334,"endColumn":39,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[13376,13378],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":335,"column":24,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":335,"endColumn":40},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":335,"column":37,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":335,"endColumn":39,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[13425,13427],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":336,"column":28,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":336,"endColumn":48},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":336,"column":41,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":336,"endColumn":43,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[13478,13480],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, expected left-hand side of `??` operator to be possibly null or undefined.","line":337,"column":29,"nodeType":"ChainExpression","messageId":"neverNullish","endLine":337,"endColumn":50},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":337,"column":42,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":337,"endColumn":44,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[13536,13538],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":445,"column":42,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":445,"endColumn":75}],"suppressedMessages":[],"errorCount":23,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * src/components/templates/TemplateBrowser.tsx\r\n * =============================================\r\n * Template browser component for loading pre-built and user-saved templates.\r\n * \r\n * Implements EUR-1.1.10 (template browser with thumbnails) and\r\n * EUR-1.1.10a (save as template button).\r\n */\r\n\r\nimport React, { useState, useCallback, useEffect } from \"react\";\r\nimport { Modal } from \"../ui/Modal\";\r\nimport { Input } from \"../ui/Input\";\r\nimport { Button } from \"../ui/Button\";\r\nimport { layoutTemplates, type LayoutTemplate } from \"./layoutTemplates\";\r\nimport { useTemplateStore, useFilteredTemplates, type FETemplate } from \"../../stores/templateStore\";\r\nimport { TemplatePreview } from \"./TemplatePreview\";\r\nimport type { CanvasElement } from \"../factory/canvasTypes\";\r\n\r\n// =============================================================================\r\n// TYPES\r\n// =============================================================================\r\n\r\n/** Info about the loaded template */\r\ninterface TemplateInfo {\r\n    name: string;\r\n    id: string;\r\n}\r\n\r\ninterface TemplateBrowserProps {\r\n    /** Called when a template is loaded */\r\n    onLoadTemplate: (\r\n        elements: CanvasElement[],\r\n        windowSize?: { width: number; height: number },\r\n        templateInfo?: TemplateInfo\r\n    ) => void;\r\n    /** Called when save as template is clicked */\r\n    onSaveAsTemplate?: () => void;\r\n    /** Additional CSS classes */\r\n    className?: string;\r\n}\r\n\r\ninterface SaveTemplateModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onSave: (name: string, description: string, tags: string[]) => Promise<void>;\r\n    isSaving: boolean;\r\n}\r\n\r\n// =============================================================================\r\n// ICONS\r\n// =============================================================================\r\n\r\nconst SearchIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n        <circle cx=\"11\" cy=\"11\" r=\"8\" />\r\n        <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\r\n    </svg>\r\n);\r\n\r\nconst TemplateIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n        <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\r\n        <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\r\n        <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\r\n        <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\r\n    </svg>\r\n);\r\n\r\nconst PlusIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n        <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\r\n        <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\r\n    </svg>\r\n);\r\n\r\nconst TrashIcon: React.FC<{ className?: string }> = ({ className }) => (\r\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n        <polyline points=\"3 6 5 6 21 6\" />\r\n        <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\r\n    </svg>\r\n);\r\n\r\n// =============================================================================\r\n// SAVE TEMPLATE MODAL\r\n// =============================================================================\r\n\r\nconst SaveTemplateModal: React.FC<SaveTemplateModalProps> = ({\r\n    isOpen,\r\n    onClose,\r\n    onSave,\r\n    isSaving,\r\n}) => {\r\n    const [name, setName] = useState(\"\");\r\n    const [description, setDescription] = useState(\"\");\r\n    const [tagsInput, setTagsInput] = useState(\"\");\r\n\r\n    const handleSave = async () => {\r\n        if (!name.trim()) return;\r\n        const tags = tagsInput.split(\",\").map((t) => t.trim()).filter(Boolean);\r\n        await onSave(name, description, tags);\r\n        setName(\"\");\r\n        setDescription(\"\");\r\n        setTagsInput(\"\");\r\n        onClose();\r\n    };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"Save as Template\" size=\"md\">\r\n            <div className=\"space-y-4\">\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                        Template Name *\r\n                    </label>\r\n                    <Input\r\n                        value={name}\r\n                        onChange={(e) => setName(e.target.value)}\r\n                        placeholder=\"e.g., My Chat Layout\"\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                        Description\r\n                    </label>\r\n                    <textarea\r\n                        value={description}\r\n                        onChange={(e) => setDescription(e.target.value)}\r\n                        placeholder=\"Describe your template...\"\r\n                        className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none\"\r\n                        rows={3}\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                        Tags (comma separated)\r\n                    </label>\r\n                    <Input\r\n                        value={tagsInput}\r\n                        onChange={(e) => setTagsInput(e.target.value)}\r\n                        placeholder=\"e.g., chat, sidebar, dark\"\r\n                    />\r\n                </div>\r\n                <div className=\"flex justify-end gap-3 pt-2\">\r\n                    <Button variant=\"secondary\" onClick={onClose} disabled={isSaving}>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button variant=\"primary\" onClick={handleSave} disabled={!name.trim() || isSaving}>\r\n                        {isSaving ? \"Saving...\" : \"Save Template\"}\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n\r\n// =============================================================================\r\n// TEMPLATE CARD\r\n// =============================================================================\r\n\r\ninterface TemplateCardProps {\r\n    template: LayoutTemplate | FETemplate;\r\n    isPrebuilt: boolean;\r\n    onLoad: () => void;\r\n    onDelete?: () => void;\r\n}\r\n\r\nconst TemplateCard: React.FC<TemplateCardProps> = ({\r\n    template,\r\n    isPrebuilt,\r\n    onLoad,\r\n    onDelete,\r\n}) => {\r\n    // Prepare data for preview\r\n    let elements: CanvasElement[] = [];\r\n    let windowSize = { width: 1920, height: 1080 };\r\n\r\n    if (isPrebuilt) {\r\n        const t = template as LayoutTemplate;\r\n        elements = t.elements || [];\r\n        if (t.windowSize) windowSize = t.windowSize;\r\n    } else {\r\n        const t = template as FETemplate;\r\n        if (t.components) {\r\n            elements = Object.values(t.components).map((comp) => ({\r\n                id: comp.id,\r\n                type: \"component\",\r\n                name: comp.name,\r\n                componentId: comp.type,\r\n                bounds: {\r\n                    x: comp.position?.x ?? 0,\r\n                    y: comp.position?.y ?? 0,\r\n                    width: comp.position?.width ?? 200,\r\n                    height: comp.position?.height ?? 100,\r\n                },\r\n                props: comp.props,\r\n                visible: true,\r\n                zIndex: 1, // Default zIndex\r\n            }));\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"group relative bg-white border border-neutral-200 rounded-xl overflow-hidden hover:border-primary-300 hover:shadow-md transition-all duration-200 cursor-default\" title={template.description}>\r\n            {/* Preview Area */}\r\n            <div className=\"h-32 bg-neutral-100 flex items-center justify-center relative overflow-hidden\">\r\n                <TemplatePreview\r\n                    elements={elements}\r\n                    windowSize={windowSize}\r\n                    containerHeight={128} // Matches h-32\r\n                />\r\n\r\n                {/* Hover Overlay */}\r\n                <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100 z-10\">\r\n                    <button\r\n                        onClick={onLoad}\r\n                        className=\"px-4 py-2 bg-white text-neutral-900 rounded-lg text-sm font-medium shadow-lg hover:bg-neutral-50 transition-colors transform translate-y-2 group-hover:translate-y-0 duration-200\"\r\n                    >\r\n                        Load Template\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Info */}\r\n            <div className=\"p-3\">\r\n                <div className=\"flex items-start justify-between gap-2\">\r\n                    <div className=\"min-w-0 flex-1\">\r\n                        <h4 className=\"font-medium text-sm text-neutral-900 truncate\">\r\n                            {template.name}\r\n                        </h4>\r\n                        <p className=\"text-xs text-neutral-500 mt-0.5 line-clamp-2\">\r\n                            {template.description}\r\n                        </p>\r\n                    </div>\r\n                    {!isPrebuilt && onDelete && (\r\n                        <button\r\n                            onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                onDelete();\r\n                            }}\r\n                            className=\"p-1.5 text-neutral-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors\"\r\n                            title=\"Delete template\"\r\n                        >\r\n                            <TrashIcon className=\"h-4 w-4\" />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Tags */}\r\n                <div className=\"flex flex-wrap gap-1 mt-2\">\r\n                    {isPrebuilt && (\r\n                        <span className=\"px-1.5 py-0.5 bg-primary-50 text-primary-600 text-[10px] font-medium rounded\">\r\n                            Built-in\r\n                        </span>\r\n                    )}\r\n                    {(template.tags || []).slice(0, 2).map((tag) => (\r\n                        <span\r\n                            key={tag}\r\n                            className=\"px-1.5 py-0.5 bg-neutral-100 text-neutral-500 text-[10px] rounded\"\r\n                        >\r\n                            {tag}\r\n                        </span>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// =============================================================================\r\n// TEMPLATE BROWSER COMPONENT\r\n// =============================================================================\r\n\r\n/**\r\n * Template browser for loading and managing FE UI templates.\r\n */\r\nexport const TemplateBrowser: React.FC<TemplateBrowserProps> = ({\r\n    onLoadTemplate,\r\n    onSaveAsTemplate,\r\n    className = \"\",\r\n}) => {\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [activeTab, setActiveTab] = useState<\"prebuilt\" | \"saved\">(\"prebuilt\");\r\n    const [showSaveModal, setShowSaveModal] = useState(false);\r\n\r\n    // User-saved templates from store\r\n    const userTemplates = useFilteredTemplates();\r\n    const { saveAsTemplate, deleteTemplate, refreshTemplates, isSaving } = useTemplateStore();\r\n\r\n    // Refresh templates on mount\r\n    useEffect(() => {\r\n        refreshTemplates();\r\n    }, [refreshTemplates]);\r\n\r\n    // Filter pre-built templates by search\r\n    const filteredPrebuilt = searchQuery\r\n        ? layoutTemplates.filter(\r\n            (t) =>\r\n                t.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                t.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                t.tags.some((tag) => tag.toLowerCase().includes(searchQuery.toLowerCase()))\r\n        )\r\n        : layoutTemplates;\r\n\r\n    // Filter user templates by search\r\n    const filteredUser = searchQuery\r\n        ? userTemplates.filter(\r\n            (t) =>\r\n                t.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                t.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                t.tags.some((tag) => tag.toLowerCase().includes(searchQuery.toLowerCase()))\r\n        )\r\n        : userTemplates;\r\n\r\n    // Handle loading a pre-built template\r\n    const handleLoadPrebuilt = useCallback(\r\n        (template: LayoutTemplate) => {\r\n            onLoadTemplate(template.elements, template.windowSize, {\r\n                name: template.name,\r\n                id: template.id,\r\n            });\r\n        },\r\n        [onLoadTemplate]\r\n    );\r\n\r\n    // Handle loading a user-saved template\r\n    const handleLoadUserTemplate = useCallback(\r\n        (template: FETemplate) => {\r\n            // Convert user template components to canvas elements\r\n            const elements: CanvasElement[] = Object.values(template.components).map((comp) => ({\r\n                id: comp.id,\r\n                type: \"component\",\r\n                name: comp.name,\r\n                componentId: comp.type,\r\n                bounds: {\r\n                    x: comp.position?.x ?? 100,\r\n                    y: comp.position?.y ?? 100,\r\n                    width: comp.position?.width ?? 200,\r\n                    height: comp.position?.height ?? 100,\r\n                },\r\n                zIndex: 1,\r\n                props: comp.props,\r\n            }));\r\n            onLoadTemplate(elements, undefined, {\r\n                name: template.name,\r\n                id: template.id,\r\n            });\r\n        },\r\n        [onLoadTemplate]\r\n    );\r\n\r\n    // Handle saving current layout as template\r\n    const handleSaveTemplate = useCallback(\r\n        async (name: string, description: string, tags: string[]) => {\r\n            await saveAsTemplate(name, description, tags);\r\n        },\r\n        [saveAsTemplate]\r\n    );\r\n\r\n    // Handle delete\r\n    const handleDelete = useCallback(\r\n        async (templateId: string) => {\r\n            if (window.confirm(\"Are you sure you want to delete this template?\")) {\r\n                await deleteTemplate(templateId);\r\n            }\r\n        },\r\n        [deleteTemplate]\r\n    );\r\n\r\n    return (\r\n        <div className={`flex flex-col h-full ${className}`}>\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n                <h3 className=\"font-semibold text-neutral-900\">Templates</h3>\r\n                {onSaveAsTemplate && (\r\n                    <button\r\n                        onClick={() => setShowSaveModal(true)}\r\n                        className=\"flex items-center gap-1 px-2 py-1 text-xs font-medium text-primary-600 hover:text-primary-700 hover:bg-primary-50 rounded transition-colors\"\r\n                    >\r\n                        <PlusIcon className=\"h-3.5 w-3.5\" />\r\n                        Save Current\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            {/* Search */}\r\n            <div className=\"relative mb-3\">\r\n                <SearchIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\" />\r\n                <input\r\n                    type=\"text\"\r\n                    value={searchQuery}\r\n                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                    placeholder=\"Search templates...\"\r\n                    className=\"w-full pl-9 pr-3 py-2 text-sm border border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\r\n                />\r\n            </div>\r\n\r\n            {/* Tabs */}\r\n            <div className=\"flex gap-1 mb-3 bg-neutral-100 p-1 rounded-lg\">\r\n                <button\r\n                    onClick={() => setActiveTab(\"prebuilt\")}\r\n                    className={`flex-1 py-1.5 px-3 text-xs font-medium rounded-md transition-colors ${activeTab === \"prebuilt\"\r\n                        ? \"bg-white text-neutral-900 shadow-sm\"\r\n                        : \"text-neutral-600 hover:text-neutral-900\"\r\n                        }`}\r\n                >\r\n                    Pre-built ({filteredPrebuilt.length})\r\n                </button>\r\n                <button\r\n                    onClick={() => setActiveTab(\"saved\")}\r\n                    className={`flex-1 py-1.5 px-3 text-xs font-medium rounded-md transition-colors ${activeTab === \"saved\"\r\n                        ? \"bg-white text-neutral-900 shadow-sm\"\r\n                        : \"text-neutral-600 hover:text-neutral-900\"\r\n                        }`}\r\n                >\r\n                    My Templates ({filteredUser.length})\r\n                </button>\r\n            </div>\r\n\r\n            {/* Template Grid */}\r\n            <div className=\"flex-1 overflow-auto\">\r\n                {activeTab === \"prebuilt\" ? (\r\n                    filteredPrebuilt.length > 0 ? (\r\n                        <div className=\"grid grid-cols-1 gap-3\">\r\n                            {filteredPrebuilt.map((template) => (\r\n                                <TemplateCard\r\n                                    key={template.id}\r\n                                    template={template}\r\n                                    isPrebuilt={true}\r\n                                    onLoad={() => handleLoadPrebuilt(template)}\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"text-center py-8 text-neutral-500 text-sm\">\r\n                            No templates found\r\n                        </div>\r\n                    )\r\n                ) : filteredUser.length > 0 ? (\r\n                    <div className=\"grid grid-cols-1 gap-3\">\r\n                        {filteredUser.map((template) => (\r\n                            <TemplateCard\r\n                                key={template.id}\r\n                                template={template}\r\n                                isPrebuilt={false}\r\n                                onLoad={() => handleLoadUserTemplate(template)}\r\n                                onDelete={() => handleDelete(template.id)}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"text-center py-8\">\r\n                        <TemplateIcon className=\"h-10 w-10 text-neutral-300 mx-auto mb-2\" />\r\n                        <p className=\"text-sm text-neutral-500\">No saved templates yet</p>\r\n                        <p className=\"text-xs text-neutral-400 mt-1\">\r\n                            Save your current layout to reuse it later\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Save Template Modal */}\r\n            <SaveTemplateModal\r\n                isOpen={showSaveModal}\r\n                onClose={() => setShowSaveModal(false)}\r\n                onSave={handleSaveTemplate}\r\n                isSaving={isSaving}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nTemplateBrowser.displayName = \"TemplateBrowser\";\r\n\r\nexport default TemplateBrowser;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\templates\\TemplatePreview.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":62,"column":44,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":62,"endColumn":46,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[2136,2138],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":67,"column":54,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":67,"endColumn":56,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[2324,2326],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":89,"column":63,"nodeType":"Identifier","messageId":"invalidType","endLine":89,"endColumn":68}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * src/components/templates/TemplatePreview.tsx\r\n * ============================================\r\n * Renders a scaled-down live preview of a template for the thumbnail view.\r\n */\r\n\r\nimport React from \"react\";\r\nimport { TemplateComponentRenderer } from \"../factory/TemplateComponentRenderer\";\r\nimport type { CanvasElement } from \"../factory/canvasTypes\";\r\n\r\ninterface TemplatePreviewProps {\r\n    elements: CanvasElement[];\r\n    windowSize: { width: number; height: number };\r\n    containerWidth?: number;\r\n    containerHeight?: number;\r\n}\r\n\r\nexport const TemplatePreview: React.FC<TemplatePreviewProps> = ({\r\n    elements,\r\n    windowSize,\r\n}) => {\r\n    const containerRef = React.useRef<HTMLDivElement>(null);\r\n    const [scale, setScale] = React.useState(0.1);\r\n\r\n    React.useEffect(() => {\r\n        const updateScale = () => {\r\n            if (!containerRef.current) return;\r\n\r\n            const { width: containerWidth, height: containerHeight } = containerRef.current.getBoundingClientRect();\r\n            const scaleX = containerWidth / windowSize.width;\r\n            const scaleY = containerHeight / windowSize.height;\r\n\r\n            // Use 90% of the available space to leave some margins\r\n            setScale(Math.min(scaleX, scaleY) * 0.9);\r\n        };\r\n\r\n        // Initial calculation\r\n        updateScale();\r\n\r\n        // Observe resizing\r\n        const observer = new ResizeObserver(updateScale);\r\n        if (containerRef.current) {\r\n            observer.observe(containerRef.current);\r\n        }\r\n\r\n        return () => observer.disconnect();\r\n    }, [windowSize]);\r\n\r\n    // Recursively render elements\r\n    const renderElement = (element: CanvasElement) => {\r\n        if (!element.visible && element.visible !== undefined) return null;\r\n\r\n        return (\r\n            <div\r\n                key={element.id}\r\n                style={{\r\n                    position: \"absolute\",\r\n                    left: element.bounds.x,\r\n                    top: element.bounds.y,\r\n                    width: element.bounds.width,\r\n                    height: element.bounds.height,\r\n                    zIndex: element.zIndex || 1,\r\n                }}\r\n                className=\"pointer-events-none\"\r\n            >\r\n                <TemplateComponentRenderer\r\n                    componentId={element.componentId || \"container\"}\r\n                    props={element.props}\r\n                    bounds={element.bounds}\r\n                />\r\n                {element.children?.map(renderElement)}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div\r\n            ref={containerRef}\r\n            className=\"w-full h-full bg-neutral-100 overflow-hidden relative\"\r\n            style={{ isolation: 'isolate' }}\r\n        >\r\n            <div\r\n                style={{\r\n                    width: windowSize.width,\r\n                    height: windowSize.height,\r\n                    position: \"absolute\",\r\n                    left: \"50%\",\r\n                    top: \"50%\",\r\n                    transform: `translate(-50%, -50%) scale(${scale})`,\r\n                    transformOrigin: \"center center\",\r\n                    backgroundColor: \"#fff\", // App background\r\n                    boxShadow: \"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)\",\r\n                }}\r\n            >\r\n                {elements.map(renderElement)}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\templates\\layoutTemplates.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\testing\\HealthDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'statusBorderColors' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":229,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":229,"endColumn":25},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":262,"column":31,"nodeType":"Identifier","messageId":"invalidType","endLine":262,"endColumn":38},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":263,"column":33,"nodeType":"CallExpression","messageId":"invalidType","endLine":263,"endColumn":57},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":264,"column":34,"nodeType":"CallExpression","messageId":"invalidType","endLine":264,"endColumn":60},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":264,"column":65,"nodeType":"CallExpression","messageId":"invalidType","endLine":264,"endColumn":98},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":265,"column":13,"nodeType":"CallExpression","messageId":"invalidType","endLine":265,"endColumn":40},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":265,"column":45,"nodeType":"CallExpression","messageId":"invalidType","endLine":265,"endColumn":81},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":272,"column":31,"nodeType":"Identifier","messageId":"invalidType","endLine":272,"endColumn":36},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":284,"column":31,"nodeType":"Identifier","messageId":"invalidType","endLine":284,"endColumn":38},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":285,"column":33,"nodeType":"CallExpression","messageId":"invalidType","endLine":285,"endColumn":57},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":286,"column":13,"nodeType":"CallExpression","messageId":"invalidType","endLine":286,"endColumn":39},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":544,"column":35,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":544,"endColumn":100},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":550,"column":35,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":550,"endColumn":101},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":556,"column":35,"nodeType":"BinaryExpression","messageId":"invalidType","endLine":556,"endColumn":102},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":664,"column":22,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":664,"endColumn":38}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D059 - src/components/testing/HealthDashboard.tsx\n * ==================================================\n * Health status dashboard for monitoring plugin system health.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D014 (Panel.tsx), D057 (PluginTester.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Health status levels.\n */\nexport type HealthStatus = \"healthy\" | \"degraded\" | \"unhealthy\" | \"unknown\";\n\n/**\n * Plugin health info.\n */\nexport interface PluginHealth {\n  id: string;\n  name: string;\n  displayName: string;\n  contract: string;\n  status: HealthStatus;\n  lastCheck: Date;\n  uptime?: number;\n  responseTime?: number;\n  memoryUsage?: number;\n  errorCount?: number;\n  lastError?: string;\n}\n\n/**\n * System health info.\n */\nexport interface SystemHealth {\n  pluginHost: {\n    status: HealthStatus;\n    pid?: number;\n    uptime?: number;\n    memoryUsage?: number;\n    cpuUsage?: number;\n  };\n  ipc: {\n    status: HealthStatus;\n    pendingRequests?: number;\n    averageLatency?: number;\n    errorRate?: number;\n  };\n  plugins: {\n    total: number;\n    healthy: number;\n    degraded: number;\n    unhealthy: number;\n    unknown: number;\n  };\n}\n\n/**\n * HealthDashboard component props.\n */\nexport interface HealthDashboardProps extends HTMLAttributes<HTMLDivElement> {\n  /** System health data */\n  systemHealth: SystemHealth;\n  /** Individual plugin health data */\n  pluginHealth: PluginHealth[];\n  /** Last refresh timestamp */\n  lastRefresh?: Date;\n  /** Callback to refresh health data */\n  onRefresh?: () => void;\n  /** Whether refresh is in progress */\n  isRefreshing?: boolean;\n  /** Auto-refresh interval in ms (0 = disabled) */\n  autoRefreshInterval?: number;\n  /** Callback when plugin is clicked */\n  onPluginClick?: (plugin: PluginHealth) => void;\n  /** Compact display mode */\n  compact?: boolean;\n}\n\n/**\n * Heart pulse icon.\n */\nconst HeartPulseIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z\" />\n    <path d=\"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27\" />\n  </svg>\n);\n\n/**\n * Server icon.\n */\nconst ServerIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <rect width=\"20\" height=\"8\" x=\"2\" y=\"2\" rx=\"2\" ry=\"2\" />\n    <rect width=\"20\" height=\"8\" x=\"2\" y=\"14\" rx=\"2\" ry=\"2\" />\n    <line x1=\"6\" x2=\"6.01\" y1=\"6\" y2=\"6\" />\n    <line x1=\"6\" x2=\"6.01\" y1=\"18\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Activity icon.\n */\nconst ActivityIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M22 12h-4l-3 9L9 3l-3 9H2\" />\n  </svg>\n);\n\n/**\n * Refresh icon.\n */\nconst RefreshIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\" />\n    <path d=\"M21 3v5h-5\" />\n    <path d=\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\" />\n    <path d=\"M8 16H3v5\" />\n  </svg>\n);\n\n/**\n * Clock icon.\n */\nconst ClockIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <polyline points=\"12 6 12 12 16 14\" />\n  </svg>\n);\n\n/**\n * Alert circle icon.\n */\nconst AlertCircleIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" x2=\"12\" y1=\"8\" y2=\"12\" />\n    <line x1=\"12\" x2=\"12.01\" y1=\"16\" y2=\"16\" />\n  </svg>\n);\n\n/**\n * Status color mapping.\n */\nconst statusColors: Record<HealthStatus, string> = {\n  healthy: \"text-success-600\",\n  degraded: \"text-warning-600\",\n  unhealthy: \"text-error-600\",\n  unknown: \"text-neutral-400\",\n};\n\n/**\n * Status background color mapping.\n */\nconst statusBgColors: Record<HealthStatus, string> = {\n  healthy: \"bg-success-50\",\n  degraded: \"bg-warning-50\",\n  unhealthy: \"bg-error-50\",\n  unknown: \"bg-neutral-50\",\n};\n\n/**\n * Status border color mapping.\n */\nconst statusBorderColors: Record<HealthStatus, string> = {\n  healthy: \"border-success-200\",\n  degraded: \"border-warning-200\",\n  unhealthy: \"border-error-200\",\n  unknown: \"border-neutral-200\",\n};\n\n/**\n * Status dot color mapping.\n */\nconst statusDotColors: Record<HealthStatus, string> = {\n  healthy: \"bg-success-500\",\n  degraded: \"bg-warning-500\",\n  unhealthy: \"bg-error-500\",\n  unknown: \"bg-neutral-400\",\n};\n\n/**\n * Contract badge colors.\n */\nconst contractColors: Record<string, string> = {\n  tts: \"bg-primary-100 text-primary-700\",\n  stt: \"bg-success-50 text-success-700\",\n  llm: \"bg-warning-50 text-warning-700\",\n  mcp: \"bg-info-50 text-info-700\",\n  vision: \"bg-purple-100 text-purple-700\",\n  embedding: \"bg-cyan-100 text-cyan-700\",\n};\n\n/**\n * Format uptime for display.\n */\nconst formatUptime = (seconds: number): string => {\n  if (seconds < 60) return `${seconds}s`;\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m`;\n  if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ${Math.floor((seconds % 3600) / 60)}m`;\n  return `${Math.floor(seconds / 86400)}d ${Math.floor((seconds % 86400) / 3600)}h`;\n};\n\n/**\n * Format bytes for display.\n */\nconst formatBytes = (bytes: number): string => {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  if (bytes < 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  return `${(bytes / (1024 * 1024 * 1024)).toFixed(2)} GB`;\n};\n\n/**\n * Format time ago for display.\n */\nconst formatTimeAgo = (date: Date): string => {\n  const seconds = Math.floor((Date.now() - date.getTime()) / 1000);\n  if (seconds < 5) return \"just now\";\n  if (seconds < 60) return `${seconds}s ago`;\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;\n  return `${Math.floor(seconds / 3600)}h ago`;\n};\n\n/**\n * HealthDashboard component.\n *\n * Displays system and plugin health status with real-time monitoring.\n *\n * @example\n * ```tsx\n * <HealthDashboard\n *   systemHealth={systemHealthData}\n *   pluginHealth={pluginHealthData}\n *   onRefresh={handleRefresh}\n *   autoRefreshInterval={5000}\n * />\n * ```\n */\nexport const HealthDashboard: React.FC<HealthDashboardProps> = ({\n  systemHealth,\n  pluginHealth,\n  lastRefresh,\n  onRefresh,\n  isRefreshing = false,\n  autoRefreshInterval = 0,\n  onPluginClick,\n  compact = false,\n  className = \"\",\n  ...props\n}) => {\n  // Overall system status\n  const overallStatus = useMemo((): HealthStatus => {\n    if (systemHealth.pluginHost.status === \"unhealthy\") return \"unhealthy\";\n    if (systemHealth.ipc.status === \"unhealthy\") return \"unhealthy\";\n    if (systemHealth.plugins.unhealthy > 0) return \"degraded\";\n    if (systemHealth.plugins.degraded > 0) return \"degraded\";\n    if (systemHealth.pluginHost.status === \"degraded\") return \"degraded\";\n    if (systemHealth.ipc.status === \"degraded\") return \"degraded\";\n    if (\n      systemHealth.pluginHost.status === \"healthy\" &&\n      systemHealth.ipc.status === \"healthy\"\n    ) {\n      return \"healthy\";\n    }\n    return \"unknown\";\n  }, [systemHealth]);\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"gap-4\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  // Card base styles\n  const cardStyles = [\n    \"bg-white\",\n    \"rounded-lg\",\n    \"border\",\n    \"border-neutral-200\",\n    \"overflow-hidden\",\n  ].join(\" \");\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <div\n            className={[\n              \"p-2\",\n              \"rounded-lg\",\n              statusBgColors[overallStatus],\n            ].join(\" \")}\n          >\n            <HeartPulseIcon\n              className={[\"h-5 w-5\", statusColors[overallStatus]].join(\" \")}\n            />\n          </div>\n          <div>\n            <h3 className=\"text-sm font-semibold text-neutral-900\">\n              System Health\n            </h3>\n            <p className={[\"text-xs font-medium\", statusColors[overallStatus]].join(\" \")}>\n              {overallStatus.charAt(0).toUpperCase() + overallStatus.slice(1)}\n            </p>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          {lastRefresh && (\n            <span className=\"text-xs text-neutral-500\">\n              Updated {formatTimeAgo(lastRefresh)}\n            </span>\n          )}\n          <button\n            type=\"button\"\n            onClick={onRefresh}\n            disabled={isRefreshing || !onRefresh}\n            className={[\n              \"inline-flex\",\n              \"items-center\",\n              \"gap-1.5\",\n              \"px-3\",\n              \"py-1.5\",\n              \"text-sm\",\n              \"font-medium\",\n              \"text-neutral-700\",\n              \"bg-neutral-100\",\n              \"rounded-md\",\n              \"hover:bg-neutral-200\",\n              \"disabled:opacity-50\",\n              \"disabled:cursor-not-allowed\",\n              \"transition-colors\",\n              \"duration-150\",\n            ].join(\" \")}\n          >\n            <RefreshIcon\n              className={[\n                \"h-4 w-4\",\n                isRefreshing && \"animate-spin\",\n              ].filter(Boolean).join(\" \")}\n            />\n            {isRefreshing ? \"Refreshing...\" : \"Refresh\"}\n          </button>\n        </div>\n      </div>\n\n      {/* System status cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        {/* Plugin Host status */}\n        <div className={cardStyles}>\n          <div className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <div className=\"flex items-center gap-2\">\n                <ServerIcon className=\"h-4 w-4 text-neutral-500\" />\n                <span className=\"text-sm font-medium text-neutral-700\">\n                  Plugin Host\n                </span>\n              </div>\n              <div\n                className={[\n                  \"h-2 w-2 rounded-full\",\n                  statusDotColors[systemHealth.pluginHost.status],\n                ].join(\" \")}\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              {systemHealth.pluginHost.pid && (\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-neutral-500\">PID</span>\n                  <span className=\"text-neutral-700 font-mono\">\n                    {systemHealth.pluginHost.pid}\n                  </span>\n                </div>\n              )}\n              {systemHealth.pluginHost.uptime !== undefined && (\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-neutral-500\">Uptime</span>\n                  <span className=\"text-neutral-700\">\n                    {formatUptime(systemHealth.pluginHost.uptime)}\n                  </span>\n                </div>\n              )}\n              {systemHealth.pluginHost.memoryUsage !== undefined && (\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-neutral-500\">Memory</span>\n                  <span className=\"text-neutral-700\">\n                    {formatBytes(systemHealth.pluginHost.memoryUsage)}\n                  </span>\n                </div>\n              )}\n              {systemHealth.pluginHost.cpuUsage !== undefined && (\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-neutral-500\">CPU</span>\n                  <span className=\"text-neutral-700\">\n                    {systemHealth.pluginHost.cpuUsage.toFixed(1)}%\n                  </span>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* IPC status */}\n        <div className={cardStyles}>\n          <div className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <div className=\"flex items-center gap-2\">\n                <ActivityIcon className=\"h-4 w-4 text-neutral-500\" />\n                <span className=\"text-sm font-medium text-neutral-700\">\n                  IPC Channel\n                </span>\n              </div>\n              <div\n                className={[\n                  \"h-2 w-2 rounded-full\",\n                  statusDotColors[systemHealth.ipc.status],\n                ].join(\" \")}\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              {systemHealth.ipc.pendingRequests !== undefined && (\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-neutral-500\">Pending</span>\n                  <span className=\"text-neutral-700\">\n                    {systemHealth.ipc.pendingRequests} requests\n                  </span>\n                </div>\n              )}\n              {systemHealth.ipc.averageLatency !== undefined && (\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-neutral-500\">Latency</span>\n                  <span className=\"text-neutral-700\">\n                    {systemHealth.ipc.averageLatency.toFixed(0)}ms avg\n                  </span>\n                </div>\n              )}\n              {systemHealth.ipc.errorRate !== undefined && (\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-neutral-500\">Error Rate</span>\n                  <span\n                    className={\n                      systemHealth.ipc.errorRate > 0.05\n                        ? \"text-error-600\"\n                        : \"text-neutral-700\"\n                    }\n                  >\n                    {(systemHealth.ipc.errorRate * 100).toFixed(1)}%\n                  </span>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Plugin summary */}\n        <div className={cardStyles}>\n          <div className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <span className=\"text-sm font-medium text-neutral-700\">\n                Plugins\n              </span>\n              <span className=\"text-xs text-neutral-500\">\n                {systemHealth.plugins.total} total\n              </span>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <div className=\"flex-1 h-2 bg-neutral-100 rounded-full overflow-hidden\">\n                {systemHealth.plugins.total > 0 && (\n                  <>\n                    <div\n                      className=\"h-full bg-success-500 float-left\"\n                      style={{\n                        width: `${(systemHealth.plugins.healthy / systemHealth.plugins.total) * 100}%`,\n                      }}\n                    />\n                    <div\n                      className=\"h-full bg-warning-500 float-left\"\n                      style={{\n                        width: `${(systemHealth.plugins.degraded / systemHealth.plugins.total) * 100}%`,\n                      }}\n                    />\n                    <div\n                      className=\"h-full bg-error-500 float-left\"\n                      style={{\n                        width: `${(systemHealth.plugins.unhealthy / systemHealth.plugins.total) * 100}%`,\n                      }}\n                    />\n                  </>\n                )}\n              </div>\n            </div>\n\n            <div className=\"mt-3 grid grid-cols-2 gap-2 text-xs\">\n              <div className=\"flex items-center gap-1.5\">\n                <div className=\"h-2 w-2 rounded-full bg-success-500\" />\n                <span className=\"text-neutral-600\">\n                  {systemHealth.plugins.healthy} healthy\n                </span>\n              </div>\n              <div className=\"flex items-center gap-1.5\">\n                <div className=\"h-2 w-2 rounded-full bg-warning-500\" />\n                <span className=\"text-neutral-600\">\n                  {systemHealth.plugins.degraded} degraded\n                </span>\n              </div>\n              <div className=\"flex items-center gap-1.5\">\n                <div className=\"h-2 w-2 rounded-full bg-error-500\" />\n                <span className=\"text-neutral-600\">\n                  {systemHealth.plugins.unhealthy} unhealthy\n                </span>\n              </div>\n              <div className=\"flex items-center gap-1.5\">\n                <div className=\"h-2 w-2 rounded-full bg-neutral-400\" />\n                <span className=\"text-neutral-600\">\n                  {systemHealth.plugins.unknown} unknown\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Plugin health list */}\n      <div className={cardStyles}>\n        <div className=\"p-4 border-b border-neutral-200 bg-neutral-50\">\n          <h4 className=\"text-sm font-semibold text-neutral-900\">\n            Plugin Health Details\n          </h4>\n        </div>\n\n        {pluginHealth.length === 0 ? (\n          <div className=\"p-6 text-center text-sm text-neutral-500\">\n            No plugins loaded\n          </div>\n        ) : (\n          <div className=\"divide-y divide-neutral-100\">\n            {pluginHealth.map((plugin) => (\n              <div\n                key={plugin.id}\n                onClick={() => onPluginClick?.(plugin)}\n                className={[\n                  \"p-4\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                  onPluginClick && \"cursor-pointer hover:bg-neutral-50\",\n                ].filter(Boolean).join(\" \")}\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div\n                      className={[\n                        \"h-2.5 w-2.5 rounded-full mt-1\",\n                        statusDotColors[plugin.status],\n                      ].join(\" \")}\n                    />\n                    <div>\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-sm font-medium text-neutral-900\">\n                          {plugin.displayName}\n                        </span>\n                        <span\n                          className={[\n                            \"px-1.5\",\n                            \"py-0.5\",\n                            \"text-xs\",\n                            \"font-medium\",\n                            \"rounded\",\n                            contractColors[plugin.contract] || \"bg-neutral-100 text-neutral-700\",\n                          ].join(\" \")}\n                        >\n                          {plugin.contract.toUpperCase()}\n                        </span>\n                      </div>\n                      <p className=\"text-xs text-neutral-500 mt-0.5\">\n                        {plugin.id}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"text-right\">\n                    <div className=\"flex items-center gap-3 text-xs\">\n                      {plugin.responseTime !== undefined && (\n                        <span className=\"text-neutral-500\">\n                          {plugin.responseTime}ms\n                        </span>\n                      )}\n                      {plugin.uptime !== undefined && (\n                        <span className=\"text-neutral-500\">\n                          Up {formatUptime(plugin.uptime)}\n                        </span>\n                      )}\n                    </div>\n                    {plugin.lastCheck && (\n                      <p className=\"text-xs text-neutral-400 mt-1\">\n                        Checked {formatTimeAgo(plugin.lastCheck)}\n                      </p>\n                    )}\n                  </div>\n                </div>\n\n                {/* Error display */}\n                {plugin.status === \"unhealthy\" && plugin.lastError && (\n                  <div className=\"mt-3 flex items-start gap-2 p-2 rounded bg-error-50\">\n                    <AlertCircleIcon className=\"h-4 w-4 text-error-500 shrink-0 mt-0.5\" />\n                    <p className=\"text-xs text-error-700\">\n                      {plugin.lastError}\n                    </p>\n                  </div>\n                )}\n\n                {/* Metrics row */}\n                {!compact && (plugin.memoryUsage !== undefined || plugin.errorCount !== undefined) && (\n                  <div className=\"mt-3 flex items-center gap-4 text-xs text-neutral-500\">\n                    {plugin.memoryUsage !== undefined && (\n                      <span>Memory: {formatBytes(plugin.memoryUsage)}</span>\n                    )}\n                    {plugin.errorCount !== undefined && plugin.errorCount > 0 && (\n                      <span className=\"text-error-600\">\n                        Errors: {plugin.errorCount}\n                      </span>\n                    )}\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Auto-refresh indicator */}\n      {autoRefreshInterval > 0 && (\n        <div className=\"flex items-center justify-center gap-2 text-xs text-neutral-400\">\n          <ClockIcon className=\"h-3.5 w-3.5\" />\n          Auto-refresh every {autoRefreshInterval / 1000}s\n        </div>\n      )}\n    </div>\n  );\n};\n\nHealthDashboard.displayName = \"HealthDashboard\";\n\nexport default HealthDashboard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\testing\\LogViewer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'levelBgColors' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":193,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":193,"endColumn":20},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":2,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":303,"column":12,"nodeType":null,"messageId":"preferOptionalChain","endLine":303,"endColumn":70,"fix":{"range":[7329,7387],"text":"log.pluginId?.toLowerCase().includes(query)"}}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D060 - src/components/testing/LogViewer.tsx\n * ============================================\n * Plugin log viewer for real-time log monitoring and filtering.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D011 (Input.tsx), D014 (Panel.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, {\n  useState,\n  useCallback,\n  useMemo,\n  useRef,\n  useEffect,\n  type HTMLAttributes,\n} from \"react\";\n\n/**\n * Log level types.\n */\nexport type LogLevel = \"debug\" | \"info\" | \"warning\" | \"error\" | \"critical\";\n\n/**\n * Log entry structure.\n */\nexport interface LogEntry {\n  id: string;\n  timestamp: Date;\n  level: LogLevel;\n  source: string;\n  message: string;\n  data?: Record<string, unknown>;\n  pluginId?: string;\n}\n\n/**\n * Log filter options.\n */\nexport interface LogFilter {\n  levels?: LogLevel[];\n  sources?: string[];\n  pluginIds?: string[];\n  search?: string;\n  startTime?: Date;\n  endTime?: Date;\n}\n\n/**\n * LogViewer component props.\n */\nexport interface LogViewerProps extends HTMLAttributes<HTMLDivElement> {\n  /** Log entries to display */\n  logs: LogEntry[];\n  /** Maximum entries to display */\n  maxEntries?: number;\n  /** Whether to auto-scroll to new entries */\n  autoScroll?: boolean;\n  /** Callback when log is cleared */\n  onClear?: () => void;\n  /** Callback when filter changes */\n  onFilterChange?: (filter: LogFilter) => void;\n  /** Callback to export logs */\n  onExport?: (format: \"json\" | \"csv\" | \"text\") => void;\n  /** Available sources for filtering */\n  availableSources?: string[];\n  /** Available plugins for filtering */\n  availablePlugins?: { id: string; name: string }[];\n  /** Show timestamp column */\n  showTimestamp?: boolean;\n  /** Show source column */\n  showSource?: boolean;\n  /** Compact display mode */\n  compact?: boolean;\n}\n\n/**\n * Search icon.\n */\nconst SearchIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n    <path d=\"m21 21-4.3-4.3\" />\n  </svg>\n);\n\n/**\n * Trash icon.\n */\nconst TrashIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M3 6h18\" />\n    <path d=\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\" />\n    <path d=\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\" />\n  </svg>\n);\n\n/**\n * Download icon.\n */\nconst DownloadIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n    <polyline points=\"7 10 12 15 17 10\" />\n    <line x1=\"12\" x2=\"12\" y1=\"15\" y2=\"3\" />\n  </svg>\n);\n\n/**\n * Scroll to bottom icon.\n */\nconst ArrowDownIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M12 5v14\" />\n    <path d=\"m19 12-7 7-7-7\" />\n  </svg>\n);\n\n/**\n * Filter icon.\n */\nconst FilterIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polygon points=\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\" />\n  </svg>\n);\n\n/**\n * Log level colors.\n */\nconst levelColors: Record<LogLevel, string> = {\n  debug: \"text-neutral-500\",\n  info: \"text-info-600\",\n  warning: \"text-warning-600\",\n  error: \"text-error-600\",\n  critical: \"text-error-700\",\n};\n\n/**\n * Log level background colors.\n */\nconst levelBgColors: Record<LogLevel, string> = {\n  debug: \"bg-neutral-100\",\n  info: \"bg-info-50\",\n  warning: \"bg-warning-50\",\n  error: \"bg-error-50\",\n  critical: \"bg-error-100\",\n};\n\n/**\n * Log level badge colors.\n */\nconst levelBadgeColors: Record<LogLevel, string> = {\n  debug: \"bg-neutral-200 text-neutral-700\",\n  info: \"bg-info-100 text-info-700\",\n  warning: \"bg-warning-100 text-warning-700\",\n  error: \"bg-error-100 text-error-700\",\n  critical: \"bg-error-200 text-error-800\",\n};\n\n/**\n * All log levels.\n */\nconst ALL_LEVELS: LogLevel[] = [\"debug\", \"info\", \"warning\", \"error\", \"critical\"];\n\n/**\n * Format timestamp for display.\n */\nconst formatTimestamp = (date: Date): string => {\n  return date.toLocaleTimeString(\"en-US\", {\n    hour12: false,\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    fractionalSecondDigits: 3,\n  } as Intl.DateTimeFormatOptions);\n};\n\n/**\n * LogViewer component.\n *\n * Real-time log viewer with filtering, search, and export capabilities.\n *\n * @example\n * ```tsx\n * <LogViewer\n *   logs={logEntries}\n *   onClear={clearLogs}\n *   onExport={exportLogs}\n *   autoScroll\n * />\n * ```\n */\nexport const LogViewer: React.FC<LogViewerProps> = ({\n  logs,\n  maxEntries = 1000,\n  autoScroll = true,\n  onClear,\n  onFilterChange,\n  onExport,\n  availableSources = [],\n  availablePlugins = [],\n  showTimestamp = true,\n  showSource = true,\n  compact = false,\n  className = \"\",\n  ...props\n}) => {\n  // Filter state\n  const [selectedLevels, setSelectedLevels] = useState<Set<LogLevel>>(\n    new Set(ALL_LEVELS)\n  );\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedSources, setSelectedSources] = useState<Set<string>>(new Set());\n  const [selectedPlugins, setSelectedPlugins] = useState<Set<string>>(new Set());\n  const [showFilters, setShowFilters] = useState(false);\n  const [isAutoScrollEnabled, setIsAutoScrollEnabled] = useState(autoScroll);\n  const [expandedLogs, setExpandedLogs] = useState<Set<string>>(new Set());\n\n  // Refs\n  const logContainerRef = useRef<HTMLDivElement>(null);\n  const wasAtBottomRef = useRef(true);\n\n  // Filtered logs\n  const filteredLogs = useMemo(() => {\n    let result = logs;\n\n    // Filter by level\n    if (selectedLevels.size < ALL_LEVELS.length) {\n      result = result.filter((log) => selectedLevels.has(log.level));\n    }\n\n    // Filter by source\n    if (selectedSources.size > 0) {\n      result = result.filter((log) => selectedSources.has(log.source));\n    }\n\n    // Filter by plugin\n    if (selectedPlugins.size > 0) {\n      result = result.filter(\n        (log) => log.pluginId && selectedPlugins.has(log.pluginId)\n      );\n    }\n\n    // Filter by search query\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      result = result.filter(\n        (log) =>\n          log.message.toLowerCase().includes(query) ||\n          log.source.toLowerCase().includes(query) ||\n          (log.pluginId && log.pluginId.toLowerCase().includes(query))\n      );\n    }\n\n    // Limit entries\n    if (result.length > maxEntries) {\n      result = result.slice(-maxEntries);\n    }\n\n    return result;\n  }, [logs, selectedLevels, selectedSources, selectedPlugins, searchQuery, maxEntries]);\n\n  // Notify filter change\n  useEffect(() => {\n    if (onFilterChange) {\n      onFilterChange({\n        levels: selectedLevels.size < ALL_LEVELS.length ? Array.from(selectedLevels) : undefined,\n        sources: selectedSources.size > 0 ? Array.from(selectedSources) : undefined,\n        pluginIds: selectedPlugins.size > 0 ? Array.from(selectedPlugins) : undefined,\n        search: searchQuery.trim() || undefined,\n      });\n    }\n  }, [selectedLevels, selectedSources, selectedPlugins, searchQuery, onFilterChange]);\n\n  // Auto-scroll handling\n  useEffect(() => {\n    const container = logContainerRef.current;\n    if (!container || !isAutoScrollEnabled) return;\n\n    // Check if we should scroll\n    if (wasAtBottomRef.current) {\n      container.scrollTop = container.scrollHeight;\n    }\n  }, [filteredLogs, isAutoScrollEnabled]);\n\n  // Track scroll position\n  const handleScroll = useCallback(() => {\n    const container = logContainerRef.current;\n    if (!container) return;\n\n    const threshold = 50;\n    const atBottom =\n      container.scrollHeight - container.scrollTop - container.clientHeight <\n      threshold;\n    wasAtBottomRef.current = atBottom;\n  }, []);\n\n  // Toggle level filter\n  const toggleLevel = useCallback((level: LogLevel) => {\n    setSelectedLevels((prev) => {\n      const next = new Set(prev);\n      if (next.has(level)) {\n        next.delete(level);\n      } else {\n        next.add(level);\n      }\n      return next;\n    });\n  }, []);\n\n  // Toggle source filter\n  const toggleSource = useCallback((source: string) => {\n    setSelectedSources((prev) => {\n      const next = new Set(prev);\n      if (next.has(source)) {\n        next.delete(source);\n      } else {\n        next.add(source);\n      }\n      return next;\n    });\n  }, []);\n\n  // Toggle plugin filter\n  const togglePlugin = useCallback((pluginId: string) => {\n    setSelectedPlugins((prev) => {\n      const next = new Set(prev);\n      if (next.has(pluginId)) {\n        next.delete(pluginId);\n      } else {\n        next.add(pluginId);\n      }\n      return next;\n    });\n  }, []);\n\n  // Toggle log expansion\n  const toggleExpanded = useCallback((logId: string) => {\n    setExpandedLogs((prev) => {\n      const next = new Set(prev);\n      if (next.has(logId)) {\n        next.delete(logId);\n      } else {\n        next.add(logId);\n      }\n      return next;\n    });\n  }, []);\n\n  // Scroll to bottom\n  const scrollToBottom = useCallback(() => {\n    const container = logContainerRef.current;\n    if (container) {\n      container.scrollTop = container.scrollHeight;\n      wasAtBottomRef.current = true;\n    }\n  }, []);\n\n  // Clear all filters\n  const clearFilters = useCallback(() => {\n    setSelectedLevels(new Set(ALL_LEVELS));\n    setSelectedSources(new Set());\n    setSelectedPlugins(new Set());\n    setSearchQuery(\"\");\n  }, []);\n\n  // Check if any filters are active\n  const hasActiveFilters =\n    selectedLevels.size < ALL_LEVELS.length ||\n    selectedSources.size > 0 ||\n    selectedPlugins.size > 0 ||\n    searchQuery.trim() !== \"\";\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"bg-white\",\n    \"rounded-lg\",\n    \"border\",\n    \"border-neutral-200\",\n    \"overflow-hidden\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Toolbar */}\n      <div className=\"flex items-center justify-between p-3 border-b border-neutral-200 bg-neutral-50\">\n        {/* Search */}\n        <div className=\"relative flex-1 max-w-md\">\n          <SearchIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400\" />\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search logs...\"\n            className={[\n              \"w-full\",\n              \"pl-9\",\n              \"pr-3\",\n              \"py-1.5\",\n              \"text-sm\",\n              \"bg-white\",\n              \"border\",\n              \"border-neutral-300\",\n              \"rounded-md\",\n              \"focus:outline-none\",\n              \"focus:ring-2\",\n              \"focus:ring-primary-500\",\n            ].join(\" \")}\n          />\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex items-center gap-2 ml-4\">\n          {/* Filter toggle */}\n          <button\n            type=\"button\"\n            onClick={() => setShowFilters(!showFilters)}\n            className={[\n              \"inline-flex\",\n              \"items-center\",\n              \"gap-1.5\",\n              \"px-3\",\n              \"py-1.5\",\n              \"text-sm\",\n              \"font-medium\",\n              \"rounded-md\",\n              \"transition-colors\",\n              \"duration-150\",\n              showFilters || hasActiveFilters\n                ? \"bg-primary-100 text-primary-700\"\n                : \"bg-neutral-100 text-neutral-700 hover:bg-neutral-200\",\n            ].join(\" \")}\n          >\n            <FilterIcon className=\"h-4 w-4\" />\n            Filters\n            {hasActiveFilters && (\n              <span className=\"ml-1 px-1.5 py-0.5 text-xs bg-primary-600 text-white rounded-full\">\n                {(selectedLevels.size < ALL_LEVELS.length ? 1 : 0) +\n                  (selectedSources.size > 0 ? 1 : 0) +\n                  (selectedPlugins.size > 0 ? 1 : 0)}\n              </span>\n            )}\n          </button>\n\n          {/* Auto-scroll toggle */}\n          <button\n            type=\"button\"\n            onClick={() => setIsAutoScrollEnabled(!isAutoScrollEnabled)}\n            className={[\n              \"inline-flex\",\n              \"items-center\",\n              \"gap-1.5\",\n              \"px-3\",\n              \"py-1.5\",\n              \"text-sm\",\n              \"font-medium\",\n              \"rounded-md\",\n              \"transition-colors\",\n              \"duration-150\",\n              isAutoScrollEnabled\n                ? \"bg-primary-100 text-primary-700\"\n                : \"bg-neutral-100 text-neutral-700 hover:bg-neutral-200\",\n            ].join(\" \")}\n            title={isAutoScrollEnabled ? \"Auto-scroll enabled\" : \"Auto-scroll disabled\"}\n          >\n            <ArrowDownIcon className=\"h-4 w-4\" />\n          </button>\n\n          {/* Export */}\n          {onExport && (\n            <div className=\"relative group\">\n              <button\n                type=\"button\"\n                className={[\n                  \"inline-flex\",\n                  \"items-center\",\n                  \"gap-1.5\",\n                  \"px-3\",\n                  \"py-1.5\",\n                  \"text-sm\",\n                  \"font-medium\",\n                  \"bg-neutral-100\",\n                  \"text-neutral-700\",\n                  \"rounded-md\",\n                  \"hover:bg-neutral-200\",\n                  \"transition-colors\",\n                  \"duration-150\",\n                ].join(\" \")}\n              >\n                <DownloadIcon className=\"h-4 w-4\" />\n                Export\n              </button>\n              <div className=\"absolute right-0 mt-1 py-1 bg-white rounded-md shadow-lg border border-neutral-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-150 z-10\">\n                <button\n                  type=\"button\"\n                  onClick={() => onExport(\"json\")}\n                  className=\"block w-full px-4 py-1.5 text-sm text-left text-neutral-700 hover:bg-neutral-50\"\n                >\n                  JSON\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => onExport(\"csv\")}\n                  className=\"block w-full px-4 py-1.5 text-sm text-left text-neutral-700 hover:bg-neutral-50\"\n                >\n                  CSV\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => onExport(\"text\")}\n                  className=\"block w-full px-4 py-1.5 text-sm text-left text-neutral-700 hover:bg-neutral-50\"\n                >\n                  Plain Text\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Clear */}\n          {onClear && (\n            <button\n              type=\"button\"\n              onClick={onClear}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"gap-1.5\",\n                \"px-3\",\n                \"py-1.5\",\n                \"text-sm\",\n                \"font-medium\",\n                \"bg-neutral-100\",\n                \"text-neutral-700\",\n                \"rounded-md\",\n                \"hover:bg-error-50\",\n                \"hover:text-error-700\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              <TrashIcon className=\"h-4 w-4\" />\n              Clear\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Filter panel */}\n      {showFilters && (\n        <div className=\"p-3 border-b border-neutral-200 bg-neutral-50 space-y-3\">\n          {/* Level filters */}\n          <div>\n            <span className=\"text-xs font-medium text-neutral-600 mb-2 block\">\n              Log Levels\n            </span>\n            <div className=\"flex flex-wrap gap-2\">\n              {ALL_LEVELS.map((level) => (\n                <button\n                  key={level}\n                  type=\"button\"\n                  onClick={() => toggleLevel(level)}\n                  className={[\n                    \"px-2.5\",\n                    \"py-1\",\n                    \"text-xs\",\n                    \"font-medium\",\n                    \"rounded-md\",\n                    \"border\",\n                    \"transition-colors\",\n                    \"duration-150\",\n                    selectedLevels.has(level)\n                      ? levelBadgeColors[level] + \" border-transparent\"\n                      : \"bg-white border-neutral-200 text-neutral-400\",\n                  ].join(\" \")}\n                >\n                  {level.toUpperCase()}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Source filters */}\n          {availableSources.length > 0 && (\n            <div>\n              <span className=\"text-xs font-medium text-neutral-600 mb-2 block\">\n                Sources\n              </span>\n              <div className=\"flex flex-wrap gap-2\">\n                {availableSources.map((source) => (\n                  <button\n                    key={source}\n                    type=\"button\"\n                    onClick={() => toggleSource(source)}\n                    className={[\n                      \"px-2.5\",\n                      \"py-1\",\n                      \"text-xs\",\n                      \"font-medium\",\n                      \"rounded-md\",\n                      \"border\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      selectedSources.has(source)\n                        ? \"bg-primary-100 text-primary-700 border-transparent\"\n                        : \"bg-white border-neutral-200 text-neutral-600 hover:border-neutral-300\",\n                    ].join(\" \")}\n                  >\n                    {source}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Plugin filters */}\n          {availablePlugins.length > 0 && (\n            <div>\n              <span className=\"text-xs font-medium text-neutral-600 mb-2 block\">\n                Plugins\n              </span>\n              <div className=\"flex flex-wrap gap-2\">\n                {availablePlugins.map((plugin) => (\n                  <button\n                    key={plugin.id}\n                    type=\"button\"\n                    onClick={() => togglePlugin(plugin.id)}\n                    className={[\n                      \"px-2.5\",\n                      \"py-1\",\n                      \"text-xs\",\n                      \"font-medium\",\n                      \"rounded-md\",\n                      \"border\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      selectedPlugins.has(plugin.id)\n                        ? \"bg-primary-100 text-primary-700 border-transparent\"\n                        : \"bg-white border-neutral-200 text-neutral-600 hover:border-neutral-300\",\n                    ].join(\" \")}\n                  >\n                    {plugin.name}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Clear filters */}\n          {hasActiveFilters && (\n            <button\n              type=\"button\"\n              onClick={clearFilters}\n              className=\"text-xs text-primary-600 hover:text-primary-700 font-medium\"\n            >\n              Clear all filters\n            </button>\n          )}\n        </div>\n      )}\n\n      {/* Log entries */}\n      <div\n        ref={logContainerRef}\n        onScroll={handleScroll}\n        className={[\n          \"flex-1\",\n          \"overflow-y-auto\",\n          \"font-mono\",\n          \"text-xs\",\n          compact ? \"p-2\" : \"p-3\",\n          \"bg-neutral-900\",\n        ].join(\" \")}\n        style={{ minHeight: \"200px\", maxHeight: \"500px\" }}\n      >\n        {filteredLogs.length === 0 ? (\n          <div className=\"flex items-center justify-center h-full text-neutral-500\">\n            {logs.length === 0 ? \"No logs yet\" : \"No logs match filters\"}\n          </div>\n        ) : (\n          <div className=\"space-y-0.5\">\n            {filteredLogs.map((log) => (\n              <div\n                key={log.id}\n                className={[\n                  \"flex\",\n                  \"items-start\",\n                  \"gap-2\",\n                  compact ? \"py-0.5\" : \"py-1\",\n                  \"px-2\",\n                  \"rounded\",\n                  \"hover:bg-neutral-800\",\n                  log.data && \"cursor-pointer\",\n                ].filter(Boolean).join(\" \")}\n                onClick={() => log.data && toggleExpanded(log.id)}\n              >\n                {/* Timestamp */}\n                {showTimestamp && (\n                  <span className=\"text-neutral-500 shrink-0\">\n                    {formatTimestamp(log.timestamp)}\n                  </span>\n                )}\n\n                {/* Level badge */}\n                <span\n                  className={[\n                    \"shrink-0\",\n                    \"px-1.5\",\n                    \"py-0.5\",\n                    \"rounded\",\n                    \"text-xs\",\n                    \"font-medium\",\n                    \"uppercase\",\n                    levelBadgeColors[log.level],\n                  ].join(\" \")}\n                >\n                  {log.level.slice(0, 4)}\n                </span>\n\n                {/* Source */}\n                {showSource && (\n                  <span className=\"text-primary-400 shrink-0\">\n                    [{log.source}]\n                  </span>\n                )}\n\n                {/* Plugin ID */}\n                {log.pluginId && (\n                  <span className=\"text-cyan-400 shrink-0\">\n                    &lt;{log.pluginId}&gt;\n                  </span>\n                )}\n\n                {/* Message */}\n                <span className={levelColors[log.level]}>\n                  {log.message}\n                </span>\n\n                {/* Expandable indicator */}\n                {log.data && (\n                  <span className=\"text-neutral-600 ml-auto\">\n                    {expandedLogs.has(log.id) ? \"Ôû╝\" : \"ÔûÂ\"}\n                  </span>\n                )}\n              </div>\n            ))}\n\n            {/* Expanded data */}\n            {filteredLogs.map(\n              (log) =>\n                log.data &&\n                expandedLogs.has(log.id) && (\n                  <div\n                    key={`${log.id}-data`}\n                    className=\"ml-6 p-2 bg-neutral-800 rounded text-neutral-300 whitespace-pre-wrap\"\n                  >\n                    {JSON.stringify(log.data, null, 2)}\n                  </div>\n                )\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Footer */}\n      <div className=\"flex items-center justify-between px-3 py-2 border-t border-neutral-200 bg-neutral-50 text-xs text-neutral-500\">\n        <span>\n          {filteredLogs.length} of {logs.length} entries\n          {hasActiveFilters && \" (filtered)\"}\n        </span>\n        <button\n          type=\"button\"\n          onClick={scrollToBottom}\n          className=\"text-primary-600 hover:text-primary-700 font-medium\"\n        >\n          Scroll to bottom\n        </button>\n      </div>\n    </div>\n  );\n};\n\nLogViewer.displayName = \"LogViewer\";\n\nexport default LogViewer;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\testing\\MethodInvoker.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'generateId' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":162,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":162,"endColumn":17},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":163,"column":17,"nodeType":"CallExpression","messageId":"invalidType","endLine":163,"endColumn":27},{"ruleId":"@typescript-eslint/no-deprecated","severity":2,"message":"`substr` is deprecated. A legacy feature for browser compatibility","line":163,"column":58,"nodeType":"Identifier","messageId":"deprecatedWithReason","endLine":163,"endColumn":64},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, the types have no overlap.","line":170,"column":23,"nodeType":"BinaryExpression","messageId":"noOverlapBooleanExpression","endLine":170,"endColumn":42},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":174,"column":7,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":174,"endColumn":37,"suggestions":[{"messageId":"addBrackets","fix":{"range":[4082,4155],"text":"{ const num = parseFloat(value);\n      return isNaN(num) ? undefined : num; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value' will use Object's default stringification format ('[object Object]') when stringified.","line":201,"column":21,"nodeType":"Identifier","messageId":"baseToString","endLine":201,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'pluginId' is defined but never used. Allowed unused args must match /^_/u.","line":230,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":230,"endColumn":11},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, the types have no overlap.","line":265,"column":46,"nodeType":"BinaryExpression","messageId":"noOverlapBooleanExpression","endLine":265,"endColumn":65},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, the types have no overlap.","line":267,"column":34,"nodeType":"BinaryExpression","messageId":"noOverlapBooleanExpression","endLine":267,"endColumn":53},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":271,"column":55,"nodeType":"MemberExpression","messageId":"invalidType","endLine":271,"endColumn":64},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":274,"column":54,"nodeType":"MemberExpression","messageId":"invalidType","endLine":274,"endColumn":63},{"ruleId":"@typescript-eslint/no-dynamic-delete","severity":2,"message":"Do not delete dynamically computed property keys.","line":301,"column":24,"nodeType":"Identifier","messageId":"dynamicDelete","endLine":301,"endColumn":28},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":450,"column":50,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":450,"endColumn":52,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[12765,12767],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":488,"column":19,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":488,"endColumn":33},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":579,"column":23,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":579,"endColumn":41}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D058 - src/components/testing/MethodInvoker.tsx\n * ================================================\n * Method test invoker for executing plugin methods with custom parameters.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D057 (PluginTester.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Parameter definition for method invocation.\n */\nexport interface InvokerParam {\n  name: string;\n  type: \"string\" | \"number\" | \"boolean\" | \"object\" | \"array\";\n  required?: boolean;\n  description?: string;\n  default?: unknown;\n  enum?: string[];\n  min?: number;\n  max?: number;\n}\n\n/**\n * Method definition for the invoker.\n */\nexport interface InvokerMethod {\n  name: string;\n  description?: string;\n  params: InvokerParam[];\n  returns?: {\n    type: string;\n    description?: string;\n  };\n}\n\n/**\n * Invocation result.\n */\nexport interface InvocationResult {\n  id: string;\n  method: string;\n  params: Record<string, unknown>;\n  success: boolean;\n  result?: unknown;\n  error?: {\n    code: number;\n    message: string;\n    data?: unknown;\n  };\n  duration: number;\n  timestamp: Date;\n}\n\n/**\n * MethodInvoker component props.\n */\nexport interface MethodInvokerProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSubmit\"> {\n  /** Method to invoke */\n  method: InvokerMethod;\n  /** Plugin ID for context */\n  pluginId: string;\n  /** Plugin display name */\n  pluginName?: string;\n  /** Callback when method is invoked */\n  onInvoke?: (method: string, params: Record<string, unknown>) => Promise<InvocationResult>;\n  /** Whether invocation is in progress */\n  isInvoking?: boolean;\n  /** Last invocation result */\n  lastResult?: InvocationResult;\n  /** Whether to show the result panel */\n  showResult?: boolean;\n  /** Compact mode */\n  compact?: boolean;\n}\n\n/**\n * Play icon.\n */\nconst PlayIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polygon points=\"5 3 19 12 5 21 5 3\" />\n  </svg>\n);\n\n/**\n * Copy icon.\n */\nconst CopyIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\" />\n    <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Reset icon.\n */\nconst ResetIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\" />\n    <path d=\"M3 3v5h5\" />\n  </svg>\n);\n\n/**\n * Generate a unique ID.\n */\nconst generateId = (): string => {\n  return `inv_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n};\n\n/**\n * Parse value based on type.\n */\nconst parseValue = (value: string, type: InvokerParam[\"type\"]): unknown => {\n  if (value === \"\" || value === undefined) return undefined;\n\n  switch (type) {\n    case \"number\":\n      const num = parseFloat(value);\n      return isNaN(num) ? undefined : num;\n    case \"boolean\":\n      return value === \"true\";\n    case \"object\":\n    case \"array\":\n      try {\n        return JSON.parse(value);\n      } catch {\n        return undefined;\n      }\n    default:\n      return value;\n  }\n};\n\n/**\n * Format value for display.\n */\nconst formatValue = (value: unknown, type: InvokerParam[\"type\"]): string => {\n  if (value === undefined || value === null) return \"\";\n\n  switch (type) {\n    case \"object\":\n    case \"array\":\n      return typeof value === \"string\" ? value : JSON.stringify(value, null, 2);\n    default:\n      return String(value);\n  }\n};\n\n/**\n * MethodInvoker component.\n *\n * Provides a form-based interface for invoking plugin methods with typed parameters.\n * Supports validation, default values, and result display.\n *\n * @example\n * ```tsx\n * <MethodInvoker\n *   method={{\n *     name: \"synthesize\",\n *     params: [\n *       { name: \"text\", type: \"string\", required: true },\n *       { name: \"voice_id\", type: \"string\", default: \"af_bella\" }\n *     ]\n *   }}\n *   pluginId=\"tts_kokoro\"\n *   onInvoke={async (method, params) => {\n *     return await callPlugin(\"tts_kokoro\", method, params);\n *   }}\n * />\n * ```\n */\nexport const MethodInvoker: React.FC<MethodInvokerProps> = ({\n  method,\n  pluginId,\n  pluginName,\n  onInvoke,\n  isInvoking = false,\n  lastResult,\n  showResult = true,\n  compact = false,\n  className = \"\",\n  ...props\n}) => {\n  // Parameter values state\n  const [paramValues, setParamValues] = useState<Record<string, string>>(() => {\n    const defaults: Record<string, string> = {};\n    method.params.forEach((param) => {\n      if (param.default !== undefined) {\n        defaults[param.name] = formatValue(param.default, param.type);\n      }\n    });\n    return defaults;\n  });\n\n  // Validation errors\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Copy state for result\n  const [copied, setCopied] = useState(false);\n\n  // Validate parameters\n  const validateParams = useCallback((): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    method.params.forEach((param) => {\n      const value = paramValues[param.name];\n      const parsed = parseValue(value, param.type);\n\n      if (param.required && (value === \"\" || value === undefined)) {\n        newErrors[param.name] = \"This field is required\";\n      } else if (value !== \"\" && value !== undefined && parsed === undefined) {\n        newErrors[param.name] = `Invalid ${param.type} value`;\n      } else if (param.type === \"number\" && parsed !== undefined) {\n        if (param.min !== undefined && (parsed as number) < param.min) {\n          newErrors[param.name] = `Must be at least ${param.min}`;\n        }\n        if (param.max !== undefined && (parsed as number) > param.max) {\n          newErrors[param.name] = `Must be at most ${param.max}`;\n        }\n      }\n    });\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  }, [method.params, paramValues]);\n\n  // Build params object\n  const buildParams = useMemo((): Record<string, unknown> => {\n    const params: Record<string, unknown> = {};\n    method.params.forEach((param) => {\n      const value = paramValues[param.name];\n      const parsed = parseValue(value, param.type);\n      if (parsed !== undefined) {\n        params[param.name] = parsed;\n      }\n    });\n    return params;\n  }, [method.params, paramValues]);\n\n  // Handle param change\n  const handleParamChange = useCallback((name: string, value: string) => {\n    setParamValues((prev) => ({ ...prev, [name]: value }));\n    setErrors((prev) => {\n      const newErrors = { ...prev };\n      delete newErrors[name];\n      return newErrors;\n    });\n  }, []);\n\n  // Handle invoke\n  const handleInvoke = useCallback(async () => {\n    if (!validateParams() || !onInvoke) return;\n    await onInvoke(method.name, buildParams);\n  }, [validateParams, onInvoke, method.name, buildParams]);\n\n  // Handle reset\n  const handleReset = useCallback(() => {\n    const defaults: Record<string, string> = {};\n    method.params.forEach((param) => {\n      if (param.default !== undefined) {\n        defaults[param.name] = formatValue(param.default, param.type);\n      }\n    });\n    setParamValues(defaults);\n    setErrors({});\n  }, [method.params]);\n\n  // Handle copy result\n  const handleCopyResult = useCallback(async () => {\n    if (!lastResult) return;\n    const text = JSON.stringify(\n      lastResult.success ? lastResult.result : lastResult.error,\n      null,\n      2\n    );\n    await navigator.clipboard.writeText(text);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  }, [lastResult]);\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"gap-4\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  // Input base styles\n  const inputBaseStyles = [\n    \"w-full\",\n    \"px-3\",\n    \"py-2\",\n    \"text-sm\",\n    \"bg-white\",\n    \"border\",\n    \"rounded-md\",\n    \"focus:outline-none\",\n    \"focus:ring-2\",\n    \"focus:ring-primary-500\",\n    \"transition-colors\",\n    \"duration-150\",\n  ];\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Method header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h4 className=\"text-sm font-semibold text-neutral-900\">\n            {method.name}()\n          </h4>\n          {method.description && (\n            <p className=\"mt-0.5 text-xs text-neutral-500\">\n              {method.description}\n            </p>\n          )}\n        </div>\n        {pluginName && (\n          <span className=\"text-xs text-neutral-400\">\n            {pluginName}\n          </span>\n        )}\n      </div>\n\n      {/* Parameters form */}\n      {method.params.length > 0 ? (\n        <div className={compact ? \"space-y-2\" : \"space-y-3\"}>\n          {method.params.map((param) => (\n            <div key={param.name}>\n              <label className=\"flex items-center gap-2 text-sm font-medium text-neutral-700 mb-1\">\n                {param.name}\n                <span className=\"text-xs font-normal text-neutral-400\">\n                  ({param.type})\n                </span>\n                {param.required && (\n                  <span className=\"text-error-500\">*</span>\n                )}\n              </label>\n\n              {/* Enum select */}\n              {param.enum ? (\n                <select\n                  value={paramValues[param.name] ?? \"\"}\n                  onChange={(e) => handleParamChange(param.name, e.target.value)}\n                  className={[\n                    ...inputBaseStyles,\n                    errors[param.name]\n                      ? \"border-error-500 focus:ring-error-500\"\n                      : \"border-neutral-300\",\n                  ].join(\" \")}\n                >\n                  <option value=\"\">Select {param.name}</option>\n                  {param.enum.map((opt) => (\n                    <option key={opt} value={opt}>\n                      {opt}\n                    </option>\n                  ))}\n                </select>\n              ) : param.type === \"boolean\" ? (\n                <select\n                  value={paramValues[param.name] ?? \"\"}\n                  onChange={(e) => handleParamChange(param.name, e.target.value)}\n                  className={[\n                    ...inputBaseStyles,\n                    errors[param.name]\n                      ? \"border-error-500 focus:ring-error-500\"\n                      : \"border-neutral-300\",\n                  ].join(\" \")}\n                >\n                  <option value=\"\">Select value</option>\n                  <option value=\"true\">true</option>\n                  <option value=\"false\">false</option>\n                </select>\n              ) : param.type === \"object\" || param.type === \"array\" ? (\n                <textarea\n                  value={paramValues[param.name] ?? \"\"}\n                  onChange={(e) => handleParamChange(param.name, e.target.value)}\n                  placeholder={param.type === \"array\" ? '[\"item1\", \"item2\"]' : '{\"key\": \"value\"}'}\n                  rows={compact ? 2 : 3}\n                  className={[\n                    ...inputBaseStyles,\n                    \"font-mono\",\n                    errors[param.name]\n                      ? \"border-error-500 focus:ring-error-500\"\n                      : \"border-neutral-300\",\n                  ].join(\" \")}\n                />\n              ) : (\n                <input\n                  type={param.type === \"number\" ? \"number\" : \"text\"}\n                  value={paramValues[param.name] ?? \"\"}\n                  onChange={(e) => handleParamChange(param.name, e.target.value)}\n                  placeholder={param.description || `Enter ${param.name}`}\n                  min={param.min}\n                  max={param.max}\n                  className={[\n                    ...inputBaseStyles,\n                    errors[param.name]\n                      ? \"border-error-500 focus:ring-error-500\"\n                      : \"border-neutral-300\",\n                  ].join(\" \")}\n                />\n              )}\n\n              {/* Error message */}\n              {errors[param.name] && (\n                <p className=\"mt-1 text-xs text-error-600\">\n                  {errors[param.name]}\n                </p>\n              )}\n\n              {/* Description */}\n              {param.description && !errors[param.name] && (\n                <p className=\"mt-1 text-xs text-neutral-500\">\n                  {param.description}\n                </p>\n              )}\n            </div>\n          ))}\n        </div>\n      ) : (\n        <p className=\"text-sm text-neutral-500 italic\">\n          No parameters required\n        </p>\n      )}\n\n      {/* Action buttons */}\n      <div className=\"flex items-center gap-2\">\n        <button\n          type=\"button\"\n          onClick={handleInvoke}\n          disabled={isInvoking || !onInvoke}\n          className={[\n            \"inline-flex\",\n            \"items-center\",\n            \"gap-2\",\n            \"px-4\",\n            \"py-2\",\n            \"text-sm\",\n            \"font-medium\",\n            \"text-white\",\n            \"bg-primary-600\",\n            \"rounded-md\",\n            \"hover:bg-primary-700\",\n            \"disabled:opacity-50\",\n            \"disabled:cursor-not-allowed\",\n            \"transition-colors\",\n            \"duration-150\",\n          ].join(\" \")}\n        >\n          {isInvoking ? (\n            <>\n              <div className=\"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n              Invoking...\n            </>\n          ) : (\n            <>\n              <PlayIcon className=\"h-4 w-4\" />\n              Invoke\n            </>\n          )}\n        </button>\n\n        <button\n          type=\"button\"\n          onClick={handleReset}\n          disabled={isInvoking}\n          className={[\n            \"inline-flex\",\n            \"items-center\",\n            \"gap-1.5\",\n            \"px-3\",\n            \"py-2\",\n            \"text-sm\",\n            \"font-medium\",\n            \"text-neutral-700\",\n            \"bg-neutral-100\",\n            \"rounded-md\",\n            \"hover:bg-neutral-200\",\n            \"disabled:opacity-50\",\n            \"disabled:cursor-not-allowed\",\n            \"transition-colors\",\n            \"duration-150\",\n          ].join(\" \")}\n        >\n          <ResetIcon className=\"h-4 w-4\" />\n          Reset\n        </button>\n      </div>\n\n      {/* Result display */}\n      {showResult && lastResult && (\n        <div\n          className={[\n            \"rounded-lg\",\n            \"border\",\n            \"overflow-hidden\",\n            lastResult.success\n              ? \"bg-success-50 border-success-200\"\n              : \"bg-error-50 border-error-200\",\n          ].join(\" \")}\n        >\n          {/* Result header */}\n          <div className=\"flex items-center justify-between px-3 py-2 border-b border-inherit\">\n            <div className=\"flex items-center gap-2\">\n              <span\n                className={[\n                  \"text-xs\",\n                  \"font-semibold\",\n                  \"uppercase\",\n                  lastResult.success ? \"text-success-700\" : \"text-error-700\",\n                ].join(\" \")}\n              >\n                {lastResult.success ? \"Success\" : \"Error\"}\n              </span>\n              <span className=\"text-xs text-neutral-500\">\n                {lastResult.duration}ms\n              </span>\n            </div>\n            <button\n              type=\"button\"\n              onClick={handleCopyResult}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"gap-1\",\n                \"px-2\",\n                \"py-1\",\n                \"text-xs\",\n                \"font-medium\",\n                \"text-neutral-600\",\n                \"hover:text-neutral-900\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              {copied ? (\n                <>\n                  <CheckIcon className=\"h-3.5 w-3.5 text-success-600\" />\n                  Copied\n                </>\n              ) : (\n                <>\n                  <CopyIcon className=\"h-3.5 w-3.5\" />\n                  Copy\n                </>\n              )}\n            </button>\n          </div>\n\n          {/* Result body */}\n          <div className=\"p-3\">\n            {lastResult.success ? (\n              <pre className=\"text-xs font-mono text-neutral-800 whitespace-pre-wrap overflow-x-auto\">\n                {JSON.stringify(lastResult.result, null, 2)}\n              </pre>\n            ) : (\n              <div>\n                <p className=\"text-sm font-medium text-error-700\">\n                  {lastResult.error?.message}\n                </p>\n                {lastResult.error?.code && (\n                  <p className=\"text-xs text-error-600 mt-1\">\n                    Error code: {lastResult.error.code}\n                  </p>\n                )}\n                {lastResult.error?.data && (\n                  <pre className=\"mt-2 text-xs font-mono text-error-600 whitespace-pre-wrap overflow-x-auto\">\n                    {JSON.stringify(lastResult.error.data, null, 2)}\n                  </pre>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nMethodInvoker.displayName = \"MethodInvoker\";\n\nexport default MethodInvoker;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\testing\\PluginTester.tsx","messages":[{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'paramValues[param.name] ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":448,"column":43,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":448,"endColumn":72},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":450,"column":60,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":450,"endColumn":62,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[14069,14071],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'paramValues[param.name] ?? \"{}\"' will use Object's default stringification format ('[object Object]') when stringified.","line":471,"column":42,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":471,"endColumn":73},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'paramValues[param.name] ?? \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":500,"column":43,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":500,"endColumn":72},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":538,"column":27,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":538,"endColumn":46}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D057 - src/components/testing/PluginTester.tsx\n * ===============================================\n * Plugin test harness UI for testing plugin functionality.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D014 (Panel.tsx), D040 (PluginGallery.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Plugin info for testing.\n */\nexport interface TestablePlugin {\n  id: string;\n  name: string;\n  displayName: string;\n  contract: string;\n  version: string;\n  status: \"loaded\" | \"unloaded\" | \"error\" | \"loading\";\n  methods: PluginMethod[];\n}\n\n/**\n * Plugin method definition.\n */\nexport interface PluginMethod {\n  name: string;\n  description?: string;\n  params: MethodParam[];\n  returns?: MethodReturn;\n  required?: boolean;\n}\n\n/**\n * Method parameter.\n */\nexport interface MethodParam {\n  name: string;\n  type: string;\n  required?: boolean;\n  description?: string;\n  default?: unknown;\n}\n\n/**\n * Method return type.\n */\nexport interface MethodReturn {\n  type: string;\n  description?: string;\n  schema?: Record<string, unknown>;\n}\n\n/**\n * Test result.\n */\nexport interface TestResult {\n  method: string;\n  success: boolean;\n  duration: number;\n  request: unknown;\n  response?: unknown;\n  error?: string;\n  timestamp: Date;\n}\n\n/**\n * PluginTester component props.\n */\nexport interface PluginTesterProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\"> {\n  /** Available plugins to test */\n  plugins: TestablePlugin[];\n  /** Currently selected plugin ID */\n  selectedPluginId?: string;\n  /** Callback when plugin is selected */\n  onSelectPlugin?: (plugin: TestablePlugin) => void;\n  /** Callback when test is executed */\n  onExecuteTest?: (plugin: TestablePlugin, method: string, params: Record<string, unknown>) => Promise<TestResult>;\n  /** Test history */\n  testHistory?: TestResult[];\n  /** Whether tests are running */\n  isRunning?: boolean;\n}\n\n/**\n * Play icon.\n */\nconst PlayIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polygon points=\"5 3 19 12 5 21 5 3\" />\n  </svg>\n);\n\n/**\n * Check circle icon.\n */\nconst CheckCircleIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" />\n    <polyline points=\"22 4 12 14.01 9 11.01\" />\n  </svg>\n);\n\n/**\n * X circle icon.\n */\nconst XCircleIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\" />\n    <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\" />\n  </svg>\n);\n\n/**\n * Clock icon.\n */\nconst ClockIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <polyline points=\"12 6 12 12 16 14\" />\n  </svg>\n);\n\n/**\n * Contract badge colors.\n */\nconst contractColors: Record<string, string> = {\n  tts: \"bg-primary-100 text-primary-700\",\n  stt: \"bg-success-50 text-success-700\",\n  llm: \"bg-warning-50 text-warning-700\",\n  mcp: \"bg-info-50 text-info-700\",\n  vision: \"bg-purple-50 text-purple-700\",\n  embedding: \"bg-cyan-50 text-cyan-700\",\n  debug: \"bg-neutral-100 text-neutral-700\",\n};\n\n/**\n * PluginTester component.\n *\n * Test harness for interactively testing plugin methods. Allows selecting\n * plugins, invoking methods with parameters, and viewing results.\n *\n * @example\n * ```tsx\n * <PluginTester\n *   plugins={availablePlugins}\n *   selectedPluginId={selectedId}\n *   onSelectPlugin={(plugin) => setSelectedId(plugin.id)}\n *   onExecuteTest={async (plugin, method, params) => {\n *     return await invokePlugin(plugin.id, method, params);\n *   }}\n * />\n * ```\n */\nexport const PluginTester: React.FC<PluginTesterProps> = ({\n  plugins,\n  selectedPluginId,\n  onSelectPlugin,\n  onExecuteTest,\n  testHistory = [],\n  isRunning = false,\n  className = \"\",\n  ...props\n}) => {\n  // Selected method\n  const [selectedMethod, setSelectedMethod] = useState<string>(\"\");\n\n  // Parameter values\n  const [paramValues, setParamValues] = useState<Record<string, unknown>>({});\n\n  // Local test results\n  const [localResults, setLocalResults] = useState<TestResult[]>([]);\n\n  // Selected plugin\n  const selectedPlugin = useMemo(\n    () => plugins.find((p) => p.id === selectedPluginId),\n    [plugins, selectedPluginId]\n  );\n\n  // Selected method info\n  const selectedMethodInfo = useMemo(\n    () => selectedPlugin?.methods.find((m) => m.name === selectedMethod),\n    [selectedPlugin, selectedMethod]\n  );\n\n  // All test results (local + history)\n  const allResults = useMemo(\n    () => [...localResults, ...testHistory].slice(0, 50),\n    [localResults, testHistory]\n  );\n\n  // Handle plugin selection\n  const handlePluginSelect = useCallback(\n    (plugin: TestablePlugin) => {\n      onSelectPlugin?.(plugin);\n      setSelectedMethod(\"\");\n      setParamValues({});\n    },\n    [onSelectPlugin]\n  );\n\n  // Handle method selection\n  const handleMethodSelect = useCallback(\n    (methodName: string) => {\n      setSelectedMethod(methodName);\n      // Initialize param values with defaults\n      const method = selectedPlugin?.methods.find((m) => m.name === methodName);\n      if (method) {\n        const defaults: Record<string, unknown> = {};\n        method.params.forEach((param) => {\n          if (param.default !== undefined) {\n            defaults[param.name] = param.default;\n          }\n        });\n        setParamValues(defaults);\n      }\n    },\n    [selectedPlugin]\n  );\n\n  // Handle param change\n  const handleParamChange = useCallback((name: string, value: unknown) => {\n    setParamValues((prev) => ({ ...prev, [name]: value }));\n  }, []);\n\n  // Handle test execution\n  const handleExecuteTest = useCallback(async () => {\n    if (!selectedPlugin || !selectedMethod || !onExecuteTest) return;\n\n    const result = await onExecuteTest(selectedPlugin, selectedMethod, paramValues);\n    setLocalResults((prev) => [result, ...prev]);\n  }, [selectedPlugin, selectedMethod, paramValues, onExecuteTest]);\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"lg:flex-row\",\n    \"gap-4\",\n    \"h-full\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  // Panel styles\n  const panelStyles = [\n    \"bg-white\",\n    \"rounded-lg\",\n    \"border\",\n    \"border-neutral-200\",\n    \"overflow-hidden\",\n  ].join(\" \");\n\n  return (\n    <div className={containerStyles} {...props}>\n      {/* Plugin selector sidebar */}\n      <div className={[panelStyles, \"w-full lg:w-72 shrink-0\"].join(\" \")}>\n        <div className=\"p-4 border-b border-neutral-200 bg-neutral-50\">\n          <h3 className=\"text-sm font-semibold text-neutral-900\">Plugins</h3>\n          <p className=\"mt-1 text-xs text-neutral-500\">\n            Select a plugin to test\n          </p>\n        </div>\n        <div className=\"max-h-96 overflow-y-auto\">\n          {plugins.length === 0 ? (\n            <div className=\"p-6 text-center text-sm text-neutral-500\">\n              No plugins available\n            </div>\n          ) : (\n            <ul className=\"divide-y divide-neutral-100\">\n              {plugins.map((plugin) => (\n                <li key={plugin.id}>\n                  <button\n                    type=\"button\"\n                    onClick={() => handlePluginSelect(plugin)}\n                    disabled={plugin.status !== \"loaded\"}\n                    className={[\n                      \"w-full\",\n                      \"p-3\",\n                      \"text-left\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      selectedPluginId === plugin.id\n                        ? \"bg-primary-50\"\n                        : \"hover:bg-neutral-50\",\n                      plugin.status !== \"loaded\" && \"opacity-50 cursor-not-allowed\",\n                    ].filter(Boolean).join(\" \")}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm font-medium text-neutral-900\">\n                        {plugin.displayName}\n                      </span>\n                      <span\n                        className={[\n                          \"px-1.5\",\n                          \"py-0.5\",\n                          \"text-xs\",\n                          \"font-medium\",\n                          \"rounded\",\n                          contractColors[plugin.contract] || contractColors.debug,\n                        ].join(\" \")}\n                      >\n                        {plugin.contract.toUpperCase()}\n                      </span>\n                    </div>\n                    <div className=\"mt-1 flex items-center gap-2\">\n                      <span className=\"text-xs text-neutral-500\">v{plugin.version}</span>\n                      <span\n                        className={[\n                          \"inline-flex\",\n                          \"h-1.5\",\n                          \"w-1.5\",\n                          \"rounded-full\",\n                          plugin.status === \"loaded\" && \"bg-success-500\",\n                          plugin.status === \"unloaded\" && \"bg-neutral-400\",\n                          plugin.status === \"error\" && \"bg-error-500\",\n                          plugin.status === \"loading\" && \"bg-warning-500 animate-pulse\",\n                        ].filter(Boolean).join(\" \")}\n                      />\n                    </div>\n                  </button>\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n      </div>\n\n      {/* Method tester */}\n      <div className={[panelStyles, \"flex-1 flex flex-col\"].join(\" \")}>\n        {!selectedPlugin ? (\n          <div className=\"flex-1 flex items-center justify-center p-6\">\n            <div className=\"text-center\">\n              <PlayIcon className=\"mx-auto h-12 w-12 text-neutral-300\" />\n              <p className=\"mt-2 text-sm text-neutral-500\">\n                Select a plugin to start testing\n              </p>\n            </div>\n          </div>\n        ) : (\n          <>\n            {/* Method selector */}\n            <div className=\"p-4 border-b border-neutral-200 bg-neutral-50\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-sm font-semibold text-neutral-900\">\n                  {selectedPlugin.displayName}\n                </h3>\n                <span className=\"text-xs text-neutral-500\">\n                  {selectedPlugin.methods.length} methods\n                </span>\n              </div>\n              <div className=\"mt-3 flex flex-wrap gap-2\">\n                {selectedPlugin.methods.map((method) => (\n                  <button\n                    key={method.name}\n                    type=\"button\"\n                    onClick={() => handleMethodSelect(method.name)}\n                    className={[\n                      \"px-3\",\n                      \"py-1.5\",\n                      \"text-sm\",\n                      \"font-medium\",\n                      \"rounded-md\",\n                      \"border\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      selectedMethod === method.name\n                        ? \"bg-primary-100 border-primary-300 text-primary-700\"\n                        : \"bg-white border-neutral-200 text-neutral-700 hover:border-neutral-300\",\n                      method.required && \"ring-1 ring-primary-200\",\n                    ].filter(Boolean).join(\" \")}\n                  >\n                    {method.name}()\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Parameter editor */}\n            {selectedMethodInfo && (\n              <div className=\"p-4 border-b border-neutral-200\">\n                <h4 className=\"text-sm font-medium text-neutral-700 mb-3\">\n                  Parameters\n                </h4>\n                {selectedMethodInfo.params.length === 0 ? (\n                  <p className=\"text-sm text-neutral-500 italic\">\n                    No parameters required\n                  </p>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {selectedMethodInfo.params.map((param) => (\n                      <div key={param.name}>\n                        <label className=\"flex items-center gap-2 text-sm font-medium text-neutral-700 mb-1\">\n                          {param.name}\n                          <span className=\"text-xs font-normal text-neutral-400\">\n                            ({param.type})\n                          </span>\n                          {param.required && (\n                            <span className=\"text-error-500\">*</span>\n                          )}\n                        </label>\n                        {param.type === \"str\" || param.type === \"string\" ? (\n                          <textarea\n                            value={String(paramValues[param.name] ?? \"\")}\n                            onChange={(e) => handleParamChange(param.name, e.target.value)}\n                            placeholder={param.description || `Enter ${param.name}`}\n                            rows={2}\n                            className={[\n                              \"w-full\",\n                              \"px-3\",\n                              \"py-2\",\n                              \"text-sm\",\n                              \"bg-white\",\n                              \"border\",\n                              \"border-neutral-300\",\n                              \"rounded-md\",\n                              \"focus:outline-none\",\n                              \"focus:ring-2\",\n                              \"focus:ring-primary-500\",\n                            ].join(\" \")}\n                          />\n                        ) : param.type === \"dict\" || param.type === \"object\" ? (\n                          <textarea\n                            value={\n                              typeof paramValues[param.name] === \"object\"\n                                ? JSON.stringify(paramValues[param.name], null, 2)\n                                : String(paramValues[param.name] ?? \"{}\")\n                            }\n                            onChange={(e) => {\n                              try {\n                                handleParamChange(param.name, JSON.parse(e.target.value));\n                              } catch {\n                                // Keep as string if invalid JSON\n                              }\n                            }}\n                            placeholder='{\"key\": \"value\"}'\n                            rows={3}\n                            className={[\n                              \"w-full\",\n                              \"px-3\",\n                              \"py-2\",\n                              \"text-sm\",\n                              \"font-mono\",\n                              \"bg-white\",\n                              \"border\",\n                              \"border-neutral-300\",\n                              \"rounded-md\",\n                              \"focus:outline-none\",\n                              \"focus:ring-2\",\n                              \"focus:ring-primary-500\",\n                            ].join(\" \")}\n                          />\n                        ) : (\n                          <input\n                            type={param.type === \"int\" || param.type === \"float\" ? \"number\" : \"text\"}\n                            value={String(paramValues[param.name] ?? \"\")}\n                            onChange={(e) => {\n                              const val = param.type === \"int\"\n                                ? parseInt(e.target.value, 10)\n                                : param.type === \"float\"\n                                  ? parseFloat(e.target.value)\n                                  : e.target.value;\n                              handleParamChange(param.name, val);\n                            }}\n                            placeholder={param.description}\n                            className={[\n                              \"w-full\",\n                              \"px-3\",\n                              \"py-2\",\n                              \"text-sm\",\n                              \"bg-white\",\n                              \"border\",\n                              \"border-neutral-300\",\n                              \"rounded-md\",\n                              \"focus:outline-none\",\n                              \"focus:ring-2\",\n                              \"focus:ring-primary-500\",\n                            ].join(\" \")}\n                          />\n                        )}\n                        {param.description && (\n                          <p className=\"mt-1 text-xs text-neutral-500\">\n                            {param.description}\n                          </p>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {/* Execute button */}\n                <button\n                  type=\"button\"\n                  onClick={handleExecuteTest}\n                  disabled={isRunning || !onExecuteTest}\n                  className={[\n                    \"mt-4\",\n                    \"inline-flex\",\n                    \"items-center\",\n                    \"gap-2\",\n                    \"px-4\",\n                    \"py-2\",\n                    \"text-sm\",\n                    \"font-medium\",\n                    \"text-white\",\n                    \"bg-primary-600\",\n                    \"rounded-md\",\n                    \"hover:bg-primary-700\",\n                    \"disabled:opacity-50\",\n                    \"disabled:cursor-not-allowed\",\n                    \"transition-colors\",\n                    \"duration-150\",\n                  ].join(\" \")}\n                >\n                  {isRunning ? (\n                    <>\n                      <div className=\"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                      Running...\n                    </>\n                  ) : (\n                    <>\n                      <PlayIcon className=\"h-4 w-4\" />\n                      Execute\n                    </>\n                  )}\n                </button>\n              </div>\n            )}\n\n            {/* Results area */}\n            <div className=\"flex-1 overflow-y-auto\">\n              <div className=\"p-4\">\n                <h4 className=\"text-sm font-medium text-neutral-700 mb-3\">\n                  Test Results ({allResults.length})\n                </h4>\n                {allResults.length === 0 ? (\n                  <p className=\"text-sm text-neutral-500 italic\">\n                    No test results yet\n                  </p>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {allResults.map((result, index) => (\n                      <div\n                        key={index}\n                        className={[\n                          \"p-3\",\n                          \"rounded-lg\",\n                          \"border\",\n                          result.success\n                            ? \"bg-success-50 border-success-200\"\n                            : \"bg-error-50 border-error-200\",\n                        ].join(\" \")}\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2\">\n                            {result.success ? (\n                              <CheckCircleIcon className=\"h-4 w-4 text-success-600\" />\n                            ) : (\n                              <XCircleIcon className=\"h-4 w-4 text-error-600\" />\n                            )}\n                            <span className=\"text-sm font-medium\">\n                              {result.method}()\n                            </span>\n                          </div>\n                          <div className=\"flex items-center gap-2 text-xs text-neutral-500\">\n                            <ClockIcon className=\"h-3.5 w-3.5\" />\n                            {result.duration}ms\n                          </div>\n                        </div>\n\n                        {result.error && (\n                          <p className=\"mt-2 text-sm text-error-700\">\n                            {result.error}\n                          </p>\n                        )}\n\n                        {result.response && (\n                          <pre className=\"mt-2 p-2 bg-white rounded text-xs font-mono overflow-x-auto\">\n                            {JSON.stringify(result.response, null, 2)}\n                          </pre>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nPluginTester.displayName = \"PluginTester\";\n\nexport default PluginTester;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\testing\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\ApiKeyManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":101,"column":32,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":101,"endColumn":46},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":219,"column":32,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":219,"endColumn":46},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":314,"column":73,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12300,12301],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12300,12301],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12300,12301],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12300,12301],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":314,"column":86,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[12313,12314],"text":"&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[12313,12314],"text":"&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[12313,12314],"text":"&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[12313,12314],"text":"&rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":333,"column":33,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":333,"endColumn":48},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":372,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":372,"endColumn":36,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[14354,14354],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[14354,14354],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":376,"column":25,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":376,"endColumn":46},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":498,"column":49,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":498,"endColumn":82}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ApiKeyManager.tsx\r\n * =================\r\n * Component for managing API keys in the Settings panel.\r\n * Provides CRUD operations for API keys with masked display.\r\n * \r\n * D079 - API Key Management (EUR-1.2.6)\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n    useApiKeyStore,\r\n    API_KEY_SERVICE_LABELS,\r\n    type ApiKeyService,\r\n    type ApiKeyEntry,\r\n} from '../../stores/apiKeyStore';\r\n\r\n// ============================================\r\n// TYPES\r\n// ============================================\r\n\r\ninterface AddKeyModalProps {\r\n    isOpen: boolean;\r\n    service: ApiKeyService;\r\n    onClose: () => void;\r\n    onAdd: (name: string, key: string) => Promise<void>;\r\n}\r\n\r\ninterface EditKeyModalProps {\r\n    isOpen: boolean;\r\n    entry: ApiKeyEntry | null;\r\n    service: ApiKeyService;\r\n    onClose: () => void;\r\n    onSave: (id: string, name: string, key?: string) => Promise<void>;\r\n}\r\n\r\ninterface DeleteConfirmModalProps {\r\n    isOpen: boolean;\r\n    entry: ApiKeyEntry | null;\r\n    onClose: () => void;\r\n    onConfirm: () => Promise<void>;\r\n}\r\n\r\n// ============================================\r\n// ADD KEY MODAL\r\n// ============================================\r\n\r\nconst AddKeyModal: React.FC<AddKeyModalProps> = ({ isOpen, service, onClose, onAdd }) => {\r\n    const [name, setName] = useState('');\r\n    const [key, setKey] = useState('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    // Reset form when modal opens\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            setName('');\r\n            setKey('');\r\n            setError('');\r\n        }\r\n    }, [isOpen]);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (!name.trim()) {\r\n            setError('Please enter a name for this key');\r\n            return;\r\n        }\r\n        if (!key.trim()) {\r\n            setError('Please enter the API key');\r\n            return;\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n        setError('');\r\n\r\n        try {\r\n            await onAdd(name.trim(), key.trim());\r\n            onClose();\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to add key');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4\">\r\n            <div className=\"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"px-6 py-4 bg-neutral-50 border-b border-neutral-200\">\r\n                    <h3 className=\"text-lg font-semibold text-neutral-900\">\r\n                        Add API Key - {API_KEY_SERVICE_LABELS[service]}\r\n                    </h3>\r\n                </div>\r\n\r\n                {/* Form */}\r\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n                    {error && (\r\n                        <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700\">\r\n                            {error}\r\n                        </div>\r\n                    )}\r\n\r\n                    <div>\r\n                        <label htmlFor=\"keyName\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            Key Name\r\n                        </label>\r\n                        <input\r\n                            id=\"keyName\"\r\n                            type=\"text\"\r\n                            value={name}\r\n                            onChange={(e) => setName(e.target.value)}\r\n                            placeholder=\"e.g., Production, Development, Testing\"\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg text-neutral-900 placeholder-neutral-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label htmlFor=\"apiKey\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            API Key\r\n                        </label>\r\n                        <input\r\n                            id=\"apiKey\"\r\n                            type=\"password\"\r\n                            value={key}\r\n                            onChange={(e) => setKey(e.target.value)}\r\n                            placeholder=\"Paste your API key here\"\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg text-neutral-900 placeholder-neutral-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-mono\"\r\n                        />\r\n                        <p className=\"mt-1 text-xs text-neutral-500\">\r\n                            Your key will be stored securely and only the first 3 and last 3 characters will be displayed.\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Buttons */}\r\n                    <div className=\"flex justify-end gap-3 pt-4\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            disabled={isSubmitting}\r\n                            className=\"px-4 py-2 text-neutral-700 hover:bg-neutral-100 rounded-lg transition-colors\"\r\n                        >\r\n                            Cancel\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={isSubmitting}\r\n                            className=\"px-4 py-2 bg-primary-500 text-white font-medium rounded-lg hover:bg-primary-600 disabled:opacity-50 transition-colors\"\r\n                        >\r\n                            {isSubmitting ? 'Adding...' : 'Add Key'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ============================================\r\n// EDIT KEY MODAL\r\n// ============================================\r\n\r\nconst EditKeyModal: React.FC<EditKeyModalProps> = ({ isOpen, entry, service: _service, onClose, onSave }) => {\r\n    const [name, setName] = useState('');\r\n    const [key, setKey] = useState('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    // Populate form when entry changes\r\n    useEffect(() => {\r\n        if (entry) {\r\n            setName(entry.name);\r\n            setKey(''); // Don't show masked key in edit field\r\n            setError('');\r\n        }\r\n    }, [entry]);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (!entry) return;\r\n        if (!name.trim()) {\r\n            setError('Please enter a name');\r\n            return;\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n        setError('');\r\n\r\n        try {\r\n            // Only pass key if user entered a new one\r\n            const newKey = key.trim() || undefined;\r\n            await onSave(entry.id, name.trim(), newKey);\r\n            onClose();\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to update key');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen || !entry) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4\">\r\n            <div className=\"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"px-6 py-4 bg-neutral-50 border-b border-neutral-200\">\r\n                    <h3 className=\"text-lg font-semibold text-neutral-900\">\r\n                        Edit API Key\r\n                    </h3>\r\n                </div>\r\n\r\n                {/* Form */}\r\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n                    {error && (\r\n                        <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700\">\r\n                            {error}\r\n                        </div>\r\n                    )}\r\n\r\n                    <div>\r\n                        <label htmlFor=\"editKeyName\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            Key Name\r\n                        </label>\r\n                        <input\r\n                            id=\"editKeyName\"\r\n                            type=\"text\"\r\n                            value={name}\r\n                            onChange={(e) => setName(e.target.value)}\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg text-neutral-900 focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label htmlFor=\"editApiKey\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            New API Key <span className=\"text-neutral-400 font-normal\">(optional)</span>\r\n                        </label>\r\n                        <input\r\n                            id=\"editApiKey\"\r\n                            type=\"password\"\r\n                            value={key}\r\n                            onChange={(e) => setKey(e.target.value)}\r\n                            placeholder=\"Leave empty to keep current key\"\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg text-neutral-900 placeholder-neutral-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-mono\"\r\n                        />\r\n                        <p className=\"mt-1 text-xs text-neutral-500\">\r\n                            Current key: <span className=\"font-mono\">{entry.keyMasked}</span>\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Buttons */}\r\n                    <div className=\"flex justify-end gap-3 pt-4\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            disabled={isSubmitting}\r\n                            className=\"px-4 py-2 text-neutral-700 hover:bg-neutral-100 rounded-lg transition-colors\"\r\n                        >\r\n                            Cancel\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={isSubmitting}\r\n                            className=\"px-4 py-2 bg-primary-500 text-white font-medium rounded-lg hover:bg-primary-600 disabled:opacity-50 transition-colors\"\r\n                        >\r\n                            {isSubmitting ? 'Saving...' : 'Save Changes'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ============================================\r\n// DELETE CONFIRM MODAL\r\n// ============================================\r\n\r\nconst DeleteConfirmModal: React.FC<DeleteConfirmModalProps> = ({ isOpen, entry, onClose, onConfirm }) => {\r\n    const [isDeleting, setIsDeleting] = useState(false);\r\n\r\n    const handleConfirm = async () => {\r\n        setIsDeleting(true);\r\n        try {\r\n            await onConfirm();\r\n            onClose();\r\n        } catch {\r\n            // Error handled by parent\r\n        } finally {\r\n            setIsDeleting(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen || !entry) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4\">\r\n            <div className=\"bg-white rounded-xl shadow-2xl max-w-sm w-full overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"px-6 py-4 bg-red-50 border-b border-red-200\">\r\n                    <h3 className=\"text-lg font-semibold text-red-700\">\r\n                        Delete API Key\r\n                    </h3>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"p-6\">\r\n                    <p className=\"text-neutral-700\">\r\n                        Are you sure you want to delete the key <strong>\"{entry.name}\"</strong>?\r\n                    </p>\r\n                    <p className=\"mt-2 text-sm text-neutral-500\">\r\n                        This action cannot be undone.\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Buttons */}\r\n                <div className=\"px-6 py-4 bg-neutral-50 border-t border-neutral-200 flex justify-end gap-3\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={onClose}\r\n                        disabled={isDeleting}\r\n                        className=\"px-4 py-2 text-neutral-700 hover:bg-neutral-100 rounded-lg transition-colors\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={handleConfirm}\r\n                        disabled={isDeleting}\r\n                        className=\"px-4 py-2 bg-red-500 text-white font-medium rounded-lg hover:bg-red-600 disabled:opacity-50 transition-colors\"\r\n                    >\r\n                        {isDeleting ? 'Deleting...' : 'Delete'}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ============================================\r\n// MAIN COMPONENT\r\n// ============================================\r\n\r\nexport const ApiKeyManager: React.FC = () => {\r\n    const {\r\n        keys,\r\n        selectedService,\r\n        isLoading,\r\n        error,\r\n        setSelectedService,\r\n        fetchKeys,\r\n        addKey,\r\n        updateKey,\r\n        deleteKey,\r\n        setActiveKey,\r\n        clearError,\r\n    } = useApiKeyStore();\r\n\r\n    // Modal states\r\n    const [showAddModal, setShowAddModal] = useState(false);\r\n    const [editEntry, setEditEntry] = useState<ApiKeyEntry | null>(null);\r\n    const [deleteEntry, setDeleteEntry] = useState<ApiKeyEntry | null>(null);\r\n    const [isExpanded, setIsExpanded] = useState(true);\r\n\r\n    // Fetch keys when component mounts or service changes\r\n    useEffect(() => {\r\n        fetchKeys(selectedService);\r\n    }, [selectedService, fetchKeys]);\r\n\r\n    // Get current service keys\r\n    const serviceKeys = keys[selectedService] || [];\r\n\r\n    // Handlers\r\n    const handleServiceChange = useCallback((e: React.ChangeEvent<HTMLSelectElement>) => {\r\n        setSelectedService(e.target.value as ApiKeyService);\r\n    }, [setSelectedService]);\r\n\r\n    const handleAddKey = useCallback(async (name: string, key: string) => {\r\n        await addKey(selectedService, name, key);\r\n    }, [addKey, selectedService]);\r\n\r\n    const handleUpdateKey = useCallback(async (id: string, name: string, key?: string) => {\r\n        await updateKey(selectedService, id, name, key);\r\n    }, [updateKey, selectedService]);\r\n\r\n    const handleDeleteKey = useCallback(async () => {\r\n        if (deleteEntry) {\r\n            await deleteKey(selectedService, deleteEntry.id);\r\n        }\r\n    }, [deleteKey, selectedService, deleteEntry]);\r\n\r\n    const handleSetActive = useCallback(async (id: string) => {\r\n        await setActiveKey(selectedService, id);\r\n    }, [setActiveKey, selectedService]);\r\n\r\n    return (\r\n        <div className=\"border border-neutral-200 rounded-lg overflow-hidden\">\r\n            {/* Header */}\r\n            <button\r\n                type=\"button\"\r\n                onClick={() => setIsExpanded(!isExpanded)}\r\n                className=\"w-full flex items-center justify-between px-4 py-3 bg-neutral-50 hover:bg-neutral-100 transition-colors\"\r\n            >\r\n                <div className=\"flex items-center gap-2\">\r\n                    <svg className=\"h-5 w-5 text-neutral-600\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                        <path d=\"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4\" />\r\n                    </svg>\r\n                    <span className=\"font-medium text-neutral-900\">API Keys</span>\r\n                    {serviceKeys.length > 0 && (\r\n                        <span className=\"px-2 py-0.5 text-xs bg-neutral-200 text-neutral-600 rounded-full\">\r\n                            {serviceKeys.length}\r\n                        </span>\r\n                    )}\r\n                </div>\r\n                <svg\r\n                    className={`h-5 w-5 text-neutral-500 transition-transform ${isExpanded ? 'rotate-180' : ''}`}\r\n                    viewBox=\"0 0 24 24\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    strokeWidth=\"2\"\r\n                >\r\n                    <polyline points=\"6 9 12 15 18 9\" />\r\n                </svg>\r\n            </button>\r\n\r\n            {/* Content */}\r\n            {isExpanded && (\r\n                <div className=\"p-4 space-y-4\">\r\n                    {/* Error Message */}\r\n                    {error && (\r\n                        <div className=\"flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n                            <span className=\"text-sm text-red-700\">{error}</span>\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={clearError}\r\n                                className=\"text-red-500 hover:text-red-700\"\r\n                            >\r\n                                <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n                                    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n                                </svg>\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Service Selector */}\r\n                    <div>\r\n                        <label htmlFor=\"serviceSelect\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            Service\r\n                        </label>\r\n                        <select\r\n                            id=\"serviceSelect\"\r\n                            value={selectedService}\r\n                            onChange={handleServiceChange}\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-white text-neutral-900 focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                        >\r\n                            {Object.entries(API_KEY_SERVICE_LABELS).map(([id, label]) => (\r\n                                <option key={id} value={id}>{label}</option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n\r\n                    {/* Keys List */}\r\n                    <div className=\"space-y-2\">\r\n                        {isLoading ? (\r\n                            <div className=\"text-center py-4 text-neutral-500\">\r\n                                <svg className=\"animate-spin h-5 w-5 mx-auto mb-2\" viewBox=\"0 0 24 24\" fill=\"none\">\r\n                                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\r\n                                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\r\n                                </svg>\r\n                                Loading keys...\r\n                            </div>\r\n                        ) : serviceKeys.length === 0 ? (\r\n                            <div className=\"text-center py-6 text-neutral-500\">\r\n                                <svg className=\"h-10 w-10 mx-auto mb-2 opacity-50\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n                                    <path d=\"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4\" />\r\n                                </svg>\r\n                                <p>No API keys configured for {API_KEY_SERVICE_LABELS[selectedService]}</p>\r\n                                <p className=\"text-xs mt-1\">Add a key to get started</p>\r\n                            </div>\r\n                        ) : (\r\n                            serviceKeys.map((entry) => (\r\n                                <div\r\n                                    key={entry.id}\r\n                                    className={`flex items-center gap-3 p-3 rounded-lg border ${entry.isActive\r\n                                        ? 'border-primary-300 bg-primary-50'\r\n                                        : 'border-neutral-200 bg-white'\r\n                                        }`}\r\n                                >\r\n                                    {/* Radio button */}\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={() => handleSetActive(entry.id)}\r\n                                        className={`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ${entry.isActive\r\n                                            ? 'border-primary-500 bg-primary-500'\r\n                                            : 'border-neutral-300 hover:border-primary-400'\r\n                                            }`}\r\n                                        title={entry.isActive ? 'Active key' : 'Set as active'}\r\n                                    >\r\n                                        {entry.isActive && (\r\n                                            <div className=\"w-2 h-2 rounded-full bg-white\" />\r\n                                        )}\r\n                                    </button>\r\n\r\n                                    {/* Key Info */}\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <div className=\"font-medium text-neutral-900 truncate\">\r\n                                            {entry.name}\r\n                                        </div>\r\n                                        <div className=\"text-sm text-neutral-500 font-mono\">\r\n                                            {entry.keyMasked}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Actions */}\r\n                                    <div className=\"flex items-center gap-1\">\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            onClick={() => setEditEntry(entry)}\r\n                                            className=\"p-2 text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100 rounded-lg transition-colors\"\r\n                                            title=\"Edit key\"\r\n                                        >\r\n                                            <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                                <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" />\r\n                                                <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" />\r\n                                            </svg>\r\n                                        </button>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            onClick={() => setDeleteEntry(entry)}\r\n                                            className=\"p-2 text-neutral-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors\"\r\n                                            title=\"Delete key\"\r\n                                        >\r\n                                            <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                                <polyline points=\"3 6 5 6 21 6\" />\r\n                                                <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\r\n                                            </svg>\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            ))\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Add Button */}\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => setShowAddModal(true)}\r\n                        className=\"w-full flex items-center justify-center gap-2 px-4 py-2 border-2 border-dashed border-neutral-300 text-neutral-600 rounded-lg hover:border-primary-400 hover:text-primary-600 transition-colors\"\r\n                    >\r\n                        <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\r\n                            <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\r\n                        </svg>\r\n                        Add New Key\r\n                    </button>\r\n                </div>\r\n            )}\r\n\r\n            {/* Modals */}\r\n            <AddKeyModal\r\n                isOpen={showAddModal}\r\n                service={selectedService}\r\n                onClose={() => setShowAddModal(false)}\r\n                onAdd={handleAddKey}\r\n            />\r\n            <EditKeyModal\r\n                isOpen={!!editEntry}\r\n                entry={editEntry}\r\n                service={selectedService}\r\n                onClose={() => setEditEntry(null)}\r\n                onSave={handleUpdateKey}\r\n            />\r\n            <DeleteConfirmModal\r\n                isOpen={!!deleteEntry}\r\n                entry={deleteEntry}\r\n                onClose={() => setDeleteEntry(null)}\r\n                onConfirm={handleDeleteKey}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\Button.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":210,"column":28,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":210,"endColumn":30,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[4812,4814],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":211,"column":33,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":211,"endColumn":35,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[4856,4858],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D010 - src/components/ui/Button.tsx\n * ====================================\n * Atomic button component using design tokens only.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing tokens\n *   - Fully typed props with TypeScript\n *   - Accessible by default (ARIA, keyboard navigation)\n */\n\nimport {\n  forwardRef,\n  type ButtonHTMLAttributes,\n  type ReactNode,\n} from \"react\";\n\n/**\n * Button variant styles mapped to Tailwind classes.\n * All colors reference semantic token aliases from design_tokens.css.\n */\nconst variants = {\n  primary: [\n    \"bg-primary-600\",\n    \"text-white\",\n    \"hover:bg-primary-700\",\n    \"focus:ring-primary-500\",\n    \"active:bg-primary-800\",\n    \"disabled:bg-primary-300\",\n  ].join(\" \"),\n\n  secondary: [\n    \"bg-neutral-100\",\n    \"text-neutral-800\",\n    \"hover:bg-neutral-200\",\n    \"focus:ring-neutral-400\",\n    \"active:bg-neutral-300\",\n    \"border\",\n    \"border-neutral-300\",\n    \"disabled:bg-neutral-50\",\n    \"disabled:text-neutral-400\",\n  ].join(\" \"),\n\n  outline: [\n    \"bg-transparent\",\n    \"text-primary-600\",\n    \"border\",\n    \"border-primary-600\",\n    \"hover:bg-primary-50\",\n    \"focus:ring-primary-500\",\n    \"active:bg-primary-100\",\n    \"disabled:text-primary-300\",\n    \"disabled:border-primary-300\",\n  ].join(\" \"),\n\n  ghost: [\n    \"bg-transparent\",\n    \"text-neutral-700\",\n    \"hover:bg-neutral-100\",\n    \"focus:ring-neutral-400\",\n    \"active:bg-neutral-200\",\n    \"disabled:text-neutral-400\",\n  ].join(\" \"),\n\n  danger: [\n    \"bg-error-600\",\n    \"text-white\",\n    \"hover:bg-error-700\",\n    \"focus:ring-error-500\",\n    \"active:bg-error-800\",\n    \"disabled:bg-error-300\",\n  ].join(\" \"),\n\n  success: [\n    \"bg-success-600\",\n    \"text-white\",\n    \"hover:bg-success-700\",\n    \"focus:ring-success-500\",\n    \"active:bg-success-800\",\n    \"disabled:bg-success-300\",\n  ].join(\" \"),\n} as const;\n\n/**\n * Button size styles mapped to Tailwind classes.\n * Uses spacing tokens from design system.\n */\nconst sizes = {\n  xs: \"px-2 py-1 text-xs gap-1\",\n  sm: \"px-3 py-1.5 text-sm gap-1.5\",\n  md: \"px-4 py-2 text-base gap-2\",\n  lg: \"px-5 py-2.5 text-lg gap-2.5\",\n  xl: \"px-6 py-3 text-xl gap-3\",\n} as const;\n\n/**\n * Icon-only button sizes (square aspect ratio).\n */\nconst iconSizes = {\n  xs: \"p-1 text-xs\",\n  sm: \"p-1.5 text-sm\",\n  md: \"p-2 text-base\",\n  lg: \"p-2.5 text-lg\",\n  xl: \"p-3 text-xl\",\n} as const;\n\n/**\n * Button component props.\n */\nexport interface ButtonProps\n  extends ButtonHTMLAttributes<HTMLButtonElement> {\n  /** Visual variant */\n  variant?: keyof typeof variants;\n  /** Size preset */\n  size?: keyof typeof sizes;\n  /** Render as icon-only button (square) */\n  iconOnly?: boolean;\n  /** Loading state - shows spinner and disables interaction */\n  loading?: boolean;\n  /** Full width button */\n  fullWidth?: boolean;\n  /** Icon on the left side of text */\n  leftIcon?: ReactNode;\n  /** Icon on the right side of text */\n  rightIcon?: ReactNode;\n  /** Pill-shaped corners */\n  pill?: boolean;\n}\n\n/**\n * Button component.\n *\n * A fully accessible button with multiple variants, sizes, and states.\n * Uses design tokens exclusively for consistent theming.\n *\n * @example\n * ```tsx\n * <Button variant=\"primary\" size=\"md\">\n *   Click me\n * </Button>\n *\n * <Button variant=\"outline\" leftIcon={<PlusIcon />}>\n *   Add item\n * </Button>\n *\n * <Button loading>\n *   Saving...\n * </Button>\n * ```\n */\nexport const Button = forwardRef<HTMLButtonElement, ButtonProps>(\n  (\n    {\n      variant = \"primary\",\n      size = \"md\",\n      iconOnly = false,\n      loading = false,\n      fullWidth = false,\n      leftIcon,\n      rightIcon,\n      pill = false,\n      disabled,\n      className = \"\",\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    // Base styles applied to all buttons\n    const baseStyles = [\n      \"inline-flex\",\n      \"items-center\",\n      \"justify-center\",\n      \"font-medium\",\n      \"transition-all\",\n      \"duration-150\",\n      \"focus:outline-none\",\n      \"focus:ring-2\",\n      \"focus:ring-offset-2\",\n      \"disabled:cursor-not-allowed\",\n      \"disabled:opacity-60\",\n    ].join(\" \");\n\n    // Determine border radius\n    const radiusStyles = pill ? \"rounded-full\" : \"rounded-md\";\n\n    // Determine size styles based on iconOnly mode\n    const sizeStyles = iconOnly ? iconSizes[size] : sizes[size];\n\n    // Compose final class string\n    const buttonClasses = [\n      baseStyles,\n      variants[variant],\n      sizeStyles,\n      radiusStyles,\n      fullWidth ? \"w-full\" : \"\",\n      className,\n    ]\n      .filter(Boolean)\n      .join(\" \");\n\n    return (\n      <button\n        ref={ref}\n        className={buttonClasses}\n        disabled={disabled || loading}\n        aria-disabled={disabled || loading}\n        aria-busy={loading}\n        {...props}\n      >\n        {/* Loading spinner - replaces left icon when loading */}\n        {loading && (\n          <svg\n            className=\"animate-spin h-4 w-4 shrink-0\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            aria-hidden=\"true\"\n          >\n            <circle\n              className=\"opacity-25\"\n              cx=\"12\"\n              cy=\"12\"\n              r=\"10\"\n              stroke=\"currentColor\"\n              strokeWidth=\"4\"\n            />\n            <path\n              className=\"opacity-75\"\n              fill=\"currentColor\"\n              d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n            />\n          </svg>\n        )}\n\n        {/* Left icon - hidden when loading */}\n        {!loading && leftIcon && (\n          <span className=\"shrink-0\" aria-hidden=\"true\">\n            {leftIcon}\n          </span>\n        )}\n\n        {/* Button text content */}\n        {children && <span>{children}</span>}\n\n        {/* Right icon */}\n        {rightIcon && (\n          <span className=\"shrink-0\" aria-hidden=\"true\">\n            {rightIcon}\n          </span>\n        )}\n      </button>\n    );\n  }\n);\n\nButton.displayName = \"Button\";\n\nexport default Button;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\Checkbox.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":173,"column":27,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":173,"endColumn":29,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3880,3882],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":304,"column":19,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":304,"endColumn":21,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[7737,7739],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D013 - src/components/ui/Checkbox.tsx\n * ======================================\n * Atomic checkbox component using design tokens only.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing tokens\n *   - Fully typed props with TypeScript\n *   - Accessible by default (ARIA, keyboard navigation)\n */\n\nimport {\n  forwardRef,\n  useId,\n  type InputHTMLAttributes,\n  type ReactNode,\n} from \"react\";\n\n/**\n * Checkbox size styles mapped to Tailwind classes.\n */\nconst sizes = {\n  sm: {\n    checkbox: \"h-4 w-4\",\n    label: \"text-sm\",\n    gap: \"gap-2\",\n  },\n  md: {\n    checkbox: \"h-5 w-5\",\n    label: \"text-base\",\n    gap: \"gap-2.5\",\n  },\n  lg: {\n    checkbox: \"h-6 w-6\",\n    label: \"text-lg\",\n    gap: \"gap-3\",\n  },\n} as const;\n\n/**\n * Color variant styles for checkbox.\n */\nconst colorVariants = {\n  primary: {\n    checked: \"checked:bg-primary-600 checked:border-primary-600\",\n    focus: \"focus:ring-primary-500\",\n  },\n  success: {\n    checked: \"checked:bg-success-600 checked:border-success-600\",\n    focus: \"focus:ring-success-500\",\n  },\n  warning: {\n    checked: \"checked:bg-warning-600 checked:border-warning-600\",\n    focus: \"focus:ring-warning-500\",\n  },\n  error: {\n    checked: \"checked:bg-error-600 checked:border-error-600\",\n    focus: \"focus:ring-error-500\",\n  },\n} as const;\n\n/**\n * Checkbox component props.\n */\nexport interface CheckboxProps\n  extends Omit<InputHTMLAttributes<HTMLInputElement>, \"size\" | \"type\"> {\n  /** Size preset */\n  size?: keyof typeof sizes;\n  /** Color variant when checked */\n  colorScheme?: keyof typeof colorVariants;\n  /** Label text */\n  label?: ReactNode;\n  /** Description text below label */\n  description?: string;\n  /** Error state */\n  error?: boolean;\n  /** Error message to display */\n  errorMessage?: string;\n  /** Indeterminate state (partially checked) */\n  indeterminate?: boolean;\n  /** Required field indicator */\n  isRequired?: boolean;\n}\n\n/**\n * Checkmark icon SVG.\n */\nconst CheckIcon = () => (\n  <svg\n    className=\"absolute h-full w-full text-white pointer-events-none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"3\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Minus icon for indeterminate state.\n */\nconst MinusIcon = () => (\n  <svg\n    className=\"absolute h-full w-full text-white pointer-events-none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"3\"\n    strokeLinecap=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Checkbox component.\n *\n * A fully accessible checkbox with support for labels, descriptions,\n * error states, and indeterminate state. Uses design tokens exclusively.\n *\n * @example\n * ```tsx\n * <Checkbox\n *   label=\"Accept terms and conditions\"\n *   description=\"You must accept to continue\"\n * />\n *\n * <Checkbox\n *   label=\"Select all\"\n *   indeterminate\n * />\n *\n * <Checkbox\n *   label=\"Agree to policy\"\n *   error\n *   errorMessage=\"You must agree to the policy\"\n * />\n * ```\n */\nexport const Checkbox = forwardRef<HTMLInputElement, CheckboxProps>(\n  (\n    {\n      size = \"md\",\n      colorScheme = \"primary\",\n      label,\n      description,\n      error = false,\n      errorMessage,\n      indeterminate = false,\n      isRequired = false,\n      disabled,\n      checked,\n      defaultChecked,\n      id,\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    // Generate unique ID for accessibility if not provided\n    const generatedId = useId();\n    const checkboxId = id || generatedId;\n    const errorId = `${checkboxId}-error`;\n    const descriptionId = `${checkboxId}-description`;\n\n    // Get size configuration\n    const sizeConfig = sizes[size];\n    const colorConfig = colorVariants[colorScheme];\n\n    // Base checkbox styles (the actual input)\n    const checkboxBaseStyles = [\n      \"appearance-none\",\n      \"shrink-0\",\n      \"rounded\",\n      \"border-2\",\n      \"border-neutral-300\",\n      \"bg-white\",\n      \"cursor-pointer\",\n      \"transition-all\",\n      \"duration-150\",\n      \"focus:outline-none\",\n      \"focus:ring-2\",\n      \"focus:ring-offset-2\",\n      colorConfig.focus,\n      colorConfig.checked,\n      \"hover:border-neutral-400\",\n      \"checked:hover:opacity-90\",\n      \"disabled:bg-neutral-100\",\n      \"disabled:border-neutral-200\",\n      \"disabled:cursor-not-allowed\",\n      \"disabled:checked:bg-neutral-400\",\n      \"disabled:checked:border-neutral-400\",\n    ].join(\" \");\n\n    // Error state border\n    const errorBorderStyles = error\n      ? \"border-error-500 focus:ring-error-500\"\n      : \"\";\n\n    // Compose checkbox classes\n    const checkboxClasses = [\n      checkboxBaseStyles,\n      sizeConfig.checkbox,\n      errorBorderStyles,\n    ]\n      .filter(Boolean)\n      .join(\" \");\n\n    // Label text styles\n    const labelStyles = [\n      sizeConfig.label,\n      \"font-medium\",\n      \"select-none\",\n      error ? \"text-error-700\" : \"text-neutral-700\",\n      disabled ? \"text-neutral-400\" : \"\",\n    ]\n      .filter(Boolean)\n      .join(\" \");\n\n    // Container styles\n    const containerStyles = [\n      \"inline-flex\",\n      \"items-start\",\n      sizeConfig.gap,\n      className,\n    ]\n      .filter(Boolean)\n      .join(\" \");\n\n    // Determine if checkbox should appear checked\n    const isChecked = checked ?? defaultChecked ?? false;\n\n    return (\n      <div className=\"flex flex-col\">\n        <label className={containerStyles}>\n          {/* Checkbox input wrapper */}\n          <span className=\"relative flex items-center justify-center\">\n            <input\n              ref={(node) => {\n                // Handle both ref forwarding and indeterminate state\n                if (typeof ref === \"function\") {\n                  ref(node);\n                } else if (ref) {\n                  ref.current = node;\n                }\n                if (node) {\n                  node.indeterminate = indeterminate;\n                }\n              }}\n              type=\"checkbox\"\n              id={checkboxId}\n              disabled={disabled}\n              checked={checked}\n              defaultChecked={defaultChecked}\n              aria-invalid={error}\n              aria-required={isRequired}\n              aria-describedby={\n                [\n                  description ? descriptionId : null,\n                  error && errorMessage ? errorId : null,\n                ]\n                  .filter(Boolean)\n                  .join(\" \") || undefined\n              }\n              className={checkboxClasses}\n              {...props}\n            />\n\n            {/* Visual checkmark/minus overlay */}\n            <span\n              className={[\n                \"absolute\",\n                \"inset-0\",\n                \"flex\",\n                \"items-center\",\n                \"justify-center\",\n                \"pointer-events-none\",\n                \"opacity-0\",\n                \"transition-opacity\",\n                \"duration-150\",\n                // Show icon when checked or indeterminate via peer selector would be ideal,\n                // but we'll use CSS to handle this via the :checked pseudo-selector\n              ].join(\" \")}\n              style={{\n                opacity: isChecked || indeterminate ? 1 : 0,\n              }}\n            >\n              {indeterminate ? <MinusIcon /> : <CheckIcon />}\n            </span>\n          </span>\n\n          {/* Label and description */}\n          {(label || description) && (\n            <span className=\"flex flex-col\">\n              {label && (\n                <span className={labelStyles}>\n                  {label}\n                  {isRequired && (\n                    <span className=\"text-error-500 ml-0.5\" aria-hidden=\"true\">\n                      *\n                    </span>\n                  )}\n                </span>\n              )}\n              {description && (\n                <span\n                  id={descriptionId}\n                  className={[\n                    \"text-sm\",\n                    \"text-neutral-500\",\n                    disabled ? \"text-neutral-400\" : \"\",\n                  ]\n                    .filter(Boolean)\n                    .join(\" \")}\n                >\n                  {description}\n                </span>\n              )}\n            </span>\n          )}\n        </label>\n\n        {/* Error message */}\n        {error && errorMessage && (\n          <p\n            id={errorId}\n            className={[\n              \"mt-1.5\",\n              \"text-sm\",\n              \"text-error-600\",\n              label || description ? `ml-[calc(${sizeConfig.checkbox}+0.625rem)]` : \"\",\n            ]\n              .filter(Boolean)\n              .join(\" \")}\n            role=\"alert\"\n            aria-live=\"polite\"\n          >\n            {errorMessage}\n          </p>\n        )}\n      </div>\n    );\n  }\n);\n\nCheckbox.displayName = \"Checkbox\";\n\nexport default Checkbox;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\Input.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":140,"column":24,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":140,"endColumn":26,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3102,3104],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D011 - src/components/ui/Input.tsx\n * ===================================\n * Atomic input component using design tokens only.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing tokens\n *   - Fully typed props with TypeScript\n *   - Accessible by default (ARIA, labels, error states)\n */\n\nimport {\n  forwardRef,\n  useId,\n  type InputHTMLAttributes,\n  type ReactNode,\n} from \"react\";\n\n/**\n * Input size styles mapped to Tailwind classes.\n */\nconst sizes = {\n  xs: \"px-2 py-1 text-xs\",\n  sm: \"px-3 py-1.5 text-sm\",\n  md: \"px-4 py-2 text-base\",\n  lg: \"px-4 py-2.5 text-lg\",\n  xl: \"px-5 py-3 text-xl\",\n} as const;\n\n/**\n * Input variant styles.\n */\nconst variants = {\n  default: [\n    \"border-neutral-300\",\n    \"focus:border-primary-500\",\n    \"focus:ring-primary-500\",\n  ].join(\" \"),\n\n  filled: [\n    \"bg-neutral-100\",\n    \"border-transparent\",\n    \"focus:bg-white\",\n    \"focus:border-primary-500\",\n    \"focus:ring-primary-500\",\n  ].join(\" \"),\n\n  flushed: [\n    \"border-x-0\",\n    \"border-t-0\",\n    \"border-b-2\",\n    \"rounded-none\",\n    \"px-0\",\n    \"focus:border-primary-500\",\n    \"focus:ring-0\",\n  ].join(\" \"),\n} as const;\n\n/**\n * Input component props.\n */\nexport interface InputProps\n  extends Omit<InputHTMLAttributes<HTMLInputElement>, \"size\"> {\n  /** Size preset */\n  size?: keyof typeof sizes;\n  /** Visual variant */\n  variant?: keyof typeof variants;\n  /** Error state */\n  error?: boolean;\n  /** Error message to display */\n  errorMessage?: string;\n  /** Label text (recommended for accessibility) */\n  label?: string;\n  /** Helper text displayed below input */\n  helperText?: string;\n  /** Icon or element on the left side */\n  leftElement?: ReactNode;\n  /** Icon or element on the right side */\n  rightElement?: ReactNode;\n  /** Full width input */\n  fullWidth?: boolean;\n  /** Required field indicator */\n  isRequired?: boolean;\n}\n\n/**\n * Input component.\n *\n * A fully accessible text input with support for labels, error states,\n * helper text, and decorative elements. Uses design tokens exclusively.\n *\n * @example\n * ```tsx\n * <Input\n *   label=\"Email\"\n *   type=\"email\"\n *   placeholder=\"Enter your email\"\n *   helperText=\"We'll never share your email\"\n * />\n *\n * <Input\n *   label=\"Password\"\n *   type=\"password\"\n *   error\n *   errorMessage=\"Password must be at least 8 characters\"\n * />\n *\n * <Input\n *   leftElement={<SearchIcon />}\n *   placeholder=\"Search...\"\n * />\n * ```\n */\nexport const Input = forwardRef<HTMLInputElement, InputProps>(\n  (\n    {\n      size = \"md\",\n      variant = \"default\",\n      error = false,\n      errorMessage,\n      label,\n      helperText,\n      leftElement,\n      rightElement,\n      fullWidth = false,\n      isRequired = false,\n      disabled,\n      id,\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    // Generate unique ID for accessibility if not provided\n    const generatedId = useId();\n    const inputId = id || generatedId;\n    const errorId = `${inputId}-error`;\n    const helperId = `${inputId}-helper`;\n\n    // Base input styles\n    const baseStyles = [\n      \"block\",\n      \"w-full\",\n      \"rounded-md\",\n      \"border\",\n      \"bg-white\",\n      \"text-neutral-900\",\n      \"placeholder:text-neutral-400\",\n      \"transition-colors\",\n      \"duration-150\",\n      \"focus:outline-none\",\n      \"focus:ring-2\",\n      \"focus:ring-offset-0\",\n      \"disabled:bg-neutral-50\",\n      \"disabled:text-neutral-500\",\n      \"disabled:cursor-not-allowed\",\n    ].join(\" \");\n\n    // Error state styles\n    const errorStyles = error\n      ? [\n        \"border-error-500\",\n        \"focus:border-error-500\",\n        \"focus:ring-error-500\",\n        \"text-error-900\",\n      ].join(\" \")\n      : \"\";\n\n    // Padding adjustments for left/right elements\n    const leftPadding = leftElement ? \"pl-10\" : \"\";\n    const rightPadding = rightElement ? \"pr-10\" : \"\";\n\n    // Compose final input class string\n    const inputClasses = [\n      baseStyles,\n      sizes[size],\n      error ? errorStyles : variants[variant],\n      leftPadding,\n      rightPadding,\n      className,\n    ]\n      .filter(Boolean)\n      .join(\" \");\n\n    // Container width\n    const containerWidth = fullWidth ? \"w-full\" : \"w-auto\";\n\n    return (\n      <div className={containerWidth}>\n        {/* Label */}\n        {label && (\n          <label\n            htmlFor={inputId}\n            className={[\n              \"block\",\n              \"mb-1.5\",\n              \"text-sm\",\n              \"font-medium\",\n              error ? \"text-error-700\" : \"text-neutral-700\",\n            ].join(\" \")}\n          >\n            {label}\n            {isRequired && (\n              <span className=\"text-error-500 ml-0.5\" aria-hidden=\"true\">\n                *\n              </span>\n            )}\n          </label>\n        )}\n\n        {/* Input wrapper for positioned elements */}\n        <div className=\"relative\">\n          {/* Left element */}\n          {leftElement && (\n            <div\n              className={[\n                \"absolute\",\n                \"inset-y-0\",\n                \"left-0\",\n                \"flex\",\n                \"items-center\",\n                \"pl-3\",\n                \"pointer-events-none\",\n                error ? \"text-error-500\" : \"text-neutral-400\",\n              ].join(\" \")}\n              aria-hidden=\"true\"\n            >\n              {leftElement}\n            </div>\n          )}\n\n          {/* Input element */}\n          <input\n            ref={ref}\n            id={inputId}\n            disabled={disabled}\n            aria-invalid={error}\n            aria-required={isRequired}\n            aria-describedby={\n              [\n                error && errorMessage ? errorId : null,\n                helperText ? helperId : null,\n              ]\n                .filter(Boolean)\n                .join(\" \") || undefined\n            }\n            className={inputClasses}\n            {...props}\n          />\n\n          {/* Right element */}\n          {rightElement && (\n            <div\n              className={[\n                \"absolute\",\n                \"inset-y-0\",\n                \"right-0\",\n                \"flex\",\n                \"items-center\",\n                \"pr-3\",\n              ].join(\" \")}\n            >\n              {rightElement}\n            </div>\n          )}\n        </div>\n\n        {/* Error message - takes priority over helper text */}\n        {error && errorMessage && (\n          <p\n            id={errorId}\n            className=\"mt-1.5 text-sm text-error-600\"\n            role=\"alert\"\n            aria-live=\"polite\"\n          >\n            {errorMessage}\n          </p>\n        )}\n\n        {/* Helper text - hidden when error message is shown */}\n        {helperText && !(error && errorMessage) && (\n          <p\n            id={helperId}\n            className=\"mt-1.5 text-sm text-neutral-500\"\n          >\n            {helperText}\n          </p>\n        )}\n      </div>\n    );\n  }\n);\n\nInput.displayName = \"Input\";\n\nexport default Input;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\Modal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":195,"column":22,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":195,"endColumn":24,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[5155,5157],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":201,"column":23,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":201,"endColumn":25,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[5349,5351],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":330,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":330,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[7831,7833],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":337,"column":17,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":337,"endColumn":19,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8045,8047],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":340,"column":29,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":340,"endColumn":31,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8163,8165],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D014 - src/components/ui/Modal.tsx\n * ===================================\n * Atomic modal component using design tokens only.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing tokens\n *   - Fully typed props with TypeScript\n *   - Accessible by default (ARIA, focus trap, keyboard navigation)\n */\n\nimport React, {\n  useEffect,\n  useRef,\n  useCallback,\n  type ReactNode,\n  type MouseEvent,\n  type KeyboardEvent,\n} from \"react\";\nimport { createPortal } from \"react-dom\";\n\n/**\n * Modal size presets.\n */\nconst sizes = {\n  xs: \"max-w-xs\",\n  sm: \"max-w-sm\",\n  md: \"max-w-md\",\n  lg: \"max-w-lg\",\n  xl: \"max-w-xl\",\n  \"2xl\": \"max-w-2xl\",\n  \"3xl\": \"max-w-3xl\",\n  \"4xl\": \"max-w-4xl\",\n  full: \"max-w-full mx-4\",\n} as const;\n\n/**\n * Modal component props.\n */\nexport interface ModalProps {\n  /** Whether the modal is open */\n  isOpen: boolean;\n  /** Callback when modal should close */\n  onClose: () => void;\n  /** Modal title (displayed in header) */\n  title?: ReactNode;\n  /** Modal content */\n  children: ReactNode;\n  /** Size preset */\n  size?: keyof typeof sizes;\n  /** Footer content (typically action buttons) */\n  footer?: ReactNode;\n  /** Whether to show close button in header */\n  showCloseButton?: boolean;\n  /** Whether clicking overlay closes modal */\n  closeOnOverlayClick?: boolean;\n  /** Whether pressing Escape closes modal */\n  closeOnEscape?: boolean;\n  /** Whether to center modal vertically */\n  centered?: boolean;\n  /** Custom className for modal content */\n  className?: string;\n  /** Whether modal should scroll internally */\n  scrollBehavior?: \"inside\" | \"outside\";\n  /** ID for accessibility */\n  id?: string;\n}\n\n/**\n * Close icon for modal header.\n */\nconst CloseIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Modal component.\n *\n * A fully accessible modal dialog with support for headers, footers,\n * focus trapping, and keyboard navigation. Uses design tokens exclusively.\n *\n * @example\n * ```tsx\n * const [isOpen, setIsOpen] = useState(false);\n *\n * <Modal\n *   isOpen={isOpen}\n *   onClose={() => setIsOpen(false)}\n *   title=\"Confirm Action\"\n *   footer={\n *     <>\n *       <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n *         Cancel\n *       </Button>\n *       <Button variant=\"primary\" onClick={handleConfirm}>\n *         Confirm\n *       </Button>\n *     </>\n *   }\n * >\n *   <p>Are you sure you want to proceed?</p>\n * </Modal>\n * ```\n */\nexport const Modal: React.FC<ModalProps> = ({\n  isOpen,\n  onClose,\n  title,\n  children,\n  size = \"md\",\n  footer,\n  showCloseButton = true,\n  closeOnOverlayClick = true,\n  closeOnEscape = true,\n  centered = true,\n  className = \"\",\n  scrollBehavior = \"inside\",\n  id,\n}) => {\n  const modalRef = useRef<HTMLDivElement>(null);\n  const previousActiveElement = useRef<HTMLElement | null>(null);\n\n  // Store the previously focused element and restore on close\n  useEffect(() => {\n    if (isOpen) {\n      previousActiveElement.current = document.activeElement as HTMLElement;\n      // Focus the modal content after a short delay for animation\n      setTimeout(() => {\n        modalRef.current?.focus();\n      }, 50);\n    } else if (previousActiveElement.current) {\n      previousActiveElement.current.focus();\n    }\n  }, [isOpen]);\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen || !closeOnEscape) return;\n\n    const handleEscape = (event: globalThis.KeyboardEvent) => {\n      if (event.key === \"Escape\") {\n        event.preventDefault();\n        onClose();\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleEscape);\n    return () => document.removeEventListener(\"keydown\", handleEscape);\n  }, [isOpen, closeOnEscape, onClose]);\n\n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    if (isOpen) {\n      const originalOverflow = document.body.style.overflow;\n      document.body.style.overflow = \"hidden\";\n      return () => {\n        document.body.style.overflow = originalOverflow;\n      };\n    }\n  }, [isOpen]);\n\n  // Focus trap implementation\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLDivElement>) => {\n      if (event.key !== \"Tab\" || !modalRef.current) return;\n\n      const focusableElements = modalRef.current.querySelectorAll<HTMLElement>(\n        'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n      );\n\n      const firstElement = focusableElements[0];\n      const lastElement = focusableElements[focusableElements.length - 1];\n\n      if (event.shiftKey) {\n        // Shift + Tab: If on first element, go to last\n        if (document.activeElement === firstElement) {\n          event.preventDefault();\n          lastElement?.focus();\n        }\n      } else {\n        // Tab: If on last element, go to first\n        if (document.activeElement === lastElement) {\n          event.preventDefault();\n          firstElement?.focus();\n        }\n      }\n    },\n    []\n  );\n\n  // Handle overlay click\n  const handleOverlayClick = useCallback(\n    (event: MouseEvent<HTMLDivElement>) => {\n      if (closeOnOverlayClick && event.target === event.currentTarget) {\n        onClose();\n      }\n    },\n    [closeOnOverlayClick, onClose]\n  );\n\n  // Don't render if not open\n  if (!isOpen) return null;\n\n  // Overlay styles\n  const overlayStyles = [\n    \"fixed\",\n    \"inset-0\",\n    \"z-50\",\n    \"bg-black/50\",\n    \"backdrop-blur-sm\",\n    \"flex\",\n    centered ? \"items-center\" : \"items-start pt-20\",\n    \"justify-center\",\n    \"p-4\",\n    scrollBehavior === \"outside\" ? \"overflow-y-auto\" : \"\",\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  // Modal content styles\n  const contentStyles = [\n    \"relative\",\n    \"w-full\",\n    sizes[size],\n    \"bg-white\",\n    \"rounded-lg\",\n    \"shadow-xl\",\n    \"flex\",\n    \"flex-col\",\n    scrollBehavior === \"inside\" ? \"max-h-[calc(100vh-2rem)]\" : \"\",\n    \"focus:outline-none\",\n    \"animate-in\",\n    \"fade-in-0\",\n    \"zoom-in-95\",\n    \"duration-200\",\n    className,\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  // Header styles\n  const headerStyles = [\n    \"flex\",\n    \"items-center\",\n    \"justify-between\",\n    \"px-6\",\n    \"py-4\",\n    \"border-b\",\n    \"border-neutral-200\",\n    \"shrink-0\",\n  ].join(\" \");\n\n  // Body styles\n  const bodyStyles = [\n    \"px-6\",\n    \"py-4\",\n    scrollBehavior === \"inside\" ? \"overflow-y-auto\" : \"\",\n    \"flex-1\",\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  // Footer styles\n  const footerStyles = [\n    \"flex\",\n    \"items-center\",\n    \"justify-end\",\n    \"gap-3\",\n    \"px-6\",\n    \"py-4\",\n    \"border-t\",\n    \"border-neutral-200\",\n    \"bg-neutral-50\",\n    \"rounded-b-lg\",\n    \"shrink-0\",\n  ].join(\" \");\n\n  // Title styles\n  const titleStyles = [\n    \"text-lg\",\n    \"font-semibold\",\n    \"text-neutral-900\",\n  ].join(\" \");\n\n  // Close button styles\n  const closeButtonStyles = [\n    \"inline-flex\",\n    \"items-center\",\n    \"justify-center\",\n    \"p-1\",\n    \"rounded-md\",\n    \"text-neutral-400\",\n    \"hover:text-neutral-600\",\n    \"hover:bg-neutral-100\",\n    \"focus:outline-none\",\n    \"focus:ring-2\",\n    \"focus:ring-primary-500\",\n    \"focus:ring-offset-2\",\n    \"transition-colors\",\n    \"duration-150\",\n  ].join(\" \");\n\n  const modalContent = (\n    <div\n      className={overlayStyles}\n      onClick={handleOverlayClick}\n      aria-hidden=\"true\"\n    >\n      <div\n        ref={modalRef}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={title ? `${id || \"modal\"}-title` : undefined}\n        tabIndex={-1}\n        onKeyDown={handleKeyDown}\n        className={contentStyles}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        {(title || showCloseButton) && (\n          <div className={headerStyles}>\n            {title && (\n              <h2 id={`${id || \"modal\"}-title`} className={titleStyles}>\n                {title}\n              </h2>\n            )}\n            {!title && <div />}\n            {showCloseButton && (\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className={closeButtonStyles}\n                aria-label=\"Close modal\"\n              >\n                <CloseIcon />\n              </button>\n            )}\n          </div>\n        )}\n\n        {/* Body */}\n        <div className={bodyStyles}>{children}</div>\n\n        {/* Footer */}\n        {footer && <div className={footerStyles}>{footer}</div>}\n      </div>\n    </div>\n  );\n\n  // Use portal to render modal at document root\n  return createPortal(modalContent, document.body);\n};\n\nModal.displayName = \"Modal\";\n\nexport default Modal;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\Panel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\ResizablePanelLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, comparison is always true, since `\"right\" === \"right\"` is true.","line":110,"column":20,"nodeType":"BinaryExpression","messageId":"comparisonBetweenLiteralTypes","endLine":110,"endColumn":45},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":153,"column":36,"nodeType":"Identifier","messageId":"invalidType","endLine":153,"endColumn":47},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":167,"column":36,"nodeType":"Identifier","messageId":"invalidType","endLine":167,"endColumn":49},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":181,"column":36,"nodeType":"Identifier","messageId":"invalidType","endLine":181,"endColumn":48}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ResizablePanelLayout.tsx\r\n * ========================\r\n * A reusable three-panel layout with draggable dividers.\r\n * \r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * \r\n * Features:\r\n * - Initial split: 25% | 50% | 25%\r\n * - Min/max constraints to prevent over-shrinking\r\n * - Mouse drag events for resize\r\n * - Full height layout for modal content\r\n */\r\n\r\nimport React, { useState, useRef, useCallback, type ReactNode } from 'react';\r\n\r\ninterface PanelConfig {\r\n    minWidth: number;  // Minimum width in pixels\r\n    initialPercent: number;  // Initial width as percentage\r\n}\r\n\r\ninterface ResizablePanelLayoutProps {\r\n    leftPanel: ReactNode;\r\n    centerPanel: ReactNode;\r\n    rightPanel: ReactNode;\r\n    leftConfig?: Partial<PanelConfig>;\r\n    rightConfig?: Partial<PanelConfig>;\r\n    className?: string;\r\n}\r\n\r\nconst DEFAULT_LEFT_CONFIG: PanelConfig = {\r\n    minWidth: 200,\r\n    initialPercent: 25,\r\n};\r\n\r\nconst DEFAULT_RIGHT_CONFIG: PanelConfig = {\r\n    minWidth: 250,\r\n    initialPercent: 25,\r\n};\r\n\r\n/**\r\n * Divider component for dragging between panels.\r\n */\r\nconst Divider: React.FC<{\r\n    onMouseDown: (e: React.MouseEvent) => void;\r\n    isActive: boolean;\r\n}> = ({ onMouseDown, isActive }) => (\r\n    <div\r\n        className={`\r\n            w-1 cursor-col-resize transition-colors duration-150\r\n            ${isActive ? 'bg-primary-500' : 'bg-neutral-700 hover:bg-neutral-600'}\r\n            flex-shrink-0\r\n        `}\r\n        onMouseDown={onMouseDown}\r\n    >\r\n        {/* Visual grip indicator */}\r\n        <div className=\"h-full w-full flex items-center justify-center\">\r\n            <div className=\"w-0.5 h-8 bg-neutral-500 rounded-full opacity-50\" />\r\n        </div>\r\n    </div>\r\n);\r\n\r\nexport const ResizablePanelLayout: React.FC<ResizablePanelLayoutProps> = ({\r\n    leftPanel,\r\n    centerPanel,\r\n    rightPanel,\r\n    leftConfig = {},\r\n    rightConfig = {},\r\n    className = '',\r\n}) => {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const mergedLeftConfig = { ...DEFAULT_LEFT_CONFIG, ...leftConfig };\r\n    const mergedRightConfig = { ...DEFAULT_RIGHT_CONFIG, ...rightConfig };\r\n\r\n    // Panel widths as percentages\r\n    const [leftPercent, setLeftPercent] = useState(mergedLeftConfig.initialPercent);\r\n    const [rightPercent, setRightPercent] = useState(mergedRightConfig.initialPercent);\r\n\r\n    // Track which divider is being dragged\r\n    const [activeDivider, setActiveDivider] = useState<'left' | 'right' | null>(null);\r\n\r\n    // Handle mouse down on left divider\r\n    const handleLeftDividerMouseDown = useCallback((e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        setActiveDivider('left');\r\n    }, []);\r\n\r\n    // Handle mouse down on right divider\r\n    const handleRightDividerMouseDown = useCallback((e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        setActiveDivider('right');\r\n    }, []);\r\n\r\n    // Handle mouse move for resizing\r\n    const handleMouseMove = useCallback((e: MouseEvent) => {\r\n        if (!activeDivider || !containerRef.current) return;\r\n\r\n        const containerRect = containerRef.current.getBoundingClientRect();\r\n        const containerWidth = containerRect.width;\r\n        const mouseX = e.clientX - containerRect.left;\r\n        const mousePercent = (mouseX / containerWidth) * 100;\r\n\r\n        if (activeDivider === 'left') {\r\n            // Constrain left panel\r\n            const minPercent = (mergedLeftConfig.minWidth / containerWidth) * 100;\r\n            const maxPercent = 100 - rightPercent - 20; // Leave at least 20% for center\r\n            const newPercent = Math.max(minPercent, Math.min(maxPercent, mousePercent));\r\n            setLeftPercent(newPercent);\r\n        } else if (activeDivider === 'right') {\r\n            // Constrain right panel\r\n            const minPercent = (mergedRightConfig.minWidth / containerWidth) * 100;\r\n            const rightEdgePercent = 100 - mousePercent;\r\n            const maxPercent = 100 - leftPercent - 20; // Leave at least 20% for center\r\n            const newPercent = Math.max(minPercent, Math.min(maxPercent, rightEdgePercent));\r\n            setRightPercent(newPercent);\r\n        }\r\n    }, [activeDivider, leftPercent, rightPercent, mergedLeftConfig.minWidth, mergedRightConfig.minWidth]);\r\n\r\n    // Handle mouse up to stop resizing\r\n    const handleMouseUp = useCallback(() => {\r\n        setActiveDivider(null);\r\n    }, []);\r\n\r\n    // Add/remove global mouse listeners\r\n    React.useEffect(() => {\r\n        if (activeDivider) {\r\n            document.addEventListener('mousemove', handleMouseMove);\r\n            document.addEventListener('mouseup', handleMouseUp);\r\n            document.body.style.cursor = 'col-resize';\r\n            document.body.style.userSelect = 'none';\r\n        }\r\n\r\n        return () => {\r\n            document.removeEventListener('mousemove', handleMouseMove);\r\n            document.removeEventListener('mouseup', handleMouseUp);\r\n            document.body.style.cursor = '';\r\n            document.body.style.userSelect = '';\r\n        };\r\n    }, [activeDivider, handleMouseMove, handleMouseUp]);\r\n\r\n    // Calculate center panel width\r\n    const centerPercent = 100 - leftPercent - rightPercent;\r\n\r\n    return (\r\n        <div\r\n            ref={containerRef}\r\n            className={`flex h-full w-full overflow-hidden ${className}`}\r\n        >\r\n            {/* Left Panel */}\r\n            <div\r\n                className=\"h-full overflow-hidden flex-shrink-0\"\r\n                style={{ width: `${leftPercent}%` }}\r\n            >\r\n                {leftPanel}\r\n            </div>\r\n\r\n            {/* Left Divider */}\r\n            <Divider\r\n                onMouseDown={handleLeftDividerMouseDown}\r\n                isActive={activeDivider === 'left'}\r\n            />\r\n\r\n            {/* Center Panel */}\r\n            <div\r\n                className=\"h-full overflow-hidden flex-grow\"\r\n                style={{ width: `${centerPercent}%` }}\r\n            >\r\n                {centerPanel}\r\n            </div>\r\n\r\n            {/* Right Divider */}\r\n            <Divider\r\n                onMouseDown={handleRightDividerMouseDown}\r\n                isActive={activeDivider === 'right'}\r\n            />\r\n\r\n            {/* Right Panel */}\r\n            <div\r\n                className=\"h-full overflow-hidden flex-shrink-0\"\r\n                style={{ width: `${rightPercent}%` }}\r\n            >\r\n                {rightPanel}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nResizablePanelLayout.displayName = 'ResizablePanelLayout';\r\n\r\nexport default ResizablePanelLayout;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\Select.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":189,"column":25,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":189,"endColumn":27,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[4302,4304],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D012 - src/components/ui/Select.tsx\n * ====================================\n * Atomic select component using design tokens only.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing tokens\n *   - Fully typed props with TypeScript\n *   - Accessible by default (ARIA, keyboard navigation)\n */\n\nimport {\n  forwardRef,\n  useId,\n  type SelectHTMLAttributes,\n  type ReactNode,\n} from \"react\";\n\n/**\n * Select size styles mapped to Tailwind classes.\n */\nconst sizes = {\n  xs: \"px-2 py-1 text-xs pr-7\",\n  sm: \"px-3 py-1.5 text-sm pr-8\",\n  md: \"px-4 py-2 text-base pr-10\",\n  lg: \"px-4 py-2.5 text-lg pr-10\",\n  xl: \"px-5 py-3 text-xl pr-12\",\n} as const;\n\n/**\n * Select variant styles.\n */\nconst variants = {\n  default: [\n    \"border-neutral-300\",\n    \"focus:border-primary-500\",\n    \"focus:ring-primary-500\",\n  ].join(\" \"),\n\n  filled: [\n    \"bg-neutral-100\",\n    \"border-transparent\",\n    \"focus:bg-white\",\n    \"focus:border-primary-500\",\n    \"focus:ring-primary-500\",\n  ].join(\" \"),\n} as const;\n\n/**\n * Option type for type-safe option lists.\n */\nexport interface SelectOption {\n  /** Option value */\n  value: string;\n  /** Display label */\n  label: string;\n  /** Disabled state */\n  disabled?: boolean;\n}\n\n/**\n * Option group type for grouped options.\n */\nexport interface SelectOptionGroup {\n  /** Group label */\n  label: string;\n  /** Options within this group */\n  options: SelectOption[];\n}\n\n/**\n * Select component props.\n */\nexport interface SelectProps\n  extends Omit<SelectHTMLAttributes<HTMLSelectElement>, \"size\"> {\n  /** Size preset */\n  size?: keyof typeof sizes;\n  /** Visual variant */\n  variant?: keyof typeof variants;\n  /** Options array */\n  options?: SelectOption[];\n  /** Grouped options */\n  optionGroups?: SelectOptionGroup[];\n  /** Error state */\n  error?: boolean;\n  /** Error message to display */\n  errorMessage?: string;\n  /** Label text (recommended for accessibility) */\n  label?: string;\n  /** Helper text displayed below select */\n  helperText?: string;\n  /** Placeholder option text */\n  placeholder?: string;\n  /** Full width select */\n  fullWidth?: boolean;\n  /** Required field indicator */\n  isRequired?: boolean;\n  /** Left icon/element */\n  leftElement?: ReactNode;\n}\n\n/**\n * Chevron down icon for the select dropdown indicator.\n */\nconst ChevronDownIcon = () => (\n  <svg\n    className=\"h-5 w-5 text-neutral-400\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 20 20\"\n    fill=\"currentColor\"\n    aria-hidden=\"true\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\"\n      clipRule=\"evenodd\"\n    />\n  </svg>\n);\n\n/**\n * Select component.\n *\n * A fully accessible select/dropdown with support for options, groups,\n * labels, error states, and helper text. Uses design tokens exclusively.\n *\n * @example\n * ```tsx\n * <Select\n *   label=\"Country\"\n *   placeholder=\"Select a country\"\n *   options={[\n *     { value: \"us\", label: \"United States\" },\n *     { value: \"uk\", label: \"United Kingdom\" },\n *     { value: \"ca\", label: \"Canada\" },\n *   ]}\n * />\n *\n * <Select\n *   label=\"Category\"\n *   optionGroups={[\n *     {\n *       label: \"Fruits\",\n *       options: [\n *         { value: \"apple\", label: \"Apple\" },\n *         { value: \"banana\", label: \"Banana\" },\n *       ],\n *     },\n *     {\n *       label: \"Vegetables\",\n *       options: [\n *         { value: \"carrot\", label: \"Carrot\" },\n *         { value: \"broccoli\", label: \"Broccoli\" },\n *       ],\n *     },\n *   ]}\n * />\n * ```\n */\nexport const Select = forwardRef<HTMLSelectElement, SelectProps>(\n  (\n    {\n      size = \"md\",\n      variant = \"default\",\n      options = [],\n      optionGroups = [],\n      error = false,\n      errorMessage,\n      label,\n      helperText,\n      placeholder,\n      fullWidth = false,\n      isRequired = false,\n      leftElement,\n      disabled,\n      id,\n      className = \"\",\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    // Generate unique ID for accessibility if not provided\n    const generatedId = useId();\n    const selectId = id || generatedId;\n    const errorId = `${selectId}-error`;\n    const helperId = `${selectId}-helper`;\n\n    // Base select styles\n    const baseStyles = [\n      \"block\",\n      \"w-full\",\n      \"rounded-md\",\n      \"border\",\n      \"bg-white\",\n      \"text-neutral-900\",\n      \"appearance-none\",\n      \"cursor-pointer\",\n      \"transition-colors\",\n      \"duration-150\",\n      \"focus:outline-none\",\n      \"focus:ring-2\",\n      \"focus:ring-offset-0\",\n      \"disabled:bg-neutral-50\",\n      \"disabled:text-neutral-500\",\n      \"disabled:cursor-not-allowed\",\n    ].join(\" \");\n\n    // Error state styles\n    const errorStyles = error\n      ? [\n        \"border-error-500\",\n        \"focus:border-error-500\",\n        \"focus:ring-error-500\",\n        \"text-error-900\",\n      ].join(\" \")\n      : \"\";\n\n    // Left padding for left element\n    const leftPadding = leftElement ? \"pl-10\" : \"\";\n\n    // Compose final select class string\n    const selectClasses = [\n      baseStyles,\n      sizes[size],\n      error ? errorStyles : variants[variant],\n      leftPadding,\n      className,\n    ]\n      .filter(Boolean)\n      .join(\" \");\n\n    // Container width\n    const containerWidth = fullWidth ? \"w-full\" : \"w-auto\";\n\n    // Determine if we should render options or children\n    const hasOptions = options.length > 0 || optionGroups.length > 0;\n\n    return (\n      <div className={containerWidth}>\n        {/* Label */}\n        {label && (\n          <label\n            htmlFor={selectId}\n            className={[\n              \"block\",\n              \"mb-1.5\",\n              \"text-sm\",\n              \"font-medium\",\n              error ? \"text-error-700\" : \"text-neutral-700\",\n            ].join(\" \")}\n          >\n            {label}\n            {isRequired && (\n              <span className=\"text-error-500 ml-0.5\" aria-hidden=\"true\">\n                *\n              </span>\n            )}\n          </label>\n        )}\n\n        {/* Select wrapper for positioned elements */}\n        <div className=\"relative\">\n          {/* Left element */}\n          {leftElement && (\n            <div\n              className={[\n                \"absolute\",\n                \"inset-y-0\",\n                \"left-0\",\n                \"flex\",\n                \"items-center\",\n                \"pl-3\",\n                \"pointer-events-none\",\n                error ? \"text-error-500\" : \"text-neutral-400\",\n              ].join(\" \")}\n              aria-hidden=\"true\"\n            >\n              {leftElement}\n            </div>\n          )}\n\n          {/* Select element */}\n          <select\n            ref={ref}\n            id={selectId}\n            disabled={disabled}\n            aria-invalid={error}\n            aria-required={isRequired}\n            aria-describedby={\n              [\n                error && errorMessage ? errorId : null,\n                helperText ? helperId : null,\n              ]\n                .filter(Boolean)\n                .join(\" \") || undefined\n            }\n            className={selectClasses}\n            {...props}\n          >\n            {/* Placeholder option */}\n            {placeholder && (\n              <option value=\"\" disabled>\n                {placeholder}\n              </option>\n            )}\n\n            {/* Render options if provided */}\n            {hasOptions ? (\n              <>\n                {/* Flat options */}\n                {options.map((option) => (\n                  <option\n                    key={option.value}\n                    value={option.value}\n                    disabled={option.disabled}\n                  >\n                    {option.label}\n                  </option>\n                ))}\n\n                {/* Grouped options */}\n                {optionGroups.map((group) => (\n                  <optgroup key={group.label} label={group.label}>\n                    {group.options.map((option) => (\n                      <option\n                        key={option.value}\n                        value={option.value}\n                        disabled={option.disabled}\n                      >\n                        {option.label}\n                      </option>\n                    ))}\n                  </optgroup>\n                ))}\n              </>\n            ) : (\n              // Render children if no options provided\n              children\n            )}\n          </select>\n\n          {/* Dropdown indicator */}\n          <div\n            className={[\n              \"absolute\",\n              \"inset-y-0\",\n              \"right-0\",\n              \"flex\",\n              \"items-center\",\n              \"pr-2\",\n              \"pointer-events-none\",\n            ].join(\" \")}\n            aria-hidden=\"true\"\n          >\n            <ChevronDownIcon />\n          </div>\n        </div>\n\n        {/* Error message - takes priority over helper text */}\n        {error && errorMessage && (\n          <p\n            id={errorId}\n            className=\"mt-1.5 text-sm text-error-600\"\n            role=\"alert\"\n            aria-live=\"polite\"\n          >\n            {errorMessage}\n          </p>\n        )}\n\n        {/* Helper text - hidden when error message is shown */}\n        {helperText && !(error && errorMessage) && (\n          <p\n            id={helperId}\n            className=\"mt-1.5 text-sm text-neutral-500\"\n          >\n            {helperText}\n          </p>\n        )}\n      </div>\n    );\n  }\n);\n\nSelect.displayName = \"Select\";\n\nexport default Select;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\SettingsPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":98,"column":13,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":98,"endColumn":27,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[4199,4199],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[4199,4199],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":105,"column":11,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":105,"endColumn":34},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":140,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":140,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5477,5479],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":143,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":143,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5603,5605],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":311,"column":37,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":311,"endColumn":59}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * SettingsPanel.tsx\r\n * =================\r\n * Slide-over panel for configuring LLM and application settings.\r\n */\r\n\r\nimport React, { useState, useCallback, useEffect } from 'react';\r\nimport { useSettingsStore, MODEL_OPTIONS, type LLMProvider } from '../../stores/settingsStore';\r\nimport { testConnection } from '../../services/llmService';\r\nimport { listLocalModels } from '../../services/ollamaService';\r\nimport { ApiKeyManager } from './ApiKeyManager';\r\n\r\ninterface SettingsPanelProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\n/**\r\n * Provider options for the dropdown.\r\n */\r\nconst PROVIDER_OPTIONS: { id: LLMProvider; label: string }[] = [\r\n    { id: 'gemini', label: 'Google Gemini' },\r\n    { id: 'openai', label: 'OpenAI' },\r\n    { id: 'anthropic', label: 'Anthropic' },\r\n    { id: 'ollama', label: 'Ollama (Local)' },\r\n];\r\n\r\nexport const SettingsPanel: React.FC<SettingsPanelProps> = ({ isOpen, onClose }) => {\r\n    // Settings store\r\n    const {\r\n        provider,\r\n        model,\r\n        temperature,\r\n        systemPrompt,\r\n        ollamaModels,\r\n        setProvider,\r\n        setModel,\r\n        setTemperature,\r\n        setSystemPrompt,\r\n        setOllamaModels,\r\n    } = useSettingsStore();\r\n\r\n    // Local state for test connection\r\n    const [testStatus, setTestStatus] = useState<'idle' | 'testing' | 'success' | 'error'>('idle');\r\n    const [testMessage, setTestMessage] = useState('');\r\n    const [isLoadingModels, setIsLoadingModels] = useState(false);\r\n\r\n    // Local state for system prompt editing\r\n    const [localSystemPrompt, setLocalSystemPrompt] = useState(systemPrompt);\r\n    const [promptSaved, setPromptSaved] = useState(true);\r\n\r\n    // Default system prompt for Component Generator\r\n    const DEFAULT_SYSTEM_PROMPT = `You are a strict code compiler. Return ONLY valid React/Tailwind code.\r\n\r\nCRITICAL INSTRUCTIONS:\r\n1. OUTPUT FORMAT: Return ONLY the raw component code. NO markdown fences, NO explanations, NO imports, NO comments.\r\n2. ACCURACY: Implement EXACTLY what is requested. DO NOT hallucinate features.\r\n3. NEGATIVE CONSTRAINTS (DO NOT DO):\r\n   - DO NOT add background colors unless requested.\r\n   - DO NOT add filler text (Lorem Ipsum) unless requested.\r\n   - DO NOT add extra padding/margins unless necessary for layout.\r\n   - DO NOT wrap the component in a centered div (the previewer handles centering).\r\n\r\nANIMATION RULES (Exact Implementation):\r\n- \"jelly\" / \"bouncy\" -> YOU MUST USE: transition-transform duration-300 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] hover:scale-110 active:scale-90\r\n- \"spin\" -> transition-transform duration-700 ease-in-out hover:rotate-[360deg]\r\n- \"squishy\" -> transition-all duration-200 hover:scale-x-125 hover:scale-y-75 active:scale-x-75 active:scale-y-125\r\n\r\nSTYLING:\r\n- Use Tailwind CSS for EVERYTHING.\r\n- For \"modern\" look: use 'ring-1 ring-white/10' for borders in dark mode if needed.\r\n- Interactive elements MUST have 'focus:ring-2 focus:outline-none'.\r\n\r\nBROWNFIELD PATTERNS (MANDATORY overrides):\r\n- If user says \"HEXAGON\" -> className=\"aspect-square bg-primary-500 [clip-path:polygon(25%_0%,75%_0%,100%_50%,75%_100%,25%_100%,0%_50%)]\"\r\n- If user says \"SPARKLES\" -> Use a wrapper div with 'relative'. Add absolute positioned spans for 'sparkles' with 'animate-ping' or 'animate-pulse'.\r\n- If user says \"NEOMORPHIC\" -> DO NOT use 'shadow-lg'. YOU MUST USE: shadow-[6px_6px_10px_0px_rgba(0,0,0,0.1),-6px_-6px_10px_0px_rgba(255,255,255,0.8)]\r\n\r\nFINAL CHECK:\r\n- Did you add a background color? If user didn't ask, REMOVE IT.\r\n- Did you add text inside the button? If user didn't ask, make it empty.`;\r\n\r\n    // Fetch Ollama models when provider is ollama\r\n    useEffect(() => {\r\n        if (provider === 'ollama' && isOpen) {\r\n            const fetchModels = async () => {\r\n                setIsLoadingModels(true);\r\n                const models = await listLocalModels();\r\n                setOllamaModels(models);\r\n                setIsLoadingModels(false);\r\n\r\n                // Auto-select first model if current model is not valid\r\n                if (models.length > 0 && !models.includes(model)) {\r\n                    setModel(models[0]);\r\n                }\r\n            };\r\n\r\n            fetchModels();\r\n        }\r\n    }, [provider, isOpen, setOllamaModels, setModel, model]);\r\n\r\n    // Get available models for current provider\r\n    const availableModels = provider === 'ollama'\r\n        ? ollamaModels.map(m => ({ id: m, label: m }))\r\n        : MODEL_OPTIONS[provider] || [];\r\n\r\n    // Handlers\r\n    const handleProviderChange = useCallback(\r\n        (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n            setProvider(e.target.value as LLMProvider);\r\n        },\r\n        [setProvider]\r\n    );\r\n\r\n    const handleModelChange = useCallback(\r\n        (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n            setModel(e.target.value);\r\n        },\r\n        [setModel]\r\n    );\r\n\r\n    const handleTemperatureChange = useCallback(\r\n        (e: React.ChangeEvent<HTMLInputElement>) => {\r\n            const value = parseFloat(e.target.value);\r\n            if (!isNaN(value)) {\r\n                setTemperature(value);\r\n            }\r\n        },\r\n        [setTemperature]\r\n    );\r\n\r\n    const handleTestConnection = useCallback(async () => {\r\n        setTestStatus('testing');\r\n        setTestMessage('');\r\n\r\n        const result = await testConnection();\r\n\r\n        if (result.success) {\r\n            setTestStatus('success');\r\n            setTestMessage(result.text || 'Connection successful!');\r\n        } else {\r\n            setTestStatus('error');\r\n            setTestMessage(result.error || 'Connection failed.');\r\n        }\r\n    }, []);\r\n\r\n    // Handle system prompt change (local only)\r\n    const handlePromptChange = useCallback((e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        setLocalSystemPrompt(e.target.value);\r\n        setPromptSaved(false);\r\n    }, []);\r\n\r\n    // Save system prompt to store\r\n    const handleSavePrompt = useCallback(() => {\r\n        setSystemPrompt(localSystemPrompt);\r\n        setPromptSaved(true);\r\n    }, [localSystemPrompt, setSystemPrompt]);\r\n\r\n    // Load default system prompt\r\n    const handleLoadDefault = useCallback(() => {\r\n        setLocalSystemPrompt(DEFAULT_SYSTEM_PROMPT);\r\n        setPromptSaved(false);\r\n    }, [DEFAULT_SYSTEM_PROMPT]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <>\r\n            {/* Backdrop */}\r\n            <div\r\n                className=\"fixed inset-0 bg-black/50 z-40 transition-opacity\"\r\n                onClick={onClose}\r\n            />\r\n\r\n            {/* Panel */}\r\n            <div className=\"fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-xl z-50 flex flex-col\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between px-6 py-4 border-b border-neutral-200\">\r\n                    <h2 className=\"text-lg font-semibold text-neutral-900\">Settings</h2>\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={onClose}\r\n                        className=\"p-2 rounded-md text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100 transition-colors\"\r\n                    >\r\n                        <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n                            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n                        </svg>\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 overflow-y-auto px-6 py-6 space-y-6\">\r\n                    {/* LLM Provider */}\r\n                    <div>\r\n                        <label htmlFor=\"provider\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            LLM Provider\r\n                        </label>\r\n                        <select\r\n                            id=\"provider\"\r\n                            value={provider}\r\n                            onChange={handleProviderChange}\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-white text-neutral-900 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors\"\r\n                        >\r\n                            {PROVIDER_OPTIONS.map((opt) => (\r\n                                <option key={opt.id} value={opt.id}>\r\n                                    {opt.label}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n\r\n                    {/* API Keys Manager (D079) */}\r\n                    <ApiKeyManager />\r\n\r\n                    {/* LLM Model */}\r\n                    <div>\r\n                        <label htmlFor=\"model\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            Model\r\n                            {isLoadingModels && <span className=\"ml-2 text-xs text-primary-500 font-normal\">Loading available models...</span>}\r\n                        </label>\r\n                        <select\r\n                            id=\"model\"\r\n                            value={model}\r\n                            onChange={handleModelChange}\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-white text-neutral-900 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors\"\r\n                        >\r\n                            {availableModels.length === 0 && provider === 'ollama' ? (\r\n                                <option value=\"\" disabled>No models found or ensure Ollama is running</option>\r\n                            ) : (\r\n                                availableModels.map((opt) => (\r\n                                    <option key={opt.id} value={opt.id}>\r\n                                        {opt.label}\r\n                                    </option>\r\n                                ))\r\n                            )}\r\n                        </select>\r\n                        {provider === 'ollama' && availableModels.length === 0 && !isLoadingModels && (\r\n                            <p className=\"mt-1 text-xs text-red-500\">\r\n                                Ensure Ollama is running at http://localhost:11434\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Temperature */}\r\n                    <div>\r\n                        <label htmlFor=\"temperature\" className=\"block text-sm font-medium text-neutral-700 mb-1\">\r\n                            Temperature\r\n                        </label>\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <input\r\n                                id=\"temperature\"\r\n                                type=\"range\"\r\n                                min=\"0\"\r\n                                max=\"2\"\r\n                                step=\"0.1\"\r\n                                value={temperature}\r\n                                onChange={handleTemperatureChange}\r\n                                className=\"flex-1 h-2 bg-neutral-200 rounded-lg appearance-none cursor-pointer accent-primary-500\"\r\n                            />\r\n                            <span className=\"w-12 text-center text-sm font-mono text-neutral-700\">\r\n                                {temperature.toFixed(1)}\r\n                            </span>\r\n                        </div>\r\n                        <p className=\"mt-1 text-xs text-neutral-500\">\r\n                            0.0 = deterministic, 2.0 = highly creative\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* System Prompt */}\r\n                    <div>\r\n                        <div className=\"flex items-center justify-between mb-1\">\r\n                            <label htmlFor=\"systemPrompt\" className=\"block text-sm font-medium text-neutral-700\">\r\n                                System Prompt\r\n                            </label>\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleLoadDefault}\r\n                                className=\"text-xs text-primary-600 hover:text-primary-700 font-medium\"\r\n                            >\r\n                                Load Default\r\n                            </button>\r\n                        </div>\r\n                        <textarea\r\n                            id=\"systemPrompt\"\r\n                            value={localSystemPrompt}\r\n                            onChange={handlePromptChange}\r\n                            rows={6}\r\n                            placeholder=\"Enter system instructions for the AI...\"\r\n                            className=\"w-full px-3 py-2 border border-neutral-300 rounded-lg bg-white text-neutral-900 placeholder-neutral-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors resize-none text-sm\"\r\n                        />\r\n                        <div className=\"flex items-center justify-between mt-2\">\r\n                            <span className={`text-xs ${promptSaved ? 'text-green-600' : 'text-amber-600'}`}>\r\n                                {promptSaved ? 'Ô£ô Saved' : 'ÔÇó Unsaved changes'}\r\n                            </span>\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleSavePrompt}\r\n                                disabled={promptSaved}\r\n                                className=\"px-3 py-1 text-sm font-medium text-white bg-primary-500 rounded-md hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                            >\r\n                                Save Prompt\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Test Connection */}\r\n                    <div className=\"pt-4 border-t border-neutral-200\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={handleTestConnection}\r\n                            disabled={testStatus === 'testing'}\r\n                            className=\"w-full flex items-center justify-center gap-2 px-4 py-2 bg-neutral-100 text-neutral-700 font-medium rounded-lg hover:bg-neutral-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                        >\r\n                            {testStatus === 'testing' ? (\r\n                                <>\r\n                                    <svg className=\"animate-spin h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\">\r\n                                        <circle\r\n                                            className=\"opacity-25\"\r\n                                            cx=\"12\"\r\n                                            cy=\"12\"\r\n                                            r=\"10\"\r\n                                            stroke=\"currentColor\"\r\n                                            strokeWidth=\"4\"\r\n                                        />\r\n                                        <path\r\n                                            className=\"opacity-75\"\r\n                                            fill=\"currentColor\"\r\n                                            d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\r\n                                        />\r\n                                    </svg>\r\n                                    Testing...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                        <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" />\r\n                                        <polyline points=\"22 4 12 14.01 9 11.01\" />\r\n                                    </svg>\r\n                                    Test Connection\r\n                                </>\r\n                            )}\r\n                        </button>\r\n\r\n                        {testStatus !== 'idle' && testStatus !== 'testing' && (\r\n                            <div\r\n                                className={`mt-3 p-3 rounded-lg text-sm ${testStatus === 'success'\r\n                                    ? 'bg-green-50 text-green-800 border border-green-200'\r\n                                    : 'bg-red-50 text-red-800 border border-red-200'\r\n                                    }`}\r\n                            >\r\n                                {testMessage}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"px-6 py-4 border-t border-neutral-200 bg-neutral-50\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={onClose}\r\n                        className=\"w-full px-4 py-2 bg-primary-500 text-white font-medium rounded-lg hover:bg-primary-600 transition-colors\"\r\n                    >\r\n                        Done\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\Tabs.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":66,"column":7,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":66,"endColumn":12}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * src/components/ui/Tabs.tsx\n * ==========================\n * Reusable Tabs component for the Sidebar using design tokens.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *\n * Traceability: Satisfies GAP-01 (Tab Switcher for Sidebar)\n */\n\nimport React from \"react\";\n\n/**\n * Tab item definition.\n */\nexport interface TabItem {\n  /** Unique tab identifier */\n  id: string;\n  /** Display label */\n  label: string;\n  /** Optional icon */\n  icon?: React.ReactNode;\n}\n\n/**\n * Tabs component props.\n */\nexport interface TabsProps {\n  /** Available tabs */\n  tabs: TabItem[];\n  /** Currently active tab ID */\n  activeTab: string;\n  /** Callback when tab changes */\n  onTabChange: (tabId: string) => void;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * Tabs component for switching between views.\n *\n * @example\n * ```tsx\n * <Tabs\n *   tabs={[\n *     { id: 'plugins', label: 'Plugins' },\n *     { id: 'components', label: 'Components' },\n *   ]}\n *   activeTab={activeTab}\n *   onTabChange={setActiveTab}\n * />\n * ```\n */\nexport const Tabs: React.FC<TabsProps> = ({\n  tabs,\n  activeTab,\n  onTabChange,\n  className = \"\",\n}) => {\n  // Defensive check: prevent crash if tabs is undefined or empty\n  if (!tabs || tabs.length === 0) {\n    return null;\n  }\n\n  const containerStyles = [\n    \"flex\",\n    \"rounded-lg\",\n    \"bg-neutral-100\",\n    \"p-1\",\n    className,\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  return (\n    <div className={containerStyles} role=\"tablist\">\n      {tabs.map((tab) => {\n        const isActive = tab.id === activeTab;\n        const tabStyles = [\n          \"flex-1\",\n          \"flex\",\n          \"items-center\",\n          \"justify-center\",\n          \"gap-1.5\",\n          \"px-3\",\n          \"py-1.5\",\n          \"text-sm\",\n          \"font-medium\",\n          \"rounded-md\",\n          \"transition-colors\",\n          isActive\n            ? \"bg-white text-neutral-900 shadow-sm\"\n            : \"text-neutral-600 hover:text-neutral-900\",\n        ].join(\" \");\n\n        return (\n          <button\n            key={tab.id}\n            type=\"button\"\n            role=\"tab\"\n            aria-selected={isActive}\n            onClick={() => onTabChange(tab.id)}\n            className={tabStyles}\n          >\n            {tab.icon}\n            {tab.label}\n          </button>\n        );\n      })}\n    </div>\n  );\n};\n\nTabs.displayName = \"Tabs\";\n\nexport default Tabs;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\ThemeCustomizationPanel.tsx","messages":[{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":227,"column":25,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":227,"endColumn":55},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\ThemeCustomizationPanel.tsx:266:7\n  264 |   useEffect(() => {\n  265 |     if (theme) {\n> 266 |       setEditingTheme({ ...theme });\n      |       ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  267 |     } else if (isNew) {\n  268 |       setEditingTheme({ ...defaultLightTheme, name: \"\" });\n  269 |     }","line":266,"column":7,"nodeType":null,"endLine":266,"endColumn":22},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":2,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":381,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":381,"endColumn":49,"suggestions":[{"fix":{"range":[14335,14375],"text":"editingTheme?.name.trim()"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"string | undefined\" of template literal expression.","line":425,"column":103,"nodeType":"ChainExpression","messageId":"invalidType","endLine":425,"endColumn":114},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":543,"column":50,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":543,"endColumn":52,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[22204,22206],"text":""},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":543,"column":58,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":543,"endColumn":60,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22212,22214],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":547,"column":50,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":547,"endColumn":52,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[22403,22405],"text":""},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":547,"column":58,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":547,"endColumn":60,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22411,22413],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":556,"column":25,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":556,"endColumn":38},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":573,"column":25,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":573,"endColumn":38}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D017 - src/components/ui/ThemeCustomizationPanel.tsx\n * =====================================================\n * Theme customization panel with single-tab themes list view.\n * \n * Features:\n *   - Themes list with load/edit/delete actions\n *   - Modal dialog for editing theme (colors, typography, spacing)\n *   - Google Fonts integration for adding custom fonts\n *   - Save button for persistence\n */\n\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport {\n  useThemeStore,\n  defaultLightTheme,\n  type ColorScale,\n  type ThemeConfig,\n  type CustomFont,\n} from \"../../context/ThemeProvider\";\nimport Button from \"./Button\";\nimport Input from \"./Input\";\nimport Select, { type SelectOption } from \"./Select\";\n// Panel import removed - not used in simplified UI\n\n// ============================================\n// Popular Google Fonts\n// ============================================\n\nconst POPULAR_GOOGLE_FONTS = [\n  { name: \"Inter\", family: \"Inter\" },\n  { name: \"Roboto\", family: \"Roboto\" },\n  { name: \"Open Sans\", family: \"Open+Sans\" },\n  { name: \"Lato\", family: \"Lato\" },\n  { name: \"Montserrat\", family: \"Montserrat\" },\n  { name: \"Poppins\", family: \"Poppins\" },\n  { name: \"Source Sans Pro\", family: \"Source+Sans+Pro\" },\n  { name: \"Raleway\", family: \"Raleway\" },\n  { name: \"Nunito\", family: \"Nunito\" },\n  { name: \"Ubuntu\", family: \"Ubuntu\" },\n  { name: \"Fira Code\", family: \"Fira+Code\" },\n  { name: \"JetBrains Mono\", family: \"JetBrains+Mono\" },\n  { name: \"Source Code Pro\", family: \"Source+Code+Pro\" },\n  { name: \"IBM Plex Mono\", family: \"IBM+Plex+Mono\" },\n];\n\n// ============================================\n// Icons\n// ============================================\n\nconst SunIcon = () => (\n  <svg className=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\n    <circle cx=\"12\" cy=\"12\" r=\"5\" />\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" />\n    <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" />\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" />\n    <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" />\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" />\n    <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" />\n    <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" />\n    <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" />\n  </svg>\n);\n\nconst MoonIcon = () => (\n  <svg className=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\n    <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\" />\n  </svg>\n);\n\nconst CloseIcon = () => (\n  <svg className=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n  </svg>\n);\n\nconst TrashIcon = () => (\n  <svg className=\"h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\n    <polyline points=\"3 6 5 6 21 6\" />\n    <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n  </svg>\n);\n\nconst EditIcon = () => (\n  <svg className=\"h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\n    <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" />\n    <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" />\n  </svg>\n);\n\nconst PlusIcon = () => (\n  <svg className=\"h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\nconst RefreshIcon = () => (\n  <svg className=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\n    <polyline points=\"23 4 23 10 17 10\" />\n    <path d=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\" />\n  </svg>\n);\n\n// ============================================\n// Color Picker Component\n// ============================================\n\ninterface ColorSwatchProps {\n  value: string;\n  onChange: (value: string) => void;\n  disabled?: boolean;\n}\n\nconst ColorSwatch: React.FC<ColorSwatchProps> = ({ value, onChange, disabled }) => (\n  <div className=\"relative\">\n    <input\n      type=\"color\"\n      value={value}\n      onChange={(e) => onChange(e.target.value)}\n      disabled={disabled}\n      className={[\n        \"w-11 h-11\",                    // HIG: 44px touch target (approx)\n        \"rounded-lg\",                   // HIG: Consistent corner radius\n        \"border-2 border-neutral-200\",  // HIG: Visible boundary\n        \"cursor-pointer\",\n        \"p-1\",\n        \"transition-all duration-200 ease-out\",  // HIG: Smooth state transitions\n        \"hover:border-neutral-400\",\n        \"focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\",\n        disabled ? \"opacity-50 cursor-not-allowed\" : \"\",\n      ].filter(Boolean).join(\" \")}\n      aria-label=\"Color picker\"\n    />\n  </div>\n);\n\ninterface HexInputProps {\n  value: string;\n  onChange: (value: string) => void;\n  disabled?: boolean;\n}\n\nconst HexInput: React.FC<HexInputProps> = ({ value, onChange, disabled }) => {\n  const handleHexChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const hex = e.target.value;\n    // Allow typing valid hex chars, validate on blur if needed or purely restrict here\n    // For now, pass through if it matches basic hex structure pattern length-wise or char-wise\n    if (/^#[0-9A-Fa-f]*$/.test(hex) && hex.length <= 7) {\n      onChange(hex);\n    }\n  };\n\n  return (\n    <input\n      type=\"text\"\n      value={value}\n      onChange={handleHexChange}\n      disabled={disabled}\n      className={[\n        \"font-mono text-sm uppercase\",\n        \"w-24 h-11\",                     // HIG: Match 44px height\n        \"px-3\",                          // HIG: 8pt grid padding\n        \"border-2 border-neutral-200\",\n        \"rounded-lg\",\n        \"text-right\",                    // HIG: Right align hex values\n        \"transition-all duration-200 ease-out\",\n        \"hover:border-neutral-400\",\n        \"focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:border-transparent\",\n        disabled ? \"opacity-50 cursor-not-allowed bg-neutral-100\" : \"bg-white\",\n      ].filter(Boolean).join(\" \")}\n      aria-label=\"Hex value\"\n    />\n  );\n};\n\n// ============================================\n// Google Fonts Modal\n// ============================================\n\ninterface GoogleFontsModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelectFont: (font: { name: string; family: string }) => void;\n  installedFonts: CustomFont[];\n}\n\nconst GoogleFontsModal: React.FC<GoogleFontsModalProps> = ({ isOpen, onClose, onSelectFont, installedFonts }) => {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [loadingFont, setLoadingFont] = useState<string | null>(null);\n\n  const filteredFonts = POPULAR_GOOGLE_FONTS.filter(\n    (font) => font.name.toLowerCase().includes(searchTerm.toLowerCase()) && !installedFonts.some((f) => f.name === font.name)\n  );\n\n  const handleSelectFont = async (font: { name: string; family: string }) => {\n    setLoadingFont(font.name);\n    // Simulate loading delay for UX\n    await new Promise((resolve) => setTimeout(resolve, 500));\n    onSelectFont(font);\n    setLoadingFont(null);\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\" onClick={onClose}>\n      <div className=\"bg-white rounded-lg shadow-xl w-96 max-h-[80vh] flex flex-col\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-neutral-200\">\n          <h3 className=\"text-lg font-semibold text-neutral-900\">Add Google Font</h3>\n          <button type=\"button\" onClick={onClose} className=\"p-1 rounded hover:bg-neutral-100\">\n            <CloseIcon />\n          </button>\n        </div>\n        <div className=\"p-4\">\n          <Input size=\"sm\" placeholder=\"Search fonts...\" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} fullWidth />\n        </div>\n        <div className=\"flex-1 overflow-y-auto px-4 pb-4 space-y-2\">\n          {filteredFonts.length === 0 ? (\n            <p className=\"text-sm text-neutral-500 text-center py-4\">No fonts found</p>\n          ) : (\n            filteredFonts.map((font) => (\n              <button\n                key={font.name}\n                type=\"button\"\n                onClick={() => handleSelectFont(font)}\n                disabled={loadingFont !== null}\n                className=\"w-full flex items-center justify-between p-3 rounded-md border border-neutral-200 hover:bg-neutral-50 transition-colors disabled:opacity-50\"\n              >\n                <span className=\"text-sm font-medium text-neutral-800\">{font.name}</span>\n                {loadingFont === font.name ? (\n                  <span className=\"text-xs text-neutral-500\">Loading...</span>\n                ) : (\n                  <PlusIcon />\n                )}\n              </button>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// ============================================\n// Theme Editor Modal\n// ============================================\n\ninterface ThemeEditorModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  theme: ThemeConfig | null;\n  isNew: boolean;\n  onSave: (theme: ThemeConfig) => void;\n  customFonts: CustomFont[];\n  onAddFont: (font: CustomFont) => void;\n}\n\nconst ThemeEditorModal: React.FC<ThemeEditorModalProps> = ({ isOpen, onClose, theme, isNew, onSave, customFonts, onAddFont }) => {\n  const [editingTheme, setEditingTheme] = useState<ThemeConfig | null>(null);\n  const [showFontsModal, setShowFontsModal] = useState(false);\n\n  useEffect(() => {\n    if (theme) {\n      setEditingTheme({ ...theme });\n    } else if (isNew) {\n      setEditingTheme({ ...defaultLightTheme, name: \"\" });\n    }\n  }, [theme, isNew]);\n\n  // Helper: Generate color scale from a base color (500 shade)\n  const generateColorScale = (baseColor: string): ColorScale => {\n    // Parse hex to get HSL for manipulation\n    const hexToHsl = (hex: string): [number, number, number] => {\n      const r = parseInt(hex.slice(1, 3), 16) / 255;\n      const g = parseInt(hex.slice(3, 5), 16) / 255;\n      const b = parseInt(hex.slice(5, 7), 16) / 255;\n      const max = Math.max(r, g, b), min = Math.min(r, g, b);\n      let h = 0, s = 0;\n      const l = (max + min) / 2;\n      if (max !== min) {\n        const d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n          case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;\n          case g: h = ((b - r) / d + 2) / 6; break;\n          case b: h = ((r - g) / d + 4) / 6; break;\n        }\n      }\n      return [h * 360, s * 100, l * 100];\n    };\n\n    const hslToHex = (h: number, s: number, l: number): string => {\n      s /= 100; l /= 100;\n      const c = (1 - Math.abs(2 * l - 1)) * s;\n      const x = c * (1 - Math.abs((h / 60) % 2 - 1));\n      const m = l - c / 2;\n      let r = 0, g = 0, b = 0;\n      if (h < 60) { r = c; g = x; }\n      else if (h < 120) { r = x; g = c; }\n      else if (h < 180) { g = c; b = x; }\n      else if (h < 240) { g = x; b = c; }\n      else if (h < 300) { r = x; b = c; }\n      else { r = c; b = x; }\n      const toHex = (v: number) => Math.round((v + m) * 255).toString(16).padStart(2, '0');\n      return `#${toHex(r)}${toHex(g)}${toHex(b)}`;\n    };\n\n    const [h, s, l] = hexToHsl(baseColor);\n    return {\n      50: hslToHex(h, Math.min(s * 0.3, 100), Math.min(l + 45, 97)),\n      100: hslToHex(h, Math.min(s * 0.4, 100), Math.min(l + 38, 94)),\n      200: hslToHex(h, Math.min(s * 0.5, 100), Math.min(l + 28, 88)),\n      300: hslToHex(h, Math.min(s * 0.7, 100), Math.min(l + 18, 78)),\n      400: hslToHex(h, Math.min(s * 0.85, 100), Math.min(l + 8, 65)),\n      500: baseColor,\n      600: hslToHex(h, Math.min(s * 1.1, 100), Math.max(l - 8, 25)),\n      700: hslToHex(h, Math.min(s * 1.15, 100), Math.max(l - 16, 20)),\n      800: hslToHex(h, Math.min(s * 1.2, 100), Math.max(l - 24, 15)),\n      900: hslToHex(h, Math.min(s * 1.25, 100), Math.max(l - 32, 10)),\n      950: hslToHex(h, Math.min(s * 1.3, 100), Math.max(l - 40, 5)),\n    };\n  };\n\n  const handleSimplifiedColorChange = (category: \"primary\" | \"neutral\" | \"info\", value: string) => {\n    if (!editingTheme) return;\n    const scale = generateColorScale(value);\n    setEditingTheme({\n      ...editingTheme,\n      colors: {\n        ...editingTheme.colors,\n        [category]: category === \"primary\" || category === \"neutral\"\n          ? scale\n          : { 50: scale[50], 500: scale[500], 600: scale[600], 700: scale[700] },\n      },\n    });\n  };\n\n  const handleTypographyChange = (type: \"sans\" | \"mono\", value: string) => {\n    if (!editingTheme) return;\n    setEditingTheme({\n      ...editingTheme,\n      typography: {\n        ...editingTheme.typography,\n        fontFamily: {\n          ...editingTheme.typography.fontFamily,\n          [type]: value,\n        },\n      },\n    });\n  };\n\n  // Header/Body text colors mapped to neutral scale endpoints\n  const handleTextColorChange = (type: \"header\" | \"body\", value: string) => {\n    if (!editingTheme) return;\n    // Header color maps to neutral-900 (darker), body maps to neutral-700\n    const shade = type === \"header\" ? 900 : 700;\n    setEditingTheme({\n      ...editingTheme,\n      colors: {\n        ...editingTheme.colors,\n        neutral: {\n          ...editingTheme.colors.neutral,\n          [shade]: value,\n        },\n      },\n    });\n  };\n\n  const handleModeToggle = () => {\n    if (!editingTheme) return;\n    const newMode = editingTheme.mode === \"light\" ? \"dark\" : \"light\";\n    setEditingTheme({\n      ...editingTheme,\n      mode: newMode,\n    });\n  };\n\n  const handleSave = () => {\n    if (editingTheme && editingTheme.name.trim()) {\n      onSave(editingTheme);\n      onClose();\n    }\n  };\n\n  const handleAddGoogleFont = (font: { name: string; family: string }) => {\n    const url = `https://fonts.googleapis.com/css2?family=${font.family}:wght@400;500;600;700&display=swap`;\n\n    // Inject the font stylesheet\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = url;\n    document.head.appendChild(link);\n\n    const customFont: CustomFont = {\n      name: font.name,\n      family: `\"${font.name}\", sans-serif`,\n      url,\n      loaded: true,\n    };\n    onAddFont(customFont);\n    setShowFontsModal(false);\n  };\n\n  // Build font options including custom fonts\n  const fontFamilyOptions: SelectOption[] = [\n    { value: '\"Inter\", system-ui, sans-serif', label: \"Inter\" },\n    { value: '\"Segoe UI\", system-ui, sans-serif', label: \"Segoe UI\" },\n    { value: \"system-ui, sans-serif\", label: \"System Default\" },\n    { value: '\"Roboto\", sans-serif', label: \"Roboto\" },\n    { value: '\"Poppins\", sans-serif', label: \"Poppins\" },\n    { value: '\"Montserrat\", sans-serif', label: \"Montserrat\" },\n    ...customFonts.map((f) => ({ value: f.family, label: f.name })),\n  ];\n\n  if (!isOpen || !editingTheme) return null;\n\n  return (\n    <>\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\" onClick={onClose}>\n        <div className=\"bg-white rounded-lg shadow-xl w-[520px] max-h-[90vh] flex flex-col\" onClick={(e) => e.stopPropagation()}>\n          {/* Header */}\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-neutral-200 bg-neutral-50 rounded-t-lg\">\n            <h3 className=\"text-lg font-semibold text-neutral-900\">{isNew ? \"Create Theme\" : `Edit: ${theme?.name}`}</h3>\n            <div className=\"flex items-center gap-2\">\n              <button type=\"button\" onClick={handleModeToggle} className=\"p-2 rounded-md hover:bg-neutral-200 transition-colors text-neutral-600\" aria-label={`Switch to ${editingTheme.mode === \"light\" ? \"dark\" : \"light\"} mode`}>\n                {editingTheme.mode === \"light\" ? <MoonIcon /> : <SunIcon />}\n              </button>\n              <button type=\"button\" onClick={onClose} className=\"p-2 rounded-md hover:bg-neutral-200 transition-colors text-neutral-600\">\n                <CloseIcon />\n              </button>\n            </div>\n          </div>\n\n          {/* Theme Name */}\n          <div className=\"px-6 py-4 border-b border-neutral-200 bg-white\">\n            <Input size=\"sm\" label=\"Theme Name\" placeholder=\"Enter theme name...\" value={editingTheme.name} onChange={(e) => setEditingTheme({ ...editingTheme, name: e.target.value })} fullWidth />\n          </div>\n\n          {/* Scrolling Content - Removed max-height constraint to use flexible height up to 90vh */}\n          <div className=\"flex-1 overflow-y-auto px-6 py-6 space-y-8\">\n\n            {/* Typography Section */}\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between border-b border-neutral-200 pb-2\">\n                <h4 className=\"text-sm font-semibold text-neutral-800\">Typography</h4>\n                <Button variant=\"ghost\" size=\"xs\" onClick={() => setShowFontsModal(true)} className=\"text-primary-600 hover:text-primary-700 hover:bg-primary-50\">\n                  <PlusIcon />\n                  <span className=\"ml-1\">Add Google Font</span>\n                </Button>\n              </div>\n\n              {/* Fonts Grid */}\n              <div className=\"space-y-6\">\n                {/* Header Font */}\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-neutral-900 block\">Header Font</label>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"flex-1\">\n                      <Select\n                        options={fontFamilyOptions}\n                        value={editingTheme.typography.fontFamily.sans}\n                        onChange={(e) => handleTypographyChange(\"sans\", e.target.value)}\n                        fullWidth\n                      />\n                    </div>\n                    <div className=\"flex items-center gap-2 shrink-0\">\n                      <span className=\"text-xs text-neutral-500 mr-1\">Color</span>\n                      <ColorSwatch\n                        value={editingTheme.colors.neutral[900] || \"#18181b\"}\n                        onChange={(value) => handleTextColorChange(\"header\", value)}\n                      />\n                      <HexInput\n                        value={editingTheme.colors.neutral[900] || \"#18181b\"}\n                        onChange={(value) => handleTextColorChange(\"header\", value)}\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                {/* Body Font */}\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-neutral-900 block\">Body Font</label>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"flex-1\">\n                      <Select\n                        options={fontFamilyOptions}\n                        value={editingTheme.typography.fontFamily.sans}\n                        onChange={(e) => handleTypographyChange(\"sans\", e.target.value)}\n                        fullWidth\n                      />\n                    </div>\n                    <div className=\"flex items-center gap-2 shrink-0\">\n                      <span className=\"text-xs text-neutral-500 mr-1\">Color</span>\n                      <ColorSwatch\n                        value={editingTheme.colors.neutral[700] || \"#3f3f46\"}\n                        onChange={(value) => handleTextColorChange(\"body\", value)}\n                      />\n                      <HexInput\n                        value={editingTheme.colors.neutral[700] || \"#3f3f46\"}\n                        onChange={(value) => handleTextColorChange(\"body\", value)}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Colors Section - Unified Grid Layout */}\n            <div className=\"space-y-4\">\n              <h4 className=\"text-sm font-semibold text-neutral-800 border-b border-neutral-200 pb-2\">Colors</h4>\n\n              <div className=\"grid grid-cols-[1fr_auto_auto] gap-x-6 gap-y-4 items-center\">\n\n                {/* Headers (Implicitly defined by alignment) */}\n\n                {/* Row 1: Backgrounds */}\n                <span className=\"text-sm font-medium text-neutral-700 text-left\">Backgrounds & Highlights</span>\n                <ColorSwatch\n                  value={editingTheme.colors.neutral[100] || \"#f4f4f5\"}\n                  onChange={(value) => handleSimplifiedColorChange(\"neutral\", value)}\n                />\n                <HexInput\n                  value={editingTheme.colors.neutral[100] || \"#f4f4f5\"}\n                  onChange={(value) => handleSimplifiedColorChange(\"neutral\", value)}\n                />\n\n                {/* Row 2: Primary Accent */}\n                <span className=\"text-sm font-medium text-neutral-700 text-left\">Primary Accent</span>\n                <ColorSwatch\n                  value={editingTheme.colors.primary[500] || \"#3b82f6\"}\n                  onChange={(value) => handleSimplifiedColorChange(\"primary\", value)}\n                />\n                <HexInput\n                  value={editingTheme.colors.primary[500] || \"#3b82f6\"}\n                  onChange={(value) => handleSimplifiedColorChange(\"primary\", value)}\n                />\n\n                {/* Row 3: Accent Elements */}\n                <span className=\"text-sm font-medium text-neutral-700 text-left\">Accent Elements</span>\n                <ColorSwatch\n                  value={editingTheme.colors.info?.[500] || \"#3b82f6\"}\n                  onChange={(value) => handleSimplifiedColorChange(\"info\", value)}\n                />\n                <HexInput\n                  value={editingTheme.colors.info?.[500] || \"#3b82f6\"}\n                  onChange={(value) => handleSimplifiedColorChange(\"info\", value)}\n                />\n\n                {/* Row 4: Clean Backgrounds */}\n                <span className=\"text-sm font-medium text-neutral-700 text-left\">Clean Backgrounds</span>\n                <ColorSwatch\n                  value={editingTheme.colors.neutral[50] || \"#fafafa\"}\n                  onChange={(value) => {\n                    if (!editingTheme) return;\n                    setEditingTheme({\n                      ...editingTheme,\n                      colors: {\n                        ...editingTheme.colors,\n                        neutral: {\n                          ...editingTheme.colors.neutral,\n                          50: value,\n                        },\n                      },\n                    });\n                  }}\n                />\n                <HexInput\n                  value={editingTheme.colors.neutral[50] || \"#fafafa\"}\n                  onChange={(value) => {\n                    // Same logic as onChange above repeated for hex\n                    if (!editingTheme) return;\n                    setEditingTheme({\n                      ...editingTheme,\n                      colors: {\n                        ...editingTheme.colors,\n                        neutral: {\n                          ...editingTheme.colors.neutral,\n                          50: value,\n                        },\n                      },\n                    });\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end gap-2 px-6 py-4 border-t border-neutral-200 bg-neutral-50 rounded-b-lg\">\n            <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>Cancel</Button>\n            <Button variant=\"primary\" size=\"sm\" onClick={handleSave} disabled={!editingTheme.name.trim()}>Save Theme</Button>\n          </div>\n        </div>\n      </div>\n\n      <GoogleFontsModal isOpen={showFontsModal} onClose={() => setShowFontsModal(false)} onSelectFont={handleAddGoogleFont} installedFonts={customFonts} />\n    </>\n  );\n};\n\n// ============================================\n// Main Component\n// ============================================\n\n/**\n * Target for theme application.\n * - 'factory': Apply theme to App Factory UI itself\n * - 'canvas': Apply theme to the app being designed in the canvas (saves to project)\n */\nexport type ThemeTarget = 'factory' | 'canvas';\n\nexport interface ThemeCustomizationPanelProps {\n  isOpen?: boolean;\n  onClose?: () => void;\n  position?: \"left\" | \"right\";\n  width?: string;\n  /** Initial target for theme application */\n  initialTarget?: ThemeTarget;\n  /** Callback when theme is applied to canvas app */\n  onApplyToCanvas?: (theme: ThemeConfig) => void;\n}\n\nexport const ThemeCustomizationPanel: React.FC<ThemeCustomizationPanelProps> = ({\n  isOpen: controlledOpen,\n  onClose,\n  position = \"right\",\n  width = \"360px\",\n  initialTarget = 'factory',\n  onApplyToCanvas,\n}) => {\n  const {\n    theme,\n    savedThemes,\n    isPanelOpen,\n    customFonts,\n    toggleMode,\n    loadTheme,\n    saveTheme,\n    deleteTheme,\n    updateTheme,\n    resetToDefault,\n    setPanelOpen,\n    addCustomFont,\n  } = useThemeStore();\n\n  const isOpen = controlledOpen ?? isPanelOpen;\n  const [editingTheme, setEditingTheme] = useState<ThemeConfig | null>(null);\n  const [isCreatingNew, setIsCreatingNew] = useState(false);\n  const [newThemeName, setNewThemeName] = useState(\"\");\n  const [themeTarget, setThemeTarget] = useState<ThemeTarget>(initialTarget);\n\n  const handleClose = useCallback(() => {\n    if (onClose) {\n      onClose();\n    } else {\n      setPanelOpen(false);\n    }\n  }, [onClose, setPanelOpen]);\n\n  const handleEditTheme = (themeToEdit: ThemeConfig) => {\n    setIsCreatingNew(false);\n    setEditingTheme(themeToEdit);\n  };\n\n  const handleCreateNew = () => {\n    setIsCreatingNew(true);\n    setEditingTheme(null);\n  };\n\n  const handleSaveEditedTheme = (updatedTheme: ThemeConfig) => {\n    // Remember current theme name before saving (in case we need to restore it)\n    const previousThemeName = theme.name;\n\n    if (isCreatingNew) {\n      // For new themes, save as a new theme entry\n      saveTheme(updatedTheme.name);\n      // Then update with full theme data\n      updateTheme(updatedTheme.name, updatedTheme);\n    } else if (editingTheme) {\n      // Update existing theme\n      updateTheme(editingTheme.name, updatedTheme);\n    }\n\n    // If in canvas mode, restore the App Factory theme and apply to canvas instead\n    if (themeTarget === 'canvas') {\n      // Restore the previous App Factory theme (saveTheme activates the new theme)\n      if (previousThemeName !== updatedTheme.name) {\n        loadTheme(previousThemeName);\n      } else {\n        // If editing the currently active theme, reload the default\n        loadTheme('Default');\n      }\n      // Apply to canvas\n      if (onApplyToCanvas) {\n        onApplyToCanvas(updatedTheme);\n      }\n    }\n\n    setEditingTheme(null);\n    setIsCreatingNew(false);\n  };\n\n  const handleQuickSave = () => {\n    if (newThemeName.trim()) {\n      // Remember current theme before saving\n      const previousThemeName = theme.name;\n\n      saveTheme(newThemeName.trim());\n\n      // If in canvas mode, restore App Factory theme and apply to canvas\n      if (themeTarget === 'canvas') {\n        loadTheme(previousThemeName);\n        // Apply the newly saved theme to canvas\n        const savedTheme = savedThemes.find(t => t.name === newThemeName.trim());\n        if (savedTheme && onApplyToCanvas) {\n          onApplyToCanvas(savedTheme);\n        }\n      }\n\n      setNewThemeName(\"\");\n    }\n  };\n\n  if (!isOpen) {\n    return null;\n  }\n\n  const positionClasses = position === \"right\" ? \"right-0 border-l\" : \"left-0 border-r\";\n\n  return (\n    <>\n      <div\n        className={[\"fixed\", \"top-0\", \"bottom-0\", \"z-40\", \"bg-white\", \"shadow-xl\", \"flex\", \"flex-col\", \"border-neutral-200\", positionClasses].join(\" \")}\n        style={{ width }}\n        role=\"dialog\"\n        aria-label=\"Theme Settings\"\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-neutral-200 bg-neutral-50 shrink-0\">\n          <h2 className=\"text-lg font-semibold text-neutral-900\">Theme Settings</h2>\n          <div className=\"flex items-center gap-2\">\n            <button type=\"button\" onClick={toggleMode} className=\"p-2 rounded-md hover:bg-neutral-200 transition-colors text-neutral-600\" aria-label={`Switch to ${theme.mode === \"light\" ? \"dark\" : \"light\"} mode`}>\n              {theme.mode === \"light\" ? <MoonIcon /> : <SunIcon />}\n            </button>\n            <button type=\"button\" onClick={handleClose} className=\"p-2 rounded-md hover:bg-neutral-200 transition-colors text-neutral-600\" aria-label=\"Close panel\">\n              <CloseIcon />\n            </button>\n          </div>\n        </div>\n\n        {/* Target Selector - Factory vs Canvas App */}\n        <div className=\"px-4 py-3 border-b border-neutral-200 bg-white\">\n          <div className=\"flex rounded-lg bg-neutral-100 p-1\">\n            <button\n              type=\"button\"\n              onClick={() => setThemeTarget('factory')}\n              className={[\n                \"flex-1 px-3 py-1.5 text-sm font-medium rounded-md transition-colors\",\n                themeTarget === 'factory'\n                  ? \"bg-white text-neutral-900 shadow-sm\"\n                  : \"text-neutral-600 hover:text-neutral-900\"\n              ].join(\" \")}\n            >\n              App Factory\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setThemeTarget('canvas')}\n              className={[\n                \"flex-1 px-3 py-1.5 text-sm font-medium rounded-md transition-colors\",\n                themeTarget === 'canvas'\n                  ? \"bg-primary-500 text-white shadow-sm\"\n                  : \"text-neutral-600 hover:text-neutral-900\"\n              ].join(\" \")}\n            >\n              Canvas App\n            </button>\n          </div>\n          <p className=\"text-xs text-neutral-500 mt-2 text-center\">\n            {themeTarget === 'factory'\n              ? \"Changes apply to App Factory UI\"\n              : \"Changes apply to the app in the canvas\"}\n          </p>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-4\">\n          {/* Quick Save Current Theme */}\n          <div className=\"space-y-2 mb-4\">\n            <h3 className=\"text-sm font-semibold text-neutral-800\">Save Current Theme</h3>\n            <div className=\"flex gap-2\">\n              <Input size=\"sm\" placeholder=\"Theme name\" value={newThemeName} onChange={(e) => setNewThemeName(e.target.value)} onKeyDown={(e) => e.key === \"Enter\" && handleQuickSave()} fullWidth />\n              <Button variant=\"primary\" size=\"sm\" onClick={handleQuickSave} disabled={!newThemeName.trim()}>Save</Button>\n            </div>\n          </div>\n\n          {/* Add New Theme Button */}\n          <Button variant=\"outline\" size=\"sm\" onClick={handleCreateNew} fullWidth className=\"mb-4\">\n            <PlusIcon />\n            <span className=\"ml-2\">Add New Theme</span>\n          </Button>\n\n          {/* Themes List */}\n          <div className=\"space-y-2\">\n            <h3 className=\"text-sm font-semibold text-neutral-800\">Saved Themes</h3>\n            {savedThemes.map((savedTheme) => {\n              const handleLoadTheme = () => {\n                if (themeTarget === 'factory') {\n                  loadTheme(savedTheme.name);\n                } else if (onApplyToCanvas) {\n                  onApplyToCanvas(savedTheme);\n                }\n              };\n\n              return (\n                <div\n                  key={savedTheme.name}\n                  className={[\"flex\", \"items-center\", \"justify-between\", \"p-3\", \"rounded-md\", \"border\", theme.name === savedTheme.name && themeTarget === 'factory' ? \"border-primary-500 bg-primary-50\" : \"border-neutral-200 bg-white hover:bg-neutral-50\"].join(\" \")}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"flex -space-x-1\">\n                      <div className=\"w-5 h-5 rounded-full border-2 border-white\" style={{ backgroundColor: savedTheme.colors.primary[500] }} />\n                      <div className=\"w-5 h-5 rounded-full border-2 border-white\" style={{ backgroundColor: savedTheme.colors.neutral[500] }} />\n                    </div>\n                    <div>\n                      <p className=\"text-sm font-medium text-neutral-800\">{savedTheme.name}</p>\n                      <p className=\"text-xs text-neutral-500 capitalize\">{savedTheme.mode} Mode</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <Button\n                      variant={themeTarget === 'canvas' ? \"primary\" : \"ghost\"}\n                      size=\"xs\"\n                      onClick={handleLoadTheme}\n                      disabled={themeTarget === 'factory' && theme.name === savedTheme.name}\n                    >\n                      {themeTarget === 'canvas' ? 'Apply' : 'Load'}\n                    </Button>\n                    <Button variant=\"ghost\" size=\"xs\" onClick={() => handleEditTheme(savedTheme)}>\n                      <EditIcon />\n                    </Button>\n                    {savedTheme.name !== \"Default\" && savedTheme.name !== \"Default Dark\" && (\n                      <Button variant=\"ghost\" size=\"xs\" onClick={() => deleteTheme(savedTheme.name)} className=\"text-error-600 hover:text-error-700 hover:bg-error-50\">\n                        <TrashIcon />\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n\n          {/* Reset Button */}\n          <div className=\"pt-4 mt-4 border-t border-neutral-200\">\n            <Button variant=\"outline\" size=\"sm\" onClick={resetToDefault} fullWidth>\n              <RefreshIcon />\n              <span className=\"ml-2\">Reset to Default</span>\n            </Button>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"px-4 py-3 border-t border-neutral-200 bg-neutral-50 shrink-0\">\n          <p className=\"text-xs text-neutral-500 text-center\">\n            {themeTarget === 'factory'\n              ? <>Current: <span className=\"font-medium\">{theme.name}</span> ({theme.mode})</>\n              : <>Editing theme for Canvas App</>}\n          </p>\n        </div>\n      </div>\n\n      {/* Edit Theme Modal */}\n      <ThemeEditorModal\n        isOpen={editingTheme !== null || isCreatingNew}\n        onClose={() => {\n          setEditingTheme(null);\n          setIsCreatingNew(false);\n        }}\n        theme={editingTheme}\n        isNew={isCreatingNew}\n        onSave={handleSaveEditedTheme}\n        customFonts={customFonts}\n        onAddFont={addCustomFont}\n      />\n    </>\n  );\n};\n\nThemeCustomizationPanel.displayName = \"ThemeCustomizationPanel\";\n\nexport default ThemeCustomizationPanel;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\ThemePreview.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":75,"column":31,"nodeType":"Identifier","messageId":"invalidType","endLine":75,"endColumn":36},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":204,"column":34,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = &quot;Hello, World!\";\n              "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = &ldquo;Hello, World!\";\n              "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = &#34;Hello, World!\";\n              "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = &rdquo;Hello, World!\";\n              "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":204,"column":48,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = \"Hello, World!&quot;;\n              "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = \"Hello, World!&ldquo;;\n              "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = \"Hello, World!&#34;;\n              "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6624,6689],"text":"\n                const greeting = \"Hello, World!&rdquo;;\n              "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":208,"column":59,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":208,"endColumn":104,"fix":{"range":[6827,6872],"text":"(keyof typeof theme.typography.fontSize)[]"}}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D018 - src/components/ui/ThemePreview.tsx\n * ==========================================\n * Theme preview component that updates in real-time as theme changes.\n * No page reload required - uses CSS custom properties injection.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies:\n *   - D006 (design_tokens.css)\n *   - D007 (tailwind.config.js)\n *   - D010 (Button.tsx)\n *   - D011 (Input.tsx)\n *   - D012 (Select.tsx)\n *   - D013 (Checkbox.tsx)\n *   - D015 (Panel.tsx)\n *   - D016 (ThemeProvider.tsx)\n *   - D017 (ThemeCustomizationPanel.tsx)\n *\n * Features:\n *   - Real-time preview of all atomic components\n *   - Showcases all variants, sizes, and states\n *   - Responsive to theme changes without refresh\n *   - Demonstrates color palette usage\n */\n\nimport React, { useState } from \"react\";\nimport { useThemeStore } from \"../../context/ThemeProvider\";\nimport Button from \"./Button\";\nimport Input from \"./Input\";\nimport Select from \"./Select\";\nimport Checkbox from \"./Checkbox\";\nimport Panel, { PanelHeader, PanelBody, PanelFooter } from \"./Panel\";\n\n// ============================================\n// Preview Section Component\n// ============================================\n\ninterface PreviewSectionProps {\n  title: string;\n  children: React.ReactNode;\n}\n\nconst PreviewSection: React.FC<PreviewSectionProps> = ({ title, children }) => (\n  <div className=\"space-y-3\">\n    <h3 className=\"text-sm font-semibold text-neutral-800 uppercase tracking-wide\">\n      {title}\n    </h3>\n    <div className=\"space-y-3\">{children}</div>\n  </div>\n);\n\n// ============================================\n// Color Swatch Component\n// ============================================\n\ninterface ColorSwatchProps {\n  name: string;\n  shades: Record<string | number, string>;\n}\n\nconst ColorSwatch: React.FC<ColorSwatchProps> = ({ name, shades }) => {\n  const displayShades = [50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 950].filter(\n    (s) => shades[s]\n  );\n\n  return (\n    <div className=\"space-y-1\">\n      <p className=\"text-xs font-medium text-neutral-600 capitalize\">{name}</p>\n      <div className=\"flex rounded-md overflow-hidden\">\n        {displayShades.map((shade) => (\n          <div\n            key={shade}\n            className=\"flex-1 h-8 relative group\"\n            style={{ backgroundColor: shades[shade] }}\n            title={`${name}-${shade}: ${shades[shade]}`}\n          >\n            <span className=\"absolute inset-0 flex items-center justify-center text-[8px] font-mono opacity-0 group-hover:opacity-100 transition-opacity bg-black/20 text-white\">\n              {shade}\n            </span>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\n// ============================================\n// Main Preview Component\n// ============================================\n\nexport interface ThemePreviewProps {\n  /** Whether to show color palette section */\n  showColorPalette?: boolean;\n  /** Whether to show component examples */\n  showComponents?: boolean;\n  /** Whether to show typography examples */\n  showTypography?: boolean;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * ThemePreview component.\n *\n * Displays a live preview of the current theme settings, showcasing\n * all atomic components and the color palette. Updates in real-time\n * as theme values change without requiring a page reload.\n *\n * @example\n * ```tsx\n * // Full preview with all sections\n * <ThemePreview />\n *\n * // Only components\n * <ThemePreview showColorPalette={false} showTypography={false} />\n *\n * // Only color palette\n * <ThemePreview showComponents={false} showTypography={false} />\n * ```\n */\nexport const ThemePreview: React.FC<ThemePreviewProps> = ({\n  showColorPalette = true,\n  showComponents = true,\n  showTypography = true,\n  className = \"\",\n}) => {\n  const { theme } = useThemeStore();\n  const [inputValue, setInputValue] = useState(\"\");\n  const [selectValue, setSelectValue] = useState(\"\");\n  const [checkboxChecked, setCheckboxChecked] = useState(false);\n\n  return (\n    <div\n      className={[\n        \"space-y-8\",\n        \"p-6\",\n        \"bg-white\",\n        \"rounded-lg\",\n        \"border\",\n        \"border-neutral-200\",\n        className,\n      ]\n        .filter(Boolean)\n        .join(\" \")}\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-xl font-bold text-neutral-900\">Theme Preview</h2>\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-sm text-neutral-500\">Current:</span>\n          <span className=\"text-sm font-medium text-neutral-800\">\n            {theme.name}\n          </span>\n          <span\n            className={[\n              \"px-2\",\n              \"py-0.5\",\n              \"text-xs\",\n              \"font-medium\",\n              \"rounded-full\",\n              theme.mode === \"dark\"\n                ? \"bg-neutral-800 text-neutral-200\"\n                : \"bg-neutral-100 text-neutral-700\",\n            ].join(\" \")}\n          >\n            {theme.mode}\n          </span>\n        </div>\n      </div>\n\n      {/* Color Palette Section */}\n      {showColorPalette && (\n        <PreviewSection title=\"Color Palette\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <ColorSwatch name=\"Primary\" shades={theme.colors.primary} />\n            <ColorSwatch name=\"Neutral\" shades={theme.colors.neutral} />\n            <ColorSwatch name=\"Success\" shades={theme.colors.success as Record<number, string>} />\n            <ColorSwatch name=\"Warning\" shades={theme.colors.warning as Record<number, string>} />\n            <ColorSwatch name=\"Error\" shades={theme.colors.error as Record<number, string>} />\n            <ColorSwatch name=\"Info\" shades={theme.colors.info as Record<number, string>} />\n          </div>\n        </PreviewSection>\n      )}\n\n      {/* Typography Section */}\n      {showTypography && (\n        <PreviewSection title=\"Typography\">\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <p className=\"text-xs text-neutral-500\">Sans-serif Font</p>\n              <p\n                className=\"text-lg text-neutral-800\"\n                style={{ fontFamily: theme.typography.fontFamily.sans }}\n              >\n                The quick brown fox jumps over the lazy dog.\n              </p>\n            </div>\n            <div className=\"space-y-2\">\n              <p className=\"text-xs text-neutral-500\">Monospace Font</p>\n              <p\n                className=\"text-lg text-neutral-800\"\n                style={{ fontFamily: theme.typography.fontFamily.mono }}\n              >\n                const greeting = \"Hello, World!\";\n              </p>\n            </div>\n            <div className=\"flex flex-wrap gap-4 pt-2\">\n              {(Object.keys(theme.typography.fontSize) as Array<keyof typeof theme.typography.fontSize>).map(\n                (size) => (\n                  <div key={size} className=\"text-center\">\n                    <span\n                      className=\"text-neutral-800 block\"\n                      style={{ fontSize: theme.typography.fontSize[size] }}\n                    >\n                      Aa\n                    </span>\n                    <span className=\"text-xs text-neutral-500\">{size}</span>\n                  </div>\n                )\n              )}\n            </div>\n          </div>\n        </PreviewSection>\n      )}\n\n      {/* Components Section */}\n      {showComponents && (\n        <>\n          {/* Buttons */}\n          <PreviewSection title=\"Buttons\">\n            <div className=\"space-y-4\">\n              {/* Variants */}\n              <div className=\"space-y-2\">\n                <p className=\"text-xs text-neutral-500\">Variants</p>\n                <div className=\"flex flex-wrap gap-2\">\n                  <Button variant=\"primary\">Primary</Button>\n                  <Button variant=\"secondary\">Secondary</Button>\n                  <Button variant=\"outline\">Outline</Button>\n                  <Button variant=\"ghost\">Ghost</Button>\n                  <Button variant=\"danger\">Danger</Button>\n                  <Button variant=\"success\">Success</Button>\n                </div>\n              </div>\n\n              {/* Sizes */}\n              <div className=\"space-y-2\">\n                <p className=\"text-xs text-neutral-500\">Sizes</p>\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <Button size=\"xs\">Extra Small</Button>\n                  <Button size=\"sm\">Small</Button>\n                  <Button size=\"md\">Medium</Button>\n                  <Button size=\"lg\">Large</Button>\n                  <Button size=\"xl\">Extra Large</Button>\n                </div>\n              </div>\n\n              {/* States */}\n              <div className=\"space-y-2\">\n                <p className=\"text-xs text-neutral-500\">States</p>\n                <div className=\"flex flex-wrap gap-2\">\n                  <Button>Default</Button>\n                  <Button loading>Loading</Button>\n                  <Button disabled>Disabled</Button>\n                  <Button pill>Pill Shape</Button>\n                </div>\n              </div>\n\n              {/* With Icons */}\n              <div className=\"space-y-2\">\n                <p className=\"text-xs text-neutral-500\">With Icons</p>\n                <div className=\"flex flex-wrap gap-2\">\n                  <Button\n                    leftIcon={\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                        <path d=\"M12 5v14M5 12h14\" />\n                      </svg>\n                    }\n                  >\n                    Add Item\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    rightIcon={\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                        <path d=\"M9 5l7 7-7 7\" />\n                      </svg>\n                    }\n                  >\n                    Continue\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    iconOnly\n                    aria-label=\"Settings\"\n                  >\n                    <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                      <circle cx=\"12\" cy=\"12\" r=\"3\" />\n                      <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\n                    </svg>\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </PreviewSection>\n\n          {/* Inputs */}\n          <PreviewSection title=\"Inputs\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Input\n                label=\"Default Input\"\n                placeholder=\"Enter text...\"\n                value={inputValue}\n                onChange={(e) => setInputValue(e.target.value)}\n              />\n              <Input\n                label=\"With Helper Text\"\n                placeholder=\"Enter email...\"\n                helperText=\"We'll never share your email.\"\n              />\n              <Input\n                label=\"Error State\"\n                placeholder=\"Enter password...\"\n                error\n                errorMessage=\"Password must be at least 8 characters.\"\n              />\n              <Input\n                label=\"Disabled\"\n                placeholder=\"Can't edit this...\"\n                disabled\n                value=\"Disabled value\"\n              />\n              <Input\n                label=\"With Left Icon\"\n                placeholder=\"Search...\"\n                leftElement={\n                  <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n                    <path d=\"M21 21l-4.35-4.35\" />\n                  </svg>\n                }\n              />\n              <Input\n                variant=\"filled\"\n                label=\"Filled Variant\"\n                placeholder=\"Filled style input...\"\n              />\n            </div>\n          </PreviewSection>\n\n          {/* Selects */}\n          <PreviewSection title=\"Selects\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Select\n                label=\"Basic Select\"\n                placeholder=\"Choose an option...\"\n                options={[\n                  { value: \"option1\", label: \"Option 1\" },\n                  { value: \"option2\", label: \"Option 2\" },\n                  { value: \"option3\", label: \"Option 3\" },\n                ]}\n                value={selectValue}\n                onChange={(e) => setSelectValue(e.target.value)}\n              />\n              <Select\n                label=\"With Helper Text\"\n                placeholder=\"Select country...\"\n                helperText=\"Choose your home country.\"\n                options={[\n                  { value: \"us\", label: \"United States\" },\n                  { value: \"uk\", label: \"United Kingdom\" },\n                  { value: \"ca\", label: \"Canada\" },\n                ]}\n              />\n              <Select\n                label=\"Error State\"\n                placeholder=\"Required field\"\n                error\n                errorMessage=\"Please select an option.\"\n                options={[\n                  { value: \"a\", label: \"Choice A\" },\n                  { value: \"b\", label: \"Choice B\" },\n                ]}\n              />\n              <Select\n                label=\"Disabled\"\n                placeholder=\"Cannot change\"\n                disabled\n                options={[\n                  { value: \"locked\", label: \"Locked Option\" },\n                ]}\n              />\n            </div>\n          </PreviewSection>\n\n          {/* Checkboxes */}\n          <PreviewSection title=\"Checkboxes\">\n            <div className=\"space-y-3\">\n              <Checkbox\n                label=\"Default checkbox\"\n                checked={checkboxChecked}\n                onChange={(e) => setCheckboxChecked(e.target.checked)}\n              />\n              <Checkbox\n                label=\"With description\"\n                description=\"This is a helpful description for the checkbox.\"\n              />\n              <Checkbox\n                label=\"Checked by default\"\n                defaultChecked\n              />\n              <Checkbox\n                label=\"Error state\"\n                error\n                errorMessage=\"You must accept the terms.\"\n              />\n              <Checkbox\n                label=\"Disabled\"\n                disabled\n              />\n              <Checkbox\n                label=\"Disabled checked\"\n                disabled\n                checked\n              />\n              <Checkbox\n                label=\"Indeterminate\"\n                indeterminate\n              />\n              <div className=\"flex gap-4\">\n                <Checkbox label=\"Small\" size=\"sm\" />\n                <Checkbox label=\"Medium\" size=\"md\" />\n                <Checkbox label=\"Large\" size=\"lg\" />\n              </div>\n              <div className=\"flex gap-4\">\n                <Checkbox label=\"Primary\" colorScheme=\"primary\" defaultChecked />\n                <Checkbox label=\"Success\" colorScheme=\"success\" defaultChecked />\n                <Checkbox label=\"Warning\" colorScheme=\"warning\" defaultChecked />\n                <Checkbox label=\"Error\" colorScheme=\"error\" defaultChecked />\n              </div>\n            </div>\n          </PreviewSection>\n\n          {/* Panels */}\n          <PreviewSection title=\"Panels\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Panel variant=\"default\" padding=\"md\">\n                <PanelHeader title=\"Default Panel\" subtitle=\"With header components\" />\n                <PanelBody>\n                  <p className=\"text-sm text-neutral-600\">\n                    This is the panel content area. It can contain any React components.\n                  </p>\n                </PanelBody>\n              </Panel>\n\n              <Panel variant=\"elevated\" padding=\"md\">\n                <PanelHeader title=\"Elevated Panel\" />\n                <PanelBody>\n                  <p className=\"text-sm text-neutral-600\">\n                    This panel has a shadow for depth.\n                  </p>\n                </PanelBody>\n              </Panel>\n\n              <Panel variant=\"filled\" padding=\"md\">\n                <PanelHeader title=\"Filled Panel\" />\n                <PanelBody>\n                  <p className=\"text-sm text-neutral-600\">\n                    This panel has a filled background.\n                  </p>\n                </PanelBody>\n              </Panel>\n\n              <Panel\n                variant=\"default\"\n                padding=\"md\"\n                collapsible\n                header=\"Collapsible Panel\"\n                defaultCollapsed={false}\n              >\n                <p className=\"text-sm text-neutral-600\">\n                  Click the header to collapse this panel.\n                </p>\n              </Panel>\n            </div>\n\n            <Panel variant=\"default\" padding=\"md\">\n              <PanelHeader\n                title=\"Panel with Actions\"\n                subtitle=\"Includes footer with buttons\"\n                actions={\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                      <circle cx=\"12\" cy=\"12\" r=\"1\" />\n                      <circle cx=\"19\" cy=\"12\" r=\"1\" />\n                      <circle cx=\"5\" cy=\"12\" r=\"1\" />\n                    </svg>\n                  </Button>\n                }\n              />\n              <PanelBody>\n                <p className=\"text-sm text-neutral-600\">\n                  This panel demonstrates the full structure with header, body, and footer.\n                </p>\n              </PanelBody>\n              <PanelFooter>\n                <Button variant=\"secondary\" size=\"sm\">Cancel</Button>\n                <Button variant=\"primary\" size=\"sm\">Save Changes</Button>\n              </PanelFooter>\n            </Panel>\n          </PreviewSection>\n        </>\n      )}\n    </div>\n  );\n};\n\nThemePreview.displayName = \"ThemePreview\";\n\nexport default ThemePreview;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\WindowConfigPanel.tsx","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":325,"column":13,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":325,"endColumn":93,"fix":{"range":[8443,8523],"text":"{ id: string; name: string; type: ScreenType; hasCustomConfig?: boolean }[]"}},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\WindowConfigPanel.tsx:383:7\n  381 |   useEffect(() => {\n  382 |     if (selectedScreenId !== undefined) {\n> 383 |       setLocalSelectedScreen(selectedScreenId);\n      |       ^^^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  384 |     }\n  385 |   }, [selectedScreenId]);\n  386 |","line":383,"column":7,"nodeType":null,"endLine":383,"endColumn":29},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":445,"column":5,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":445,"endColumn":47,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[11907,11907],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[11907,11907],"text":"await "},"desc":"Add await operator."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D019 - src/components/ui/WindowConfigPanel.tsx\n * ===============================================\n * Window configuration panel with toggles for: fullscreen, floating,\n * frameless, always-on-top. Persists settings to tauri.conf.json.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies:\n *   - D006 (design_tokens.css)\n *   - D007 (tailwind.config.js)\n *   - D010 (Button.tsx)\n *   - D011 (Input.tsx)\n *   - D012 (Select.tsx)\n *   - D013 (Checkbox.tsx)\n *   - D015 (Panel.tsx)\n *\n * Features:\n *   - Window mode toggles (fullscreen, floating, frameless, always-on-top)\n *   - Window dimensions configuration\n *   - Minimum/maximum size constraints\n *   - Window position settings\n *   - Live preview of configuration\n *   - Export to tauri.conf.json format\n */\n\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport { create } from \"zustand\";\nimport { persist, createJSONStorage } from \"zustand/middleware\";\nimport Button from \"./Button\";\nimport Input from \"./Input\";\n// Select import removed - not used in this file\nimport Checkbox from \"./Checkbox\";\nimport Panel, { PanelHeader, PanelBody } from \"./Panel\";\nimport type { ScreenType, SerializedWindowConfig } from \"../../stores/projectStore\";\n\n// ============================================\n// Types\n// ============================================\n\n/**\n * Window configuration state.\n */\nexport interface WindowConfig {\n  // Basic settings\n  title: string;\n  width: number;\n  height: number;\n  minWidth: number;\n  minHeight: number;\n  maxWidth: number | null;\n  maxHeight: number | null;\n\n  // Position (null = centered)\n  x: number | null;\n  y: number | null;\n  center: boolean;\n\n  // Window behavior flags\n  fullscreen: boolean;\n  resizable: boolean;\n  decorations: boolean;\n  alwaysOnTop: boolean;\n  skipTaskbar: boolean;\n  transparent: boolean;\n  visible: boolean;\n  focus: boolean;\n  closable: boolean;\n  minimizable: boolean;\n  maximizable: boolean;\n\n  // Special modes\n  fileDropEnabled: boolean;\n}\n\n/**\n * Window config store state.\n */\ninterface WindowConfigState {\n  config: WindowConfig;\n  isDirty: boolean;\n\n  // Actions\n  setConfig: (updates: Partial<WindowConfig>) => void;\n  resetToDefaults: () => void;\n  markClean: () => void;\n  exportToTauriConfig: () => TauriWindowConfig;\n}\n\n/**\n * Tauri window configuration format (for export).\n */\ninterface TauriWindowConfig {\n  label: string;\n  title: string;\n  width: number;\n  height: number;\n  minWidth?: number;\n  minHeight?: number;\n  maxWidth?: number;\n  maxHeight?: number;\n  x?: number;\n  y?: number;\n  center: boolean;\n  fullscreen: boolean;\n  resizable: boolean;\n  decorations: boolean;\n  alwaysOnTop: boolean;\n  skipTaskbar: boolean;\n  transparent: boolean;\n  visible: boolean;\n  focus: boolean;\n  closable: boolean;\n  minimizable: boolean;\n  maximizable: boolean;\n  fileDropEnabled: boolean;\n}\n\n// ============================================\n// Default Configuration\n// ============================================\n\nconst defaultConfig: WindowConfig = {\n  title: \"App Factory\",\n  width: 1200,\n  height: 800,\n  minWidth: 800,\n  minHeight: 600,\n  maxWidth: null,\n  maxHeight: null,\n  x: null,\n  y: null,\n  center: true,\n  fullscreen: false,\n  resizable: true,\n  decorations: true,\n  alwaysOnTop: false,\n  skipTaskbar: false,\n  transparent: false,\n  visible: true,\n  focus: true,\n  closable: true,\n  minimizable: true,\n  maximizable: true,\n  fileDropEnabled: true,\n};\n\n// ============================================\n// Zustand Store\n// ============================================\n\n/**\n * Window configuration store with persistence.\n */\nexport const useWindowConfigStore = create<WindowConfigState>()(\n  persist(\n    (set, get) => ({\n      config: defaultConfig,\n      isDirty: false,\n\n      setConfig: (updates) =>\n        set((state) => ({\n          config: { ...state.config, ...updates },\n          isDirty: true,\n        })),\n\n      resetToDefaults: () =>\n        set({\n          config: defaultConfig,\n          isDirty: true,\n        }),\n\n      markClean: () => set({ isDirty: false }),\n\n      exportToTauriConfig: () => {\n        const { config } = get();\n        const tauriConfig: TauriWindowConfig = {\n          label: \"main\",\n          title: config.title,\n          width: config.width,\n          height: config.height,\n          center: config.center,\n          fullscreen: config.fullscreen,\n          resizable: config.resizable,\n          decorations: config.decorations,\n          alwaysOnTop: config.alwaysOnTop,\n          skipTaskbar: config.skipTaskbar,\n          transparent: config.transparent,\n          visible: config.visible,\n          focus: config.focus,\n          closable: config.closable,\n          minimizable: config.minimizable,\n          maximizable: config.maximizable,\n          fileDropEnabled: config.fileDropEnabled,\n        };\n\n        // Only include optional values if set\n        if (config.minWidth > 0) tauriConfig.minWidth = config.minWidth;\n        if (config.minHeight > 0) tauriConfig.minHeight = config.minHeight;\n        if (config.maxWidth !== null) tauriConfig.maxWidth = config.maxWidth;\n        if (config.maxHeight !== null) tauriConfig.maxHeight = config.maxHeight;\n        if (!config.center && config.x !== null) tauriConfig.x = config.x;\n        if (!config.center && config.y !== null) tauriConfig.y = config.y;\n\n        return tauriConfig;\n      },\n    }),\n    {\n      name: \"app-factory-window-config\",\n      storage: createJSONStorage(() => localStorage),\n      partialize: (state) => ({ config: state.config }),\n    }\n  )\n);\n\n// ============================================\n// Preset Configurations\n// ============================================\n\ninterface WindowPreset {\n  name: string;\n  description: string;\n  config: Partial<WindowConfig>;\n}\n\nconst windowPresets: WindowPreset[] = [\n  {\n    name: \"Default\",\n    description: \"Standard resizable window with decorations\",\n    config: {\n      width: 1200,\n      height: 800,\n      fullscreen: false,\n      resizable: true,\n      decorations: true,\n      alwaysOnTop: false,\n    },\n  },\n  {\n    name: \"Fullscreen\",\n    description: \"Full screen application\",\n    config: {\n      fullscreen: true,\n      decorations: false,\n      resizable: false,\n    },\n  },\n  {\n    name: \"Floating Widget\",\n    description: \"Small always-on-top widget\",\n    config: {\n      width: 320,\n      height: 480,\n      minWidth: 280,\n      minHeight: 400,\n      maxWidth: 400,\n      maxHeight: 600,\n      resizable: true,\n      decorations: true,\n      alwaysOnTop: true,\n      fullscreen: false,\n    },\n  },\n  {\n    name: \"Frameless\",\n    description: \"Borderless window without title bar\",\n    config: {\n      decorations: false,\n      resizable: true,\n      transparent: false,\n    },\n  },\n  {\n    name: \"Transparent Overlay\",\n    description: \"Transparent background for overlays\",\n    config: {\n      decorations: false,\n      transparent: true,\n      alwaysOnTop: true,\n      skipTaskbar: true,\n    },\n  },\n  {\n    name: \"Kiosk Mode\",\n    description: \"Locked fullscreen without controls\",\n    config: {\n      fullscreen: true,\n      decorations: false,\n      resizable: false,\n      closable: false,\n      minimizable: false,\n      maximizable: false,\n    },\n  },\n];\n\n// ============================================\n// Main Component\n// ============================================\n\n/**\n * Target for window config application.\n * - 'factory': Apply config to App Factory window itself\n * - 'canvas': Apply config to the app being designed in the canvas (saves to project)\n */\nexport type WindowConfigTarget = 'factory' | 'canvas';\n\nexport interface WindowConfigPanelProps {\n  /** Whether the panel is open */\n  isOpen?: boolean;\n  /** Callback when panel should close */\n  onClose?: () => void;\n  /** Callback when config is saved/exported */\n  onSave?: (config: TauriWindowConfig) => void;\n  /** Position of the panel */\n  position?: \"left\" | \"right\";\n  /** Width of the panel */\n  width?: string;\n  /** Initial target for window config application */\n  initialTarget?: WindowConfigTarget;\n  /** Callback when window config is applied to canvas app (main window) */\n  onApplyToCanvas?: (config: WindowConfig) => void;\n  /** Callback when window config is applied to a specific screen */\n  onApplyToScreen?: (screenId: string, config: WindowConfig) => void;\n  /** Available screens from loaded project (for per-screen config) */\n  screens?: Array<{ id: string; name: string; type: ScreenType; hasCustomConfig?: boolean }>;\n  /** Currently selected screen ID for per-screen config (null = main window) */\n  selectedScreenId?: string | null;\n  /** Callback when screen selection changes */\n  onScreenSelect?: (screenId: string | null) => void;\n  /** Initial config to load (from project or screen) */\n  initialConfig?: SerializedWindowConfig | null;\n}\n\n/**\n * WindowConfigPanel component.\n *\n * A comprehensive panel for configuring Tauri window settings including\n * size, position, behavior flags, and special modes. Can export configuration\n * in tauri.conf.json format.\n *\n * @example\n * ```tsx\n * const [isOpen, setIsOpen] = useState(false);\n *\n * <WindowConfigPanel\n *   isOpen={isOpen}\n *   onClose={() => setIsOpen(false)}\n *   onSave={(config) => console.log(\"Config:\", config)}\n * />\n * ```\n */\nexport const WindowConfigPanel: React.FC<WindowConfigPanelProps> = ({\n  isOpen = true,\n  onClose,\n  onSave,\n  position = \"right\",\n  width = \"380px\",\n  initialTarget = 'factory',\n  onApplyToCanvas,\n  onApplyToScreen,\n  screens = [],\n  selectedScreenId,\n  onScreenSelect,\n  initialConfig,\n}) => {\n  const {\n    config,\n    isDirty,\n    setConfig,\n    resetToDefaults,\n    markClean,\n    exportToTauriConfig,\n  } = useWindowConfigStore();\n\n  const [showExportModal, setShowExportModal] = useState(false);\n  const [configTarget, setConfigTarget] = useState<WindowConfigTarget>(initialTarget);\n  // Local state for screen selection (controlled by parent or internal)\n  const [localSelectedScreen, setLocalSelectedScreen] = useState<string | null>(selectedScreenId ?? null);\n\n  // Sync local screen selection with parent prop\n  useEffect(() => {\n    if (selectedScreenId !== undefined) {\n      setLocalSelectedScreen(selectedScreenId);\n    }\n  }, [selectedScreenId]);\n\n  // Load initial config when it changes (e.g., when switching screens)\n  useEffect(() => {\n    if (initialConfig && configTarget === 'canvas') {\n      setConfig(initialConfig as Partial<WindowConfig>);\n    }\n  }, [initialConfig, configTarget, setConfig]);\n\n  // Handle screen selection change\n  const handleScreenChange = useCallback((screenId: string | null) => {\n    setLocalSelectedScreen(screenId);\n    if (onScreenSelect) {\n      onScreenSelect(screenId);\n    }\n  }, [onScreenSelect]);\n\n  // Handle number input changes\n  const handleNumberChange = useCallback(\n    (key: keyof WindowConfig, value: string) => {\n      const numValue = parseInt(value, 10);\n      if (!isNaN(numValue)) {\n        setConfig({ [key]: numValue });\n      } else if (value === \"\") {\n        setConfig({ [key]: key.includes(\"max\") ? null : 0 });\n      }\n    },\n    [setConfig]\n  );\n\n  // Handle boolean toggle changes\n  const handleToggle = useCallback(\n    (key: keyof WindowConfig) => {\n      setConfig({ [key]: !config[key] });\n    },\n    [config, setConfig]\n  );\n\n  // Apply preset\n  const applyPreset = useCallback(\n    (preset: WindowPreset) => {\n      setConfig(preset.config);\n    },\n    [setConfig]\n  );\n\n  // Export configuration\n  const handleExport = useCallback(() => {\n    const tauriConfig = exportToTauriConfig();\n    if (onSave) {\n      onSave(tauriConfig);\n    }\n    markClean();\n    setShowExportModal(true);\n  }, [exportToTauriConfig, onSave, markClean]);\n\n  // Copy to clipboard\n  const copyToClipboard = useCallback(() => {\n    const tauriConfig = exportToTauriConfig();\n    const jsonString = JSON.stringify(tauriConfig, null, 2);\n    navigator.clipboard.writeText(jsonString);\n  }, [exportToTauriConfig]);\n\n  if (!isOpen) {\n    return null;\n  }\n\n  const positionClasses =\n    position === \"right\" ? \"right-0 border-l\" : \"left-0 border-r\";\n\n  return (\n    <div\n      className={[\n        \"fixed\",\n        \"top-0\",\n        \"bottom-0\",\n        \"z-40\",\n        \"bg-white\",\n        \"shadow-xl\",\n        \"flex\",\n        \"flex-col\",\n        \"border-neutral-200\",\n        positionClasses,\n      ].join(\" \")}\n      style={{ width }}\n      role=\"dialog\"\n      aria-label=\"Window Configuration Panel\"\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-4 py-3 border-b border-neutral-200 bg-neutral-50 shrink-0\">\n        <div className=\"flex items-center gap-2\">\n          <h2 className=\"text-lg font-semibold text-neutral-900\">\n            Window Config\n          </h2>\n          {isDirty && (\n            <span className=\"px-1.5 py-0.5 text-xs font-medium bg-warning-100 text-warning-700 rounded\">\n              Modified\n            </span>\n          )}\n        </div>\n        {onClose && (\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className=\"p-2 rounded-md hover:bg-neutral-200 transition-colors text-neutral-600\"\n            aria-label=\"Close panel\"\n          >\n            <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n              <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n            </svg>\n          </button>\n        )}\n      </div>\n\n      {/* Target Selector - Factory vs Canvas App */}\n      <div className=\"px-4 py-3 border-b border-neutral-200 bg-white\">\n        <div className=\"flex rounded-lg bg-neutral-100 p-1\">\n          <button\n            type=\"button\"\n            onClick={() => setConfigTarget('factory')}\n            className={[\n              \"flex-1 px-3 py-1.5 text-sm font-medium rounded-md transition-colors\",\n              configTarget === 'factory'\n                ? \"bg-white text-neutral-900 shadow-sm\"\n                : \"text-neutral-600 hover:text-neutral-900\"\n            ].join(\" \")}\n          >\n            App Factory\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setConfigTarget('canvas')}\n            className={[\n              \"flex-1 px-3 py-1.5 text-sm font-medium rounded-md transition-colors\",\n              configTarget === 'canvas'\n                ? \"bg-primary-500 text-white shadow-sm\"\n                : \"text-neutral-600 hover:text-neutral-900\"\n            ].join(\" \")}\n          >\n            Canvas App\n          </button>\n        </div>\n        <p className=\"text-xs text-neutral-500 mt-2 text-center\">\n          {configTarget === 'factory'\n            ? \"Changes apply to App Factory window\"\n            : \"Changes apply to the app in the canvas\"}\n        </p>\n      </div>\n\n      {/* Screen Selector - Only show when Canvas App mode is active */}\n      {configTarget === 'canvas' && (\n        <div className=\"px-4 py-3 border-b border-neutral-200 bg-neutral-50\">\n          <label className=\"block text-xs font-medium text-neutral-600 mb-2\">\n            Configure Window For:\n          </label>\n          <select\n            value={localSelectedScreen ?? 'main'}\n            onChange={(e) => handleScreenChange(e.target.value === 'main' ? null : e.target.value)}\n            className={[\n              \"w-full px-3 py-2 text-sm rounded-md border border-neutral-200\",\n              \"bg-white focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\",\n              \"transition-colors\"\n            ].join(\" \")}\n          >\n            <option value=\"main\">Main App Window</option>\n            {screens.map((screen) => (\n              <option key={screen.id} value={screen.id}>\n                {screen.name} ({screen.type})\n                {screen.hasCustomConfig ? ' Ôÿà' : ''}\n              </option>\n            ))}\n          </select>\n          {localSelectedScreen && screens.find(s => s.id === localSelectedScreen)?.hasCustomConfig && (\n            <p className=\"text-xs text-primary-600 mt-1.5 flex items-center gap-1\">\n              <span className=\"inline-block w-2 h-2 bg-primary-500 rounded-full\"></span>\n              Custom configuration set\n            </p>\n          )}\n          {screens.length === 0 && (\n            <p className=\"text-xs text-neutral-400 mt-1.5 italic\">\n              No additional screens in project\n            </p>\n          )}\n        </div>\n      )}\n\n      {/* Content */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {/* Presets */}\n        <Panel variant=\"filled\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Quick Presets\" />\n          <PanelBody className=\"pt-3\">\n            <div className=\"grid grid-cols-2 gap-2\">\n              {windowPresets.map((preset) => (\n                <button\n                  key={preset.name}\n                  type=\"button\"\n                  onClick={() => applyPreset(preset)}\n                  className={[\n                    \"p-2\",\n                    \"text-left\",\n                    \"rounded-md\",\n                    \"border\",\n                    \"border-neutral-200\",\n                    \"hover:border-primary-300\",\n                    \"hover:bg-primary-50\",\n                    \"transition-colors\",\n                  ].join(\" \")}\n                  title={preset.description}\n                >\n                  <span className=\"text-sm font-medium text-neutral-800 block\">\n                    {preset.name}\n                  </span>\n                  <span className=\"text-xs text-neutral-500 line-clamp-1\">\n                    {preset.description}\n                  </span>\n                </button>\n              ))}\n            </div>\n          </PanelBody>\n        </Panel>\n\n        {/* Window Title */}\n        <Panel variant=\"default\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Basic Settings\" />\n          <PanelBody className=\"pt-3 space-y-3\">\n            <Input\n              label=\"Window Title\"\n              value={config.title}\n              onChange={(e) => setConfig({ title: e.target.value })}\n              fullWidth\n            />\n          </PanelBody>\n        </Panel>\n\n        {/* Dimensions */}\n        <Panel variant=\"default\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Dimensions\" />\n          <PanelBody className=\"pt-3 space-y-3\">\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input\n                label=\"Width\"\n                type=\"number\"\n                value={config.width}\n                onChange={(e) => handleNumberChange(\"width\", e.target.value)}\n                rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n              />\n              <Input\n                label=\"Height\"\n                type=\"number\"\n                value={config.height}\n                onChange={(e) => handleNumberChange(\"height\", e.target.value)}\n                rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n              />\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input\n                label=\"Min Width\"\n                type=\"number\"\n                value={config.minWidth}\n                onChange={(e) => handleNumberChange(\"minWidth\", e.target.value)}\n                rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n              />\n              <Input\n                label=\"Min Height\"\n                type=\"number\"\n                value={config.minHeight}\n                onChange={(e) => handleNumberChange(\"minHeight\", e.target.value)}\n                rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n              />\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input\n                label=\"Max Width\"\n                type=\"number\"\n                value={config.maxWidth ?? \"\"}\n                onChange={(e) => handleNumberChange(\"maxWidth\", e.target.value)}\n                placeholder=\"None\"\n                rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n              />\n              <Input\n                label=\"Max Height\"\n                type=\"number\"\n                value={config.maxHeight ?? \"\"}\n                onChange={(e) => handleNumberChange(\"maxHeight\", e.target.value)}\n                placeholder=\"None\"\n                rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n              />\n            </div>\n          </PanelBody>\n        </Panel>\n\n        {/* Position */}\n        <Panel variant=\"default\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Position\" />\n          <PanelBody className=\"pt-3 space-y-3\">\n            <Checkbox\n              label=\"Center on screen\"\n              description=\"Ignore X/Y position and center window\"\n              checked={config.center}\n              onChange={() => handleToggle(\"center\")}\n            />\n            {!config.center && (\n              <div className=\"grid grid-cols-2 gap-3\">\n                <Input\n                  label=\"X Position\"\n                  type=\"number\"\n                  value={config.x ?? \"\"}\n                  onChange={(e) => handleNumberChange(\"x\", e.target.value)}\n                  placeholder=\"Auto\"\n                  rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n                />\n                <Input\n                  label=\"Y Position\"\n                  type=\"number\"\n                  value={config.y ?? \"\"}\n                  onChange={(e) => handleNumberChange(\"y\", e.target.value)}\n                  placeholder=\"Auto\"\n                  rightElement={<span className=\"text-xs text-neutral-400\">px</span>}\n                />\n              </div>\n            )}\n          </PanelBody>\n        </Panel>\n\n        {/* Window Behavior */}\n        <Panel variant=\"default\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Window Behavior\" />\n          <PanelBody className=\"pt-3 space-y-2\">\n            <Checkbox\n              label=\"Fullscreen\"\n              description=\"Launch in fullscreen mode\"\n              checked={config.fullscreen}\n              onChange={() => handleToggle(\"fullscreen\")}\n            />\n            <Checkbox\n              label=\"Resizable\"\n              description=\"Allow user to resize window\"\n              checked={config.resizable}\n              onChange={() => handleToggle(\"resizable\")}\n            />\n            <Checkbox\n              label=\"Decorations\"\n              description=\"Show title bar and window controls\"\n              checked={config.decorations}\n              onChange={() => handleToggle(\"decorations\")}\n            />\n            <Checkbox\n              label=\"Always on Top\"\n              description=\"Keep window above other windows\"\n              checked={config.alwaysOnTop}\n              onChange={() => handleToggle(\"alwaysOnTop\")}\n            />\n            <Checkbox\n              label=\"Skip Taskbar\"\n              description=\"Hide from taskbar/dock\"\n              checked={config.skipTaskbar}\n              onChange={() => handleToggle(\"skipTaskbar\")}\n            />\n            <Checkbox\n              label=\"Transparent\"\n              description=\"Enable transparent background\"\n              checked={config.transparent}\n              onChange={() => handleToggle(\"transparent\")}\n            />\n          </PanelBody>\n        </Panel>\n\n        {/* Window Controls */}\n        <Panel variant=\"default\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Window Controls\" />\n          <PanelBody className=\"pt-3 space-y-2\">\n            <Checkbox\n              label=\"Closable\"\n              description=\"Show close button\"\n              checked={config.closable}\n              onChange={() => handleToggle(\"closable\")}\n            />\n            <Checkbox\n              label=\"Minimizable\"\n              description=\"Show minimize button\"\n              checked={config.minimizable}\n              onChange={() => handleToggle(\"minimizable\")}\n            />\n            <Checkbox\n              label=\"Maximizable\"\n              description=\"Show maximize button\"\n              checked={config.maximizable}\n              onChange={() => handleToggle(\"maximizable\")}\n            />\n          </PanelBody>\n        </Panel>\n\n        {/* Other Settings */}\n        <Panel variant=\"default\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Other Settings\" />\n          <PanelBody className=\"pt-3 space-y-2\">\n            <Checkbox\n              label=\"Visible on launch\"\n              description=\"Show window immediately\"\n              checked={config.visible}\n              onChange={() => handleToggle(\"visible\")}\n            />\n            <Checkbox\n              label=\"Focus on launch\"\n              description=\"Give focus to window on start\"\n              checked={config.focus}\n              onChange={() => handleToggle(\"focus\")}\n            />\n            <Checkbox\n              label=\"File drop enabled\"\n              description=\"Accept drag-and-drop files\"\n              checked={config.fileDropEnabled}\n              onChange={() => handleToggle(\"fileDropEnabled\")}\n            />\n          </PanelBody>\n        </Panel>\n\n        {/* Preview */}\n        <Panel variant=\"filled\" padding=\"sm\" radius=\"md\">\n          <PanelHeader title=\"Configuration Preview\" />\n          <PanelBody className=\"pt-3\">\n            <pre className=\"text-xs font-mono bg-neutral-900 text-neutral-100 p-3 rounded-md overflow-x-auto max-h-48\">\n              {JSON.stringify(exportToTauriConfig(), null, 2)}\n            </pre>\n          </PanelBody>\n        </Panel>\n      </div>\n\n      {/* Footer */}\n      <div className=\"px-4 py-3 border-t border-neutral-200 bg-neutral-50 shrink-0\">\n        {configTarget === 'canvas' ? (\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={resetToDefaults}\n              className=\"flex-1\"\n            >\n              Reset\n            </Button>\n            <Button\n              variant=\"primary\"\n              size=\"sm\"\n              onClick={() => {\n                if (localSelectedScreen && onApplyToScreen) {\n                  // Apply to specific screen\n                  onApplyToScreen(localSelectedScreen, config);\n                } else if (onApplyToCanvas) {\n                  // Apply to main app window\n                  onApplyToCanvas(config);\n                }\n              }}\n              className=\"flex-1\"\n            >\n              {localSelectedScreen ? 'Apply to Screen' : 'Apply to Canvas'}\n            </Button>\n          </div>\n        ) : (\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={resetToDefaults}\n              className=\"flex-1\"\n            >\n              Reset\n            </Button>\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={copyToClipboard}\n              className=\"flex-1\"\n            >\n              Copy JSON\n            </Button>\n            <Button\n              variant=\"primary\"\n              size=\"sm\"\n              onClick={handleExport}\n              className=\"flex-1\"\n            >\n              Export\n            </Button>\n          </div>\n        )}\n      </div>\n\n      {/* Export Success Modal */}\n      {showExportModal && (\n        <div className=\"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"w-10 h-10 rounded-full bg-success-100 flex items-center justify-center\">\n                <svg\n                  className=\"h-6 w-6 text-success-600\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                >\n                  <polyline points=\"20 6 9 17 4 12\" />\n                </svg>\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-neutral-900\">\n                  Configuration Exported\n                </h3>\n                <p className=\"text-sm text-neutral-600\">\n                  Copy the JSON to your tauri.conf.json\n                </p>\n              </div>\n            </div>\n            <Button\n              variant=\"primary\"\n              size=\"sm\"\n              onClick={() => setShowExportModal(false)}\n              fullWidth\n            >\n              Done\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nWindowConfigPanel.displayName = \"WindowConfigPanel\";\n\nexport default WindowConfigPanel;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\wizard\\ContractSelector.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":187,"column":10,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":187,"endColumn":35},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":239,"column":10,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":239,"endColumn":36}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D051 - src/components/wizard/ContractSelector.tsx\n * ==================================================\n * Contract type selector for plugin creation wizard.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D050 (PluginWizard.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { forwardRef, type HTMLAttributes } from \"react\";\n\n/**\n * Contract type information.\n */\nexport interface ContractInfo {\n  /** Contract identifier */\n  id: string;\n  /** Display name */\n  name: string;\n  /** Contract description */\n  description: string;\n  /** Icon component or element */\n  icon?: React.ReactNode;\n  /** Whether contract is available */\n  available?: boolean;\n  /** Required methods */\n  requiredMethods?: string[];\n  /** Optional methods */\n  optionalMethods?: string[];\n  /** Example use cases */\n  examples?: string[];\n}\n\n/**\n * Default contract types based on contracts_registry.yaml.\n */\nexport const CONTRACT_TYPES: ContractInfo[] = [\n  {\n    id: \"tts\",\n    name: \"Text-to-Speech\",\n    description: \"Convert text into spoken audio. Implement voice synthesis with multiple voice options.\",\n    requiredMethods: [\"synthesize\", \"get_voices\"],\n    optionalMethods: [\"set_voice\", \"synthesize_stream\"],\n    examples: [\"Kokoro TTS\", \"Piper TTS\", \"XTTS\"],\n    available: true,\n  },\n  {\n    id: \"stt\",\n    name: \"Speech-to-Text\",\n    description: \"Transcribe audio into text. Implement real-time or batch transcription with language detection.\",\n    requiredMethods: [\"transcribe\", \"get_languages\"],\n    optionalMethods: [\"start_streaming\", \"stop_streaming\", \"push_audio_chunk\"],\n    examples: [\"Moonshine STT\", \"Whisper\", \"Vosk\"],\n    available: true,\n  },\n  {\n    id: \"llm\",\n    name: \"Large Language Model\",\n    description: \"Generate text completions from chat messages. Implement local or API-based language models.\",\n    requiredMethods: [\"complete\", \"get_models\"],\n    optionalMethods: [\"complete_stream\", \"embed\"],\n    examples: [\"Ollama\", \"LM Studio\", \"OpenAI API\"],\n    available: true,\n  },\n  {\n    id: \"mcp\",\n    name: \"MCP Bridge\",\n    description: \"Bridge to Model Context Protocol servers. Connect external tools and resources.\",\n    requiredMethods: [\"list_tools\", \"call_tool\", \"list_resources\"],\n    optionalMethods: [\"read_resource\"],\n    examples: [\"Filesystem MCP\", \"Database MCP\"],\n    available: true,\n  },\n  {\n    id: \"vision\",\n    name: \"Computer Vision\",\n    description: \"Analyze images and visual content. Implement object detection, image description, or generation.\",\n    requiredMethods: [\"analyze\"],\n    optionalMethods: [\"detect\", \"generate\"],\n    examples: [\"LLaVA\", \"CLIP\", \"BLIP\"],\n    available: true,\n  },\n  {\n    id: \"embedding\",\n    name: \"Text Embedding\",\n    description: \"Generate vector embeddings from text. Implement semantic search and similarity matching.\",\n    requiredMethods: [\"embed\", \"get_dimensions\"],\n    optionalMethods: [\"embed_batch\", \"similarity\"],\n    examples: [\"Sentence Transformers\", \"OpenAI Embeddings\"],\n    available: true,\n  },\n  {\n    id: \"debug\",\n    name: \"Debug Plugin\",\n    description: \"Development and debugging utilities. Use for testing the plugin system.\",\n    requiredMethods: [\"ping\", \"echo\"],\n    optionalMethods: [\"log\", \"inspect\", \"profile\"],\n    examples: [\"Debug Echo\", \"Performance Profiler\"],\n    available: true,\n  },\n];\n\n/**\n * ContractSelector component props.\n */\nexport interface ContractSelectorProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n  /** Currently selected contract ID */\n  value?: string;\n  /** Callback when selection changes */\n  onChange?: (contractId: string) => void;\n  /** Available contract types */\n  contracts?: ContractInfo[];\n  /** Whether to show detailed information */\n  showDetails?: boolean;\n  /** Layout variant */\n  layout?: \"grid\" | \"list\";\n  /** Grid columns for grid layout */\n  gridColumns?: 2 | 3;\n  /** Disabled contract IDs */\n  disabledContracts?: string[];\n}\n\n/**\n * Contract icon components.\n */\nconst ContractIcons: Record<string, React.FC<{ className?: string }>> = {\n  tts: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\" />\n      <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\n      <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n      <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n    </svg>\n  ),\n  stt: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n      <path d=\"M15.54 8.46a5 5 0 0 1 0 7.07\" />\n      <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14\" />\n    </svg>\n  ),\n  llm: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 2L2 7l10 5 10-5-10-5z\" />\n      <path d=\"M2 17l10 5 10-5\" />\n      <path d=\"M2 12l10 5 10-5\" />\n    </svg>\n  ),\n  mcp: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\" />\n      <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\" />\n      <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\" />\n    </svg>\n  ),\n  vision: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\n      <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    </svg>\n  ),\n  embedding: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\n      <path d=\"M8 12h8\" />\n      <path d=\"M12 8v8\" />\n    </svg>\n  ),\n  debug: ({ className }) => (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z\" />\n      <path d=\"m9 9 6 6\" />\n      <path d=\"m15 9-6 6\" />\n    </svg>\n  ),\n};\n\n/**\n * Get icon for contract type.\n */\nconst getContractIcon = (contractId: string): React.FC<{ className?: string }> => {\n  return ContractIcons[contractId] || ContractIcons.debug;\n};\n\n/**\n * Contract card colors.\n */\nconst contractColors: Record<string, { bg: string; border: string; text: string; iconBg: string }> = {\n  tts: {\n    bg: \"bg-primary-50\",\n    border: \"border-primary-200\",\n    text: \"text-primary-700\",\n    iconBg: \"bg-primary-100\",\n  },\n  stt: {\n    bg: \"bg-success-50\",\n    border: \"border-success-200\",\n    text: \"text-success-700\",\n    iconBg: \"bg-success-100\",\n  },\n  llm: {\n    bg: \"bg-warning-50\",\n    border: \"border-warning-200\",\n    text: \"text-warning-700\",\n    iconBg: \"bg-warning-100\",\n  },\n  mcp: {\n    bg: \"bg-info-50\",\n    border: \"border-info-200\",\n    text: \"text-info-700\",\n    iconBg: \"bg-info-100\",\n  },\n  vision: {\n    bg: \"bg-purple-50\",\n    border: \"border-purple-200\",\n    text: \"text-purple-700\",\n    iconBg: \"bg-purple-100\",\n  },\n  embedding: {\n    bg: \"bg-cyan-50\",\n    border: \"border-cyan-200\",\n    text: \"text-cyan-700\",\n    iconBg: \"bg-cyan-100\",\n  },\n  debug: {\n    bg: \"bg-neutral-50\",\n    border: \"border-neutral-200\",\n    text: \"text-neutral-700\",\n    iconBg: \"bg-neutral-100\",\n  },\n};\n\nconst getContractColors = (contractId: string) => {\n  return contractColors[contractId] || contractColors.debug;\n};\n\n/**\n * ContractSelector component.\n *\n * Displays available contract types as selectable cards. Users select\n * the contract type their plugin will implement.\n *\n * @example\n * ```tsx\n * <ContractSelector\n *   value={selectedContract}\n *   onChange={(id) => setSelectedContract(id)}\n *   showDetails\n * />\n * ```\n */\nexport const ContractSelector = forwardRef<HTMLDivElement, ContractSelectorProps>(\n  (\n    {\n      value,\n      onChange,\n      contracts = CONTRACT_TYPES,\n      showDetails = true,\n      layout = \"grid\",\n      gridColumns = 2,\n      disabledContracts = [],\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    // Grid column classes\n    const gridColClasses = {\n      2: \"grid-cols-1 sm:grid-cols-2\",\n      3: \"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3\",\n    };\n\n    // Container styles\n    const containerStyles = [\n      layout === \"grid\" && [\"grid\", \"gap-4\", gridColClasses[gridColumns]].join(\" \"),\n      layout === \"list\" && \"flex flex-col gap-3\",\n      className,\n    ].filter(Boolean).join(\" \");\n\n    // Handle selection\n    const handleSelect = (contractId: string) => {\n      if (!disabledContracts.includes(contractId)) {\n        onChange?.(contractId);\n      }\n    };\n\n    return (\n      <div ref={ref} className={containerStyles} {...props}>\n        {contracts.map((contract) => {\n          const isSelected = value === contract.id;\n          const isDisabled = disabledContracts.includes(contract.id) || !contract.available;\n          const colors = getContractColors(contract.id);\n          const Icon = getContractIcon(contract.id);\n\n          // Card styles\n          const cardStyles = [\n            \"group\",\n            \"relative\",\n            \"p-4\",\n            \"rounded-lg\",\n            \"border-2\",\n            \"cursor-pointer\",\n            \"transition-all\",\n            \"duration-150\",\n            isSelected && [\n              \"ring-2\",\n              \"ring-offset-2\",\n              \"ring-primary-500\",\n              colors.border,\n              colors.bg,\n            ].join(\" \"),\n            !isSelected && !isDisabled && [\n              \"border-neutral-200\",\n              \"bg-white\",\n              \"hover:border-neutral-300\",\n              \"hover:shadow-sm\",\n            ].join(\" \"),\n            isDisabled && [\n              \"border-neutral-100\",\n              \"bg-neutral-50\",\n              \"cursor-not-allowed\",\n              \"opacity-60\",\n            ].join(\" \"),\n          ].filter(Boolean).join(\" \");\n\n          return (\n            <div\n              key={contract.id}\n              className={cardStyles}\n              onClick={() => handleSelect(contract.id)}\n              role=\"button\"\n              tabIndex={isDisabled ? -1 : 0}\n              aria-pressed={isSelected}\n              aria-disabled={isDisabled}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\" || e.key === \" \") {\n                  e.preventDefault();\n                  handleSelect(contract.id);\n                }\n              }}\n            >\n              {/* Selection indicator */}\n              {isSelected && (\n                <div className=\"absolute top-3 right-3\">\n                  <div className=\"flex items-center justify-center w-5 h-5 bg-primary-500 rounded-full\">\n                    <svg\n                      className=\"w-3 h-3 text-white\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <polyline points=\"20 6 9 17 4 12\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                    </svg>\n                  </div>\n                </div>\n              )}\n\n              {/* Header with icon and name */}\n              <div className=\"flex items-start gap-3\">\n                {/* Icon */}\n                <div\n                  className={[\n                    \"flex\",\n                    \"items-center\",\n                    \"justify-center\",\n                    \"w-10\",\n                    \"h-10\",\n                    \"rounded-lg\",\n                    \"shrink-0\",\n                    isSelected ? colors.iconBg : \"bg-neutral-100\",\n                  ].join(\" \")}\n                >\n                  <Icon\n                    className={[\n                      \"w-5\",\n                      \"h-5\",\n                      isSelected ? colors.text : \"text-neutral-600\",\n                    ].join(\" \")}\n                  />\n                </div>\n\n                {/* Name and ID */}\n                <div className=\"flex-1 min-w-0\">\n                  <h3 className={[\n                    \"text-base\",\n                    \"font-semibold\",\n                    isSelected ? \"text-neutral-900\" : \"text-neutral-800\",\n                  ].join(\" \")}>\n                    {contract.name}\n                  </h3>\n                  <span className={[\n                    \"inline-flex\",\n                    \"items-center\",\n                    \"mt-1\",\n                    \"px-2\",\n                    \"py-0.5\",\n                    \"text-xs\",\n                    \"font-medium\",\n                    \"rounded\",\n                    isSelected ? [colors.bg, colors.text].join(\" \") : \"bg-neutral-100 text-neutral-600\",\n                  ].join(\" \")}>\n                    {contract.id.toUpperCase()}\n                  </span>\n                </div>\n              </div>\n\n              {/* Description */}\n              <p className=\"mt-3 text-sm text-neutral-600 line-clamp-2\">\n                {contract.description}\n              </p>\n\n              {/* Details section */}\n              {showDetails && (\n                <div className=\"mt-4 pt-3 border-t border-neutral-100\">\n                  {/* Required methods */}\n                  {contract.requiredMethods && contract.requiredMethods.length > 0 && (\n                    <div className=\"mb-2\">\n                      <span className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide\">\n                        Required:\n                      </span>\n                      <div className=\"mt-1 flex flex-wrap gap-1\">\n                        {contract.requiredMethods.map((method) => (\n                          <code\n                            key={method}\n                            className=\"px-1.5 py-0.5 text-xs bg-neutral-100 text-neutral-700 rounded font-mono\"\n                          >\n                            {method}()\n                          </code>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Examples */}\n                  {contract.examples && contract.examples.length > 0 && (\n                    <div>\n                      <span className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide\">\n                        Examples:\n                      </span>\n                      <p className=\"mt-1 text-xs text-neutral-500\">\n                        {contract.examples.join(\", \")}\n                      </p>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Unavailable indicator */}\n              {!contract.available && (\n                <div className=\"absolute inset-0 flex items-center justify-center bg-white/80 rounded-lg\">\n                  <span className=\"px-3 py-1 text-sm font-medium bg-neutral-200 text-neutral-600 rounded-full\">\n                    Coming Soon\n                  </span>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n);\n\nContractSelector.displayName = \"ContractSelector\";\n\n/**\n * Compact contract selector for smaller spaces.\n */\nexport interface ContractSelectorCompactProps {\n  value?: string;\n  onChange?: (contractId: string) => void;\n  contracts?: ContractInfo[];\n  className?: string;\n}\n\nexport const ContractSelectorCompact: React.FC<ContractSelectorCompactProps> = ({\n  value,\n  onChange,\n  contracts = CONTRACT_TYPES,\n  className = \"\",\n}) => {\n  return (\n    <div className={[\"flex\", \"flex-wrap\", \"gap-2\", className].filter(Boolean).join(\" \")}>\n      {contracts.filter(c => c.available).map((contract) => {\n        const isSelected = value === contract.id;\n        const colors = getContractColors(contract.id);\n        const Icon = getContractIcon(contract.id);\n\n        return (\n          <button\n            key={contract.id}\n            type=\"button\"\n            onClick={() => onChange?.(contract.id)}\n            className={[\n              \"inline-flex\",\n              \"items-center\",\n              \"gap-2\",\n              \"px-3\",\n              \"py-2\",\n              \"rounded-lg\",\n              \"border\",\n              \"text-sm\",\n              \"font-medium\",\n              \"transition-colors\",\n              \"duration-150\",\n              isSelected\n                ? [colors.bg, colors.border, colors.text].join(\" \")\n                : \"bg-white border-neutral-200 text-neutral-700 hover:border-neutral-300\",\n            ].join(\" \")}\n          >\n            <Icon className=\"w-4 h-4\" />\n            {contract.name}\n          </button>\n        );\n      })}\n    </div>\n  );\n};\n\nContractSelectorCompact.displayName = \"ContractSelectorCompact\";\n\nexport default ContractSelector;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\wizard\\DependencySelector.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":172,"column":21,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":172,"endColumn":26,"fix":{"range":[6010,6045],"text":"/^([a-zA-Z0-9_-]+)(.*)$/.exec(dep)"}},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":225,"column":14,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":225,"endColumn":42},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":246,"column":36,"nodeType":"Identifier","messageId":"invalidType","endLine":246,"endColumn":51},{"ruleId":"@typescript-eslint/no-deprecated","severity":2,"message":"`onKeyPress` is deprecated. Use `onKeyUp` or `onKeyDown` instead","line":349,"column":17,"nodeType":"JSXIdentifier","messageId":"deprecatedWithReason","endLine":349,"endColumn":27},{"ruleId":"@typescript-eslint/no-deprecated","severity":2,"message":"`onKeyPress` is deprecated. Use `onKeyUp` or `onKeyDown` instead","line":363,"column":17,"nodeType":"JSXIdentifier","messageId":"deprecatedWithReason","endLine":363,"endColumn":27}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D053 - src/components/wizard/DependencySelector.tsx\n * ====================================================\n * Dependency picker for plugin creation wizard.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D011 (Input.tsx), D050 (PluginWizard.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { forwardRef, useState, useCallback, useMemo, type HTMLAttributes } from \"react\";\n\n/**\n * Python package dependency.\n */\nexport interface PythonDependency {\n  /** Package name */\n  name: string;\n  /** Version constraint (optional) */\n  version?: string;\n  /** Whether package is optional */\n  optional?: boolean;\n  /** Package description */\n  description?: string;\n  /** Category for grouping */\n  category?: string;\n}\n\n/**\n * Common dependency presets by contract type.\n */\nexport const DEPENDENCY_PRESETS: Record<string, PythonDependency[]> = {\n  tts: [\n    { name: \"torch\", version: \">=2.0.0\", description: \"PyTorch for neural TTS\", category: \"ML\" },\n    { name: \"numpy\", description: \"Numerical computing\", category: \"Core\" },\n    { name: \"soundfile\", description: \"Audio file I/O\", category: \"Audio\" },\n    { name: \"scipy\", description: \"Scientific computing\", category: \"Core\" },\n    { name: \"librosa\", description: \"Audio analysis\", category: \"Audio\", optional: true },\n  ],\n  stt: [\n    { name: \"torch\", version: \">=2.0.0\", description: \"PyTorch for speech recognition\", category: \"ML\" },\n    { name: \"numpy\", description: \"Numerical computing\", category: \"Core\" },\n    { name: \"soundfile\", description: \"Audio file I/O\", category: \"Audio\" },\n    { name: \"torchaudio\", description: \"Audio processing with PyTorch\", category: \"Audio\" },\n  ],\n  llm: [\n    { name: \"httpx\", description: \"HTTP client for API calls\", category: \"Networking\" },\n    { name: \"pydantic\", version: \">=2.0\", description: \"Data validation\", category: \"Core\" },\n  ],\n  mcp: [\n    { name: \"httpx\", description: \"HTTP client\", category: \"Networking\" },\n    { name: \"websockets\", description: \"WebSocket client\", category: \"Networking\" },\n  ],\n  vision: [\n    { name: \"torch\", version: \">=2.0.0\", description: \"PyTorch for vision models\", category: \"ML\" },\n    { name: \"torchvision\", description: \"Vision utilities\", category: \"ML\" },\n    { name: \"pillow\", description: \"Image processing\", category: \"Image\" },\n    { name: \"numpy\", description: \"Numerical computing\", category: \"Core\" },\n  ],\n  embedding: [\n    { name: \"torch\", version: \">=2.0.0\", description: \"PyTorch for embeddings\", category: \"ML\" },\n    { name: \"transformers\", description: \"Hugging Face transformers\", category: \"ML\" },\n    { name: \"numpy\", description: \"Numerical computing\", category: \"Core\" },\n  ],\n  debug: [],\n};\n\n/**\n * Common packages that work across contracts.\n */\nexport const COMMON_PACKAGES: PythonDependency[] = [\n  { name: \"pydantic\", version: \">=2.0\", description: \"Data validation\", category: \"Core\" },\n  { name: \"httpx\", description: \"Modern HTTP client\", category: \"Networking\" },\n  { name: \"aiohttp\", description: \"Async HTTP client\", category: \"Networking\" },\n  { name: \"numpy\", description: \"Numerical computing\", category: \"Core\" },\n  { name: \"scipy\", description: \"Scientific computing\", category: \"Core\" },\n  { name: \"pillow\", description: \"Image processing\", category: \"Image\" },\n  { name: \"requests\", description: \"HTTP library\", category: \"Networking\" },\n  { name: \"python-dotenv\", description: \"Environment variables\", category: \"Config\" },\n  { name: \"pyyaml\", description: \"YAML parsing\", category: \"Config\" },\n  { name: \"rich\", description: \"Rich text formatting\", category: \"Debug\" },\n];\n\n/**\n * DependencySelector component props.\n */\nexport interface DependencySelectorProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n  /** Current dependencies list */\n  value: string[];\n  /** Callback when dependencies change */\n  onChange: (dependencies: string[]) => void;\n  /** Contract type for presets */\n  contract?: string;\n  /** Whether to show presets */\n  showPresets?: boolean;\n  /** Whether to show common packages */\n  showCommon?: boolean;\n  /** Maximum number of dependencies */\n  maxDependencies?: number;\n  /** Disabled state */\n  disabled?: boolean;\n}\n\n/**\n * Package icon.\n */\nconst PackageIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M16.5 9.4l-9-5.19\" />\n    <path d=\"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z\" />\n    <polyline points=\"3.27 6.96 12 12.01 20.73 6.96\" />\n    <line x1=\"12\" y1=\"22.08\" x2=\"12\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * Plus icon.\n */\nconst PlusIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" />\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n  </svg>\n);\n\n/**\n * X icon.\n */\nconst XIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n  </svg>\n);\n\n/**\n * Parse dependency string into name and version.\n */\nconst parseDependency = (dep: string): { name: string; version: string } => {\n  const match = dep.match(/^([a-zA-Z0-9_-]+)(.*)$/);\n  if (match) {\n    return { name: match[1], version: match[2] || \"\" };\n  }\n  return { name: dep, version: \"\" };\n};\n\n/**\n * Format dependency as string.\n */\nconst formatDependency = (name: string, version?: string): string => {\n  return version ? `${name}${version}` : name;\n};\n\n/**\n * DependencySelector component.\n *\n * Allows users to add/remove Python package dependencies for their plugin.\n * Includes presets based on contract type and common package suggestions.\n *\n * @example\n * ```tsx\n * <DependencySelector\n *   value={dependencies}\n *   onChange={setDependencies}\n *   contract=\"tts\"\n *   showPresets\n * />\n * ```\n */\nexport const DependencySelector = forwardRef<HTMLDivElement, DependencySelectorProps>(\n  (\n    {\n      value,\n      onChange,\n      contract,\n      showPresets = true,\n      showCommon = true,\n      maxDependencies = 50,\n      disabled = false,\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    // State for new dependency input\n    const [newDep, setNewDep] = useState(\"\");\n    const [newVersion, setNewVersion] = useState(\"\");\n    const [inputError, setInputError] = useState(\"\");\n\n    // Get preset dependencies for contract\n    const presetDeps = useMemo(() => {\n      if (!contract || !showPresets) return [];\n      return DEPENDENCY_PRESETS[contract] || [];\n    }, [contract, showPresets]);\n\n    // Parse current dependencies\n    const parsedDeps = useMemo(() => {\n      return value.map(parseDependency);\n    }, [value]);\n\n    // Check if a package is already added\n    const isAdded = useCallback(\n      (packageName: string): boolean => {\n        return parsedDeps.some((d) => d.name.toLowerCase() === packageName.toLowerCase());\n      },\n      [parsedDeps]\n    );\n\n    // Add a dependency\n    const addDependency = useCallback(\n      (name: string, version?: string) => {\n        if (disabled) return;\n        if (value.length >= maxDependencies) {\n          setInputError(`Maximum ${maxDependencies} dependencies allowed`);\n          return;\n        }\n        if (isAdded(name)) {\n          setInputError(`${name} is already added`);\n          return;\n        }\n\n        const dep = formatDependency(name, version);\n        onChange([...value, dep]);\n        setNewDep(\"\");\n        setNewVersion(\"\");\n        setInputError(\"\");\n      },\n      [disabled, value, maxDependencies, isAdded, onChange]\n    );\n\n    // Remove a dependency\n    const removeDependency = useCallback(\n      (index: number) => {\n        if (disabled) return;\n        const newDeps = [...value];\n        newDeps.splice(index, 1);\n        onChange(newDeps);\n      },\n      [disabled, value, onChange]\n    );\n\n    // Handle add from input\n    const handleAdd = useCallback(() => {\n      if (!newDep.trim()) {\n        setInputError(\"Package name is required\");\n        return;\n      }\n\n      // Validate package name\n      if (!/^[a-zA-Z0-9_-]+$/.test(newDep.trim())) {\n        setInputError(\"Invalid package name\");\n        return;\n      }\n\n      // Validate version if provided\n      if (newVersion && !/^(>=|<=|==|~=|>|<)?[\\d.]+[a-zA-Z0-9.-]*$/.test(newVersion.trim())) {\n        setInputError(\"Invalid version constraint\");\n        return;\n      }\n\n      addDependency(newDep.trim(), newVersion.trim() || undefined);\n    }, [newDep, newVersion, addDependency]);\n\n    // Handle key press\n    const handleKeyPress = useCallback(\n      (e: React.KeyboardEvent) => {\n        if (e.key === \"Enter\") {\n          e.preventDefault();\n          handleAdd();\n        }\n      },\n      [handleAdd]\n    );\n\n    // Container styles\n    const containerStyles = [\n      \"space-y-6\",\n      className,\n    ].filter(Boolean).join(\" \");\n\n    // Input styles\n    const inputStyles = [\n      \"block\",\n      \"w-full\",\n      \"px-3\",\n      \"py-2\",\n      \"text-sm\",\n      \"bg-white\",\n      \"border\",\n      \"border-neutral-300\",\n      \"rounded-md\",\n      \"placeholder:text-neutral-400\",\n      \"focus:outline-none\",\n      \"focus:ring-2\",\n      \"focus:ring-primary-500\",\n      \"focus:border-transparent\",\n      \"disabled:bg-neutral-50\",\n      \"disabled:text-neutral-500\",\n    ].join(\" \");\n\n    return (\n      <div ref={ref} className={containerStyles} {...props}>\n        {/* Add dependency section */}\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-neutral-700\">\n            Add Package\n          </label>\n          <div className=\"flex gap-2\">\n            <div className=\"flex-1\">\n              <input\n                type=\"text\"\n                value={newDep}\n                onChange={(e) => {\n                  setNewDep(e.target.value);\n                  setInputError(\"\");\n                }}\n                onKeyPress={handleKeyPress}\n                disabled={disabled}\n                placeholder=\"Package name (e.g., numpy)\"\n                className={inputStyles}\n              />\n            </div>\n            <div className=\"w-32\">\n              <input\n                type=\"text\"\n                value={newVersion}\n                onChange={(e) => {\n                  setNewVersion(e.target.value);\n                  setInputError(\"\");\n                }}\n                onKeyPress={handleKeyPress}\n                disabled={disabled}\n                placeholder=\">=1.0.0\"\n                className={inputStyles}\n              />\n            </div>\n            <button\n              type=\"button\"\n              onClick={handleAdd}\n              disabled={disabled || !newDep.trim()}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"justify-center\",\n                \"px-4\",\n                \"py-2\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-white\",\n                \"bg-primary-600\",\n                \"rounded-md\",\n                \"hover:bg-primary-700\",\n                \"disabled:opacity-50\",\n                \"disabled:cursor-not-allowed\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n          {inputError && (\n            <p className=\"text-sm text-error-600\">{inputError}</p>\n          )}\n        </div>\n\n        {/* Current dependencies */}\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <label className=\"block text-sm font-medium text-neutral-700\">\n              Dependencies ({value.length})\n            </label>\n            {value.length > 0 && (\n              <button\n                type=\"button\"\n                onClick={() => onChange([])}\n                disabled={disabled}\n                className=\"text-xs text-neutral-500 hover:text-neutral-700\"\n              >\n                Clear all\n              </button>\n            )}\n          </div>\n\n          {value.length === 0 ? (\n            <div className=\"flex items-center justify-center p-6 bg-neutral-50 rounded-lg border-2 border-dashed border-neutral-200\">\n              <div className=\"text-center\">\n                <PackageIcon className=\"mx-auto h-8 w-8 text-neutral-400\" />\n                <p className=\"mt-2 text-sm text-neutral-500\">\n                  No dependencies added yet\n                </p>\n                <p className=\"mt-1 text-xs text-neutral-400\">\n                  Add packages or select from presets below\n                </p>\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex flex-wrap gap-2\">\n              {parsedDeps.map((dep, index) => (\n                <div\n                  key={index}\n                  className={[\n                    \"inline-flex\",\n                    \"items-center\",\n                    \"gap-1.5\",\n                    \"px-3\",\n                    \"py-1.5\",\n                    \"bg-neutral-100\",\n                    \"text-neutral-800\",\n                    \"rounded-full\",\n                    \"text-sm\",\n                    \"font-medium\",\n                  ].join(\" \")}\n                >\n                  <PackageIcon className=\"h-3.5 w-3.5 text-neutral-500\" />\n                  <span className=\"font-mono\">{dep.name}</span>\n                  {dep.version && (\n                    <span className=\"text-neutral-500 font-mono text-xs\">\n                      {dep.version}\n                    </span>\n                  )}\n                  <button\n                    type=\"button\"\n                    onClick={() => removeDependency(index)}\n                    disabled={disabled}\n                    className={[\n                      \"ml-1\",\n                      \"p-0.5\",\n                      \"rounded-full\",\n                      \"text-neutral-400\",\n                      \"hover:text-neutral-600\",\n                      \"hover:bg-neutral-200\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                    ].join(\" \")}\n                  >\n                    <XIcon className=\"h-3.5 w-3.5\" />\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Preset dependencies */}\n        {showPresets && presetDeps.length > 0 && (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-neutral-700\">\n              Recommended for {contract?.toUpperCase()}\n            </label>\n            <div className=\"flex flex-wrap gap-2\">\n              {presetDeps.map((dep) => {\n                const added = isAdded(dep.name);\n                return (\n                  <button\n                    key={dep.name}\n                    type=\"button\"\n                    onClick={() => !added && addDependency(dep.name, dep.version)}\n                    disabled={disabled || added}\n                    title={dep.description}\n                    className={[\n                      \"inline-flex\",\n                      \"items-center\",\n                      \"gap-1.5\",\n                      \"px-3\",\n                      \"py-1.5\",\n                      \"rounded-full\",\n                      \"text-sm\",\n                      \"font-medium\",\n                      \"border\",\n                      \"transition-colors\",\n                      \"duration-150\",\n                      added\n                        ? \"bg-success-50 border-success-200 text-success-700 cursor-default\"\n                        : \"bg-white border-neutral-200 text-neutral-700 hover:border-primary-300 hover:bg-primary-50 cursor-pointer\",\n                      dep.optional && !added && \"border-dashed\",\n                    ].filter(Boolean).join(\" \")}\n                  >\n                    {added ? (\n                      <svg className=\"h-3.5 w-3.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <polyline points=\"20 6 9 17 4 12\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                      </svg>\n                    ) : (\n                      <PlusIcon className=\"h-3.5 w-3.5\" />\n                    )}\n                    <span className=\"font-mono\">{dep.name}</span>\n                    {dep.version && (\n                      <span className=\"text-xs opacity-60\">{dep.version}</span>\n                    )}\n                    {dep.optional && !added && (\n                      <span className=\"text-xs text-neutral-400\">(optional)</span>\n                    )}\n                  </button>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Common packages */}\n        {showCommon && (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-neutral-700\">\n              Common Packages\n            </label>\n            <div className=\"flex flex-wrap gap-2\">\n              {COMMON_PACKAGES.filter((dep) => !isAdded(dep.name)).slice(0, 10).map((dep) => (\n                <button\n                  key={dep.name}\n                  type=\"button\"\n                  onClick={() => addDependency(dep.name, dep.version)}\n                  disabled={disabled}\n                  title={dep.description}\n                  className={[\n                    \"inline-flex\",\n                    \"items-center\",\n                    \"gap-1.5\",\n                    \"px-2.5\",\n                    \"py-1\",\n                    \"rounded-md\",\n                    \"text-xs\",\n                    \"font-medium\",\n                    \"bg-white\",\n                    \"border\",\n                    \"border-neutral-200\",\n                    \"text-neutral-600\",\n                    \"hover:border-neutral-300\",\n                    \"hover:bg-neutral-50\",\n                    \"cursor-pointer\",\n                    \"transition-colors\",\n                    \"duration-150\",\n                  ].join(\" \")}\n                >\n                  <PlusIcon className=\"h-3 w-3\" />\n                  <span className=\"font-mono\">{dep.name}</span>\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Requirements.txt preview */}\n        {value.length > 0 && (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-neutral-700\">\n              requirements.txt Preview\n            </label>\n            <pre className=\"p-3 bg-neutral-900 text-neutral-100 rounded-lg text-sm font-mono overflow-x-auto\">\n              {value.join(\"\\n\")}\n            </pre>\n          </div>\n        )}\n      </div>\n    );\n  }\n);\n\nDependencySelector.displayName = \"DependencySelector\";\n\n/**\n * Compact dependency display.\n */\nexport interface DependencyListProps {\n  dependencies: string[];\n  className?: string;\n}\n\nexport const DependencyList: React.FC<DependencyListProps> = ({\n  dependencies,\n  className = \"\",\n}) => {\n  if (dependencies.length === 0) {\n    return (\n      <span className=\"text-sm text-neutral-500 italic\">No dependencies</span>\n    );\n  }\n\n  return (\n    <div className={[\"flex flex-wrap gap-1\", className].filter(Boolean).join(\" \")}>\n      {dependencies.map((dep, index) => {\n        const { name, version } = parseDependency(dep);\n        return (\n          <span\n            key={index}\n            className=\"inline-flex items-center px-2 py-0.5 bg-neutral-100 text-neutral-700 rounded text-xs font-mono\"\n          >\n            {name}\n            {version && <span className=\"text-neutral-500 ml-0.5\">{version}</span>}\n          </span>\n        );\n      })}\n    </div>\n  );\n};\n\nDependencyList.displayName = \"DependencyList\";\n\nexport default DependencySelector;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\wizard\\ImportWizard.tsx","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"string | undefined\" of template literal expression.","line":179,"column":19,"nodeType":"Identifier","messageId":"invalidType","endLine":179,"endColumn":28},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":295,"column":31,"nodeType":"MemberExpression","messageId":"invalidType","endLine":295,"endColumn":46},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":298,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":298,"endColumn":39},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":302,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":302,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .name on an `any` value.","line":302,"column":18,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":302,"endColumn":22},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":302,"column":23,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":302,"endColumn":25,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[7999,8001],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":303,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":303,"endColumn":72},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .displayName on an `any` value.","line":303,"column":25,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":303,"endColumn":36},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":303,"column":37,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":303,"endColumn":39,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8032,8061],"text":"(data.displayName ?? data.name)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .name on an `any` value.","line":303,"column":45,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":303,"endColumn":49},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":303,"column":50,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":303,"endColumn":52,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8062,8064],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":304,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":304,"endColumn":39},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .version on an `any` value.","line":304,"column":21,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":304,"endColumn":28},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":304,"column":29,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":304,"endColumn":31,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8114,8116],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":305,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":305,"endColumn":65},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .description on an `any` value.","line":305,"column":25,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":305,"endColumn":36},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":305,"column":37,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":305,"endColumn":39,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8162,8164],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":306,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":306,"endColumn":60},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .author on an `any` value.","line":306,"column":20,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":306,"endColumn":26},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":306,"column":33,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":306,"endColumn":35,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8206,8238],"text":"(data.author?.name ?? data.author)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .author on an `any` value.","line":306,"column":41,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":306,"endColumn":47},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":306,"column":48,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":306,"endColumn":50,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8239,8241],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":307,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":307,"endColumn":41},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .license on an `any` value.","line":307,"column":21,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":307,"endColumn":28},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":307,"column":29,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":307,"endColumn":31,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8281,8283],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":308,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":308,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .type on an `any` value.","line":308,"column":18,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":308,"endColumn":22},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":308,"column":23,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":308,"endColumn":25,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8317,8319],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":309,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":309,"endColumn":65},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .repository on an `any` value.","line":309,"column":24,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":309,"endColumn":34},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":309,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":309,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8351,8390],"text":"(data.repository?.url ?? data.repository)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .repository on an `any` value.","line":309,"column":48,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":309,"endColumn":58},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":309,"column":59,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":309,"endColumn":61,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8391,8393],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":310,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":310,"endColumn":30},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .homepage on an `any` value.","line":310,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":310,"endColumn":30},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .dependencies on an `any` value.","line":311,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":311,"endColumn":38},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `{}`.","line":311,"column":53,"nodeType":"MemberExpression","messageId":"unsafeArgument","endLine":311,"endColumn":70},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .dependencies on an `any` value.","line":311,"column":58,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":311,"endColumn":70},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":312,"column":7,"nodeType":"Property","messageId":"anyAssignment","endLine":312,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .keywords on an `any` value.","line":312,"column":18,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":312,"endColumn":26},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":312,"column":27,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":312,"endColumn":29,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8519,8545],"text":"(data.keywords ?? data.tags)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .tags on an `any` value.","line":312,"column":35,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":312,"endColumn":39},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":312,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":312,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8546,8548],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":401,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":401,"endColumn":54,"suggestions":[{"messageId":"addBrackets","fix":{"range":[10780,11506],"text":"{ if (!sourceUrl.trim()) {\n          setError(\"Please enter a URL\");\n          return;\n        }\n        const urlValidation = validateUrl(sourceUrl);\n        if (!urlValidation.isValid) {\n          setError(urlValidation.errors[0]);\n          return;\n        }\n        setCurrentStep(\"fetch\");\n        // Auto-start fetch\n        setIsLoading(true);\n        try {\n          const fetchedManifest = await fetchManifest(sourceUrl);\n          setManifest(fetchedManifest);\n          setCurrentStep(\"preview\");\n        } catch (err) {\n          setError(\"Failed to fetch manifest. Please check the URL and try again.\");\n          setCurrentStep(\"source\");\n        } finally {\n          setIsLoading(false);\n        }\n        break; }"},"desc":"Add {} brackets around the case block."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":413,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":413,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":430,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":430,"endColumn":21},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":736,"column":25,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":736,"endColumn":37}],"suppressedMessages":[],"errorCount":47,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * UJ-1.1.4 - src/components/wizard/ImportWizard.tsx\n * ==================================================\n * Multi-step wizard for importing third-party components/plugins from external URLs.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D011 (Input.tsx), D015 (Modal.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo } from \"react\";\nimport { Button } from \"../ui/Button\";\nimport { Input } from \"../ui/Input\";\nimport { Modal } from \"../ui/Modal\";\nimport { Panel } from \"../ui/Panel\";\n\n/**\n * Import source type.\n */\nexport type ImportSourceType = \"github\" | \"url\" | \"local\";\n\n/**\n * Component manifest from external source.\n */\nexport interface ComponentManifest {\n  /** Component name */\n  name: string;\n  /** Display name */\n  displayName: string;\n  /** Version */\n  version: string;\n  /** Description */\n  description: string;\n  /** Author */\n  author: string;\n  /** License */\n  license: string;\n  /** Component type */\n  type: \"plugin\" | \"component\" | \"template\";\n  /** Contract type (for plugins) */\n  contract?: string;\n  /** Repository URL */\n  repository?: string;\n  /** Homepage URL */\n  homepage?: string;\n  /** Dependencies */\n  dependencies?: string[];\n  /** Tags */\n  tags?: string[];\n}\n\n/**\n * Import wizard step.\n */\nexport type ImportWizardStep = \"source\" | \"fetch\" | \"preview\" | \"install\";\n\n/**\n * Import wizard props.\n */\nexport interface ImportWizardProps {\n  /** Whether the wizard modal is open */\n  isOpen: boolean;\n  /** Callback to close the wizard */\n  onClose: () => void;\n  /** Callback when import is complete */\n  onImport?: (manifest: ComponentManifest, sourceUrl: string) => Promise<void>;\n  /** Custom className */\n  className?: string;\n}\n\n/**\n * Import validation result.\n */\ninterface ValidationResult {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n}\n\n/**\n * GitHub icon.\n */\nconst GitHubIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"currentColor\"\n  >\n    <path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\" />\n  </svg>\n);\n\n/**\n * Link icon.\n */\nconst LinkIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\" />\n    <path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\" />\n  </svg>\n);\n\n/**\n * Folder icon.\n */\nconst FolderIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Alert icon.\n */\nconst AlertIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" />\n    <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\" />\n  </svg>\n);\n\n/**\n * Loader icon.\n */\nconst LoaderIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={`${className} animate-spin`}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n  >\n    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" />\n    <path\n      className=\"opacity-75\"\n      d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n);\n\n/**\n * Source type selector card.\n */\nconst SourceTypeCard: React.FC<{\n  type: ImportSourceType;\n  title: string;\n  description: string;\n  icon: React.ReactNode;\n  selected: boolean;\n  onClick: () => void;\n}> = ({ type: _type, title, description, icon, selected, onClick }) => (\n  <button\n    type=\"button\"\n    onClick={onClick}\n    className={[\n      \"p-4\",\n      \"rounded-lg\",\n      \"border-2\",\n      \"text-left\",\n      \"transition-all\",\n      \"duration-200\",\n      \"w-full\",\n      selected\n        ? \"border-primary-500 bg-primary-50\"\n        : \"border-neutral-200 hover:border-primary-300 bg-white\",\n    ].join(\" \")}\n  >\n    <div className=\"flex items-center gap-3\">\n      <div\n        className={[\n          \"h-10 w-10 rounded-lg flex items-center justify-center\",\n          selected ? \"bg-primary-500 text-white\" : \"bg-neutral-100 text-neutral-600\",\n        ].join(\" \")}\n      >\n        {icon}\n      </div>\n      <div>\n        <h4 className=\"font-medium text-neutral-900\">{title}</h4>\n        <p className=\"text-sm text-neutral-500\">{description}</p>\n      </div>\n    </div>\n  </button>\n);\n\n/**\n * Validate URL format.\n */\nconst validateUrl = (url: string): ValidationResult => {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!url.trim()) {\n    errors.push(\"URL is required\");\n    return { isValid: false, errors, warnings };\n  }\n\n  try {\n    const parsed = new URL(url);\n    if (![\"http:\", \"https:\"].includes(parsed.protocol)) {\n      errors.push(\"URL must use http or https protocol\");\n    }\n  } catch {\n    errors.push(\"Invalid URL format\");\n  }\n\n  // GitHub-specific validation\n  if (url.includes(\"github.com\")) {\n    if (!url.includes(\"/blob/\") && !url.includes(\"/raw/\") && !url.endsWith(\".json\")) {\n      warnings.push(\"For GitHub URLs, ensure you're linking to a raw file or manifest.json\");\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n};\n\n/**\n * Fetch manifest from URL - transforms GitHub URLs and handles errors.\n */\nconst fetchManifest = async (url: string): Promise<ComponentManifest> => {\n  // Transform GitHub blob URLs to raw URLs\n  let fetchUrl = url;\n  if (url.includes('github.com') && url.includes('/blob/')) {\n    fetchUrl = url\n      .replace('github.com', 'raw.githubusercontent.com')\n      .replace('/blob/', '/');\n  }\n\n  try {\n    const response = await fetch(fetchUrl, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n\n    const data = await response.json();\n\n    // Validate required fields and normalize to ComponentManifest\n    return {\n      name: data.name || 'unknown',\n      displayName: data.displayName || data.name || 'Unknown Component',\n      version: data.version || '0.0.0',\n      description: data.description || 'No description provided',\n      author: data.author?.name || data.author || 'Unknown',\n      license: data.license || 'Unknown',\n      type: data.type || 'component',\n      repository: data.repository?.url || data.repository || url,\n      homepage: data.homepage,\n      dependencies: data.dependencies ? Object.keys(data.dependencies) : [],\n      tags: data.keywords || data.tags || [],\n    };\n  } catch (error) {\n    if (error instanceof SyntaxError) {\n      throw new Error('Invalid JSON: The URL did not return valid JSON data');\n    }\n    throw error;\n  }\n};\n\n/**\n * ImportWizard component.\n *\n * A multi-step wizard for importing third-party components/plugins from\n * GitHub repositories or direct URLs.\n *\n * @example\n * ```tsx\n * <ImportWizard\n *   isOpen={showImportWizard}\n *   onClose={() => setShowImportWizard(false)}\n *   onImport={async (manifest, url) => {\n *     await installComponent(manifest, url);\n *   }}\n * />\n * ```\n */\nexport const ImportWizard: React.FC<ImportWizardProps> = ({\n  isOpen,\n  onClose,\n  onImport,\n  className = \"\",\n}) => {\n  // Wizard state\n  const [currentStep, setCurrentStep] = useState<ImportWizardStep>(\"source\");\n  const [sourceType, setSourceType] = useState<ImportSourceType>(\"github\");\n  const [sourceUrl, setSourceUrl] = useState(\"\");\n  const [manifest, setManifest] = useState<ComponentManifest | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [validation, setValidation] = useState<ValidationResult | null>(null);\n\n  // Step info\n  const steps: { id: ImportWizardStep; title: string }[] = [\n    { id: \"source\", title: \"Source\" },\n    { id: \"fetch\", title: \"Fetch\" },\n    { id: \"preview\", title: \"Preview\" },\n    { id: \"install\", title: \"Install\" },\n  ];\n\n  const currentStepIndex = steps.findIndex((s) => s.id === currentStep);\n\n  // URL validation\n  const handleUrlChange = useCallback((value: string) => {\n    setSourceUrl(value);\n    if (value.trim()) {\n      setValidation(validateUrl(value));\n    } else {\n      setValidation(null);\n    }\n  }, []);\n\n  // Reset wizard\n  const resetWizard = useCallback(() => {\n    setCurrentStep(\"source\");\n    setSourceType(\"github\");\n    setSourceUrl(\"\");\n    setManifest(null);\n    setError(null);\n    setValidation(null);\n    setIsLoading(false);\n  }, []);\n\n  // Handle close\n  const handleClose = useCallback(() => {\n    resetWizard();\n    onClose();\n  }, [onClose, resetWizard]);\n\n  // Navigate to next step\n  const handleNext = useCallback(async () => {\n    setError(null);\n\n    switch (currentStep) {\n      case \"source\":\n        if (!sourceUrl.trim()) {\n          setError(\"Please enter a URL\");\n          return;\n        }\n        const urlValidation = validateUrl(sourceUrl);\n        if (!urlValidation.isValid) {\n          setError(urlValidation.errors[0]);\n          return;\n        }\n        setCurrentStep(\"fetch\");\n        // Auto-start fetch\n        setIsLoading(true);\n        try {\n          const fetchedManifest = await fetchManifest(sourceUrl);\n          setManifest(fetchedManifest);\n          setCurrentStep(\"preview\");\n        } catch (err) {\n          setError(\"Failed to fetch manifest. Please check the URL and try again.\");\n          setCurrentStep(\"source\");\n        } finally {\n          setIsLoading(false);\n        }\n        break;\n\n      case \"preview\":\n        setCurrentStep(\"install\");\n        setIsLoading(true);\n        try {\n          if (manifest && onImport) {\n            await onImport(manifest, sourceUrl);\n          }\n          // Success - close wizard\n          handleClose();\n        } catch (err) {\n          setError(\"Failed to install component. Please try again.\");\n        } finally {\n          setIsLoading(false);\n        }\n        break;\n    }\n  }, [currentStep, sourceUrl, manifest, onImport, handleClose]);\n\n  // Handle back\n  const handleBack = useCallback(() => {\n    switch (currentStep) {\n      case \"fetch\":\n      case \"preview\":\n        setCurrentStep(\"source\");\n        break;\n      case \"install\":\n        setCurrentStep(\"preview\");\n        break;\n    }\n  }, [currentStep]);\n\n  // Step content\n  const renderStepContent = useMemo(() => {\n    switch (currentStep) {\n      case \"source\":\n        return (\n          <div className=\"space-y-6\">\n            {/* Source type selection */}\n            <div className=\"space-y-3\">\n              <label className=\"block text-sm font-medium text-neutral-700\">\n                Import Source\n              </label>\n              <div className=\"grid grid-cols-3 gap-3\">\n                <SourceTypeCard\n                  type=\"github\"\n                  title=\"GitHub\"\n                  description=\"Import from repository\"\n                  icon={<GitHubIcon className=\"h-5 w-5\" />}\n                  selected={sourceType === \"github\"}\n                  onClick={() => setSourceType(\"github\")}\n                />\n                <SourceTypeCard\n                  type=\"url\"\n                  title=\"Direct URL\"\n                  description=\"Raw JSON manifest\"\n                  icon={<LinkIcon className=\"h-5 w-5\" />}\n                  selected={sourceType === \"url\"}\n                  onClick={() => setSourceType(\"url\")}\n                />\n                <SourceTypeCard\n                  type=\"local\"\n                  title=\"Local File\"\n                  description=\"Browse local files\"\n                  icon={<FolderIcon className=\"h-5 w-5\" />}\n                  selected={sourceType === \"local\"}\n                  onClick={() => setSourceType(\"local\")}\n                />\n              </div>\n            </div>\n\n            {/* URL input */}\n            <div className=\"space-y-2\">\n              <Input\n                label={\n                  sourceType === \"github\"\n                    ? \"GitHub URL\"\n                    : sourceType === \"url\"\n                      ? \"Manifest URL\"\n                      : \"Local Path\"\n                }\n                value={sourceUrl}\n                onChange={(e) => handleUrlChange(e.target.value)}\n                placeholder={\n                  sourceType === \"github\"\n                    ? \"https://github.com/user/repo/blob/main/manifest.json\"\n                    : sourceType === \"url\"\n                      ? \"https://example.com/component/manifest.json\"\n                      : \"C:/path/to/manifest.json\"\n                }\n                fullWidth\n                helperText={\n                  sourceType === \"github\"\n                    ? \"Paste the URL to a GitHub repository or manifest.json file\"\n                    : sourceType === \"url\"\n                      ? \"Direct link to a component manifest JSON file\"\n                      : \"Select a local manifest.json file\"\n                }\n              />\n\n              {/* Validation feedback */}\n              {validation && (\n                <div className=\"space-y-1\">\n                  {validation.errors.map((err, i) => (\n                    <div key={i} className=\"flex items-center gap-2 text-sm text-error-600\">\n                      <AlertIcon className=\"h-4 w-4\" />\n                      {err}\n                    </div>\n                  ))}\n                  {validation.warnings.map((warn, i) => (\n                    <div key={i} className=\"flex items-center gap-2 text-sm text-warning-600\">\n                      <AlertIcon className=\"h-4 w-4\" />\n                      {warn}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        );\n\n      case \"fetch\":\n        return (\n          <div className=\"flex flex-col items-center justify-center py-12\">\n            <LoaderIcon className=\"h-12 w-12 text-primary-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-neutral-900\">Fetching Manifest</h3>\n            <p className=\"text-sm text-neutral-500 mt-1\">\n              Retrieving component information from source...\n            </p>\n          </div>\n        );\n\n      case \"preview\":\n        return (\n          <div className=\"space-y-6\">\n            {manifest && (\n              <>\n                {/* Component header */}\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"h-16 w-16 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600\">\n                    <FolderIcon className=\"h-8 w-8\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-neutral-900\">\n                      {manifest.displayName}\n                    </h3>\n                    <p className=\"text-sm text-neutral-500\">\n                      {manifest.name} ÔÇó v{manifest.version}\n                    </p>\n                    <p className=\"text-sm text-neutral-600 mt-2\">{manifest.description}</p>\n                  </div>\n                </div>\n\n                {/* Metadata panel */}\n                <Panel variant=\"default\" padding=\"md\" radius=\"lg\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <dt className=\"text-xs font-medium text-neutral-500 uppercase\">Author</dt>\n                      <dd className=\"text-sm text-neutral-900\">{manifest.author}</dd>\n                    </div>\n                    <div>\n                      <dt className=\"text-xs font-medium text-neutral-500 uppercase\">License</dt>\n                      <dd className=\"text-sm text-neutral-900\">{manifest.license}</dd>\n                    </div>\n                    <div>\n                      <dt className=\"text-xs font-medium text-neutral-500 uppercase\">Type</dt>\n                      <dd className=\"text-sm text-neutral-900 capitalize\">{manifest.type}</dd>\n                    </div>\n                    {manifest.contract && (\n                      <div>\n                        <dt className=\"text-xs font-medium text-neutral-500 uppercase\">Contract</dt>\n                        <dd className=\"text-sm text-neutral-900\">{manifest.contract}</dd>\n                      </div>\n                    )}\n                  </div>\n                </Panel>\n\n                {/* Tags */}\n                {manifest.tags && manifest.tags.length > 0 && (\n                  <div className=\"flex flex-wrap gap-2\">\n                    {manifest.tags.map((tag) => (\n                      <span\n                        key={tag}\n                        className=\"px-2 py-1 bg-neutral-100 text-neutral-600 text-xs rounded-full\"\n                      >\n                        {tag}\n                      </span>\n                    ))}\n                  </div>\n                )}\n\n                {/* Dependencies warning */}\n                {manifest.dependencies && manifest.dependencies.length > 0 && (\n                  <div className=\"p-3 bg-warning-50 border border-warning-200 rounded-lg\">\n                    <div className=\"flex items-start gap-2\">\n                      <AlertIcon className=\"h-5 w-5 text-warning-600 shrink-0 mt-0.5\" />\n                      <div>\n                        <h4 className=\"text-sm font-medium text-warning-800\">\n                          Dependencies Required\n                        </h4>\n                        <p className=\"text-sm text-warning-700 mt-1\">\n                          This component requires additional dependencies:{\" \"}\n                          {manifest.dependencies.join(\", \")}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n        );\n\n      case \"install\":\n        return (\n          <div className=\"flex flex-col items-center justify-center py-12\">\n            <LoaderIcon className=\"h-12 w-12 text-primary-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-neutral-900\">Installing Component</h3>\n            <p className=\"text-sm text-neutral-500 mt-1\">\n              Adding component to your project...\n            </p>\n          </div>\n        );\n    }\n  }, [currentStep, sourceType, sourceUrl, manifest, validation, handleUrlChange]);\n\n  // Can proceed to next step\n  const canProceed = useMemo(() => {\n    switch (currentStep) {\n      case \"source\":\n        return sourceUrl.trim().length > 0 && (!validation || validation.isValid);\n      case \"preview\":\n        return manifest !== null;\n      default:\n        return false;\n    }\n  }, [currentStep, sourceUrl, validation, manifest]);\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={handleClose}\n      title=\"Import Component\"\n      size=\"lg\"\n      className={className}\n    >\n      <div className=\"space-y-6\">\n        {/* Step indicators */}\n        <div className=\"flex items-center justify-between px-4\">\n          {steps.map((step, index) => (\n            <React.Fragment key={step.id}>\n              <div className=\"flex items-center gap-2\">\n                <div\n                  className={[\n                    \"h-8 w-8 rounded-full flex items-center justify-center text-sm font-medium\",\n                    index < currentStepIndex\n                      ? \"bg-success-500 text-white\"\n                      : index === currentStepIndex\n                        ? \"bg-primary-500 text-white\"\n                        : \"bg-neutral-200 text-neutral-500\",\n                  ].join(\" \")}\n                >\n                  {index < currentStepIndex ? (\n                    <CheckIcon className=\"h-4 w-4\" />\n                  ) : (\n                    index + 1\n                  )}\n                </div>\n                <span\n                  className={[\n                    \"text-sm font-medium\",\n                    index === currentStepIndex ? \"text-primary-700\" : \"text-neutral-500\",\n                  ].join(\" \")}\n                >\n                  {step.title}\n                </span>\n              </div>\n              {index < steps.length - 1 && (\n                <div\n                  className={[\n                    \"flex-1 h-0.5 mx-2\",\n                    index < currentStepIndex ? \"bg-success-500\" : \"bg-neutral-200\",\n                  ].join(\" \")}\n                />\n              )}\n            </React.Fragment>\n          ))}\n        </div>\n\n        {/* Error message */}\n        {error && (\n          <div className=\"p-3 bg-error-50 border border-error-200 rounded-lg\">\n            <div className=\"flex items-center gap-2 text-error-700\">\n              <AlertIcon className=\"h-5 w-5\" />\n              <p className=\"text-sm\">{error}</p>\n            </div>\n          </div>\n        )}\n\n        {/* Step content */}\n        <div className=\"min-h-64\">{renderStepContent}</div>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-between pt-4 border-t border-neutral-200\">\n          <Button variant=\"ghost\" onClick={handleClose}>\n            Cancel\n          </Button>\n          <div className=\"flex items-center gap-2\">\n            {currentStepIndex > 0 && currentStep !== \"fetch\" && currentStep !== \"install\" && (\n              <Button variant=\"secondary\" onClick={handleBack}>\n                Back\n              </Button>\n            )}\n            {(currentStep === \"source\" || currentStep === \"preview\") && (\n              <Button\n                variant=\"primary\"\n                onClick={handleNext}\n                disabled={!canProceed || isLoading}\n                loading={isLoading}\n              >\n                {currentStep === \"preview\" ? \"Install\" : \"Continue\"}\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nImportWizard.displayName = \"ImportWizard\";\n\nexport default ImportWizard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\wizard\\ManifestEditor.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":316,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":316,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[8027,8029],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":571,"column":12,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":571,"endColumn":43,"fix":{"range":[17013,17044],"text":"(keyof PluginManifestData)[]"}},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":590,"column":38,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":590,"endColumn":40,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[17583,17585],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":603,"column":34,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":603,"endColumn":36,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[18002,18004],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":615,"column":38,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":615,"endColumn":40,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[18408,18410],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D052 - src/components/wizard/ManifestEditor.tsx\n * ================================================\n * Manifest editor form for plugin creation wizard.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D011 (Input.tsx),\n *               D012 (Select.tsx), D050 (PluginWizard.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { forwardRef, useCallback, useMemo, type HTMLAttributes } from \"react\";\nimport type { PluginManifestData } from \"./PluginWizard\";\n\n/**\n * ManifestEditor component props.\n */\nexport interface ManifestEditorProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n  /** Current manifest data */\n  value: PluginManifestData;\n  /** Callback when data changes */\n  onChange: (data: Partial<PluginManifestData>) => void;\n  /** Contract type (used for name prefix) */\n  contract?: string;\n  /** Validation errors */\n  errors?: Record<string, string>;\n  /** Whether form is disabled */\n  disabled?: boolean;\n  /** Whether to show advanced options */\n  showAdvanced?: boolean;\n  /** Custom section to render after basic info */\n  additionalContent?: React.ReactNode;\n}\n\n/**\n * License options.\n */\nconst LICENSE_OPTIONS = [\n  { value: \"MIT\", label: \"MIT License\" },\n  { value: \"Apache-2.0\", label: \"Apache 2.0\" },\n  { value: \"GPL-3.0\", label: \"GPL 3.0\" },\n  { value: \"BSD-3-Clause\", label: \"BSD 3-Clause\" },\n  { value: \"ISC\", label: \"ISC License\" },\n  { value: \"Proprietary\", label: \"Proprietary\" },\n];\n\n/**\n * Python version options.\n */\nconst PYTHON_VERSION_OPTIONS = [\n  { value: \">=3.11\", label: \"Python 3.11+\" },\n  { value: \">=3.10\", label: \"Python 3.10+\" },\n  { value: \">=3.9\", label: \"Python 3.9+\" },\n];\n\n/**\n * Form field component.\n */\ninterface FormFieldProps {\n  label: string;\n  htmlFor: string;\n  error?: string;\n  required?: boolean;\n  helpText?: string;\n  children: React.ReactNode;\n}\n\nconst FormField: React.FC<FormFieldProps> = ({\n  label,\n  htmlFor,\n  error,\n  required,\n  helpText,\n  children,\n}) => (\n  <div>\n    <label\n      htmlFor={htmlFor}\n      className={[\n        \"block\",\n        \"mb-1.5\",\n        \"text-sm\",\n        \"font-medium\",\n        error ? \"text-error-700\" : \"text-neutral-700\",\n      ].join(\" \")}\n    >\n      {label}\n      {required && (\n        <span className=\"text-error-500 ml-0.5\" aria-hidden=\"true\">\n          *\n        </span>\n      )}\n    </label>\n    {children}\n    {error && (\n      <p className=\"mt-1 text-sm text-error-600\" role=\"alert\">\n        {error}\n      </p>\n    )}\n    {helpText && !error && (\n      <p className=\"mt-1 text-sm text-neutral-500\">{helpText}</p>\n    )}\n  </div>\n);\n\n/**\n * Input styles.\n */\nconst inputStyles = [\n  \"block\",\n  \"w-full\",\n  \"px-3\",\n  \"py-2\",\n  \"text-sm\",\n  \"bg-white\",\n  \"border\",\n  \"border-neutral-300\",\n  \"rounded-md\",\n  \"placeholder:text-neutral-400\",\n  \"focus:outline-none\",\n  \"focus:ring-2\",\n  \"focus:ring-primary-500\",\n  \"focus:border-transparent\",\n  \"disabled:bg-neutral-50\",\n  \"disabled:text-neutral-500\",\n].join(\" \");\n\nconst inputErrorStyles = [\n  \"border-error-500\",\n  \"focus:ring-error-500\",\n].join(\" \");\n\n/**\n * Textarea styles.\n */\nconst textareaStyles = [\n  inputStyles,\n  \"min-h-20\",\n  \"resize-y\",\n].join(\" \");\n\n/**\n * Select styles.\n */\nconst selectStyles = [\n  inputStyles,\n  \"appearance-none\",\n  \"cursor-pointer\",\n  \"pr-10\",\n].join(\" \");\n\n/**\n * Checkbox styles.\n */\nconst checkboxStyles = [\n  \"h-4\",\n  \"w-4\",\n  \"text-primary-600\",\n  \"border-neutral-300\",\n  \"rounded\",\n  \"focus:ring-primary-500\",\n  \"focus:ring-offset-0\",\n].join(\" \");\n\n/**\n * ManifestEditor component.\n *\n * Form for editing plugin manifest metadata. Provides fields for\n * all required and optional manifest properties.\n *\n * @example\n * ```tsx\n * <ManifestEditor\n *   value={manifestData}\n *   onChange={(updates) => setManifestData(prev => ({ ...prev, ...updates }))}\n *   contract=\"tts\"\n * />\n * ```\n */\nexport const ManifestEditor = forwardRef<HTMLDivElement, ManifestEditorProps>(\n  (\n    {\n      value,\n      onChange,\n      contract,\n      errors = {},\n      disabled = false,\n      showAdvanced = false,\n      additionalContent,\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    // Generate plugin name from display name\n    const generatePluginName = useCallback(\n      (displayName: string): string => {\n        if (!contract) return \"\";\n        const slug = displayName\n          .toLowerCase()\n          .replace(/[^a-z0-9\\s]/g, \"\")\n          .replace(/\\s+/g, \"_\")\n          .replace(/_+/g, \"_\")\n          .replace(/^_|_$/g, \"\");\n        return slug ? `${contract}_${slug}_plugin` : \"\";\n      },\n      [contract]\n    );\n\n    // Handle display name change and auto-generate plugin name\n    const handleDisplayNameChange = useCallback(\n      (e: React.ChangeEvent<HTMLInputElement>) => {\n        const displayName = e.target.value;\n        const name = generatePluginName(displayName);\n        onChange({ displayName, name });\n      },\n      [generatePluginName, onChange]\n    );\n\n    // Handle input change\n    const handleInputChange = useCallback(\n      (field: keyof PluginManifestData) =>\n        (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\n          onChange({ [field]: e.target.value });\n        },\n      [onChange]\n    );\n\n    // Handle checkbox change\n    const handleCheckboxChange = useCallback(\n      (field: keyof PluginManifestData) =>\n        (e: React.ChangeEvent<HTMLInputElement>) => {\n          onChange({ [field]: e.target.checked });\n        },\n      [onChange]\n    );\n\n    // Handle number change\n    const handleNumberChange = useCallback(\n      (field: keyof PluginManifestData) =>\n        (e: React.ChangeEvent<HTMLInputElement>) => {\n          const num = parseInt(e.target.value, 10);\n          if (!isNaN(num)) {\n            onChange({ [field]: num });\n          }\n        },\n      [onChange]\n    );\n\n    // Handle tags input (comma-separated)\n    const handleTagsChange = useCallback(\n      (e: React.ChangeEvent<HTMLInputElement>) => {\n        const tags = e.target.value\n          .split(\",\")\n          .map((t) => t.trim())\n          .filter((t) => t.length > 0);\n        onChange({ tags });\n      },\n      [onChange]\n    );\n\n    // Tags as comma-separated string\n    const tagsString = useMemo(() => value.tags.join(\", \"), [value.tags]);\n\n    // Container styles\n    const containerStyles = [\n      \"space-y-6\",\n      className,\n    ].filter(Boolean).join(\" \");\n\n    return (\n      <div ref={ref} className={containerStyles} {...props}>\n        {/* Basic Information Section */}\n        <div className=\"space-y-4\">\n          <h3 className=\"text-sm font-semibold text-neutral-900 uppercase tracking-wide\">\n            Basic Information\n          </h3>\n\n          {/* Display Name */}\n          <FormField\n            label=\"Display Name\"\n            htmlFor=\"displayName\"\n            required\n            error={errors.displayName}\n            helpText=\"Human-readable name shown in the UI\"\n          >\n            <input\n              type=\"text\"\n              id=\"displayName\"\n              value={value.displayName}\n              onChange={handleDisplayNameChange}\n              disabled={disabled}\n              placeholder=\"e.g., Kokoro TTS\"\n              className={[inputStyles, errors.displayName && inputErrorStyles].filter(Boolean).join(\" \")}\n            />\n          </FormField>\n\n          {/* Plugin Name (auto-generated) */}\n          <FormField\n            label=\"Plugin Name\"\n            htmlFor=\"name\"\n            required\n            error={errors.name}\n            helpText=\"Auto-generated from display name and contract\"\n          >\n            <input\n              type=\"text\"\n              id=\"name\"\n              value={value.name}\n              onChange={handleInputChange(\"name\")}\n              disabled={disabled}\n              placeholder={`${contract || \"contract\"}_name_plugin`}\n              className={[\n                inputStyles,\n                errors.name && inputErrorStyles,\n                \"font-mono\",\n                \"text-sm\",\n              ].filter(Boolean).join(\" \")}\n            />\n          </FormField>\n\n          {/* Version */}\n          <FormField\n            label=\"Version\"\n            htmlFor=\"version\"\n            required\n            error={errors.version}\n            helpText=\"Semantic version (major.minor.patch)\"\n          >\n            <input\n              type=\"text\"\n              id=\"version\"\n              value={value.version}\n              onChange={handleInputChange(\"version\")}\n              disabled={disabled}\n              placeholder=\"1.0.0\"\n              className={[inputStyles, errors.version && inputErrorStyles].filter(Boolean).join(\" \")}\n            />\n          </FormField>\n\n          {/* Description */}\n          <FormField\n            label=\"Description\"\n            htmlFor=\"description\"\n            error={errors.description}\n            helpText=\"Brief description of what your plugin does\"\n          >\n            <textarea\n              id=\"description\"\n              value={value.description}\n              onChange={handleInputChange(\"description\")}\n              disabled={disabled}\n              placeholder=\"Describe your plugin's functionality...\"\n              rows={3}\n              className={[textareaStyles, errors.description && inputErrorStyles].filter(Boolean).join(\" \")}\n            />\n          </FormField>\n        </div>\n\n        {/* Author & License Section */}\n        <div className=\"space-y-4\">\n          <h3 className=\"text-sm font-semibold text-neutral-900 uppercase tracking-wide\">\n            Author & License\n          </h3>\n\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n            {/* Author */}\n            <FormField\n              label=\"Author\"\n              htmlFor=\"author\"\n              error={errors.author}\n            >\n              <input\n                type=\"text\"\n                id=\"author\"\n                value={value.author}\n                onChange={handleInputChange(\"author\")}\n                disabled={disabled}\n                placeholder=\"Your name or organization\"\n                className={[inputStyles, errors.author && inputErrorStyles].filter(Boolean).join(\" \")}\n              />\n            </FormField>\n\n            {/* License */}\n            <FormField\n              label=\"License\"\n              htmlFor=\"license\"\n              error={errors.license}\n            >\n              <div className=\"relative\">\n                <select\n                  id=\"license\"\n                  value={value.license}\n                  onChange={handleInputChange(\"license\")}\n                  disabled={disabled}\n                  className={selectStyles}\n                >\n                  {LICENSE_OPTIONS.map((opt) => (\n                    <option key={opt.value} value={opt.value}>\n                      {opt.label}\n                    </option>\n                  ))}\n                </select>\n                <div className=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\">\n                  <svg className=\"h-4 w-4 text-neutral-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\n                  </svg>\n                </div>\n              </div>\n            </FormField>\n          </div>\n        </div>\n\n        {/* Entry Point Section */}\n        <div className=\"space-y-4\">\n          <h3 className=\"text-sm font-semibold text-neutral-900 uppercase tracking-wide\">\n            Entry Point\n          </h3>\n\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n            {/* Entry Point Module */}\n            <FormField\n              label=\"Entry Point Module\"\n              htmlFor=\"entryPoint\"\n              error={errors.entryPoint}\n              helpText=\"Python module name (without .py)\"\n            >\n              <input\n                type=\"text\"\n                id=\"entryPoint\"\n                value={value.entryPoint}\n                onChange={handleInputChange(\"entryPoint\")}\n                disabled={disabled}\n                placeholder=\"plugin\"\n                className={[inputStyles, \"font-mono\", errors.entryPoint && inputErrorStyles].filter(Boolean).join(\" \")}\n              />\n            </FormField>\n\n            {/* Python Version */}\n            <FormField\n              label=\"Python Version\"\n              htmlFor=\"pythonRequires\"\n              error={errors.pythonRequires}\n            >\n              <div className=\"relative\">\n                <select\n                  id=\"pythonRequires\"\n                  value={value.pythonRequires}\n                  onChange={handleInputChange(\"pythonRequires\")}\n                  disabled={disabled}\n                  className={selectStyles}\n                >\n                  {PYTHON_VERSION_OPTIONS.map((opt) => (\n                    <option key={opt.value} value={opt.value}>\n                      {opt.label}\n                    </option>\n                  ))}\n                </select>\n                <div className=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\">\n                  <svg className=\"h-4 w-4 text-neutral-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\n                  </svg>\n                </div>\n              </div>\n            </FormField>\n          </div>\n        </div>\n\n        {/* Tags Section */}\n        <div className=\"space-y-4\">\n          <h3 className=\"text-sm font-semibold text-neutral-900 uppercase tracking-wide\">\n            Tags & Categorization\n          </h3>\n\n          <FormField\n            label=\"Tags\"\n            htmlFor=\"tags\"\n            error={errors.tags}\n            helpText=\"Comma-separated list of tags for search and filtering\"\n          >\n            <input\n              type=\"text\"\n              id=\"tags\"\n              value={tagsString}\n              onChange={handleTagsChange}\n              disabled={disabled}\n              placeholder=\"e.g., japanese, high-quality, local\"\n              className={[inputStyles, errors.tags && inputErrorStyles].filter(Boolean).join(\" \")}\n            />\n          </FormField>\n        </div>\n\n        {/* Advanced Options */}\n        {showAdvanced && (\n          <div className=\"space-y-4 pt-4 border-t border-neutral-200\">\n            <h3 className=\"text-sm font-semibold text-neutral-900 uppercase tracking-wide\">\n              System Requirements\n            </h3>\n\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\n              {/* Minimum Memory */}\n              <FormField\n                label=\"Min Memory (MB)\"\n                htmlFor=\"minMemoryMb\"\n                error={errors.minMemoryMb}\n              >\n                <input\n                  type=\"number\"\n                  id=\"minMemoryMb\"\n                  value={value.minMemoryMb}\n                  onChange={handleNumberChange(\"minMemoryMb\")}\n                  disabled={disabled}\n                  min={0}\n                  step={256}\n                  className={[inputStyles, errors.minMemoryMb && inputErrorStyles].filter(Boolean).join(\" \")}\n                />\n              </FormField>\n\n              {/* GPU Required */}\n              <div className=\"flex items-center gap-3 pt-6\">\n                <input\n                  type=\"checkbox\"\n                  id=\"gpuRequired\"\n                  checked={value.gpuRequired}\n                  onChange={handleCheckboxChange(\"gpuRequired\")}\n                  disabled={disabled}\n                  className={checkboxStyles}\n                />\n                <label htmlFor=\"gpuRequired\" className=\"text-sm text-neutral-700\">\n                  GPU Required\n                </label>\n              </div>\n\n              {/* GPU Recommended */}\n              <div className=\"flex items-center gap-3 pt-6\">\n                <input\n                  type=\"checkbox\"\n                  id=\"gpuRecommended\"\n                  checked={value.gpuRecommended}\n                  onChange={handleCheckboxChange(\"gpuRecommended\")}\n                  disabled={disabled}\n                  className={checkboxStyles}\n                />\n                <label htmlFor=\"gpuRecommended\" className=\"text-sm text-neutral-700\">\n                  GPU Recommended\n                </label>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Additional content slot */}\n        {additionalContent}\n      </div>\n    );\n  }\n);\n\nManifestEditor.displayName = \"ManifestEditor\";\n\n/**\n * Compact manifest editor for inline editing.\n */\nexport interface ManifestEditorCompactProps {\n  value: Partial<PluginManifestData>;\n  onChange: (data: Partial<PluginManifestData>) => void;\n  fields?: Array<keyof PluginManifestData>;\n  className?: string;\n}\n\nexport const ManifestEditorCompact: React.FC<ManifestEditorCompactProps> = ({\n  value,\n  onChange,\n  fields = [\"displayName\", \"version\", \"description\"],\n  className = \"\",\n}) => {\n  return (\n    <div className={[\"space-y-3\", className].filter(Boolean).join(\" \")}>\n      {fields.includes(\"displayName\") && (\n        <div>\n          <label className=\"block text-xs font-medium text-neutral-500 mb-1\">\n            Name\n          </label>\n          <input\n            type=\"text\"\n            value={value.displayName || \"\"}\n            onChange={(e) => onChange({ displayName: e.target.value })}\n            className={[inputStyles, \"text-sm\"].join(\" \")}\n          />\n        </div>\n      )}\n      {fields.includes(\"version\") && (\n        <div>\n          <label className=\"block text-xs font-medium text-neutral-500 mb-1\">\n            Version\n          </label>\n          <input\n            type=\"text\"\n            value={value.version || \"\"}\n            onChange={(e) => onChange({ version: e.target.value })}\n            className={[inputStyles, \"text-sm\"].join(\" \")}\n          />\n        </div>\n      )}\n      {fields.includes(\"description\") && (\n        <div>\n          <label className=\"block text-xs font-medium text-neutral-500 mb-1\">\n            Description\n          </label>\n          <textarea\n            value={value.description || \"\"}\n            onChange={(e) => onChange({ description: e.target.value })}\n            rows={2}\n            className={[textareaStyles, \"text-sm\"].join(\" \")}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nManifestEditorCompact.displayName = \"ManifestEditorCompact\";\n\nexport default ManifestEditor;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\wizard\\PluginWizard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":472,"column":36,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":472,"endColumn":38,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[12526,12528],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":605,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":605,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onChange' is defined but never used. Allowed unused args must match /^_/u.","line":606,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":606,"endColumn":11}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D050 - src/components/wizard/PluginWizard.tsx\n * ==============================================\n * Multi-step wizard for creating new plugins.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010 (Button.tsx),\n *               D015 (Modal.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { useState, useCallback, useMemo, type ReactNode } from \"react\";\n\n/**\n * Wizard step definition.\n */\nexport interface WizardStep {\n  /** Unique step identifier */\n  id: string;\n  /** Step display title */\n  title: string;\n  /** Step description */\n  description?: string;\n  /** Whether step is optional */\n  optional?: boolean;\n  /** Icon component for step */\n  icon?: ReactNode;\n}\n\n/**\n * Plugin manifest data collected through wizard.\n */\nexport interface PluginManifestData {\n  /** Plugin name (e.g., tts_kokoro_plugin) */\n  name: string;\n  /** Display name */\n  displayName: string;\n  /** Version */\n  version: string;\n  /** Contract type */\n  contract: string;\n  /** Entry point module */\n  entryPoint: string;\n  /** Description */\n  description: string;\n  /** Author */\n  author: string;\n  /** License */\n  license: string;\n  /** Python requirements */\n  dependencies: string[];\n  /** Python version requirement */\n  pythonRequires: string;\n  /** GPU required */\n  gpuRequired: boolean;\n  /** GPU recommended */\n  gpuRecommended: boolean;\n  /** Minimum memory MB */\n  minMemoryMb: number;\n  /** Tags */\n  tags: string[];\n  /** Capabilities */\n  capabilities: string[];\n  /** Config schema */\n  configSchema: Record<string, unknown>;\n  /** Default config */\n  defaultConfig: Record<string, unknown>;\n}\n\n/**\n * Default manifest data for new plugins.\n */\nexport const DEFAULT_MANIFEST_DATA: PluginManifestData = {\n  name: \"\",\n  displayName: \"\",\n  version: \"1.0.0\",\n  contract: \"\",\n  entryPoint: \"plugin\",\n  description: \"\",\n  author: \"\",\n  license: \"MIT\",\n  dependencies: [],\n  pythonRequires: \">=3.11\",\n  gpuRequired: false,\n  gpuRecommended: false,\n  minMemoryMb: 512,\n  tags: [],\n  capabilities: [],\n  configSchema: {},\n  defaultConfig: {},\n};\n\n/**\n * Wizard step identifiers.\n */\nexport type WizardStepId =\n  | \"contract\"\n  | \"manifest\"\n  | \"dependencies\"\n  | \"preview\";\n\n/**\n * Default wizard steps.\n */\nexport const WIZARD_STEPS: WizardStep[] = [\n  {\n    id: \"contract\",\n    title: \"Select Contract\",\n    description: \"Choose the contract type your plugin will implement\",\n  },\n  {\n    id: \"manifest\",\n    title: \"Plugin Details\",\n    description: \"Configure plugin metadata and settings\",\n  },\n  {\n    id: \"dependencies\",\n    title: \"Dependencies\",\n    description: \"Add Python package dependencies\",\n    optional: true,\n  },\n  {\n    id: \"preview\",\n    title: \"Preview & Create\",\n    description: \"Review generated code and create plugin\",\n  },\n];\n\n/**\n * PluginWizard component props.\n */\nexport interface PluginWizardProps {\n  /** Initial manifest data */\n  initialData?: Partial<PluginManifestData>;\n  /** Custom wizard steps */\n  steps?: WizardStep[];\n  /** Callback when wizard completes */\n  onComplete?: (data: PluginManifestData) => void;\n  /** Callback when wizard is cancelled */\n  onCancel?: () => void;\n  /** Custom step content renderer */\n  renderStep?: (stepId: string, data: PluginManifestData, onChange: (data: Partial<PluginManifestData>) => void) => ReactNode;\n  /** Whether wizard is in loading state */\n  isLoading?: boolean;\n  /** Additional className */\n  className?: string;\n}\n\n/**\n * Check icon component.\n */\nconst CheckIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Arrow left icon.\n */\nconst ArrowLeftIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"19\" y1=\"12\" x2=\"5\" y2=\"12\" />\n    <polyline points=\"12 19 5 12 12 5\" />\n  </svg>\n);\n\n/**\n * Arrow right icon.\n */\nconst ArrowRightIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    aria-hidden=\"true\"\n  >\n    <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" />\n    <polyline points=\"12 5 19 12 12 19\" />\n  </svg>\n);\n\n/**\n * Loader icon.\n */\nconst LoaderIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    aria-hidden=\"true\"\n  >\n    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n  </svg>\n);\n\n/**\n * PluginWizard component.\n *\n * A multi-step wizard for creating new plugins. Guides users through\n * contract selection, manifest configuration, dependency setup, and\n * code preview.\n *\n * @example\n * ```tsx\n * <PluginWizard\n *   onComplete={(data) => createPlugin(data)}\n *   onCancel={() => setShowWizard(false)}\n * />\n * ```\n */\nexport const PluginWizard: React.FC<PluginWizardProps> = ({\n  initialData,\n  steps = WIZARD_STEPS,\n  onComplete,\n  onCancel,\n  renderStep,\n  isLoading = false,\n  className = \"\",\n}) => {\n  // Current step index\n  const [currentStepIndex, setCurrentStepIndex] = useState(0);\n\n  // Manifest data being edited\n  const [manifestData, setManifestData] = useState<PluginManifestData>({\n    ...DEFAULT_MANIFEST_DATA,\n    ...initialData,\n  });\n\n  // Validation errors per step\n  const [stepErrors, setStepErrors] = useState<Record<string, string[]>>({});\n\n  // Current step\n  const currentStep = steps[currentStepIndex];\n  const isFirstStep = currentStepIndex === 0;\n  const isLastStep = currentStepIndex === steps.length - 1;\n\n  // Update manifest data\n  const handleDataChange = useCallback((updates: Partial<PluginManifestData>) => {\n    setManifestData((prev) => ({ ...prev, ...updates }));\n  }, []);\n\n  // Validate current step\n  const validateStep = useCallback((stepId: string): string[] => {\n    const errors: string[] = [];\n\n    switch (stepId) {\n      case \"contract\":\n        if (!manifestData.contract) {\n          errors.push(\"Please select a contract type\");\n        }\n        break;\n\n      case \"manifest\":\n        if (!manifestData.name) {\n          errors.push(\"Plugin name is required\");\n        } else if (!/^[a-z][a-z0-9_]*_plugin$/.test(manifestData.name)) {\n          errors.push(\"Name must be lowercase with underscores, ending in _plugin\");\n        }\n        if (!manifestData.displayName) {\n          errors.push(\"Display name is required\");\n        }\n        if (!manifestData.version || !/^\\d+\\.\\d+\\.\\d+/.test(manifestData.version)) {\n          errors.push(\"Valid semantic version required (e.g., 1.0.0)\");\n        }\n        break;\n\n      case \"dependencies\":\n        // Dependencies step is optional\n        break;\n\n      case \"preview\":\n        // Final validation\n        if (!manifestData.contract || !manifestData.name) {\n          errors.push(\"Please complete all required fields\");\n        }\n        break;\n    }\n\n    return errors;\n  }, [manifestData]);\n\n  // Go to next step\n  const handleNext = useCallback(() => {\n    const errors = validateStep(currentStep.id);\n\n    if (errors.length > 0) {\n      setStepErrors((prev) => ({ ...prev, [currentStep.id]: errors }));\n      return;\n    }\n\n    // Clear errors for this step\n    setStepErrors((prev) => ({ ...prev, [currentStep.id]: [] }));\n\n    if (isLastStep) {\n      onComplete?.(manifestData);\n    } else {\n      setCurrentStepIndex((prev) => prev + 1);\n    }\n  }, [currentStep.id, isLastStep, manifestData, onComplete, validateStep]);\n\n  // Go to previous step\n  const handlePrevious = useCallback(() => {\n    if (!isFirstStep) {\n      setCurrentStepIndex((prev) => prev - 1);\n    }\n  }, [isFirstStep]);\n\n  // Jump to specific step\n  const handleStepClick = useCallback((index: number) => {\n    // Only allow going to completed steps or next step\n    if (index <= currentStepIndex) {\n      setCurrentStepIndex(index);\n    }\n  }, [currentStepIndex]);\n\n  // Step completion status\n  const stepCompletion = useMemo(() => {\n    return steps.map((step, index) => {\n      if (index < currentStepIndex) {\n        return \"completed\";\n      }\n      if (index === currentStepIndex) {\n        return \"current\";\n      }\n      return \"pending\";\n    });\n  }, [currentStepIndex, steps]);\n\n  // Container styles\n  const containerStyles = [\n    \"flex\",\n    \"flex-col\",\n    \"bg-white\",\n    \"rounded-lg\",\n    \"border\",\n    \"border-neutral-200\",\n    \"shadow-lg\",\n    \"overflow-hidden\",\n    className,\n  ].filter(Boolean).join(\" \");\n\n  // Step indicator styles\n  const getStepIndicatorStyles = (status: string) => [\n    \"flex\",\n    \"items-center\",\n    \"justify-center\",\n    \"w-8\",\n    \"h-8\",\n    \"rounded-full\",\n    \"text-sm\",\n    \"font-semibold\",\n    \"shrink-0\",\n    \"transition-colors\",\n    \"duration-200\",\n    status === \"completed\" && \"bg-success-500 text-white\",\n    status === \"current\" && \"bg-primary-500 text-white\",\n    status === \"pending\" && \"bg-neutral-200 text-neutral-500\",\n  ].filter(Boolean).join(\" \");\n\n  // Step text styles\n  const getStepTextStyles = (status: string) => [\n    \"text-sm\",\n    \"font-medium\",\n    \"transition-colors\",\n    \"duration-200\",\n    status === \"completed\" && \"text-success-700\",\n    status === \"current\" && \"text-primary-700\",\n    status === \"pending\" && \"text-neutral-500\",\n  ].filter(Boolean).join(\" \");\n\n  // Step connector styles\n  const getConnectorStyles = (status: string) => [\n    \"flex-1\",\n    \"h-0.5\",\n    \"mx-2\",\n    \"transition-colors\",\n    \"duration-200\",\n    status === \"completed\" ? \"bg-success-500\" : \"bg-neutral-200\",\n  ].filter(Boolean).join(\" \");\n\n  return (\n    <div className={containerStyles}>\n      {/* Step indicators */}\n      <div className=\"flex items-center p-6 border-b border-neutral-200 bg-neutral-50\">\n        {steps.map((step, index) => (\n          <React.Fragment key={step.id}>\n            {/* Step indicator */}\n            <button\n              type=\"button\"\n              onClick={() => handleStepClick(index)}\n              disabled={stepCompletion[index] === \"pending\"}\n              className={[\n                \"flex\",\n                \"items-center\",\n                \"gap-2\",\n                \"cursor-pointer\",\n                stepCompletion[index] === \"pending\" && \"cursor-not-allowed opacity-60\",\n              ].filter(Boolean).join(\" \")}\n            >\n              <div className={getStepIndicatorStyles(stepCompletion[index])}>\n                {stepCompletion[index] === \"completed\" ? (\n                  <CheckIcon className=\"h-4 w-4\" />\n                ) : (\n                  index + 1\n                )}\n              </div>\n              <span className={getStepTextStyles(stepCompletion[index])}>\n                {step.title}\n                {step.optional && (\n                  <span className=\"ml-1 text-xs text-neutral-400\">(optional)</span>\n                )}\n              </span>\n            </button>\n\n            {/* Connector */}\n            {index < steps.length - 1 && (\n              <div className={getConnectorStyles(stepCompletion[index])} />\n            )}\n          </React.Fragment>\n        ))}\n      </div>\n\n      {/* Step content */}\n      <div className=\"flex-1 p-6 min-h-96\">\n        {/* Step header */}\n        <div className=\"mb-6\">\n          <h2 className=\"text-xl font-semibold text-neutral-900\">\n            {currentStep.title}\n          </h2>\n          {currentStep.description && (\n            <p className=\"mt-1 text-sm text-neutral-600\">\n              {currentStep.description}\n            </p>\n          )}\n        </div>\n\n        {/* Validation errors */}\n        {stepErrors[currentStep.id]?.length > 0 && (\n          <div className=\"mb-4 p-3 bg-error-50 border border-error-200 rounded-lg\">\n            <ul className=\"list-disc list-inside text-sm text-error-700\">\n              {stepErrors[currentStep.id].map((error, index) => (\n                <li key={index}>{error}</li>\n              ))}\n            </ul>\n          </div>\n        )}\n\n        {/* Custom content or default placeholder */}\n        {renderStep ? (\n          renderStep(currentStep.id, manifestData, handleDataChange)\n        ) : (\n          <DefaultStepContent\n            stepId={currentStep.id}\n            data={manifestData}\n            onChange={handleDataChange}\n          />\n        )}\n      </div>\n\n      {/* Footer with navigation */}\n      <div className=\"flex items-center justify-between p-4 border-t border-neutral-200 bg-neutral-50\">\n        <div>\n          {onCancel && (\n            <button\n              type=\"button\"\n              onClick={onCancel}\n              className={[\n                \"px-4\",\n                \"py-2\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-neutral-700\",\n                \"hover:text-neutral-900\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              Cancel\n            </button>\n          )}\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          {/* Previous button */}\n          {!isFirstStep && (\n            <button\n              type=\"button\"\n              onClick={handlePrevious}\n              className={[\n                \"inline-flex\",\n                \"items-center\",\n                \"gap-2\",\n                \"px-4\",\n                \"py-2\",\n                \"text-sm\",\n                \"font-medium\",\n                \"text-neutral-700\",\n                \"bg-white\",\n                \"border\",\n                \"border-neutral-300\",\n                \"rounded-md\",\n                \"hover:bg-neutral-50\",\n                \"transition-colors\",\n                \"duration-150\",\n              ].join(\" \")}\n            >\n              <ArrowLeftIcon className=\"h-4 w-4\" />\n              Previous\n            </button>\n          )}\n\n          {/* Next/Complete button */}\n          <button\n            type=\"button\"\n            onClick={handleNext}\n            disabled={isLoading}\n            className={[\n              \"inline-flex\",\n              \"items-center\",\n              \"gap-2\",\n              \"px-4\",\n              \"py-2\",\n              \"text-sm\",\n              \"font-medium\",\n              \"text-white\",\n              \"bg-primary-600\",\n              \"rounded-md\",\n              \"hover:bg-primary-700\",\n              \"disabled:opacity-60\",\n              \"disabled:cursor-not-allowed\",\n              \"transition-colors\",\n              \"duration-150\",\n            ].join(\" \")}\n          >\n            {isLoading ? (\n              <>\n                <LoaderIcon className=\"h-4 w-4 animate-spin\" />\n                Creating...\n              </>\n            ) : isLastStep ? (\n              <>\n                Create Plugin\n                <CheckIcon className=\"h-4 w-4\" />\n              </>\n            ) : (\n              <>\n                Next\n                <ArrowRightIcon className=\"h-4 w-4\" />\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nPluginWizard.displayName = \"PluginWizard\";\n\n/**\n * Default step content placeholder.\n */\ninterface DefaultStepContentProps {\n  stepId: string;\n  data: PluginManifestData;\n  onChange: (data: Partial<PluginManifestData>) => void;\n}\n\nconst DefaultStepContent: React.FC<DefaultStepContentProps> = ({\n  stepId,\n  data,\n  onChange,\n}) => {\n  // Placeholder content - real components will be provided via renderStep\n  return (\n    <div className=\"flex items-center justify-center h-64 bg-neutral-50 rounded-lg border-2 border-dashed border-neutral-200\">\n      <div className=\"text-center\">\n        <p className=\"text-neutral-500\">\n          Step content for <span className=\"font-medium\">{stepId}</span>\n        </p>\n        <p className=\"mt-1 text-sm text-neutral-400\">\n          Use renderStep prop to provide custom content\n        </p>\n      </div>\n    </div>\n  );\n};\n\n/**\n * Hook for wizard state management.\n */\nexport interface UsePluginWizardOptions {\n  initialData?: Partial<PluginManifestData>;\n  onComplete?: (data: PluginManifestData) => void;\n}\n\nexport interface UsePluginWizardReturn {\n  data: PluginManifestData;\n  setData: React.Dispatch<React.SetStateAction<PluginManifestData>>;\n  updateData: (updates: Partial<PluginManifestData>) => void;\n  reset: () => void;\n}\n\nexport function usePluginWizard(options: UsePluginWizardOptions = {}): UsePluginWizardReturn {\n  const [data, setData] = useState<PluginManifestData>({\n    ...DEFAULT_MANIFEST_DATA,\n    ...options.initialData,\n  });\n\n  const updateData = useCallback((updates: Partial<PluginManifestData>) => {\n    setData((prev) => ({ ...prev, ...updates }));\n  }, []);\n\n  const reset = useCallback(() => {\n    setData({ ...DEFAULT_MANIFEST_DATA, ...options.initialData });\n  }, [options.initialData]);\n\n  return {\n    data,\n    setData,\n    updateData,\n    reset,\n  };\n}\n\nexport default PluginWizard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\wizard\\ScaffoldPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":568,"column":11,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":568,"endColumn":24},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise-returning function provided to attribute where a void return was expected.","line":690,"column":21,"nodeType":"JSXExpressionContainer","messageId":"voidReturnAttribute","endLine":690,"endColumn":33},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":726,"column":32,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":726,"endColumn":34,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[20236,20238],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":736,"column":26,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":736,"endColumn":28,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[20613,20615],"text":"."},"desc":"Remove unnecessary optional chain"}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D054 - src/components/wizard/ScaffoldPreview.tsx\n * =================================================\n * Generated code preview for plugin creation wizard.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D050 (PluginWizard.tsx),\n *               D051 (ContractSelector.tsx)\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *   - Fully typed props with TypeScript\n */\n\nimport React, { forwardRef, useState, useMemo, type HTMLAttributes } from \"react\";\nimport type { PluginManifestData } from \"./PluginWizard\";\n\n/**\n * Generated file content.\n */\nexport interface GeneratedFile {\n  /** File path relative to plugin folder */\n  path: string;\n  /** File content */\n  content: string;\n  /** File type for syntax highlighting */\n  language: \"python\" | \"json\" | \"yaml\" | \"text\";\n  /** Whether file is the main entry point */\n  isEntryPoint?: boolean;\n}\n\n/**\n * ScaffoldPreview component props.\n */\nexport interface ScaffoldPreviewProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n  /** Plugin manifest data */\n  manifestData: PluginManifestData;\n  /** Custom file generator */\n  generateFiles?: (data: PluginManifestData) => GeneratedFile[];\n  /** Whether preview is loading */\n  isLoading?: boolean;\n  /** Error message if generation failed */\n  error?: string;\n  /** Callback when file is selected */\n  onFileSelect?: (file: GeneratedFile) => void;\n}\n\n/**\n * File icon.\n */\nconst FileIcon: React.FC<{ className?: string; type: string }> = ({ className, type }) => {\n  if (type === \"python\") {\n    return (\n      <svg className={className} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n        <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z\" />\n      </svg>\n    );\n  }\n  if (type === \"json\") {\n    return (\n      <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" />\n        <polyline points=\"14 2 14 8 20 8\" />\n        <path d=\"M8 13h2\" />\n        <path d=\"M8 17h2\" />\n        <path d=\"M14 13h2\" />\n        <path d=\"M14 17h2\" />\n      </svg>\n    );\n  }\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" />\n      <polyline points=\"14 2 14 8 20 8\" />\n      <line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\" />\n      <line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\" />\n      <polyline points=\"10 9 9 9 8 9\" />\n    </svg>\n  );\n};\n\n/**\n * Folder icon.\n */\nconst FolderIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\" />\n  </svg>\n);\n\n/**\n * Copy icon.\n */\nconst CopyIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\" />\n    <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\" />\n  </svg>\n);\n\n/**\n * Check icon.\n */\nconst CheckIcon: React.FC<{ className?: string }> = ({ className }) => (\n  <svg\n    className={className}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"2\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n  >\n    <polyline points=\"20 6 9 17 4 12\" />\n  </svg>\n);\n\n/**\n * Generate manifest.json content.\n */\nconst generateManifest = (data: PluginManifestData): string => {\n  const manifest = {\n    name: data.name,\n    version: data.version,\n    contract: data.contract,\n    entry_point: data.entryPoint,\n    display_name: data.displayName,\n    description: data.description,\n    author: data.author,\n    license: data.license,\n    dependencies: data.dependencies,\n    python_requires: data.pythonRequires,\n    gpu_required: data.gpuRequired,\n    gpu_recommended: data.gpuRecommended,\n    min_memory_mb: data.minMemoryMb,\n    tags: data.tags,\n    capabilities: data.capabilities,\n    config_schema: data.configSchema,\n    default_config: data.defaultConfig,\n  };\n  return JSON.stringify(manifest, null, 2);\n};\n\n/**\n * Generate plugin.py content based on contract.\n */\nconst generatePluginCode = (data: PluginManifestData): string => {\n  const contractUpper = data.contract.toUpperCase();\n  const className = data.displayName\n    .split(/\\s+/)\n    .map((w) => w.charAt(0).toUpperCase() + w.slice(1))\n    .join(\"\")\n    .replace(/[^a-zA-Z0-9]/g, \"\");\n\n  const contractClass = `${data.contract.charAt(0).toUpperCase()}${data.contract.slice(1)}Contract`;\n\n  // Contract-specific implementations\n  const implementations: Record<string, string> = {\n    tts: `\n    def synthesize(self, text: str, voice_id: str | None = None, options: dict | None = None) -> dict:\n        \"\"\"\n        Synthesize text to audio.\n\n        Args:\n            text: Text to synthesize\n            voice_id: Voice ID to use (optional)\n            options: Additional options (optional)\n\n        Returns:\n            Dict with audio_data (base64), format, sample_rate, duration_ms\n        \"\"\"\n        # TODO: Implement TTS synthesis\n        self.logger.info(f\"Synthesizing: {text[:50]}...\")\n\n        # Example return structure\n        return {\n            \"audio_data\": \"\",  # Base64 encoded audio\n            \"format\": \"wav\",\n            \"sample_rate\": 22050,\n            \"duration_ms\": 0,\n        }\n\n    def get_voices(self) -> list[dict]:\n        \"\"\"\n        Get available voices.\n\n        Returns:\n            List of voice info dicts with id, name, language\n        \"\"\"\n        # TODO: Return actual available voices\n        return [\n            {\"id\": \"default\", \"name\": \"Default Voice\", \"language\": \"en\"},\n        ]`,\n    stt: `\n    def transcribe(self, audio_data: str, language: str | None = None, options: dict | None = None) -> dict:\n        \"\"\"\n        Transcribe audio to text.\n\n        Args:\n            audio_data: Base64 encoded audio\n            language: Language code (optional)\n            options: Additional options (optional)\n\n        Returns:\n            Dict with text, confidence, language, segments (optional)\n        \"\"\"\n        # TODO: Implement STT transcription\n        self.logger.info(\"Transcribing audio...\")\n\n        return {\n            \"text\": \"\",\n            \"confidence\": 0.0,\n            \"language\": language or \"en\",\n        }\n\n    def get_languages(self) -> list[str]:\n        \"\"\"\n        Get supported languages.\n\n        Returns:\n            List of language codes\n        \"\"\"\n        return [\"en\"]`,\n    llm: `\n    def complete(self, messages: list[dict], options: dict | None = None) -> dict:\n        \"\"\"\n        Generate completion for messages.\n\n        Args:\n            messages: List of chat messages with role and content\n            options: Generation options (temperature, max_tokens, etc.)\n\n        Returns:\n            Dict with content, model, usage\n        \"\"\"\n        # TODO: Implement LLM completion\n        self.logger.info(f\"Completing with {len(messages)} messages...\")\n\n        return {\n            \"content\": \"\",\n            \"model\": \"${data.name}\",\n            \"usage\": {\n                \"prompt_tokens\": 0,\n                \"completion_tokens\": 0,\n                \"total_tokens\": 0,\n            },\n        }\n\n    def get_models(self) -> list[str]:\n        \"\"\"\n        Get available models.\n\n        Returns:\n            List of model identifiers\n        \"\"\"\n        return [\"default\"]`,\n    mcp: `\n    def list_tools(self) -> dict:\n        \"\"\"\n        List available tools from MCP server.\n\n        Returns:\n            Dict with tools list\n        \"\"\"\n        return {\"tools\": []}\n\n    def call_tool(self, name: str, arguments: dict | None = None) -> dict:\n        \"\"\"\n        Call a tool on the MCP server.\n\n        Args:\n            name: Tool name\n            arguments: Tool arguments (optional)\n\n        Returns:\n            Tool result dict\n        \"\"\"\n        # TODO: Implement MCP tool call\n        self.logger.info(f\"Calling tool: {name}\")\n        return {\"result\": None}\n\n    def list_resources(self) -> dict:\n        \"\"\"\n        List available resources.\n\n        Returns:\n            Dict with resources list\n        \"\"\"\n        return {\"resources\": []}`,\n    vision: `\n    def analyze(self, image_data: str, prompt: str | None = None) -> dict:\n        \"\"\"\n        Analyze image content.\n\n        Args:\n            image_data: Base64 encoded image\n            prompt: Analysis prompt (optional)\n\n        Returns:\n            Dict with description, labels, confidence\n        \"\"\"\n        # TODO: Implement vision analysis\n        self.logger.info(\"Analyzing image...\")\n\n        return {\n            \"description\": \"\",\n            \"labels\": [],\n            \"confidence\": 0.0,\n        }`,\n    embedding: `\n    def embed(self, text: str) -> dict:\n        \"\"\"\n        Generate embedding vector for text.\n\n        Args:\n            text: Text to embed\n\n        Returns:\n            Dict with vector, dimensions, model\n        \"\"\"\n        # TODO: Implement embedding generation\n        self.logger.info(f\"Embedding: {text[:50]}...\")\n\n        return {\n            \"vector\": [],\n            \"dimensions\": 0,\n            \"model\": \"${data.name}\",\n        }\n\n    def get_dimensions(self) -> int:\n        \"\"\"\n        Get embedding dimensions.\n\n        Returns:\n            Vector dimensions\n        \"\"\"\n        return 0`,\n    debug: `\n    def ping(self) -> str:\n        \"\"\"\n        Simple health check.\n\n        Returns:\n            \"pong\"\n        \"\"\"\n        return \"pong\"\n\n    def echo(self, message: any) -> any:\n        \"\"\"\n        Echo back input.\n\n        Args:\n            message: Any value\n\n        Returns:\n            Same value\n        \"\"\"\n        return message`,\n  };\n\n  const implementation = implementations[data.contract] || implementations.debug;\n\n  return `\"\"\"\n${data.name}\n${\"=\".repeat(data.name.length)}\n${data.description || \"Plugin implementation.\"}\n\nArchitecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\nProtocol: JSON-RPC 2.0 over stdin/stdout\n\nContract: ${contractUpper}\nAuthor: ${data.author || \"Unknown\"}\nLicense: ${data.license}\n\"\"\"\n\nimport logging\nfrom typing import Any\n\nfrom contracts.base import PluginBase, PluginStatus, HealthStatus\nfrom contracts.${data.contract}_contract import ${contractClass}\n\n\nclass ${className}Plugin(PluginBase, ${contractClass}):\n    \"\"\"\n    ${data.displayName} plugin implementation.\n\n    Implements the ${contractUpper} contract.\n    \"\"\"\n\n    def __init__(self):\n        \"\"\"Initialize plugin.\"\"\"\n        super().__init__()\n        self.logger = logging.getLogger(__name__)\n        self._config: dict = {}\n        self._status = PluginStatus.CREATED\n\n    def initialize(self, config: dict | None = None) -> bool:\n        \"\"\"\n        Initialize plugin with configuration.\n\n        Args:\n            config: Plugin configuration dictionary\n\n        Returns:\n            True if initialization succeeded\n        \"\"\"\n        self.logger.info(f\"Initializing ${data.displayName}...\")\n\n        self._config = config or {}\n\n        # TODO: Add initialization logic here\n        # - Load models\n        # - Set up connections\n        # - Validate configuration\n\n        self._status = PluginStatus.READY\n        self.logger.info(\"${data.displayName} initialized successfully\")\n        return True\n\n    def shutdown(self) -> None:\n        \"\"\"\n        Shutdown plugin and release resources.\n        \"\"\"\n        self.logger.info(\"Shutting down ${data.displayName}...\")\n\n        # TODO: Add cleanup logic here\n        # - Release models\n        # - Close connections\n        # - Save state if needed\n\n        self._status = PluginStatus.STOPPED\n        self.logger.info(\"${data.displayName} shutdown complete\")\n\n    def health_check(self) -> HealthStatus:\n        \"\"\"\n        Perform health check.\n\n        Returns:\n            HealthStatus with current status and message\n        \"\"\"\n        return HealthStatus(\n            status=self._status,\n            message=\"Plugin is healthy\" if self._status == PluginStatus.READY else \"Plugin not ready\",\n        )\n${implementation}\n\n\n# Plugin instance for registration\nplugin = ${className}Plugin()\n`;\n};\n\n/**\n * Generate __init__.py content.\n */\nconst generateInit = (data: PluginManifestData): string => {\n  return `\"\"\"\n${data.name}\n${\"=\".repeat(data.name.length)}\n${data.description || \"Plugin package.\"}\n\"\"\"\n\nfrom .${data.entryPoint} import plugin\n\n__all__ = [\"plugin\"]\n__version__ = \"${data.version}\"\n`;\n};\n\n/**\n * Default file generator.\n */\nconst defaultGenerateFiles = (data: PluginManifestData): GeneratedFile[] => {\n  return [\n    {\n      path: \"manifest.json\",\n      content: generateManifest(data),\n      language: \"json\",\n    },\n    {\n      path: `${data.entryPoint}.py`,\n      content: generatePluginCode(data),\n      language: \"python\",\n      isEntryPoint: true,\n    },\n    {\n      path: \"__init__.py\",\n      content: generateInit(data),\n      language: \"python\",\n    },\n  ];\n};\n\n/**\n * ScaffoldPreview component.\n *\n * Displays generated plugin code files with syntax highlighting.\n * Allows users to preview and copy the generated code before creation.\n *\n * @example\n * ```tsx\n * <ScaffoldPreview\n *   manifestData={wizardData}\n * />\n * ```\n */\nexport const ScaffoldPreview = forwardRef<HTMLDivElement, ScaffoldPreviewProps>(\n  (\n    {\n      manifestData,\n      generateFiles = defaultGenerateFiles,\n      isLoading = false,\n      error,\n      onFileSelect,\n      className = \"\",\n      ...props\n    },\n    ref\n  ) => {\n    // Selected file index\n    const [selectedIndex, setSelectedIndex] = useState(0);\n\n    // Copy state\n    const [copied, setCopied] = useState(false);\n\n    // Generate files\n    const files = useMemo(() => {\n      if (!manifestData.name || !manifestData.contract) {\n        return [];\n      }\n      return generateFiles(manifestData);\n    }, [manifestData, generateFiles]);\n\n    // Selected file\n    const selectedFile = files[selectedIndex];\n\n    // Handle file selection\n    const handleFileSelect = (index: number) => {\n      setSelectedIndex(index);\n      setCopied(false);\n      if (files[index]) {\n        onFileSelect?.(files[index]);\n      }\n    };\n\n    // Handle copy\n    const handleCopy = async () => {\n      if (!selectedFile) return;\n\n      try {\n        await navigator.clipboard.writeText(selectedFile.content);\n        setCopied(true);\n        setTimeout(() => setCopied(false), 2000);\n      } catch (err) {\n        console.error(\"Failed to copy:\", err);\n      }\n    };\n\n    // Container styles\n    const containerStyles = [\n      \"flex\",\n      \"flex-col\",\n      \"h-full\",\n      \"min-h-96\",\n      \"bg-white\",\n      \"rounded-lg\",\n      \"border\",\n      \"border-neutral-200\",\n      \"overflow-hidden\",\n      className,\n    ].filter(Boolean).join(\" \");\n\n    // Loading state\n    if (isLoading) {\n      return (\n        <div ref={ref} className={containerStyles} {...props}>\n          <div className=\"flex-1 flex items-center justify-center\">\n            <div className=\"text-center\">\n              <div className=\"inline-block h-8 w-8 border-2 border-primary-500 border-t-transparent rounded-full animate-spin\" />\n              <p className=\"mt-2 text-sm text-neutral-500\">Generating files...</p>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    // Error state\n    if (error) {\n      return (\n        <div ref={ref} className={containerStyles} {...props}>\n          <div className=\"flex-1 flex items-center justify-center p-6\">\n            <div className=\"text-center\">\n              <div className=\"inline-flex items-center justify-center w-12 h-12 rounded-full bg-error-100 text-error-600 mb-4\">\n                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </div>\n              <p className=\"text-sm text-error-700\">{error}</p>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    // Empty state\n    if (files.length === 0) {\n      return (\n        <div ref={ref} className={containerStyles} {...props}>\n          <div className=\"flex-1 flex items-center justify-center p-6\">\n            <div className=\"text-center\">\n              <FolderIcon className=\"mx-auto h-12 w-12 text-neutral-300\" />\n              <p className=\"mt-2 text-sm text-neutral-500\">\n                Complete the previous steps to see generated files\n              </p>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div ref={ref} className={containerStyles} {...props}>\n        {/* Header with folder structure */}\n        <div className=\"flex items-center gap-2 px-4 py-3 border-b border-neutral-200 bg-neutral-50\">\n          <FolderIcon className=\"h-4 w-4 text-warning-500\" />\n          <span className=\"text-sm font-medium text-neutral-700\">{manifestData.name}/</span>\n        </div>\n\n        {/* File tabs */}\n        <div className=\"flex border-b border-neutral-200 bg-neutral-50 overflow-x-auto\">\n          {files.map((file, index) => (\n            <button\n              key={file.path}\n              type=\"button\"\n              onClick={() => handleFileSelect(index)}\n              className={[\n                \"flex\",\n                \"items-center\",\n                \"gap-2\",\n                \"px-4\",\n                \"py-2.5\",\n                \"text-sm\",\n                \"font-medium\",\n                \"border-b-2\",\n                \"-mb-px\",\n                \"transition-colors\",\n                \"duration-150\",\n                \"whitespace-nowrap\",\n                selectedIndex === index\n                  ? \"border-primary-500 text-primary-700 bg-white\"\n                  : \"border-transparent text-neutral-600 hover:text-neutral-900 hover:bg-neutral-100\",\n              ].join(\" \")}\n            >\n              <FileIcon className=\"h-4 w-4\" type={file.language} />\n              {file.path}\n              {file.isEntryPoint && (\n                <span className=\"px-1.5 py-0.5 text-xs bg-primary-100 text-primary-700 rounded\">\n                  main\n                </span>\n              )}\n            </button>\n          ))}\n        </div>\n\n        {/* Code display */}\n        <div className=\"flex-1 relative overflow-hidden\">\n          {/* Copy button */}\n          <button\n            type=\"button\"\n            onClick={handleCopy}\n            className={[\n              \"absolute\",\n              \"top-3\",\n              \"right-3\",\n              \"z-10\",\n              \"inline-flex\",\n              \"items-center\",\n              \"gap-1.5\",\n              \"px-2.5\",\n              \"py-1.5\",\n              \"text-xs\",\n              \"font-medium\",\n              \"rounded-md\",\n              \"transition-colors\",\n              \"duration-150\",\n              copied\n                ? \"bg-success-100 text-success-700\"\n                : \"bg-neutral-700 text-neutral-200 hover:bg-neutral-600\",\n            ].join(\" \")}\n          >\n            {copied ? (\n              <>\n                <CheckIcon className=\"h-3.5 w-3.5\" />\n                Copied!\n              </>\n            ) : (\n              <>\n                <CopyIcon className=\"h-3.5 w-3.5\" />\n                Copy\n              </>\n            )}\n          </button>\n\n          {/* Code content */}\n          <pre className=\"h-full p-4 bg-neutral-900 text-neutral-100 text-sm font-mono overflow-auto\">\n            <code>{selectedFile?.content}</code>\n          </pre>\n        </div>\n\n        {/* File info footer */}\n        <div className=\"flex items-center justify-between px-4 py-2 border-t border-neutral-200 bg-neutral-50 text-xs text-neutral-500\">\n          <span>\n            {files.length} file{files.length !== 1 ? \"s\" : \"\"} will be created\n          </span>\n          <span>\n            {selectedFile?.content.split(\"\\n\").length} lines\n          </span>\n        </div>\n      </div>\n    );\n  }\n);\n\nScaffoldPreview.displayName = \"ScaffoldPreview\";\n\nexport default ScaffoldPreview;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\components\\wizard\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\context\\ThemeProvider.tsx","messages":[{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `{ [s: string]: unknown; } | ArrayLike<unknown>`.","line":508,"column":20,"nodeType":"Identifier","messageId":"unsafeArgument","endLine":508,"endColumn":25},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `string | null`.","line":529,"column":48,"nodeType":"Identifier","messageId":"unsafeArgument","endLine":529,"endColumn":53},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `string | null`.","line":534,"column":47,"nodeType":"Identifier","messageId":"unsafeArgument","endLine":534,"endColumn":52},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `string | null`.","line":539,"column":47,"nodeType":"Identifier","messageId":"unsafeArgument","endLine":539,"endColumn":52},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `{ [s: string]: unknown; } | ArrayLike<unknown>`.","line":565,"column":20,"nodeType":"Identifier","messageId":"unsafeArgument","endLine":565,"endColumn":25},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":580,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":580,"endColumn":39},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":585,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":585,"endColumn":38},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":590,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":590,"endColumn":38},{"ruleId":"@typescript-eslint/dot-notation","severity":2,"message":"[\"colorScheme\"] is better written in dot notation.","line":594,"column":10,"nodeType":"Literal","messageId":"useDot","endLine":594,"endColumn":23,"fix":{"range":[14119,14134],"text":".colorScheme"}}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'initialTheme' and 'store'. Either include them or remove the dependency array.","line":668,"column":6,"nodeType":"ArrayExpression","endLine":668,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [initialTheme, store]","fix":{"range":[15886,15888],"text":"[initialTheme, store]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'store'. Either include it or remove the dependency array.","line":689,"column":6,"nodeType":"ArrayExpression","endLine":689,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [store, syncWithSystem]","fix":{"range":[16517,16533],"text":"[store, syncWithSystem]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D016 - src/context/ThemeProvider.tsx\n * =====================================\n * Theme context provider managing theme state with Zustand.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D007 (tailwind.config.js), D010-D015 (atomic components)\n *\n * Features:\n *   - Centralized theme state management via Zustand\n *   - CSS custom properties injection for real-time theme updates\n *   - Persistence to localStorage\n *   - Light/Dark mode support\n *   - Custom color palette support\n */\n\nimport React, {\n  createContext,\n  useContext,\n  useEffect,\n  type ReactNode,\n} from \"react\";\nimport { create } from \"zustand\";\nimport { persist, createJSONStorage } from \"zustand/middleware\";\n\n// ============================================\n// Theme Types\n// ============================================\n\n/**\n * Color scale type (50-950 shades).\n */\nexport interface ColorScale {\n  50: string;\n  100: string;\n  200: string;\n  300: string;\n  400: string;\n  500: string;\n  600: string;\n  700: string;\n  800: string;\n  900: string;\n  950: string;\n}\n\n/**\n * Semantic color definitions.\n */\nexport interface SemanticColors {\n  primary: ColorScale;\n  neutral: ColorScale;\n  success: Partial<ColorScale>;\n  warning: Partial<ColorScale>;\n  error: Partial<ColorScale>;\n  info: Partial<ColorScale>;\n}\n\n/**\n * Typography settings.\n */\nexport interface TypographySettings {\n  fontFamily: {\n    sans: string;\n    mono: string;\n  };\n  fontSize: {\n    xs: string;\n    sm: string;\n    base: string;\n    lg: string;\n    xl: string;\n    \"2xl\": string;\n    \"3xl\": string;\n  };\n}\n\n/**\n * Spacing scale.\n */\nexport interface SpacingScale {\n  0: string;\n  1: string;\n  2: string;\n  3: string;\n  4: string;\n  5: string;\n  6: string;\n  8: string;\n  10: string;\n  12: string;\n  16: string;\n  20: string;\n  24: string;\n}\n\n/**\n * Border radius presets.\n */\nexport interface RadiusScale {\n  none: string;\n  sm: string;\n  md: string;\n  lg: string;\n  xl: string;\n  \"2xl\": string;\n  full: string;\n}\n\n/**\n * Shadow presets.\n */\nexport interface ShadowScale {\n  none: string;\n  sm: string;\n  md: string;\n  lg: string;\n  xl: string;\n  \"2xl\": string;\n}\n\n/**\n * Complete theme configuration.\n */\nexport interface ThemeConfig {\n  name: string;\n  mode: \"light\" | \"dark\";\n  colors: SemanticColors;\n  typography: TypographySettings;\n  spacing: SpacingScale;\n  radius: RadiusScale;\n  shadows: ShadowScale;\n}\n\n/**\n * Theme store state.\n */\n/**\n * Custom font entry for Google Fonts integration.\n */\nexport interface CustomFont {\n  name: string;\n  family: string;\n  url: string;\n  loaded: boolean;\n}\n\nexport interface ThemeState {\n  // Current theme configuration\n  theme: ThemeConfig;\n  // List of saved theme presets\n  savedThemes: ThemeConfig[];\n  // Whether the theme panel is open\n  isPanelOpen: boolean;\n  // Custom fonts loaded from Google Fonts\n  customFonts: CustomFont[];\n\n  // Actions\n  setMode: (mode: \"light\" | \"dark\") => void;\n  toggleMode: () => void;\n  setColor: (\n    category: keyof SemanticColors,\n    shade: keyof ColorScale,\n    value: string\n  ) => void;\n  setTypography: (key: keyof TypographySettings, value: unknown) => void;\n  setRadius: (key: keyof RadiusScale, value: string) => void;\n  setShadow: (key: keyof ShadowScale, value: string) => void;\n  saveTheme: (name: string) => void;\n  loadTheme: (name: string) => void;\n  deleteTheme: (name: string) => void;\n  updateTheme: (name: string, updatedTheme: ThemeConfig) => void;\n  resetToDefault: () => void;\n  setTheme: (theme: Partial<ThemeConfig>) => void;\n  setPanelOpen: (open: boolean) => void;\n  togglePanel: () => void;\n  addCustomFont: (font: CustomFont) => void;\n  removeCustomFont: (fontName: string) => void;\n}\n\n// ============================================\n// Default Theme\n// ============================================\n\n/**\n * Default light theme configuration.\n */\nexport const defaultLightTheme: ThemeConfig = {\n  name: \"Default\",\n  mode: \"light\",\n  colors: {\n    primary: {\n      50: \"#eff6ff\",\n      100: \"#dbeafe\",\n      200: \"#bfdbfe\",\n      300: \"#93c5fd\",\n      400: \"#60a5fa\",\n      500: \"#3b82f6\",\n      600: \"#2563eb\",\n      700: \"#1d4ed8\",\n      800: \"#1e40af\",\n      900: \"#1e3a8a\",\n      950: \"#172554\",\n    },\n    neutral: {\n      50: \"#fafafa\",\n      100: \"#f4f4f5\",\n      200: \"#e4e4e7\",\n      300: \"#d4d4d8\",\n      400: \"#a1a1aa\",\n      500: \"#71717a\",\n      600: \"#52525b\",\n      700: \"#3f3f46\",\n      800: \"#27272a\",\n      900: \"#18181b\",\n      950: \"#09090b\",\n    },\n    success: {\n      50: \"#f0fdf4\",\n      500: \"#22c55e\",\n      600: \"#16a34a\",\n      700: \"#15803d\",\n    },\n    warning: {\n      50: \"#fffbeb\",\n      500: \"#f59e0b\",\n      600: \"#d97706\",\n      700: \"#b45309\",\n    },\n    error: {\n      50: \"#fef2f2\",\n      500: \"#ef4444\",\n      600: \"#dc2626\",\n      700: \"#b91c1c\",\n    },\n    info: {\n      50: \"#eff6ff\",\n      500: \"#3b82f6\",\n      600: \"#2563eb\",\n      700: \"#1d4ed8\",\n    },\n  },\n  typography: {\n    fontFamily: {\n      sans: '\"Inter\", \"Segoe UI\", system-ui, -apple-system, sans-serif',\n      mono: '\"JetBrains Mono\", \"Fira Code\", \"Consolas\", monospace',\n    },\n    fontSize: {\n      xs: \"0.75rem\",\n      sm: \"0.875rem\",\n      base: \"1rem\",\n      lg: \"1.125rem\",\n      xl: \"1.25rem\",\n      \"2xl\": \"1.5rem\",\n      \"3xl\": \"1.875rem\",\n    },\n  },\n  spacing: {\n    0: \"0\",\n    1: \"0.25rem\",\n    2: \"0.5rem\",\n    3: \"0.75rem\",\n    4: \"1rem\",\n    5: \"1.25rem\",\n    6: \"1.5rem\",\n    8: \"2rem\",\n    10: \"2.5rem\",\n    12: \"3rem\",\n    16: \"4rem\",\n    20: \"5rem\",\n    24: \"6rem\",\n  },\n  radius: {\n    none: \"0\",\n    sm: \"0.125rem\",\n    md: \"0.375rem\",\n    lg: \"0.5rem\",\n    xl: \"0.75rem\",\n    \"2xl\": \"1rem\",\n    full: \"9999px\",\n  },\n  shadows: {\n    none: \"none\",\n    sm: \"0 1px 2px 0 rgb(0 0 0 / 0.05)\",\n    md: \"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)\",\n    lg: \"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)\",\n    xl: \"0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)\",\n    \"2xl\": \"0 25px 50px -12px rgb(0 0 0 / 0.25)\",\n  },\n};\n\n/**\n * Default dark theme configuration.\n */\nexport const defaultDarkTheme: ThemeConfig = {\n  ...defaultLightTheme,\n  name: \"Default Dark\",\n  mode: \"dark\",\n  colors: {\n    ...defaultLightTheme.colors,\n    neutral: {\n      50: \"#09090b\",\n      100: \"#18181b\",\n      200: \"#27272a\",\n      300: \"#3f3f46\",\n      400: \"#52525b\",\n      500: \"#71717a\",\n      600: \"#a1a1aa\",\n      700: \"#d4d4d8\",\n      800: \"#e4e4e7\",\n      900: \"#f4f4f5\",\n      950: \"#fafafa\",\n    },\n  },\n};\n\n// ============================================\n// Zustand Store\n// ============================================\n\n/**\n * Theme store with persistence.\n */\nexport const useThemeStore = create<ThemeState>()(\n  persist(\n    (set) => ({\n      theme: defaultLightTheme,\n      savedThemes: [defaultLightTheme, defaultDarkTheme],\n      isPanelOpen: false,\n      customFonts: [],\n\n      setMode: (mode) =>\n        set((state) => ({\n          theme: {\n            ...state.theme,\n            mode,\n            colors:\n              mode === \"dark\"\n                ? defaultDarkTheme.colors\n                : defaultLightTheme.colors,\n          },\n        })),\n\n      toggleMode: () =>\n        set((state) => {\n          const newMode = state.theme.mode === \"light\" ? \"dark\" : \"light\";\n          return {\n            theme: {\n              ...state.theme,\n              mode: newMode,\n              colors:\n                newMode === \"dark\"\n                  ? defaultDarkTheme.colors\n                  : defaultLightTheme.colors,\n            },\n          };\n        }),\n\n      setColor: (category, shade, value) =>\n        set((state) => ({\n          theme: {\n            ...state.theme,\n            colors: {\n              ...state.theme.colors,\n              [category]: {\n                ...state.theme.colors[category],\n                [shade]: value,\n              },\n            },\n          },\n        })),\n\n      setTypography: (key, value) =>\n        set((state) => ({\n          theme: {\n            ...state.theme,\n            typography: {\n              ...state.theme.typography,\n              [key]: value,\n            },\n          },\n        })),\n\n      setRadius: (key, value) =>\n        set((state) => ({\n          theme: {\n            ...state.theme,\n            radius: {\n              ...state.theme.radius,\n              [key]: value,\n            },\n          },\n        })),\n\n      setShadow: (key, value) =>\n        set((state) => ({\n          theme: {\n            ...state.theme,\n            shadows: {\n              ...state.theme.shadows,\n              [key]: value,\n            },\n          },\n        })),\n\n      saveTheme: (name) =>\n        set((state) => {\n          const newTheme = { ...state.theme, name };\n          const existingIndex = state.savedThemes.findIndex(\n            (t) => t.name === name\n          );\n          const updatedThemes =\n            existingIndex >= 0\n              ? state.savedThemes.map((t, i) =>\n                i === existingIndex ? newTheme : t\n              )\n              : [...state.savedThemes, newTheme];\n          return {\n            theme: newTheme,\n            savedThemes: updatedThemes,\n          };\n        }),\n\n      loadTheme: (name) =>\n        set((state) => {\n          const theme = state.savedThemes.find((t) => t.name === name);\n          if (theme) {\n            return { theme };\n          }\n          return {};\n        }),\n\n      deleteTheme: (name) =>\n        set((state) => ({\n          savedThemes: state.savedThemes.filter((t) => t.name !== name),\n        })),\n\n      updateTheme: (name, updatedTheme) =>\n        set((state) => {\n          const existingIndex = state.savedThemes.findIndex(\n            (t) => t.name === name\n          );\n          if (existingIndex >= 0) {\n            const updatedThemes = state.savedThemes.map((t, i) =>\n              i === existingIndex ? updatedTheme : t\n            );\n            return {\n              savedThemes: updatedThemes,\n              // If the updated theme is the current theme, update it too\n              theme: state.theme.name === name ? updatedTheme : state.theme,\n            };\n          }\n          return {};\n        }),\n\n      resetToDefault: () =>\n        set((state) => ({\n          theme:\n            state.theme.mode === \"dark\" ? defaultDarkTheme : defaultLightTheme,\n        })),\n\n      setTheme: (partialTheme) =>\n        set((state) => ({\n          theme: {\n            ...state.theme,\n            ...partialTheme,\n          },\n        })),\n\n      setPanelOpen: (open) => set({ isPanelOpen: open }),\n\n      togglePanel: () => set((state) => ({ isPanelOpen: !state.isPanelOpen })),\n\n      addCustomFont: (font) =>\n        set((state) => ({\n          customFonts: [...state.customFonts.filter(f => f.name !== font.name), font],\n        })),\n\n      removeCustomFont: (fontName) =>\n        set((state) => ({\n          customFonts: state.customFonts.filter((f) => f.name !== fontName),\n        })),\n    }),\n    {\n      name: \"app-factory-theme\",\n      storage: createJSONStorage(() => localStorage),\n      partialize: (state) => ({\n        theme: state.theme,\n        savedThemes: state.savedThemes,\n        customFonts: state.customFonts,\n      }),\n    }\n  )\n);\n\n// ============================================\n// CSS Variable Injection\n// ============================================\n\n/**\n * Injects theme values as CSS custom properties on the document root.\n */\nfunction injectThemeVariables(theme: ThemeConfig): void {\n  const root = document.documentElement;\n\n  // Inject colors\n  Object.entries(theme.colors).forEach(([category, scale]) => {\n    Object.entries(scale).forEach(([shade, value]) => {\n      root.style.setProperty(`--color-${category}-${shade}`, value as string);\n    });\n  });\n\n  // Inject typography\n  root.style.setProperty(\n    \"--font-family-sans\",\n    theme.typography.fontFamily.sans\n  );\n  root.style.setProperty(\n    \"--font-family-mono\",\n    theme.typography.fontFamily.mono\n  );\n\n  Object.entries(theme.typography.fontSize).forEach(([key, value]) => {\n    root.style.setProperty(`--font-size-${key}`, value);\n  });\n\n  // Inject spacing\n  Object.entries(theme.spacing).forEach(([key, value]) => {\n    root.style.setProperty(`--spacing-${key}`, value);\n  });\n\n  // Inject radius\n  Object.entries(theme.radius).forEach(([key, value]) => {\n    root.style.setProperty(`--radius-${key}`, value);\n  });\n\n  // Inject shadows\n  Object.entries(theme.shadows).forEach(([key, value]) => {\n    root.style.setProperty(`--shadow-${key}`, value);\n  });\n\n  // Set color scheme for native elements\n  root.style.setProperty(\"color-scheme\", theme.mode);\n\n  // Add/remove dark mode class\n  if (theme.mode === \"dark\") {\n    root.classList.add(\"dark\");\n  } else {\n    root.classList.remove(\"dark\");\n  }\n}\n\n/**\n * Generate CSS custom property styles for a theme.\n * Use this to apply a theme to a specific container element (for scoped theming).\n *\n * @param theme - The theme configuration to generate styles for\n * @returns An object with CSS custom properties as style object\n */\nexport function generateThemeStyles(theme: ThemeConfig): React.CSSProperties {\n  const styles: Record<string, string> = {};\n\n  // Inject colors\n  Object.entries(theme.colors).forEach(([category, scale]) => {\n    Object.entries(scale).forEach(([shade, value]) => {\n      styles[`--color-${category}-${shade}`] = value as string;\n    });\n  });\n\n  // Inject typography\n  styles[\"--font-family-sans\"] = theme.typography.fontFamily.sans;\n  styles[\"--font-family-mono\"] = theme.typography.fontFamily.mono;\n\n  Object.entries(theme.typography.fontSize).forEach(([key, value]) => {\n    styles[`--font-size-${key}`] = value;\n  });\n\n  // Inject spacing\n  Object.entries(theme.spacing).forEach(([key, value]) => {\n    styles[`--spacing-${key}`] = value;\n  });\n\n  // Inject radius\n  Object.entries(theme.radius).forEach(([key, value]) => {\n    styles[`--radius-${key}`] = value;\n  });\n\n  // Inject shadows\n  Object.entries(theme.shadows).forEach(([key, value]) => {\n    styles[`--shadow-${key}`] = value;\n  });\n\n  // Set color scheme for native elements\n  styles[\"colorScheme\"] = theme.mode;\n\n  return styles as React.CSSProperties;\n}\n\n// ============================================\n// Theme Context\n// ============================================\n\n/**\n * Theme context for components that need theme access outside React tree.\n */\nconst ThemeContext = createContext<ThemeState | null>(null);\n\n/**\n * Hook to access theme context.\n */\nexport function useTheme(): ThemeState {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    // Fall back to Zustand store if not in provider\n    return useThemeStore.getState();\n  }\n  return context;\n}\n\n// ============================================\n// Theme Provider Component\n// ============================================\n\nexport interface ThemeProviderProps {\n  /** Child components */\n  children: ReactNode;\n  /** Initial theme to use (overrides stored theme) */\n  initialTheme?: Partial<ThemeConfig>;\n  /** Whether to sync with system color scheme preference */\n  syncWithSystem?: boolean;\n}\n\n/**\n * ThemeProvider component.\n *\n * Provides theme context and injects CSS custom properties for real-time\n * theme updates. Wraps the application to enable theme functionality.\n *\n * @example\n * ```tsx\n * <ThemeProvider>\n *   <App />\n * </ThemeProvider>\n *\n * // With system sync\n * <ThemeProvider syncWithSystem>\n *   <App />\n * </ThemeProvider>\n *\n * // With initial theme override\n * <ThemeProvider initialTheme={{ mode: \"dark\" }}>\n *   <App />\n * </ThemeProvider>\n * ```\n */\nexport const ThemeProvider: React.FC<ThemeProviderProps> = ({\n  children,\n  initialTheme,\n  syncWithSystem = false,\n}) => {\n  const store = useThemeStore();\n\n  // Apply initial theme on mount if provided\n  useEffect(() => {\n    if (initialTheme) {\n      store.setTheme(initialTheme);\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Sync with system preference if enabled\n  useEffect(() => {\n    if (!syncWithSystem) return;\n\n    const mediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n\n    const handleChange = (e: MediaQueryListEvent) => {\n      store.setMode(e.matches ? \"dark\" : \"light\");\n    };\n\n    // Set initial mode based on system preference\n    store.setMode(mediaQuery.matches ? \"dark\" : \"light\");\n\n    // Listen for changes\n    mediaQuery.addEventListener(\"change\", handleChange);\n\n    return () => {\n      mediaQuery.removeEventListener(\"change\", handleChange);\n    };\n  }, [syncWithSystem]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Inject CSS variables whenever theme changes\n  useEffect(() => {\n    injectThemeVariables(store.theme);\n  }, [store.theme]);\n\n  // Subscribe to store changes and update CSS variables\n  useEffect(() => {\n    const unsubscribe = useThemeStore.subscribe((state) => {\n      injectThemeVariables(state.theme);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  return (\n    <ThemeContext.Provider value={store}>\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n\nThemeProvider.displayName = \"ThemeProvider\";\n\nexport default ThemeProvider;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\context\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\hooks\\useComponentGenerator.ts","messages":[{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":267,"column":28,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":267,"endColumn":33,"fix":{"range":[10042,10099],"text":"/export\\s+(?:const|function)\\s+(\\w+)/.exec(code)"}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":275,"column":26,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":275,"endColumn":31,"fix":{"range":[10218,10278],"text":"/(?:const|function)\\s+(\\w+)\\s*(?::|=|<)/.exec(code)"}},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":364,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":364,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[12524,12526],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"prefer-const","severity":2,"message":"'code' is never reassigned. Use 'const' instead.","line":367,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":367,"endColumn":13}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * src/hooks/useComponentGenerator.ts\n * ===================================\n * React hook for AI-powered component generation using the configured LLM provider.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D078, D079, D070\n *\n * Traceability: Satisfies GAP-03 (Orphaned AI Backend), GAP-04 (Preview Wiring)\n *\n * NOTE: This hook uses llmService.generateText() which respects user settings\n * (provider, model, API key) from settingsStore.\n */\n\nimport { useState, useCallback } from \"react\";\nimport type {\n  ComponentType,\n  FrameworkTarget,\n  GeneratedComponent,\n} from \"../components/ai/ComponentGenerator\";\nimport { generateText } from \"../services/llmService\";\n\n/**\n * Generation state.\n */\nexport interface GenerationState {\n  /** Whether generation is in progress */\n  isGenerating: boolean;\n  /** Last generated component */\n  generatedComponent: GeneratedComponent | null;\n  /** Error message if generation failed */\n  error: string | null;\n}\n\n/**\n * Hook return type.\n */\nexport interface UseComponentGeneratorReturn {\n  /** Current generation state */\n  state: GenerationState;\n  /** Generate a component from prompt */\n  generate: (\n    prompt: string,\n    type: ComponentType,\n    framework: FrameworkTarget\n  ) => Promise<GeneratedComponent>;\n  /** Clear the generated component */\n  clearGenerated: () => void;\n  /** Clear error */\n  clearError: () => void;\n}\n\n/**\n * Design System Token Reference (D006 - design_tokens.css)\n * =========================================================\n * This constant provides LLM with available Tailwind classes that map to\n * the App Factory design system tokens. All generated components MUST use\n * these classes to satisfy C2 (Strict FE Design System).\n * \n * Traceability: EUR-1.1.3a, D070, C2\n */\nconst DESIGN_TOKEN_REFERENCE = `\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\nDESIGN SYSTEM - EXACT TOKENS (Use ONLY these - others will NOT render)\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\n\nCOLOR MAPPING (User words ÔåÆ Tailwind classes):\nÔöîÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔö¼ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÉ\nÔöé User says   Ôöé Use these EXACT classes                            Ôöé\nÔö£ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔö╝ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöñ\nÔöé blue        Ôöé bg-primary-500, bg-primary-600 (bright blue)       Ôöé\nÔöé yellow      Ôöé bg-amber-400, bg-amber-500, bg-yellow-400          Ôöé\nÔöé orange      Ôöé bg-warning-500, bg-warning-600 (#f59e0b)           Ôöé\nÔöé red         Ôöé bg-error-500, bg-error-600                         Ôöé\nÔöé green       Ôöé bg-success-500, bg-success-600                     Ôöé\nÔöé gray/grey   Ôöé bg-neutral-400, bg-neutral-500                     Ôöé\nÔöé white       Ôöé bg-white, bg-neutral-50                            Ôöé\nÔöé black       Ôöé bg-neutral-900, bg-neutral-950                     Ôöé\nÔöé purple      Ôöé bg-purple-500, bg-purple-600                       Ôöé\nÔöé pink        Ôöé bg-pink-500, bg-pink-600                           Ôöé\nÔööÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔö┤ÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÇÔöÿ\n\nAVAILABLE COLOR SCALES:\n- primary: 50,100,200,300,400,500,600,700,800,900,950 (blue)\n- neutral: 50,100,200,300,400,500,600,700,800,900,950 (gray)\n- success: 50,500,600,700 (green)\n- warning: 50,500,600,700 (orange/amber)\n- error: 50,500,600,700 (red)\n- Standard Tailwind: amber, yellow, purple, pink, etc. all work\n\nTEXT ON COLORS:\n- On dark bg (500+): use text-white\n- On light bg (50-200): use text-neutral-900\n\nSIZING:\n- Small: w-8 h-8, w-10 h-10\n- Medium: w-12 h-12, w-16 h-16\n- Large: w-20 h-20, w-24 h-24\n\nSHAPES:\n- Circle/round: rounded-full\n- Rounded square: rounded-lg, rounded-xl\n- Square: rounded-none\n\nSHADOWS & DEPTH:\n- Flat: (no shadow)\n- Subtle: shadow-sm\n- Elevated: shadow-md, shadow-lg\n- Dramatic: shadow-xl, shadow-2xl\n- Neumorphic: shadow-lg + border + slightly lighter bg\n\nANIMATIONS (for hover/interaction requests):\n- Spin: transition-transform duration-500 hover:rotate-[360deg]\n- Pulse: hover:animate-pulse\n- Bounce: transition-transform duration-300 hover:animate-bounce\n- Jelly/bouncy: transition-all duration-300 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] hover:scale-110 active:scale-90\n- Scale up: transition-transform duration-200 hover:scale-110\n- Scale down (press): active:scale-95\n- Squish/squishy: transition-transform duration-150 hover:scale-110 active:scale-90\n\nSTATES (always include):\n- Hover: hover:bg-{color}-700, hover:scale-105\n- Focus: focus:outline-none focus:ring-2 focus:ring-{color}-500 focus:ring-offset-2\n- Active: active:scale-95\n- Disabled: disabled:opacity-50 disabled:cursor-not-allowed\n\nACCESSIBILITY (MANDATORY):\n- Buttons: aria-label=\"description of what button does\"\n- Good contrast: dark text on light bg, light text on dark bg\n`;\n\n/**\n * Build LLM prompt for component generation.\n * \n * The prompt is designed to produce code that can be compiled at runtime\n * by Sucrase. Key requirements:\n * - No complex TypeScript syntax (generics, type assertions)\n * - Simple parameter types or none at all\n * - Tailwind classes referencing design tokens (C2 compliance)\n * - Self-contained components\n * \n * Traceability: EUR-1.1.3a, D070, C2\n */\nfunction buildPrompt(\n  userPrompt: string,\n  _type: ComponentType,\n  framework: FrameworkTarget\n): string {\n  const frameworkInstructions: Record<FrameworkTarget, string> = {\n    react: `Generate a React functional component using JavaScript.\nIMPORTANT: Do NOT include any TypeScript syntax such as:\n- Type annotations (: string, : number, : Props)\n- Interface or type definitions\n- Generic type parameters (<T>, useState<number>)\n- \"as\" type assertions\nUse plain JavaScript that works directly in the browser.`,\n    vue: \"Generate a Vue 3 component using the Composition API with Tailwind classes.\",\n    svelte: \"Generate a Svelte component with Tailwind classes.\",\n    html: \"Generate HTML with Tailwind CSS classes.\",\n  };\n\n  return `You are a world-class UI component generator. Your output is used in a live preview - it must be PIXEL PERFECT and FULLY FUNCTIONAL.\n\nREQUEST: \"${userPrompt}\"\n\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\nSTEP 1: PARSE THE REQUEST (extract ALL requirements)\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\nBefore generating, identify:\n- SHAPE: round/circle ÔåÆ rounded-full, square ÔåÆ rounded-none, rounded ÔåÆ rounded-lg\n- COLOR: yellow ÔåÆ bg-yellow-400/bg-amber-400, blue ÔåÆ bg-primary-600, etc.\n- SIZE: small/large/specific dimensions\n- BEHAVIOR: hover effects, click actions, animations\n- CONTENT: text label, icon, etc.\n\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\nSTEP 2: APPLY THESE NON-NEGOTIABLE RULES\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\n\nRULE 1 - SINGLE ELEMENT OUTPUT:\nReturn ONLY the requested component. NO wrapper divs, containers, headers, descriptions, or demo UI.\nIf user says \"button\" ÔåÆ return just a <button>\nIf user says \"card\" ÔåÆ return just the card element\n\nRULE 2 - LITERAL IMPLEMENTATION:\nEvery word in the request MUST be reflected in the output:\n- \"yellow\" ÔåÆ bg-yellow-400 or bg-amber-400 (NOT warning - use actual yellow)\n- \"round/circle\" ÔåÆ rounded-full\n- \"spins on hover\" ÔåÆ transition-transform duration-500 hover:rotate-[360deg]\n- \"squishy/squish\" ÔåÆ transition-transform duration-150 hover:scale-110 active:scale-90\n- \"pulses\" ÔåÆ hover:animate-pulse\n- \"on click says X\" ÔåÆ onClick={() => alert('X')}\n- \"neomorphic/neumorphic\" ÔåÆ shadow-lg bg-neutral-100 border border-neutral-200\n\nRULE 3 - TECHNICAL:\n- ${frameworkInstructions[framework]}\n- Tailwind CSS classes ONLY (no inline styles)\n- No imports (React is global)\n- No markdown code fences\n- Use React.useState, React.useCallback, React.useEffect directly\n\nRULE 4 - ACCESSIBILITY:\n- All buttons: aria-label=\"descriptive text\"\n- Focus ring: focus:outline-none focus:ring-2 focus:ring-offset-2\n\nRULE 5 - NO UNWANTED ELEMENTS:\n- If user does NOT mention text/label ÔåÆ button must be EMPTY (no children, self-closing or empty)\n- If user does NOT mention background color ÔåÆ use the color they DID mention\n- ONLY add what is EXPLICITLY requested - nothing more\n- \"jelly\" or \"bouncy\" ÔåÆ MUST use elastic cubic-bezier: ease-[cubic-bezier(0.68,-0.55,0.265,1.55)]\n\n${DESIGN_TOKEN_REFERENCE}\n\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\nEXAMPLES (study the pattern)\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\n\nREQUEST: \"yellow neomorphic button that bounces like jelly on hover\"\nconst JellyNeomorphicButton = () => {\n  return (\n    <button\n      aria-label=\"Jelly neomorphic button\"\n      className=\"w-16 h-16 rounded-xl bg-yellow-400 shadow-lg border border-yellow-300 transition-all duration-300 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] hover:scale-110 active:scale-90 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2\"\n    />\n  );\n};\n\nREQUEST: \"small red circle\"\nconst SmallRedCircle = () => {\n  return (\n    <div\n      aria-label=\"Small red circle\"\n      className=\"w-8 h-8 rounded-full bg-red-500\"\n    />\n  );\n};\n\nREQUEST: \"blue button that spins on hover, on click alerts hello\"\nconst SpinningBlueButton = () => {\n  return (\n    <button\n      aria-label=\"Click to say hello\"\n      onClick={() => alert('hello')}\n      className=\"px-6 py-3 rounded-lg bg-primary-600 text-white font-semibold transition-transform duration-500 hover:rotate-[360deg] focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2\"\n    >\n      HELLO\n    </button>\n  );\n};\n\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ\nNOW GENERATE (code only, no explanation)\nÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉÔòÉ`;\n}\n\n/**\n * Exported design token reference for use in refinement prompts.\n * This ensures consistency between initial generation and refinements.\n */\nexport { DESIGN_TOKEN_REFERENCE };\n\n/**\n * Parse component name from generated code.\n */\nfunction parseComponentName(code: string): string {\n  // Try to find exported component name\n  const exportMatch = code.match(\n    /export\\s+(?:const|function)\\s+(\\w+)/\n  );\n  if (exportMatch) {\n    return exportMatch[1];\n  }\n\n  // Try to find function/const declaration\n  const declMatch = code.match(\n    /(?:const|function)\\s+(\\w+)\\s*(?::|=|<)/\n  );\n  if (declMatch) {\n    return declMatch[1];\n  }\n\n  return \"GeneratedComponent\";\n}\n\n/**\n * Extract error message from various error types.\n * Handles Error instances, Tauri CommandError objects, and unknown types.\n */\nfunction extractErrorMessage(err: unknown): string {\n  // Standard Error instance\n  if (err instanceof Error) {\n    return err.message;\n  }\n\n  // Tauri CommandError object: { code: string, message: string }\n  if (typeof err === \"object\" && err !== null && \"message\" in err) {\n    const msg = (err as { message: string }).message;\n    if (typeof msg === \"string\" && msg.length > 0) {\n      return msg;\n    }\n  }\n\n  // String error\n  if (typeof err === \"string\" && err.length > 0) {\n    return err;\n  }\n\n  return \"Failed to generate component\";\n}\n\n/**\n * Hook for AI-powered component generation.\n *\n * Uses the configured LLM provider (Gemini, Ollama, etc.) from settings\n * to generate UI components from natural language descriptions.\n *\n * @example\n * ```tsx\n * const { state, generate } = useComponentGenerator();\n *\n * const handleGenerate = async () => {\n *   const result = await generate(\"A blue submit button\", \"button\", \"react\");\n *   console.log(result.code);\n * };\n * ```\n */\nexport function useComponentGenerator(): UseComponentGeneratorReturn {\n  const [state, setState] = useState<GenerationState>({\n    isGenerating: false,\n    generatedComponent: null,\n    error: null,\n  });\n\n  /**\n   * Generate a component from prompt.\n   */\n  const generate = useCallback(\n    async (\n      prompt: string,\n      type: ComponentType,\n      framework: FrameworkTarget\n    ): Promise<GeneratedComponent> => {\n      if (!prompt.trim()) {\n        throw new Error(\"Prompt cannot be empty\");\n      }\n\n      setState((prev) => ({\n        ...prev,\n        isGenerating: true,\n        error: null,\n      }));\n\n      try {\n        let code: string;\n\n        // Build the LLM prompt\n        const llmPrompt = buildPrompt(prompt, type, framework);\n\n        // Use the settings-based LLM service (supports Gemini, Ollama, etc.)\n        const result = await generateText(llmPrompt);\n\n        if (!result.success || !result.text) {\n          // If LLM call fails, throw with the actual error message\n          throw new Error(result.error || \"LLM generation failed - no response received\");\n        }\n\n        code = result.text;\n\n        const name = parseComponentName(code);\n\n        const generated: GeneratedComponent = {\n          name,\n          type,\n          framework,\n          code,\n          generatedAt: new Date(),\n          prompt,\n        };\n\n        setState({\n          isGenerating: false,\n          generatedComponent: generated,\n          error: null,\n        });\n\n        return generated;\n      } catch (err) {\n        const errorMsg = extractErrorMessage(err);\n\n        setState((prev) => ({\n          ...prev,\n          isGenerating: false,\n          error: errorMsg,\n        }));\n\n        throw new Error(errorMsg);\n      }\n    },\n    []\n  );\n\n  /**\n   * Clear the generated component.\n   */\n  const clearGenerated = useCallback(() => {\n    setState((prev) => ({\n      ...prev,\n      generatedComponent: null,\n    }));\n  }, []);\n\n  /**\n   * Clear error.\n   */\n  const clearError = useCallback(() => {\n    setState((prev) => ({\n      ...prev,\n      error: null,\n    }));\n  }, []);\n\n  return {\n    state,\n    generate,\n    clearGenerated,\n    clearError,\n  };\n}\n\nexport default useComponentGenerator;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\hooks\\useIpc.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DEFAULT_STATS' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":193,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":193,"endColumn":20},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":220,"column":10,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":220,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'addNotification' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":317,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":317,"endColumn":24},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":433,"column":28,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":433,"endColumn":30,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[11399,11401],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":514,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":514,"endColumn":17},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":537,"column":5,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":537,"endColumn":21,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[13780,13780],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[13780,13780],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":549,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":549,"endColumn":25,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[14082,14082],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[14082,14082],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":620,"column":5,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":620,"endColumn":19,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[15561,15561],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[15561,15561],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise returned in function argument where a void return was expected.","line":621,"column":34,"nodeType":"Identifier","messageId":"voidReturnArgument","endLine":621,"endColumn":45},{"ruleId":"@typescript-eslint/no-unnecessary-type-parameters","severity":2,"message":"Type parameter T is used only once in the function signature.","line":639,"column":28,"nodeType":"TSTypeParameter","messageId":"sole","endLine":639,"endColumn":39,"suggestions":[{"messageId":"replaceUsagesWithConstraint","fix":{"range":[15891,16626],"text":"(\n  method: string,\n  params?: Record<string, unknown>,\n  options?: { enabled?: boolean; refetchInterval?: number }\n): {\n  data: unknown | null;\n  isLoading: boolean;\n  error: string | null;\n  refetch: () => Promise<void>;\n} {\n  const [data, setData] = useState<unknown | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const { enabled = true, refetchInterval } = options || {};\n\n  const fetch = useCallback(async () => {\n    if (!enabled) return;\n    if (!isTauri()) {\n      setError('IPC unavailable: Not running in Tauri environment');\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const result = await invoke<unknown"},"desc":"Replace all usages of type parameter with its constraint."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":653,"column":55,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":653,"endColumn":57,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[16344,16346],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":668,"column":24,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":668,"endColumn":26,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[16681,16683],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":680,"column":5,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":680,"endColumn":13,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[16885,16885],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[16885,16885],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise returned in function argument where a void return was expected.","line":686,"column":34,"nodeType":"Identifier","messageId":"voidReturnArgument","endLine":686,"endColumn":39}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * D078 - src/hooks/useIpc.ts\n * ==========================\n * React hook for IPC communication with the Python subprocess.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D075, D076, D036\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *\n * This hook provides:\n *   - IPC lifecycle management (start/stop)\n *   - Status monitoring and health checks\n *   - Generic IPC call interface\n *   - Batch request support\n *   - Error handling and recovery\n *\n * Usage:\n *   ```tsx\n *   const { status, call, start, stop, isReady } = useIpc();\n *\n *   // Start IPC when component mounts\n *   useEffect(() => { start(); }, [start]);\n *\n *   // Make IPC calls\n *   const result = await call('plugin/list', {});\n *   ```\n */\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { invoke } from \"@tauri-apps/api/tauri\";\nimport { useFactoryStore } from \"../stores/factoryStore\";\nimport { isTauri } from \"../utils/tauriUtils\";\n\n// ============================================\n// TYPES\n// ============================================\n\n/**\n * IPC lifecycle state.\n */\nexport type IpcLifecycleState =\n  | \"uninitialized\"\n  | \"starting\"\n  | \"running\"\n  | \"stopping\"\n  | \"stopped\"\n  | \"error\";\n\n/**\n * IPC health status.\n */\nexport interface IpcHealthStatus {\n  /** Whether the subprocess is healthy */\n  isHealthy: boolean;\n  /** Last latency measurement in ms */\n  lastLatencyMs: number | null;\n  /** Consecutive failure count */\n  failureCount: number;\n  /** Last check timestamp */\n  lastCheckAt: number | null;\n  /** Last error message */\n  lastError: string | null;\n}\n\n/**\n * IPC manager statistics.\n */\nexport interface IpcManagerStats {\n  /** Current lifecycle state */\n  lifecycleState: IpcLifecycleState;\n  /** Health status */\n  healthStatus: IpcHealthStatus;\n  /** Total requests sent */\n  totalRequests: number;\n  /** Successful requests */\n  successfulRequests: number;\n  /** Failed requests */\n  failedRequests: number;\n  /** Average response time in ms */\n  avgResponseTimeMs: number;\n  /** Subprocess uptime in seconds */\n  uptimeSeconds: number;\n  /** Respawn count */\n  respawnCount: number;\n}\n\n/**\n * IPC call options.\n */\nexport interface IpcCallOptions {\n  /** Timeout in milliseconds */\n  timeout?: number;\n  /** Retry count on failure */\n  retries?: number;\n  /** Show loading indicator */\n  showLoading?: boolean;\n  /** Loading message */\n  loadingMessage?: string;\n}\n\n/**\n * Batch request item.\n */\nexport interface BatchRequest {\n  /** Method name */\n  method: string;\n  /** Method parameters */\n  params?: Record<string, unknown>;\n}\n\n/**\n * Batch result item.\n */\nexport interface BatchResult {\n  /** Whether request succeeded */\n  success: boolean;\n  /** Result data if successful */\n  result?: unknown;\n  /** Error if failed */\n  error?: {\n    code: string;\n    message: string;\n  };\n}\n\n/**\n * Command error from Rust backend.\n */\nexport interface CommandError {\n  /** Error code */\n  code: string;\n  /** Error message */\n  message: string;\n  /** Additional details */\n  details?: Record<string, unknown>;\n}\n\n/**\n * IPC hook return type.\n */\nexport interface UseIpcReturn {\n  /** Current IPC status */\n  status: IpcLifecycleState;\n  /** Health information */\n  health: IpcHealthStatus;\n  /** Manager statistics */\n  stats: IpcManagerStats | null;\n  /** Whether IPC is ready for requests */\n  isReady: boolean;\n  /** Whether IPC is starting */\n  isStarting: boolean;\n  /** Whether a call is in progress */\n  isLoading: boolean;\n  /** Last error */\n  error: string | null;\n  /** Start IPC */\n  start: () => Promise<void>;\n  /** Stop IPC */\n  stop: () => Promise<void>;\n  /** Make IPC call */\n  call: <T = unknown>(\n    method: string,\n    params?: Record<string, unknown>,\n    options?: IpcCallOptions\n  ) => Promise<T>;\n  /** Make batch IPC calls */\n  batch: (requests: BatchRequest[]) => Promise<BatchResult[]>;\n  /** Check health */\n  checkHealth: () => Promise<IpcHealthStatus>;\n  /** Ping subprocess */\n  ping: () => Promise<boolean>;\n  /** Refresh status */\n  refreshStatus: () => Promise<void>;\n  /** Clear error */\n  clearError: () => void;\n}\n\n// ============================================\n// DEFAULT VALUES\n// ============================================\n\nconst DEFAULT_HEALTH: IpcHealthStatus = {\n  isHealthy: false,\n  lastLatencyMs: null,\n  failureCount: 0,\n  lastCheckAt: null,\n  lastError: null,\n};\n\nconst DEFAULT_STATS: IpcManagerStats = {\n  lifecycleState: \"uninitialized\",\n  healthStatus: DEFAULT_HEALTH,\n  totalRequests: 0,\n  successfulRequests: 0,\n  failedRequests: 0,\n  avgResponseTimeMs: 0,\n  uptimeSeconds: 0,\n  respawnCount: 0,\n};\n\n// ============================================\n// HELPER FUNCTIONS\n// ============================================\n\n/**\n * Parse lifecycle state from backend response.\n */\nfunction parseLifecycleState(state: string): IpcLifecycleState {\n  const stateMap: Record<string, IpcLifecycleState> = {\n    Uninitialized: \"uninitialized\",\n    Starting: \"starting\",\n    Running: \"running\",\n    Stopping: \"stopping\",\n    Stopped: \"stopped\",\n    Error: \"error\",\n  };\n  return stateMap[state] || \"uninitialized\";\n}\n\n/**\n * Parse health status from backend response.\n */\nfunction parseHealthStatus(data: Record<string, unknown>): IpcHealthStatus {\n  return {\n    isHealthy: Boolean(data.is_healthy ?? data.isHealthy ?? false),\n    lastLatencyMs: (data.last_latency_ms ?? data.lastLatencyMs ?? null) as number | null,\n    failureCount: (data.failure_count ?? data.failureCount ?? 0) as number,\n    lastCheckAt: (data.last_check_at ?? data.lastCheckAt ?? null) as number | null,\n    lastError: (data.last_error ?? data.lastError ?? null) as string | null,\n  };\n}\n\n/**\n * Parse manager stats from backend response.\n */\nfunction parseManagerStats(data: Record<string, unknown>): IpcManagerStats {\n  const healthData = (data.health_status ?? data.healthStatus ?? {}) as Record<string, unknown>;\n  return {\n    lifecycleState: parseLifecycleState(\n      (data.lifecycle_state ?? data.lifecycleState ?? \"uninitialized\") as string\n    ),\n    healthStatus: parseHealthStatus(healthData),\n    totalRequests: (data.total_requests ?? data.totalRequests ?? 0) as number,\n    successfulRequests: (data.successful_requests ?? data.successfulRequests ?? 0) as number,\n    failedRequests: (data.failed_requests ?? data.failedRequests ?? 0) as number,\n    avgResponseTimeMs: (data.avg_response_time_ms ?? data.avgResponseTimeMs ?? 0) as number,\n    uptimeSeconds: (data.uptime_seconds ?? data.uptimeSeconds ?? 0) as number,\n    respawnCount: (data.respawn_count ?? data.respawnCount ?? 0) as number,\n  };\n}\n\n/**\n * Convert command error to string.\n */\nfunction errorToString(error: unknown): string {\n  if (typeof error === \"string\") return error;\n  if (error && typeof error === \"object\") {\n    const err = error as CommandError;\n    if (err.message) return `[${err.code || \"ERROR\"}] ${err.message}`;\n  }\n  return String(error);\n}\n\n// ============================================\n// HOOK IMPLEMENTATION\n// ============================================\n\n/**\n * React hook for IPC communication with Python subprocess.\n *\n * Provides lifecycle management, status monitoring, and call interface\n * for communicating with the plugin host via Tauri commands.\n *\n * @example\n * ```tsx\n * function App() {\n *   const { status, call, start, isReady } = useIpc();\n *\n *   useEffect(() => {\n *     start();\n *   }, [start]);\n *\n *   const handleClick = async () => {\n *     if (!isReady) return;\n *     const plugins = await call('plugin/list');\n *     console.log(plugins);\n *   };\n *\n *   return (\n *     <div>\n *       <p>IPC Status: {status}</p>\n *       <button onClick={handleClick} disabled={!isReady}>\n *         List Plugins\n *       </button>\n *     </div>\n *   );\n * }\n * ```\n */\nexport function useIpc(): UseIpcReturn {\n  // State\n  const [status, setStatus] = useState<IpcLifecycleState>(\"uninitialized\");\n  const [health, setHealth] = useState<IpcHealthStatus>(DEFAULT_HEALTH);\n  const [stats, setStats] = useState<IpcManagerStats | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Refs for cleanup\n  const statusIntervalRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  const mountedRef = useRef(true);\n\n  // Factory store integration\n  const setFactoryLoading = useFactoryStore((state) => state.setLoading);\n  const addNotification = useFactoryStore((state) => state.addNotification);\n\n  /**\n   * Start the IPC manager.\n   */\n  const start = useCallback(async () => {\n    if (status === \"running\" || status === \"starting\") return;\n    if (!isTauri()) {\n      console.warn('[useIpc] start: Not in Tauri environment, skipping');\n      return;\n    }\n\n    try {\n      setStatus(\"starting\");\n      setError(null);\n\n      await invoke(\"ipc_start\");\n\n      if (mountedRef.current) {\n        setStatus(\"running\");\n        setHealth((prev) => ({ ...prev, isHealthy: true }));\n      }\n    } catch (err) {\n      const errorMsg = errorToString(err);\n      if (mountedRef.current) {\n        setStatus(\"error\");\n        setError(errorMsg);\n        setHealth((prev) => ({ ...prev, isHealthy: false, lastError: errorMsg }));\n      }\n      throw err;\n    }\n  }, [status]);\n\n  /**\n   * Stop the IPC manager.\n   */\n  const stop = useCallback(async () => {\n    if (status === \"stopped\" || status === \"stopping\") return;\n    if (!isTauri()) {\n      console.warn('[useIpc] stop: Not in Tauri environment, skipping');\n      return;\n    }\n\n    try {\n      setStatus(\"stopping\");\n      setError(null);\n\n      await invoke(\"ipc_stop\");\n\n      if (mountedRef.current) {\n        setStatus(\"stopped\");\n        setHealth(DEFAULT_HEALTH);\n      }\n    } catch (err) {\n      const errorMsg = errorToString(err);\n      if (mountedRef.current) {\n        setStatus(\"error\");\n        setError(errorMsg);\n      }\n      throw err;\n    }\n  }, [status]);\n\n  /**\n   * Make an IPC call.\n   */\n  const call = useCallback(\n    async <T = unknown>(\n      method: string,\n      params: Record<string, unknown> = {},\n      options: IpcCallOptions = {}\n    ): Promise<T> => {\n      if (!isTauri()) {\n        throw new Error('IPC call unavailable: Not running in Tauri environment');\n      }\n      const { showLoading = false, loadingMessage = \"Processing...\" } = options;\n\n      try {\n        if (showLoading) {\n          setIsLoading(true);\n          setFactoryLoading(true, loadingMessage);\n        }\n\n        const result = await invoke<T>(\"ipc_call\", {\n          method,\n          params,\n        });\n\n        return result;\n      } catch (err) {\n        const errorMsg = errorToString(err);\n        setError(errorMsg);\n        throw err;\n      } finally {\n        if (showLoading) {\n          setIsLoading(false);\n          setFactoryLoading(false);\n        }\n      }\n    },\n    [setFactoryLoading]\n  );\n\n  /**\n   * Make batch IPC calls.\n   */\n  const batch = useCallback(async (requests: BatchRequest[]): Promise<BatchResult[]> => {\n    if (!isTauri()) {\n      throw new Error('IPC batch unavailable: Not running in Tauri environment');\n    }\n    try {\n      setIsLoading(true);\n\n      const results = await invoke<BatchResult[]>(\"ipc_batch\", {\n        requests: requests.map((r) => ({\n          method: r.method,\n          params: r.params || {},\n        })),\n      });\n\n      return results;\n    } catch (err) {\n      const errorMsg = errorToString(err);\n      setError(errorMsg);\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  /**\n   * Check subprocess health.\n   */\n  const checkHealth = useCallback(async (): Promise<IpcHealthStatus> => {\n    if (!isTauri()) {\n      return { ...DEFAULT_HEALTH, lastError: 'Not in Tauri environment' };\n    }\n    try {\n      const result = await invoke<Record<string, unknown>>(\"health_check\");\n      const healthStatus = parseHealthStatus(result);\n\n      if (mountedRef.current) {\n        setHealth(healthStatus);\n      }\n\n      return healthStatus;\n    } catch (err) {\n      const errorMsg = errorToString(err);\n      const unhealthyStatus: IpcHealthStatus = {\n        ...DEFAULT_HEALTH,\n        isHealthy: false,\n        lastError: errorMsg,\n        lastCheckAt: Date.now(),\n      };\n\n      if (mountedRef.current) {\n        setHealth(unhealthyStatus);\n      }\n\n      return unhealthyStatus;\n    }\n  }, []);\n\n  /**\n   * Ping the subprocess.\n   */\n  const ping = useCallback(async (): Promise<boolean> => {\n    if (!isTauri()) {\n      return false;\n    }\n    try {\n      await invoke(\"ping\");\n      return true;\n    } catch {\n      return false;\n    }\n  }, []);\n\n  /**\n   * Refresh status from backend.\n   */\n  const refreshStatus = useCallback(async () => {\n    if (!isTauri()) {\n      // Not in Tauri - set safe defaults\n      setStatus(\"stopped\");\n      setHealth(DEFAULT_HEALTH);\n      return;\n    }\n    try {\n      const result = await invoke<Record<string, unknown>>(\"ipc_status\");\n      const managerStats = parseManagerStats(result);\n\n      if (mountedRef.current) {\n        setStats(managerStats);\n        setStatus(managerStats.lifecycleState);\n        setHealth(managerStats.healthStatus);\n      }\n    } catch (err) {\n      // Status check failed - subprocess might not be running\n      if (mountedRef.current) {\n        setStatus(\"uninitialized\");\n        setHealth(DEFAULT_HEALTH);\n      }\n    }\n  }, []);\n\n  /**\n   * Clear error state.\n   */\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  // Check if IPC is ready\n  const isReady = status === \"running\" && health.isHealthy;\n  const isStarting = status === \"starting\";\n\n  // Initial status check on mount\n  useEffect(() => {\n    mountedRef.current = true;\n    refreshStatus();\n\n    return () => {\n      mountedRef.current = false;\n    };\n  }, [refreshStatus]);\n\n  // Periodic status polling when running\n  useEffect(() => {\n    if (status === \"running\") {\n      // Poll every 5 seconds while running\n      statusIntervalRef.current = setInterval(() => {\n        refreshStatus();\n      }, 5000);\n    }\n\n    return () => {\n      if (statusIntervalRef.current) {\n        clearInterval(statusIntervalRef.current);\n        statusIntervalRef.current = null;\n      }\n    };\n  }, [status, refreshStatus]);\n\n  return {\n    status,\n    health,\n    stats,\n    isReady,\n    isStarting,\n    isLoading,\n    error,\n    start,\n    stop,\n    call,\n    batch,\n    checkHealth,\n    ping,\n    refreshStatus,\n    clearError,\n  };\n}\n\n// ============================================\n// SPECIALIZED HOOKS\n// ============================================\n\n/**\n * Hook for IPC status only (lightweight).\n */\nexport function useIpcStatus(): {\n  status: IpcLifecycleState;\n  isReady: boolean;\n  health: IpcHealthStatus;\n} {\n  const [status, setStatus] = useState<IpcLifecycleState>(\"uninitialized\");\n  const [health, setHealth] = useState<IpcHealthStatus>(DEFAULT_HEALTH);\n\n  useEffect(() => {\n    let mounted = true;\n\n    const checkStatus = async () => {\n      if (!isTauri()) {\n        if (mounted) {\n          setStatus(\"stopped\");\n          setHealth(DEFAULT_HEALTH);\n        }\n        return;\n      }\n      try {\n        const ready = await invoke<boolean>(\"ipc_ready\");\n        if (mounted) {\n          setStatus(ready ? \"running\" : \"stopped\");\n          setHealth((prev) => ({ ...prev, isHealthy: ready }));\n        }\n      } catch {\n        if (mounted) {\n          setStatus(\"uninitialized\");\n          setHealth(DEFAULT_HEALTH);\n        }\n      }\n    };\n\n    checkStatus();\n    const interval = setInterval(checkStatus, 10000);\n\n    return () => {\n      mounted = false;\n      clearInterval(interval);\n    };\n  }, []);\n\n  return {\n    status,\n    isReady: status === \"running\" && health.isHealthy,\n    health,\n  };\n}\n\n/**\n * Hook for making single IPC calls.\n */\nexport function useIpcCall<T = unknown>(\n  method: string,\n  params?: Record<string, unknown>,\n  options?: { enabled?: boolean; refetchInterval?: number }\n): {\n  data: T | null;\n  isLoading: boolean;\n  error: string | null;\n  refetch: () => Promise<void>;\n} {\n  const [data, setData] = useState<T | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const { enabled = true, refetchInterval } = options || {};\n\n  const fetch = useCallback(async () => {\n    if (!enabled) return;\n    if (!isTauri()) {\n      setError('IPC unavailable: Not running in Tauri environment');\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const result = await invoke<T>(\"ipc_call\", {\n        method,\n        params: params || {},\n      });\n\n      setData(result);\n    } catch (err) {\n      setError(errorToString(err));\n    } finally {\n      setIsLoading(false);\n    }\n  }, [method, params, enabled]);\n\n  useEffect(() => {\n    fetch();\n  }, [fetch]);\n\n  useEffect(() => {\n    if (!refetchInterval || !enabled) return;\n\n    const interval = setInterval(fetch, refetchInterval);\n    return () => clearInterval(interval);\n  }, [refetchInterval, enabled, fetch]);\n\n  return {\n    data,\n    isLoading,\n    error,\n    refetch: fetch,\n  };\n}\n\nexport default useIpc;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\hooks\\usePlugin.ts","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":53,"column":11,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":56,"endColumn":5,"fix":{"range":[1660,1709],"text":"{\n    path: string;\n    error: string;\n  }[]"}},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'data.id || data.name || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":183,"column":16,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":183,"endColumn":42},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":183,"column":24,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":183,"endColumn":26,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[4977,4997],"text":"(data.id ?? data.name)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":183,"column":37,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":183,"endColumn":39,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[4998,5000],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'data.name || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":184,"column":18,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":184,"endColumn":33},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":184,"column":28,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":184,"endColumn":30,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5033,5035],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'data.version || \"1.0.0\"' will use Object's default stringification format ('[object Object]') when stringified.","line":185,"column":21,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":185,"endColumn":44},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":185,"column":34,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":185,"endColumn":36,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5074,5076],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'data.description || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":186,"column":25,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":186,"endColumn":47},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":186,"column":42,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":186,"endColumn":44,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5128,5130],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'data.author || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":187,"column":20,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":187,"endColumn":37},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":187,"column":32,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":187,"endColumn":34,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5167,5169],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":188,"column":30,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":188,"endColumn":32,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5204,5206],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'data.contract || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":189,"column":22,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":189,"endColumn":41},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":189,"column":36,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":189,"endColumn":38,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5283,5285],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'data.entry_point || data.entryPoint || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":190,"column":24,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":190,"endColumn":65},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":190,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":190,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5314,5349],"text":"(data.entry_point ?? data.entryPoint)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":190,"column":60,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":190,"endColumn":62,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5350,5352],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of type `any[]` to a variable of type `string[]`.","line":191,"column":5,"nodeType":"Property","messageId":"unsafeAssignment","endLine":191,"endColumn":76},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of type `any[]` to a variable of type `string[]`.","line":192,"column":5,"nodeType":"Property","messageId":"unsafeAssignment","endLine":192,"endColumn":52},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":196,"column":44,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":196,"endColumn":46,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[5678,5680],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'method.name || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":209,"column":20,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":209,"endColumn":37},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":209,"column":32,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":209,"endColumn":34,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6005,6007],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'method.description || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":210,"column":27,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":210,"endColumn":51},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":210,"column":46,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":210,"endColumn":48,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6058,6060],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'p.name || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":213,"column":24,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":213,"endColumn":36},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":213,"column":31,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":213,"endColumn":33,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6214,6216],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'p.type || \"any\"' will use Object's default stringification format ('[object Object]') when stringified.","line":214,"column":24,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":214,"endColumn":39},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":214,"column":31,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":214,"endColumn":33,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6252,6254],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'method.return_type || method.returnType || \"void\"' will use Object's default stringification format ('[object Object]') when stringified.","line":219,"column":26,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":219,"endColumn":75},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":219,"column":45,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":219,"endColumn":47,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6385,6424],"text":"(method.return_type ?? method.returnType)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":219,"column":66,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":219,"endColumn":68,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6425,6427],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'config.key || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":234,"column":19,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":234,"endColumn":35},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":234,"column":30,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":234,"endColumn":32,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6778,6780],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'config.label || config.key || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":235,"column":21,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":235,"endColumn":53},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":235,"column":34,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":235,"endColumn":36,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6806,6832],"text":"(config.label ?? config.key)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":235,"column":48,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":235,"endColumn":50,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6833,6835],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":236,"column":26,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":236,"endColumn":28,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6866,6868],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":240,"column":34,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":240,"endColumn":73,"fix":{"range":[7112,7151],"text":"{ value: string; label: string }[]"}},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":250,"column":13,"nodeType":"CallExpression","messageId":"invalidType","endLine":250,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'clearPlugins' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":325,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":325,"endColumn":21},{"ruleId":"@typescript-eslint/no-unnecessary-type-conversion","severity":2,"message":"Passing a string to String() does not change the type or value of the string.","line":360,"column":22,"nodeType":"Identifier","messageId":"unnecessaryTypeConversion","endLine":360,"endColumn":28,"suggestions":[{"messageId":"suggestRemove","fix":{"range":[11346,11415],"text":"((result.paths as Record<string, string>)?.[manifest.id] || \"\")"},"desc":"Remove the type conversion."},{"messageId":"suggestSatisfies","data":{"type":"string"},"fix":{"range":[11346,11415],"text":"((result.paths as Record<string, string>)?.[manifest.id] || \"\") satisfies string"},"desc":"Instead, assert that the value satisfies the string type."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":360,"column":69,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":360,"endColumn":71,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[11393,11395],"text":""},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":368,"column":31,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":368,"endColumn":69,"fix":{"range":[11638,11676],"text":"{ path: string; error: string }[]"}},{"ruleId":"@typescript-eslint/no-unnecessary-type-conversion","severity":2,"message":"Passing a string to String() does not change the type or value of the string.","line":406,"column":22,"nodeType":"Identifier","messageId":"unnecessaryTypeConversion","endLine":406,"endColumn":28,"suggestions":[{"messageId":"suggestRemove","fix":{"range":[12744,12813],"text":"((result.paths as Record<string, string>)?.[manifest.id] || \"\")"},"desc":"Remove the type conversion."},{"messageId":"suggestSatisfies","data":{"type":"string"},"fix":{"range":[12744,12813],"text":"((result.paths as Record<string, string>)?.[manifest.id] || \"\") satisfies string"},"desc":"Instead, assert that the value satisfies the string type."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":406,"column":69,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":406,"endColumn":71,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[12791,12793],"text":""},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":414,"column":34,"nodeType":"MemberExpression","messageId":"invalidType","endLine":414,"endColumn":51},{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":423,"column":31,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":423,"endColumn":69,"fix":{"range":[13258,13296],"text":"{ path: string; error: string }[]"}},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":455,"column":45,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":455,"endColumn":47,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[14149,14151],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'pluginData.path || \"\"' will use Object's default stringification format ('[object Object]') when stringified.","line":456,"column":31,"nodeType":"LogicalExpression","messageId":"baseToString","endLine":456,"endColumn":52},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":456,"column":47,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":456,"endColumn":49,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[14233,14235],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":459,"column":15,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":459,"endColumn":36},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":500,"column":39,"nodeType":"TSAsExpression","messageId":"alwaysTruthy","endLine":500,"endColumn":66},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":501,"column":44,"nodeType":"TSAsExpression","messageId":"alwaysTruthy","endLine":501,"endColumn":70},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":736,"column":14,"nodeType":"ChainExpression","messageId":"alwaysTruthy","endLine":736,"endColumn":39},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":736,"column":31,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":736,"endColumn":33,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[21513,21515],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":788,"column":47,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":788,"endColumn":49,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22913,22956],"text":"(result.response_time ?? result.responseTime)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":788,"column":70,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":788,"endColumn":72,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[22957,22959],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":789,"column":32,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":789,"endColumn":34,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[23015,23017],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":790,"column":47,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":790,"endColumn":49,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[23067,23110],"text":"(result.failure_count ?? result.failureCount)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":790,"column":70,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":790,"endColumn":72,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[23111,23113],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":805,"column":43,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":805,"endColumn":45,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[23559,23561],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":832,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":832,"endColumn":47,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[24198,24198],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[24198,24198],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":897,"column":7,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":897,"endColumn":25,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[25741,25741],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[25741,25741],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":966,"column":26,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":966,"endColumn":28,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[27257,27259],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":967,"column":19,"nodeType":"ChainExpression","messageId":"alwaysTruthy","endLine":967,"endColumn":34},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":967,"column":25,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":967,"endColumn":27,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[27304,27306],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":968,"column":18,"nodeType":"ChainExpression","messageId":"alwaysTruthy","endLine":968,"endColumn":32},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":968,"column":24,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":968,"endColumn":26,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[27344,27346],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":969,"column":18,"nodeType":"ChainExpression","messageId":"alwaysTruthy","endLine":969,"endColumn":32},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":969,"column":24,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":969,"endColumn":26,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[27383,27385],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1025,"column":61,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1025,"endColumn":63,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[28811,28813],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1033,"column":75,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1033,"endColumn":77,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[29031,29049],"text":"(invokeArgs ?? args)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1033,"column":83,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1033,"endColumn":85,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[29050,29052],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":1049,"column":7,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":1049,"endColumn":16,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[29406,29406],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[29406,29406],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-misused-promises","severity":2,"message":"Promise returned in function argument where a void return was expected.","line":1056,"column":34,"nodeType":"Identifier","messageId":"voidReturnArgument","endLine":1056,"endColumn":40}],"suppressedMessages":[],"errorCount":76,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"/**\n * D079 - src/hooks/usePlugin.ts\n * =============================\n * React hook for plugin management operations.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D075, D076, D077, D078\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *\n * This hook provides:\n *   - Plugin discovery and listing\n *   - Plugin loading/unloading\n *   - Plugin method invocation\n *   - Hot-swap functionality\n *   - Health monitoring\n *   - Configuration management\n *\n * Usage:\n *   ```tsx\n *   const { plugins, loadPlugin, invokeMethod } = usePlugin();\n *\n *   // Load a plugin\n *   await loadPlugin('tts_kokoro');\n *\n *   // Call plugin method\n *   const audio = await invokeMethod('tts_kokoro', 'synthesize', { text: 'Hello' });\n *   ```\n */\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { invoke } from \"@tauri-apps/api/tauri\";\nimport { usePluginStore, type Plugin, type PluginManifest, type PluginMethod, type PluginConfigOption, type PluginHealth, type PluginInvocationResult } from \"../stores/pluginStore\";\nimport { useFactoryStore } from \"../stores/factoryStore\";\nimport { useIpc } from \"./useIpc\";\nimport { isTauri } from \"../utils/tauriUtils\";\n\n// ============================================\n// TYPES\n// ============================================\n\n/**\n * Plugin discovery result.\n */\nexport interface DiscoveryResult {\n  /** Number of plugins found */\n  count: number;\n  /** Discovered plugin manifests */\n  plugins: PluginManifest[];\n  /** Errors encountered during discovery */\n  errors: Array<{\n    path: string;\n    error: string;\n  }>;\n}\n\n/**\n * Plugin load result.\n */\nexport interface LoadResult {\n  /** Whether load succeeded */\n  success: boolean;\n  /** Plugin ID */\n  pluginId: string;\n  /** Available methods after loading */\n  methods: PluginMethod[];\n  /** Configuration options */\n  config: PluginConfigOption[];\n  /** Error message if failed */\n  error?: string;\n}\n\n/**\n * Plugin method invocation options.\n */\nexport interface InvokeOptions {\n  /** Timeout in milliseconds */\n  timeout?: number;\n  /** Show loading indicator */\n  showLoading?: boolean;\n  /** Loading message */\n  loadingMessage?: string;\n  /** Track in invocation history */\n  trackHistory?: boolean;\n}\n\n/**\n * Hot-swap result.\n */\nexport interface SwapResult {\n  /** Whether swap succeeded */\n  success: boolean;\n  /** Old plugin ID */\n  oldPluginId: string;\n  /** New plugin ID */\n  newPluginId: string;\n  /** Error message if failed */\n  error?: string;\n}\n\n/**\n * Plugin hook return type.\n */\nexport interface UsePluginReturn {\n  /** All plugins */\n  plugins: Record<string, Plugin>;\n  /** Selected plugin */\n  selectedPlugin: Plugin | null;\n  /** Whether discovery is in progress */\n  isDiscovering: boolean;\n  /** Loading plugin IDs */\n  loadingPlugins: Set<string>;\n  /** Invocation history */\n  invocationHistory: PluginInvocationResult[];\n  /** Health monitoring active */\n  healthMonitoringActive: boolean;\n\n  // Discovery\n  /** Discover available plugins */\n  discoverPlugins: () => Promise<DiscoveryResult>;\n  /** Scan for new plugins */\n  scanPlugins: () => Promise<DiscoveryResult>;\n  /** Refresh plugin list */\n  refreshPlugins: () => Promise<void>;\n\n  // Lifecycle\n  /** Load a plugin */\n  loadPlugin: (pluginId: string) => Promise<LoadResult>;\n  /** Unload a plugin */\n  unloadPlugin: (pluginId: string) => Promise<void>;\n  /** Hot-swap plugins */\n  swapPlugin: (oldPluginId: string, newPluginId: string) => Promise<SwapResult>;\n\n  // Invocation\n  /** Invoke a plugin method */\n  invokeMethod: <T = unknown>(\n    pluginId: string,\n    method: string,\n    args?: Record<string, unknown>,\n    options?: InvokeOptions\n  ) => Promise<T>;\n\n  // Selection\n  /** Select a plugin */\n  selectPlugin: (pluginId: string | null) => void;\n\n  // Configuration\n  /** Get plugin configuration */\n  getPluginConfig: (pluginId: string) => PluginConfigOption[];\n  /** Update plugin configuration */\n  updatePluginConfig: (pluginId: string, key: string, value: unknown) => Promise<void>;\n\n  // Health\n  /** Start health monitoring */\n  startHealthMonitoring: () => void;\n  /** Stop health monitoring */\n  stopHealthMonitoring: () => void;\n  /** Check plugin health */\n  checkPluginHealth: (pluginId: string) => Promise<PluginHealth>;\n\n  // Utility\n  /** Get plugin by ID */\n  getPlugin: (pluginId: string) => Plugin | undefined;\n  /** Get plugins by category */\n  getPluginsByCategory: (category: string) => Plugin[];\n  /** Get active plugins */\n  getActivePlugins: () => Plugin[];\n  /** Clear invocation history */\n  clearInvocationHistory: () => void;\n}\n\n// ============================================\n// HELPER FUNCTIONS\n// ============================================\n\n/**\n * Parse plugin manifest from backend response.\n */\nfunction parseManifest(data: Record<string, unknown>): PluginManifest {\n  return {\n    id: String(data.id || data.name || \"\"),\n    name: String(data.name || \"\"),\n    version: String(data.version || \"1.0.0\"),\n    description: String(data.description || \"\"),\n    author: String(data.author || \"\"),\n    category: (data.category || \"custom\") as PluginManifest[\"category\"],\n    contract: String(data.contract || \"\"),\n    entryPoint: String(data.entry_point || data.entryPoint || \"\"),\n    dependencies: Array.isArray(data.dependencies) ? data.dependencies : [],\n    tags: Array.isArray(data.tags) ? data.tags : [],\n    icon: data.icon as string | undefined,\n    license: data.license as string | undefined,\n    repository: data.repository as string | undefined,\n    minHostVersion: (data.min_host_version || data.minHostVersion) as string | undefined,\n  };\n}\n\n/**\n * Parse plugin methods from backend response.\n */\nfunction parseMethods(data: unknown[]): PluginMethod[] {\n  if (!Array.isArray(data)) return [];\n\n  return data.map((m) => {\n    const method = m as Record<string, unknown>;\n    return {\n      name: String(method.name || \"\"),\n      description: String(method.description || \"\"),\n      parameters: Array.isArray(method.parameters)\n        ? method.parameters.map((p: Record<string, unknown>) => ({\n          name: String(p.name || \"\"),\n          type: String(p.type || \"any\"),\n          required: Boolean(p.required),\n          default: p.default,\n        }))\n        : [],\n      returnType: String(method.return_type || method.returnType || \"void\"),\n      async: Boolean(method.async),\n    };\n  });\n}\n\n/**\n * Parse plugin config options from backend response.\n */\nfunction parseConfigOptions(data: unknown[]): PluginConfigOption[] {\n  if (!Array.isArray(data)) return [];\n\n  return data.map((c) => {\n    const config = c as Record<string, unknown>;\n    return {\n      key: String(config.key || \"\"),\n      label: String(config.label || config.key || \"\"),\n      type: (config.type || \"string\") as PluginConfigOption[\"type\"],\n      value: config.value,\n      defaultValue: config.default_value ?? config.defaultValue ?? config.value,\n      description: config.description as string | undefined,\n      options: config.options as Array<{ value: string; label: string }> | undefined,\n      validation: config.validation as PluginConfigOption[\"validation\"] | undefined,\n    };\n  });\n}\n\n/**\n * Generate unique ID.\n */\nfunction generateId(): string {\n  return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n\n// ============================================\n// HOOK IMPLEMENTATION\n// ============================================\n\n/**\n * React hook for plugin management.\n *\n * Provides comprehensive plugin lifecycle management including\n * discovery, loading, unloading, method invocation, and health monitoring.\n *\n * @example\n * ```tsx\n * function PluginPanel() {\n *   const {\n *     plugins,\n *     loadPlugin,\n *     invokeMethod,\n *     discoverPlugins,\n *   } = usePlugin();\n *\n *   useEffect(() => {\n *     discoverPlugins();\n *   }, [discoverPlugins]);\n *\n *   const handleLoad = async (id: string) => {\n *     const result = await loadPlugin(id);\n *     if (result.success) {\n *       console.log('Plugin loaded with methods:', result.methods);\n *     }\n *   };\n *\n *   const handleSynthesize = async () => {\n *     const audio = await invokeMethod('tts_kokoro', 'synthesize', {\n *       text: 'Hello world',\n *       voice: 'af_bella',\n *     });\n *   };\n *\n *   return (\n *     <div>\n *       {Object.values(plugins).map((plugin) => (\n *         <div key={plugin.manifest.id}>\n *           {plugin.manifest.name} - {plugin.status}\n *         </div>\n *       ))}\n *     </div>\n *   );\n * }\n * ```\n */\nexport function usePlugin(): UsePluginReturn {\n  // Store access\n  const plugins = usePluginStore((state) => state.plugins);\n  const selectedPluginId = usePluginStore((state) => state.selectedPluginId);\n  const isDiscovering = usePluginStore((state) => state.isDiscovering);\n  const loadingPlugins = usePluginStore((state) => state.loadingPlugins);\n  const invocationHistory = usePluginStore((state) => state.invocationHistory);\n  const healthMonitoringActive = usePluginStore((state) => state.healthMonitoringActive);\n  const healthCheckInterval = usePluginStore((state) => state.healthCheckInterval);\n\n  // Store actions\n  const setDiscovering = usePluginStore((state) => state.setDiscovering);\n  const addDiscoveredPlugin = usePluginStore((state) => state.addDiscoveredPlugin);\n  const setPluginStatus = usePluginStore((state) => state.setPluginStatus);\n  const setPluginMethods = usePluginStore((state) => state.setPluginMethods);\n  const setPluginConfig = usePluginStore((state) => state.setPluginConfig);\n  const updatePluginConfigValue = usePluginStore((state) => state.updatePluginConfigValue);\n  const updatePluginHealth = usePluginStore((state) => state.updatePluginHealth);\n  const setHealthMonitoring = usePluginStore((state) => state.setHealthMonitoring);\n  const storeSelectPlugin = usePluginStore((state) => state.selectPlugin);\n  const addInvocationResult = usePluginStore((state) => state.addInvocationResult);\n  const storeClearHistory = usePluginStore((state) => state.clearInvocationHistory);\n  const clearPlugins = usePluginStore((state) => state.clearPlugins);\n\n  // Factory store for notifications\n  const addNotification = useFactoryStore((state) => state.addNotification);\n  const setLoading = useFactoryStore((state) => state.setLoading);\n\n  // IPC hook\n  const { isReady: ipcReady } = useIpc();\n\n  // Health monitoring interval ref\n  const healthIntervalRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  const mountedRef = useRef(true);\n\n  // Selected plugin\n  const selectedPlugin = selectedPluginId ? plugins[selectedPluginId] : null;\n\n  /**\n   * Discover available plugins.\n   */\n  const discoverPlugins = useCallback(async (): Promise<DiscoveryResult> => {\n    if (!isTauri()) {\n      console.warn('[usePlugin] discoverPlugins: Not in Tauri environment');\n      return { count: 0, plugins: [], errors: [] };\n    }\n    try {\n      setDiscovering(true);\n\n      const result = await invoke<Record<string, unknown>>(\"discover_plugins\");\n\n      const discoveredPlugins = Array.isArray(result.plugins)\n        ? (result.plugins as Record<string, unknown>[]).map(parseManifest)\n        : [];\n\n      // Add discovered plugins to store\n      for (const manifest of discoveredPlugins) {\n        const path = String((result.paths as Record<string, string>)?.[manifest.id] || \"\");\n        addDiscoveredPlugin(manifest, path);\n      }\n\n      return {\n        count: discoveredPlugins.length,\n        plugins: discoveredPlugins,\n        errors: Array.isArray(result.errors)\n          ? (result.errors as Array<{ path: string; error: string }>)\n          : [],\n      };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : String(err);\n      addNotification({\n        type: \"error\",\n        title: \"Discovery Failed\",\n        message: errorMsg,\n        timeout: 5000,\n      });\n      throw err;\n    } finally {\n      if (mountedRef.current) {\n        setDiscovering(false);\n      }\n    }\n  }, [setDiscovering, addDiscoveredPlugin, addNotification]);\n\n  /**\n   * Scan for new plugins.\n   */\n  const scanPlugins = useCallback(async (): Promise<DiscoveryResult> => {\n    if (!isTauri()) {\n      console.warn('[usePlugin] scanPlugins: Not in Tauri environment');\n      return { count: 0, plugins: [], errors: [] };\n    }\n    try {\n      setDiscovering(true);\n\n      const result = await invoke<Record<string, unknown>>(\"scan_plugins\");\n\n      const newPlugins = Array.isArray(result.new_plugins)\n        ? (result.new_plugins as Record<string, unknown>[]).map(parseManifest)\n        : [];\n\n      // Add new plugins to store\n      for (const manifest of newPlugins) {\n        const path = String((result.paths as Record<string, string>)?.[manifest.id] || \"\");\n        addDiscoveredPlugin(manifest, path);\n      }\n\n      if (newPlugins.length > 0) {\n        addNotification({\n          type: \"success\",\n          title: \"Plugins Found\",\n          message: `Discovered ${newPlugins.length} new plugin(s)`,\n          timeout: 3000,\n        });\n      }\n\n      return {\n        count: newPlugins.length,\n        plugins: newPlugins,\n        errors: Array.isArray(result.errors)\n          ? (result.errors as Array<{ path: string; error: string }>)\n          : [],\n      };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : String(err);\n      addNotification({\n        type: \"error\",\n        title: \"Scan Failed\",\n        message: errorMsg,\n        timeout: 5000,\n      });\n      throw err;\n    } finally {\n      if (mountedRef.current) {\n        setDiscovering(false);\n      }\n    }\n  }, [setDiscovering, addDiscoveredPlugin, addNotification]);\n\n  /**\n   * Refresh plugin list from backend.\n   */\n  const refreshPlugins = useCallback(async (): Promise<void> => {\n    if (!isTauri()) {\n      return;\n    }\n    try {\n      const result = await invoke<Record<string, unknown>[]>(\"plugin_list\");\n\n      if (Array.isArray(result)) {\n        for (const pluginData of result) {\n          const manifest = parseManifest(pluginData);\n          const status = (pluginData.status || \"discovered\") as Plugin[\"status\"];\n          const path = String(pluginData.path || \"\");\n\n          // Update or add plugin\n          if (!plugins[manifest.id]) {\n            addDiscoveredPlugin(manifest, path);\n          }\n          setPluginStatus(manifest.id, status);\n\n          // Update methods and config if available\n          if (pluginData.methods) {\n            setPluginMethods(manifest.id, parseMethods(pluginData.methods as unknown[]));\n          }\n          if (pluginData.config) {\n            setPluginConfig(manifest.id, parseConfigOptions(pluginData.config as unknown[]));\n          }\n        }\n      }\n    } catch (err) {\n      // Silently handle refresh errors\n      console.error(\"Failed to refresh plugins:\", err);\n    }\n  }, [plugins, addDiscoveredPlugin, setPluginStatus, setPluginMethods, setPluginConfig]);\n\n  /**\n   * Load a plugin.\n   */\n  const loadPlugin = useCallback(\n    async (pluginId: string): Promise<LoadResult> => {\n      if (!isTauri()) {\n        return {\n          success: false,\n          pluginId,\n          methods: [],\n          config: [],\n          error: 'Not running in Tauri environment',\n        };\n      }\n      try {\n        setPluginStatus(pluginId, \"loading\");\n\n        const result = await invoke<Record<string, unknown>>(\"plugin_load\", {\n          name: pluginId,\n        });\n\n        const methods = parseMethods((result.methods as unknown[]) || []);\n        const config = parseConfigOptions((result.config as unknown[]) || []);\n\n        if (mountedRef.current) {\n          setPluginStatus(pluginId, \"active\");\n          setPluginMethods(pluginId, methods);\n          setPluginConfig(pluginId, config);\n        }\n\n        addNotification({\n          type: \"success\",\n          title: \"Plugin Loaded\",\n          message: `${pluginId} is now active`,\n          timeout: 3000,\n        });\n\n        return {\n          success: true,\n          pluginId,\n          methods,\n          config,\n        };\n      } catch (err) {\n        const errorMsg = err instanceof Error ? err.message : String(err);\n\n        if (mountedRef.current) {\n          setPluginStatus(pluginId, \"error\", errorMsg);\n        }\n\n        addNotification({\n          type: \"error\",\n          title: \"Load Failed\",\n          message: `Failed to load ${pluginId}: ${errorMsg}`,\n          timeout: 5000,\n        });\n\n        return {\n          success: false,\n          pluginId,\n          methods: [],\n          config: [],\n          error: errorMsg,\n        };\n      }\n    },\n    [setPluginStatus, setPluginMethods, setPluginConfig, addNotification]\n  );\n\n  /**\n   * Unload a plugin.\n   */\n  const unloadPlugin = useCallback(\n    async (pluginId: string): Promise<void> => {\n      try {\n        setPluginStatus(pluginId, \"unloading\");\n\n        await invoke(\"plugin_unload\", { name: pluginId });\n\n        if (mountedRef.current) {\n          setPluginStatus(pluginId, \"discovered\");\n        }\n\n        addNotification({\n          type: \"info\",\n          title: \"Plugin Unloaded\",\n          message: `${pluginId} has been unloaded`,\n          timeout: 3000,\n        });\n      } catch (err) {\n        const errorMsg = err instanceof Error ? err.message : String(err);\n\n        if (mountedRef.current) {\n          setPluginStatus(pluginId, \"error\", errorMsg);\n        }\n\n        addNotification({\n          type: \"error\",\n          title: \"Unload Failed\",\n          message: `Failed to unload ${pluginId}: ${errorMsg}`,\n          timeout: 5000,\n        });\n\n        throw err;\n      }\n    },\n    [setPluginStatus, addNotification]\n  );\n\n  /**\n   * Hot-swap plugins.\n   */\n  const swapPlugin = useCallback(\n    async (oldPluginId: string, newPluginId: string): Promise<SwapResult> => {\n      try {\n        setLoading(true, `Swapping ${oldPluginId} with ${newPluginId}...`);\n        setPluginStatus(oldPluginId, \"unloading\");\n        setPluginStatus(newPluginId, \"loading\");\n\n        const result = await invoke<Record<string, unknown>>(\"plugin_swap\", {\n          old_name: oldPluginId,\n          new_name: newPluginId,\n        });\n\n        if (mountedRef.current) {\n          setPluginStatus(oldPluginId, \"discovered\");\n          setPluginStatus(newPluginId, \"active\");\n\n          // Update methods and config for new plugin\n          if (result.methods) {\n            setPluginMethods(newPluginId, parseMethods(result.methods as unknown[]));\n          }\n          if (result.config) {\n            setPluginConfig(newPluginId, parseConfigOptions(result.config as unknown[]));\n          }\n        }\n\n        addNotification({\n          type: \"success\",\n          title: \"Plugin Swapped\",\n          message: `Replaced ${oldPluginId} with ${newPluginId}`,\n          timeout: 3000,\n        });\n\n        return {\n          success: true,\n          oldPluginId,\n          newPluginId,\n        };\n      } catch (err) {\n        const errorMsg = err instanceof Error ? err.message : String(err);\n\n        if (mountedRef.current) {\n          setPluginStatus(oldPluginId, \"error\", errorMsg);\n          setPluginStatus(newPluginId, \"error\", errorMsg);\n        }\n\n        addNotification({\n          type: \"error\",\n          title: \"Swap Failed\",\n          message: errorMsg,\n          timeout: 5000,\n        });\n\n        return {\n          success: false,\n          oldPluginId,\n          newPluginId,\n          error: errorMsg,\n        };\n      } finally {\n        setLoading(false);\n      }\n    },\n    [setLoading, setPluginStatus, setPluginMethods, setPluginConfig, addNotification]\n  );\n\n  /**\n   * Invoke a plugin method.\n   */\n  const invokeMethod = useCallback(\n    async <T = unknown>(\n      pluginId: string,\n      method: string,\n      args: Record<string, unknown> = {},\n      options: InvokeOptions = {}\n    ): Promise<T> => {\n      const {\n        showLoading = false,\n        loadingMessage = `Calling ${method}...`,\n        trackHistory = true,\n      } = options;\n\n      const startTime = Date.now();\n      let success = false;\n      let result: unknown = null;\n      let errorMsg: string | null = null;\n\n      try {\n        if (!isTauri()) {\n          throw new Error('Not running in Tauri environment');\n        }\n        if (showLoading) {\n          setLoading(true, loadingMessage);\n        }\n\n        result = await invoke<T>(\"plugin_call\", {\n          plugin: pluginId,\n          method,\n          args,\n        });\n\n        success = true;\n        return result as T;\n      } catch (err) {\n        errorMsg = err instanceof Error ? err.message : String(err);\n        throw err;\n      } finally {\n        const executionTime = Date.now() - startTime;\n\n        if (showLoading) {\n          setLoading(false);\n        }\n\n        // Track in history\n        if (trackHistory) {\n          addInvocationResult({\n            id: generateId(),\n            pluginId,\n            method,\n            success,\n            result,\n            error: errorMsg,\n            executionTime,\n            timestamp: Date.now(),\n          });\n        }\n      }\n    },\n    [setLoading, addInvocationResult]\n  );\n\n  /**\n   * Select a plugin.\n   */\n  const selectPlugin = useCallback(\n    (pluginId: string | null) => {\n      storeSelectPlugin(pluginId);\n    },\n    [storeSelectPlugin]\n  );\n\n  /**\n   * Get plugin configuration.\n   */\n  const getPluginConfig = useCallback(\n    (pluginId: string): PluginConfigOption[] => {\n      return plugins[pluginId]?.config || [];\n    },\n    [plugins]\n  );\n\n  /**\n   * Update plugin configuration.\n   */\n  const updatePluginConfig = useCallback(\n    async (pluginId: string, key: string, value: unknown): Promise<void> => {\n      try {\n        // Update in store immediately for optimistic UI\n        updatePluginConfigValue(pluginId, key, value);\n\n        // Sync to backend\n        await invoke(\"ipc_call\", {\n          method: \"plugin/config\",\n          params: {\n            plugin: pluginId,\n            key,\n            value,\n          },\n        });\n      } catch (err) {\n        // Revert on error (would need to store previous value)\n        const errorMsg = err instanceof Error ? err.message : String(err);\n        addNotification({\n          type: \"error\",\n          title: \"Config Update Failed\",\n          message: errorMsg,\n          timeout: 5000,\n        });\n        throw err;\n      }\n    },\n    [updatePluginConfigValue, addNotification]\n  );\n\n  /**\n   * Check plugin health.\n   */\n  const checkPluginHealth = useCallback(\n    async (pluginId: string): Promise<PluginHealth> => {\n      try {\n        const result = await invoke<Record<string, unknown>>(\"ipc_call\", {\n          method: \"plugin/health\",\n          params: { plugin: pluginId },\n        });\n\n        const health: PluginHealth = {\n          healthy: Boolean(result.healthy),\n          lastCheck: Date.now(),\n          responseTime: (result.response_time || result.responseTime || null) as number | null,\n          error: (result.error || null) as string | null,\n          failureCount: (result.failure_count || result.failureCount || 0) as number,\n        };\n\n        if (mountedRef.current) {\n          updatePluginHealth(pluginId, health);\n        }\n\n        return health;\n      } catch (err) {\n        const errorMsg = err instanceof Error ? err.message : String(err);\n        const unhealthyStatus: PluginHealth = {\n          healthy: false,\n          lastCheck: Date.now(),\n          responseTime: null,\n          error: errorMsg,\n          failureCount: (plugins[pluginId]?.health.failureCount || 0) + 1,\n        };\n\n        if (mountedRef.current) {\n          updatePluginHealth(pluginId, unhealthyStatus);\n        }\n\n        return unhealthyStatus;\n      }\n    },\n    [plugins, updatePluginHealth]\n  );\n\n  /**\n   * Start health monitoring.\n   */\n  const startHealthMonitoring = useCallback(() => {\n    if (healthIntervalRef.current) return;\n\n    setHealthMonitoring(true);\n\n    healthIntervalRef.current = setInterval(() => {\n      const activePlugins = Object.values(plugins).filter(\n        (p) => p.status === \"active\" || p.status === \"loaded\"\n      );\n\n      for (const plugin of activePlugins) {\n        checkPluginHealth(plugin.manifest.id);\n      }\n    }, healthCheckInterval);\n  }, [plugins, healthCheckInterval, setHealthMonitoring, checkPluginHealth]);\n\n  /**\n   * Stop health monitoring.\n   */\n  const stopHealthMonitoring = useCallback(() => {\n    if (healthIntervalRef.current) {\n      clearInterval(healthIntervalRef.current);\n      healthIntervalRef.current = null;\n    }\n    setHealthMonitoring(false);\n  }, [setHealthMonitoring]);\n\n  /**\n   * Get plugin by ID.\n   */\n  const getPlugin = useCallback(\n    (pluginId: string): Plugin | undefined => {\n      return plugins[pluginId];\n    },\n    [plugins]\n  );\n\n  /**\n   * Get plugins by category.\n   */\n  const getPluginsByCategory = useCallback(\n    (category: string): Plugin[] => {\n      return Object.values(plugins).filter((p) => p.manifest.category === category);\n    },\n    [plugins]\n  );\n\n  /**\n   * Get active plugins.\n   */\n  const getActivePlugins = useCallback((): Plugin[] => {\n    return Object.values(plugins).filter((p) => p.status === \"active\");\n  }, [plugins]);\n\n  /**\n   * Clear invocation history.\n   */\n  const clearInvocationHistory = useCallback(() => {\n    storeClearHistory();\n  }, [storeClearHistory]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    mountedRef.current = true;\n\n    return () => {\n      mountedRef.current = false;\n      if (healthIntervalRef.current) {\n        clearInterval(healthIntervalRef.current);\n      }\n    };\n  }, []);\n\n  // Auto-discover on IPC ready\n  useEffect(() => {\n    if (ipcReady && Object.keys(plugins).length === 0) {\n      discoverPlugins();\n    }\n  }, [ipcReady, plugins, discoverPlugins]);\n\n  return {\n    plugins,\n    selectedPlugin,\n    isDiscovering,\n    loadingPlugins,\n    invocationHistory,\n    healthMonitoringActive,\n\n    // Discovery\n    discoverPlugins,\n    scanPlugins,\n    refreshPlugins,\n\n    // Lifecycle\n    loadPlugin,\n    unloadPlugin,\n    swapPlugin,\n\n    // Invocation\n    invokeMethod,\n\n    // Selection\n    selectPlugin,\n\n    // Configuration\n    getPluginConfig,\n    updatePluginConfig,\n\n    // Health\n    startHealthMonitoring,\n    stopHealthMonitoring,\n    checkPluginHealth,\n\n    // Utility\n    getPlugin,\n    getPluginsByCategory,\n    getActivePlugins,\n    clearInvocationHistory,\n  };\n}\n\n// ============================================\n// SPECIALIZED HOOKS\n// ============================================\n\n/**\n * Hook for using a specific plugin.\n */\nexport function usePluginInstance(pluginId: string): {\n  plugin: Plugin | undefined;\n  isLoading: boolean;\n  isActive: boolean;\n  methods: PluginMethod[];\n  config: PluginConfigOption[];\n  health: PluginHealth;\n  load: () => Promise<LoadResult>;\n  unload: () => Promise<void>;\n  invoke: <T = unknown>(method: string, args?: Record<string, unknown>) => Promise<T>;\n  updateConfig: (key: string, value: unknown) => Promise<void>;\n} {\n  const { plugins, loadPlugin, unloadPlugin, invokeMethod, updatePluginConfig, loadingPlugins } =\n    usePlugin();\n\n  const plugin = plugins[pluginId];\n  const isLoading = loadingPlugins.has(pluginId);\n  const isActive = plugin?.status === \"active\";\n  const methods = plugin?.methods || [];\n  const config = plugin?.config || [];\n  const health = plugin?.health || {\n    healthy: false,\n    lastCheck: 0,\n    responseTime: null,\n    error: null,\n    failureCount: 0,\n  };\n\n  const load = useCallback(() => loadPlugin(pluginId), [loadPlugin, pluginId]);\n  const unload = useCallback(() => unloadPlugin(pluginId), [unloadPlugin, pluginId]);\n  const invoke = useCallback(\n    <T = unknown>(method: string, args?: Record<string, unknown>) =>\n      invokeMethod<T>(pluginId, method, args),\n    [invokeMethod, pluginId]\n  );\n  const updateConfig = useCallback(\n    (key: string, value: unknown) => updatePluginConfig(pluginId, key, value),\n    [updatePluginConfig, pluginId]\n  );\n\n  return {\n    plugin,\n    isLoading,\n    isActive,\n    methods,\n    config,\n    health,\n    load,\n    unload,\n    invoke,\n    updateConfig,\n  };\n}\n\n/**\n * Hook for plugin method invocation with automatic tracking.\n */\nexport function usePluginMethod<T = unknown>(\n  pluginId: string,\n  method: string,\n  options?: {\n    args?: Record<string, unknown>;\n    enabled?: boolean;\n    refetchInterval?: number;\n  }\n): {\n  data: T | null;\n  isLoading: boolean;\n  error: string | null;\n  invoke: (args?: Record<string, unknown>) => Promise<T>;\n} {\n  const { invokeMethod } = usePlugin();\n  const [data, setData] = useState<T | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const { args, enabled = true, refetchInterval } = options || {};\n\n  const invoke = useCallback(\n    async (invokeArgs?: Record<string, unknown>) => {\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        const result = await invokeMethod<T>(pluginId, method, invokeArgs || args || {});\n        setData(result);\n        return result;\n      } catch (err) {\n        const errorMsg = err instanceof Error ? err.message : String(err);\n        setError(errorMsg);\n        throw err;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [pluginId, method, args, invokeMethod]\n  );\n\n  useEffect(() => {\n    if (enabled) {\n      invoke();\n    }\n  }, [enabled, invoke]);\n\n  useEffect(() => {\n    if (!refetchInterval || !enabled) return;\n\n    const interval = setInterval(invoke, refetchInterval);\n    return () => clearInterval(interval);\n  }, [refetchInterval, enabled, invoke]);\n\n  return {\n    data,\n    isLoading,\n    error,\n    invoke,\n  };\n}\n\nexport default usePlugin;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\hooks\\useThemedStyles.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `{ [s: string]: unknown; } | ArrayLike<unknown>`.","line":31,"column":24,"nodeType":"Identifier","messageId":"unsafeArgument","endLine":31,"endColumn":29},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":46,"column":9,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":46,"endColumn":47},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":51,"column":9,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":51,"endColumn":46},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":56,"column":9,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":56,"endColumn":46},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":106,"column":44,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":106,"endColumn":46,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3514,3516],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":107,"column":45,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":107,"endColumn":47,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3573,3575],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":108,"column":44,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":108,"endColumn":46,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3631,3633],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":109,"column":45,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":109,"endColumn":47,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3690,3692],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":110,"column":40,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":110,"endColumn":42,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3744,3746],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":111,"column":41,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":111,"endColumn":43,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3799,3801],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":112,"column":38,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":112,"endColumn":40,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3851,3853],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":113,"column":39,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":113,"endColumn":41,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[3904,3906],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * useThemedStyles.ts\r\n * ==================\r\n * Hook that generates inline style objects from the current theme.\r\n * Used to apply theme customizations to canvas and preview components.\r\n *\r\n * Dependencies: D016 (ThemeProvider.tsx)\r\n */\r\n\r\nimport { useMemo } from 'react';\r\nimport { useThemeStore, type ThemeConfig } from '../context/ThemeProvider';\r\n\r\n/**\r\n * Themed CSS custom properties that can be applied as inline styles.\r\n * Uses Record type to allow CSS custom property keys.\r\n */\r\nexport type ThemedCSSProperties = Record<string, string | number | undefined>;\r\n\r\n/**\r\n * Generate CSS custom properties from a theme configuration.\r\n * These can be applied as inline styles to create a themed context.\r\n *\r\n * @param theme - The theme configuration to convert\r\n * @returns Object containing CSS custom properties\r\n */\r\nexport function generateThemeCSSProperties(theme: ThemeConfig): ThemedCSSProperties {\r\n    const properties: ThemedCSSProperties = {};\r\n\r\n    // Inject colors\r\n    Object.entries(theme.colors).forEach(([category, scale]) => {\r\n        Object.entries(scale).forEach(([shade, value]) => {\r\n            properties[`--color-${category}-${shade}`] = value as string;\r\n        });\r\n    });\r\n\r\n    // Inject typography\r\n    properties['--font-family-sans'] = theme.typography.fontFamily.sans;\r\n    properties['--font-family-mono'] = theme.typography.fontFamily.mono;\r\n\r\n    Object.entries(theme.typography.fontSize).forEach(([key, value]) => {\r\n        properties[`--font-size-${key}`] = value;\r\n    });\r\n\r\n    // Inject spacing\r\n    Object.entries(theme.spacing).forEach(([key, value]) => {\r\n        properties[`--spacing-${key}`] = value;\r\n    });\r\n\r\n    // Inject radius\r\n    Object.entries(theme.radius).forEach(([key, value]) => {\r\n        properties[`--radius-${key}`] = value;\r\n    });\r\n\r\n    // Inject shadows\r\n    Object.entries(theme.shadows).forEach(([key, value]) => {\r\n        properties[`--shadow-${key}`] = value;\r\n    });\r\n\r\n    // Set background and text based on mode\r\n    if (theme.mode === 'dark') {\r\n        properties.backgroundColor = theme.colors.neutral[50]; // Dark background\r\n        properties.color = theme.colors.neutral[950]; // Light text\r\n    } else {\r\n        properties.backgroundColor = theme.colors.neutral[50]; // Light background\r\n        properties.color = theme.colors.neutral[950]; // Dark text\r\n    }\r\n\r\n    // Set font family\r\n    properties.fontFamily = theme.typography.fontFamily.sans;\r\n\r\n    return properties;\r\n}\r\n\r\n/**\r\n * Hook that returns themed styles from the current theme store.\r\n * \r\n * @example\r\n * ```tsx\r\n * const { themedStyles, theme, cssVariables } = useThemedStyles();\r\n * \r\n * return (\r\n *   <div style={themedStyles}>\r\n *     Content with theme applied\r\n *   </div>\r\n * );\r\n * ```\r\n */\r\nexport function useThemedStyles() {\r\n    const theme = useThemeStore((state) => state.theme);\r\n\r\n    const themedStyles = useMemo(() => {\r\n        return generateThemeCSSProperties(theme);\r\n    }, [theme]);\r\n\r\n    // Generate primary color for common use cases\r\n    const primaryColor = theme.colors.primary[500];\r\n    const primaryColorLight = theme.colors.primary[50];\r\n    const primaryColorDark = theme.colors.primary[700];\r\n\r\n    // Generate semantic colors\r\n    const semanticColors = useMemo(() => ({\r\n        primary: theme.colors.primary[500],\r\n        primaryBg: theme.colors.primary[50],\r\n        neutral: theme.colors.neutral[500],\r\n        neutralBg: theme.colors.neutral[50],\r\n        success: theme.colors.success[500] || '#22c55e',\r\n        successBg: theme.colors.success[50] || '#f0fdf4',\r\n        warning: theme.colors.warning[500] || '#f59e0b',\r\n        warningBg: theme.colors.warning[50] || '#fffbeb',\r\n        error: theme.colors.error[500] || '#ef4444',\r\n        errorBg: theme.colors.error[50] || '#fef2f2',\r\n        info: theme.colors.info[500] || '#3b82f6',\r\n        infoBg: theme.colors.info[50] || '#eff6ff',\r\n    }), [theme.colors]);\r\n\r\n    return {\r\n        /** Full themed inline styles including CSS custom properties */\r\n        themedStyles,\r\n        /** Current theme configuration */\r\n        theme,\r\n        /** Primary color value */\r\n        primaryColor,\r\n        primaryColorLight,\r\n        primaryColorDark,\r\n        /** Semantic color shortcuts */\r\n        semanticColors,\r\n        /** Whether dark mode is active */\r\n        isDarkMode: theme.mode === 'dark',\r\n    };\r\n}\r\n\r\nexport default useThemedStyles;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\main.tsx","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":17,"column":38,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":17,"endColumn":55},{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":19,"column":3,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":19,"endColumn":37,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[671,704],"text":"void (import('./mocks/tauri-v1.8-mock'))"},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[671,704],"text":"await (import('./mocks/tauri-v1.8-mock'))"},"desc":"Add await operator."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * B002 - src/main.tsx\n * ===================\n * React application entry point.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006 (design_tokens.css), D018 (ThemeProvider)\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { App } from './App';\nimport './index.css';\n\n// SAFETY: Import Mock Layer ONLY if strict Tauri (window.__TAURI__) is missing.\n// This prevents the mock from ever polluting the production app running inside Tauri.\nif (typeof window !== 'undefined' && !window.__TAURI__) {\n  console.log('[App Factory] Browser environment detected. Loading Mock Layer...');\n  import('./mocks/tauri-v1.8-mock');\n}\n\n// Get root element\nconst rootElement = document.getElementById('root');\n\nif (!rootElement) {\n  throw new Error('Root element not found. Make sure index.html has a div with id=\"root\".');\n}\n\n// Create React root and render app\nReactDOM.createRoot(rootElement).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\mocks\\demoPreviewData.ts","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":256,"column":39,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":256,"endColumn":41,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[7692,7694],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * src/mocks/demoPreviewData.ts\r\n * ============================\r\n * Demo data for FE UI Preview demonstration.\r\n * Provides sample screen and component data for standalone preview testing.\r\n *\r\n * NOTICE TO AI ASSISTANTS:\r\n * ========================\r\n * This file contains mock/dummy data for preview demonstration.\r\n * Replace with production data sources when wiring to real project.\r\n * Search for \"REPLACE_WITH_PRODUCTION\" comments for integration points.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D045-D047 (Live preview panel requirements)\r\n */\r\n\r\nimport type { ProjectScreen, ProjectComponent } from '../stores/projectStore';\r\n\r\n// =============================================================================\r\n// DEMO SCREEN CONFIGURATION\r\n// =============================================================================\r\n\r\n// DUMMY_DATA_START: Demo screen for preview\r\n// REPLACE_WITH_PRODUCTION: Load from projectStore.screens[screenId]\r\nexport const demoScreen: ProjectScreen = {\r\n    id: 'demo-screen-1',\r\n    name: 'Demo Preview Screen',\r\n    type: 'main',\r\n    rootComponentId: 'demo-container',\r\n    route: '/',\r\n    title: 'Demo Preview',\r\n    isDefault: true,\r\n    settings: {},\r\n};\r\n// DUMMY_DATA_END\r\n\r\n// =============================================================================\r\n// DEMO COMPONENT HIERARCHY\r\n// =============================================================================\r\n\r\n// DUMMY_DATA_START: Demo component tree for preview\r\n// REPLACE_WITH_PRODUCTION: Load from projectStore.components\r\nexport const demoComponents: Record<string, ProjectComponent> = {\r\n    // Root container\r\n    'demo-container': {\r\n        id: 'demo-container',\r\n        type: 'panel',\r\n        name: 'Demo Container',\r\n        props: {\r\n            title: 'Live Preview Demo',\r\n            variant: 'elevated',\r\n            padding: 'lg',\r\n        },\r\n        children: ['demo-form-section', 'demo-actions-section'],\r\n        parentId: null,\r\n        position: { x: 0, y: 0, width: 600, height: 400 },\r\n        slots: [],\r\n        styles: {},\r\n        events: {},\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Form section\r\n    'demo-form-section': {\r\n        id: 'demo-form-section',\r\n        type: 'panel',\r\n        name: 'Form Section',\r\n        props: {\r\n            title: 'User Input',\r\n            variant: 'outlined',\r\n        },\r\n        children: ['demo-input-name', 'demo-input-email', 'demo-select-option', 'demo-checkbox-agree'],\r\n        parentId: 'demo-container',\r\n        position: { x: 16, y: 60, width: 568, height: 200 },\r\n        slots: [],\r\n        styles: {},\r\n        events: {},\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Text input - Name\r\n    'demo-input-name': {\r\n        id: 'demo-input-name',\r\n        type: 'input',\r\n        name: 'Name Input',\r\n        props: {\r\n            label: 'Full Name',\r\n            placeholder: 'Enter your name...',\r\n            type: 'text',\r\n            required: true,\r\n        },\r\n        children: [],\r\n        parentId: 'demo-form-section',\r\n        position: { x: 8, y: 40, width: 260, height: 60 },\r\n        slots: [],\r\n        styles: {},\r\n        events: { change: 'handleNameChange' },\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Text input - Email\r\n    'demo-input-email': {\r\n        id: 'demo-input-email',\r\n        type: 'input',\r\n        name: 'Email Input',\r\n        props: {\r\n            label: 'Email Address',\r\n            placeholder: 'user@example.com',\r\n            type: 'email',\r\n            required: true,\r\n        },\r\n        children: [],\r\n        parentId: 'demo-form-section',\r\n        position: { x: 280, y: 40, width: 260, height: 60 },\r\n        slots: [],\r\n        styles: {},\r\n        events: { change: 'handleEmailChange' },\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Select dropdown\r\n    'demo-select-option': {\r\n        id: 'demo-select-option',\r\n        type: 'select',\r\n        name: 'Category Select',\r\n        props: {\r\n            label: 'Category',\r\n            placeholder: 'Select a category...',\r\n            // Options provided by mockSelectOptions in previewMocks.ts\r\n        },\r\n        children: [],\r\n        parentId: 'demo-form-section',\r\n        position: { x: 8, y: 110, width: 260, height: 60 },\r\n        slots: [],\r\n        styles: {},\r\n        events: { change: 'handleCategoryChange' },\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Checkbox\r\n    'demo-checkbox-agree': {\r\n        id: 'demo-checkbox-agree',\r\n        type: 'checkbox',\r\n        name: 'Agreement Checkbox',\r\n        props: {\r\n            label: 'I agree to the terms and conditions',\r\n            checked: false,\r\n        },\r\n        children: [],\r\n        parentId: 'demo-form-section',\r\n        position: { x: 280, y: 120, width: 260, height: 40 },\r\n        slots: [],\r\n        styles: {},\r\n        events: { change: 'handleAgreeChange' },\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Actions section\r\n    'demo-actions-section': {\r\n        id: 'demo-actions-section',\r\n        type: 'panel',\r\n        name: 'Actions Section',\r\n        props: {\r\n            variant: 'flat',\r\n        },\r\n        children: ['demo-btn-submit', 'demo-btn-cancel'],\r\n        parentId: 'demo-container',\r\n        position: { x: 16, y: 280, width: 568, height: 80 },\r\n        slots: [],\r\n        styles: {},\r\n        events: {},\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Primary button\r\n    'demo-btn-submit': {\r\n        id: 'demo-btn-submit',\r\n        type: 'button',\r\n        name: 'Submit Button',\r\n        props: {\r\n            children: 'Submit',\r\n            variant: 'primary',\r\n            size: 'md',\r\n        },\r\n        children: [],\r\n        parentId: 'demo-actions-section',\r\n        position: { x: 8, y: 16, width: 120, height: 40 },\r\n        slots: [],\r\n        styles: {},\r\n        events: { click: 'handleSubmit' },\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n\r\n    // Secondary button\r\n    'demo-btn-cancel': {\r\n        id: 'demo-btn-cancel',\r\n        type: 'button',\r\n        name: 'Cancel Button',\r\n        props: {\r\n            children: 'Cancel',\r\n            variant: 'secondary',\r\n            size: 'md',\r\n        },\r\n        children: [],\r\n        parentId: 'demo-actions-section',\r\n        position: { x: 140, y: 16, width: 120, height: 40 },\r\n        slots: [],\r\n        styles: {},\r\n        events: { click: 'handleCancel' },\r\n        visible: true,\r\n        locked: false,\r\n    },\r\n};\r\n// DUMMY_DATA_END\r\n\r\n// =============================================================================\r\n// HELPER FUNCTIONS\r\n// =============================================================================\r\n\r\n/**\r\n * Load demo data into project store for preview testing.\r\n * REPLACE_WITH_PRODUCTION: Remove this function when using real project data.\r\n *\r\n * @param store - The project store instance\r\n */\r\nexport function loadDemoDataIntoStore(store: {\r\n    screens: Record<string, ProjectScreen>;\r\n    components: Record<string, ProjectComponent>;\r\n}): void {\r\n    // Merge demo data into store\r\n    store.screens[demoScreen.id] = demoScreen;\r\n    Object.entries(demoComponents).forEach(([id, component]) => {\r\n        store.components[id] = component;\r\n    });\r\n}\r\n\r\n/**\r\n * Get all demo component IDs.\r\n */\r\nexport function getDemoComponentIds(): string[] {\r\n    return Object.keys(demoComponents);\r\n}\r\n\r\n/**\r\n * Get the root component ID for the demo screen.\r\n */\r\nexport function getDemoRootComponentId(): string {\r\n    return demoScreen.rootComponentId || '';\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\mocks\\previewMocks.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1072,1075],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1072,1075],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * src/mocks/previewMocks.ts\r\n * =========================\r\n * Centralized mock data for FE UI Preview.\r\n * Used to hydrate components with dummy data when no live data is available.\r\n */\r\n\r\n// DUMMY_DATA_START: Select options\r\nexport const mockSelectOptions = [\r\n    { value: 'option-1', label: 'Option 1' },\r\n    { value: 'option-2', label: 'Option 2' },\r\n    { value: 'option-3', label: 'Option 3' },\r\n];\r\n// DUMMY_DATA_END\r\n\r\n// DUMMY_DATA_START: Tab items\r\nexport const mockTabItems = [\r\n    { id: 'tab-1', label: 'Tab 1', content: 'Content for Tab 1' },\r\n    { id: 'tab-2', label: 'Tab 2', content: 'Content for Tab 2' },\r\n    { id: 'tab-3', label: 'Tab 3', content: 'Content for Tab 3' },\r\n];\r\n// DUMMY_DATA_END\r\n\r\n// DUMMY_DATA_START: Table data\r\nexport const mockTableData = [\r\n    { id: 1, name: 'Item 1', status: 'Active' },\r\n    { id: 2, name: 'Item 2', status: 'Inactive' },\r\n    { id: 3, name: 'Item 3', status: 'Pending' },\r\n];\r\n// DUMMY_DATA_END\r\n\r\n// MOCK_FUNCTION_START: Generic handler\r\nexport const mockEventHandler = (eventName: string, ...args: any[]) => {\r\n    console.log(`[Preview Interaction] Event: ${eventName}`, args);\r\n};\r\n// MOCK_FUNCTION_END\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\mocks\\tauri-v1.8-mock.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\mocks\\tauri-v1.8-mock.js","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: \"parserOptions.project\" has been provided for @typescript-eslint/parser.\nThe file was not found in any of the provided project(s): src\\mocks\\tauri-v1.8-mock.js"}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Tauri v1.8 Mock Layer\r\n * ======================\r\n * Simulates the Tauri backend environment for User Acceptance Testing (UAT)\r\n * in a standard browser environment.\r\n * \r\n * Usage: Import this file before your app initializes.\r\n */\r\n\r\nconsole.log(\"%c[Tauri Mock] Initializing...\", \"color: #8b5cf6; font-weight: bold;\");\r\n\r\n// Mock Data Store\r\nconst mockStore = {\r\n    plugins: [\r\n        {\r\n            id: \"tts_kokoro\",\r\n            name: \"Kokoro TTS\",\r\n            version: \"1.2.0\",\r\n            description: \"High-quality text-to-speech engine\",\r\n            author: \"Piovis\",\r\n            type: \"plugin\",\r\n            status: \"active\",\r\n            tags: [\"audio\", \"ai\"]\r\n        }\r\n    ],\r\n    components: [],\r\n    lifecycle: \"running\",\r\n    // D079 - API Key storage for mock\r\n    apiKeys: {},        // { service: [ApiKeyEntry, ...] }\r\n    apiKeyValues: {}    // { \"service-id\": \"actual-key-value\" }\r\n};\r\n\r\n/**\r\n * Compile TSX code using Sucrase (browser-mode fallback).\r\n * Returns a CompileResult matching the Tauri backend interface.\r\n */\r\nasync function compileWithSucrase(code) {\r\n    try {\r\n        // Dynamic import Sucrase\r\n        const { transform } = await import('sucrase');\r\n\r\n        const result = transform(code, {\r\n            transforms: ['typescript', 'jsx'],\r\n            jsxRuntime: 'classic',\r\n            production: true,\r\n        });\r\n\r\n        console.log('[Tauri Mock] compile_tsx: Success');\r\n        return {\r\n            success: true,\r\n            code: result.code,\r\n            error: null,\r\n        };\r\n    } catch (err) {\r\n        const errorMessage = err instanceof Error ? err.message : String(err);\r\n        console.error('[Tauri Mock] compile_tsx: Error -', errorMessage);\r\n        return {\r\n            success: false,\r\n            code: null,\r\n            error: `Sucrase compilation error: ${errorMessage}`,\r\n        };\r\n    }\r\n}\r\n\r\n// 1. Mock window.__TAURI__ if it doesn't exist\r\nif (!window.__TAURI__) {\r\n    window.__TAURI__ = {};\r\n}\r\n\r\n// 2. Mock invoke function\r\nwindow.__TAURI__.invoke = async (cmd, args = {}) => {\r\n    console.log(`%c[Tauri Mock] invoke('${cmd}')`, \"color: #0ea5e9;\", args);\r\n\r\n    // Simulate network/processing delay\r\n    await new Promise(resolve => setTimeout(resolve, 300));\r\n\r\n    switch (cmd) {\r\n        // --- Lifecycle ---\r\n        case \"ipc_start\":\r\n            mockStore.lifecycle = \"running\";\r\n            return null;\r\n        case \"ipc_stop\":\r\n            mockStore.lifecycle = \"stopped\";\r\n            return null;\r\n        case \"ipc_status\":\r\n            return {\r\n                lifecycle_state: mockStore.lifecycle,\r\n                health_status: {\r\n                    is_healthy: true,\r\n                    last_latency_ms: 5,\r\n                    failure_count: 0\r\n                },\r\n                uptime_seconds: 120\r\n            };\r\n\r\n        // --- Plugin Management ---\r\n        case \"discover_plugins\":\r\n        case \"scan_plugins\":\r\n            return {\r\n                plugins: mockStore.plugins,\r\n                paths: mockStore.plugins.reduce((acc, p) => ({ ...acc, [p.id]: `/plugins/${p.id}` }), {}),\r\n                count: mockStore.plugins.length,\r\n                errors: []\r\n            };\r\n\r\n        case \"plugin_list\":\r\n            return mockStore.plugins.map(p => ({\r\n                ...p,\r\n                config: [],\r\n                methods: []\r\n            }));\r\n\r\n        case \"plugin_load\":\r\n            // Always succeed for UAT\r\n            if (args.name === \"example_component\") {\r\n                return {\r\n                    methods: [],\r\n                    config: []\r\n                };\r\n            }\r\n            return { methods: [], config: [] };\r\n\r\n        // --- Generic IPC Call ---\r\n        case \"ipc_call\":\r\n            return handleIpcCall(args.method, args.params);\r\n\r\n        case \"ping\":\r\n            return \"pong\";\r\n\r\n        // --- TSX Compilation (Phase 1 Mock) ---\r\n        case \"compile_tsx\":\r\n            // Use Sucrase for browser-mode TSX compilation\r\n            return await compileWithSucrase(args.code);\r\n\r\n        // --- API Key Management (D079) ---\r\n        case \"get_api_keys\":\r\n            // Return mock API keys for the service\r\n            return mockStore.apiKeys[args.service] || [];\r\n\r\n        case \"add_api_key\":\r\n            // Add a mock API key\r\n            const newKey = {\r\n                id: `mock-${Date.now()}`,\r\n                service: args.service,\r\n                name: args.name,\r\n                key_masked: args.key ? `${args.key.slice(0, 3)}***${args.key.slice(-3)}` : '***',\r\n                is_active: true,\r\n                created_at: new Date().toISOString()\r\n            };\r\n            if (!mockStore.apiKeys[args.service]) {\r\n                mockStore.apiKeys[args.service] = [];\r\n            }\r\n            // Set all other keys to inactive\r\n            mockStore.apiKeys[args.service].forEach(k => k.is_active = false);\r\n            mockStore.apiKeys[args.service].push(newKey);\r\n            // Store the actual key for get_active_api_key_value\r\n            mockStore.apiKeyValues[`${args.service}-${newKey.id}`] = args.key;\r\n            console.log(`[Tauri Mock] Added API key for ${args.service}`);\r\n            return newKey;\r\n\r\n        case \"get_active_api_key\":\r\n            // Return the active key (masked)\r\n            const serviceKeys = mockStore.apiKeys[args.service] || [];\r\n            return serviceKeys.find(k => k.is_active) || null;\r\n\r\n        case \"get_active_api_key_value\":\r\n            // Return the actual API key value for making API calls\r\n            const keys = mockStore.apiKeys[args.service] || [];\r\n            const activeKey = keys.find(k => k.is_active);\r\n            if (activeKey) {\r\n                return mockStore.apiKeyValues[`${args.service}-${activeKey.id}`] || null;\r\n            }\r\n            return null;\r\n\r\n        case \"set_active_api_key\":\r\n            // Set a key as active\r\n            const allKeys = mockStore.apiKeys[args.service] || [];\r\n            allKeys.forEach(k => k.is_active = (k.id === args.id));\r\n            return null;\r\n\r\n        case \"delete_api_key\":\r\n            // Delete a key\r\n            if (mockStore.apiKeys[args.service]) {\r\n                mockStore.apiKeys[args.service] = mockStore.apiKeys[args.service].filter(k => k.id !== args.id);\r\n            }\r\n            return null;\r\n\r\n        case \"get_configured_services\":\r\n            // Return services that have keys\r\n            return Object.keys(mockStore.apiKeys).filter(s => mockStore.apiKeys[s].length > 0);\r\n\r\n        default:\r\n            console.warn(`[Tauri Mock] Unhandled command: ${cmd}`);\r\n            return null;\r\n    }\r\n};\r\n\r\n/**\r\n * Handle specific ipc_call methods\r\n */\r\nasync function handleIpcCall(method, params) {\r\n    switch (method) {\r\n        case \"plugin/import\":\r\n            console.log(\"[Tauri Mock] Importing component:\", params);\r\n            // Add to mock store\r\n            const newComponent = {\r\n                id: \"example_component\",\r\n                name: \"Example Component\",\r\n                version: params.manifest?.version || \"1.0.0\",\r\n                type: \"component\",\r\n                status: \"active\",\r\n                author: params.manifest?.author || \"Unknown\",\r\n                description: params.manifest?.description || \"Imported via Mock\",\r\n                tags: params.manifest?.tags || [],\r\n                createdAt: new Date(),\r\n                updatedAt: new Date()\r\n            };\r\n            mockStore.plugins.push(newComponent);\r\n            return { success: true };\r\n\r\n        case \"plugin/list\":\r\n            return mockStore.plugins;\r\n\r\n        default:\r\n            console.log(`[Tauri Mock] Generic IPC call: ${method}`, params);\r\n            return { success: true };\r\n    }\r\n}\r\n\r\n// 3. Shim for @tauri-apps/api/tauri if using ESM imports in Vite\r\n// This is tricky because imports are static. \r\n// We rely on the fact that `window.__TAURI_IPC__` or similar might be used by the bindings.\r\n// However, since we use `invoke` from `@tauri-apps/api/tauri`, we might need to intercept that module resolution \r\n// or ensure the global `window.__TAURI__.invoke` is used if the library falls back to it.\r\n\r\n// For the `invoke` exported by `@tauri-apps/api`, it typically uses `window.__TAURI_IPC__` internally \r\n// OR calls `window.__TAURI__.invoke` if available? \r\n// Actually current Tauri v1 adapter often looks like this.\r\n// To ensure it works, we make sure the global invoke is our mock.\r\n// AND we can try to patch the window if the app uses `window.invoke`.\r\n\r\nwindow.invoke = window.__TAURI__.invoke;\r\n\r\nconsole.log(\"%c[Tauri Mock] Ready\", \"color: #10b981; font-weight: bold;\");\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\services\\aiChatLlmService.ts","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":78,"column":25,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":78,"endColumn":101,"fix":{"range":[2398,2474],"text":"({ text: string } | { inlineData: { mimeType: string; data: string } })[]"}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\r\n * aiChatLlmService.ts\r\n * ===================\r\n * Multi-LLM instance service for AI App Chat feature.\r\n * Supports concurrent LLM instances with per-scope configurations.\r\n * \r\n * Architecture: Extends existing llmService pattern to support\r\n * multiple independent LLM configurations (Backend/Frontend/Full scopes).\r\n */\r\n\r\nimport { GoogleGenAI } from '@google/genai';\r\nimport { useApiKeyStore, type ApiKeyService } from '../stores/apiKeyStore';\r\nimport { generateWithOllama } from './ollamaService';\r\nimport type { LLMResult } from './llmService';\r\nimport Anthropic from '@anthropic-ai/sdk';\r\n\r\n/**\r\n * Supported LLM providers for AI Chat.\r\n */\r\nexport type AiChatProvider = 'gemini' | 'openai' | 'anthropic' | 'ollama';\r\n\r\n/**\r\n * Configuration for a single LLM instance.\r\n */\r\nexport interface LLMInstanceConfig {\r\n    /** LLM provider */\r\n    provider: AiChatProvider;\r\n    /** Model ID (e.g., 'gemini-2.5-flash', 'llama3.2') */\r\n    model: string;\r\n    /** API key ID from apiKeyStore (empty for Ollama) */\r\n    apiKeyId: string;\r\n    /** System prompt for this instance */\r\n    systemPrompt: string;\r\n    /** Temperature (0-2) */\r\n    temperature: number;\r\n}\r\n\r\n/**\r\n * Chat message structure for conversation history.\r\n */\r\nexport interface ChatMessage {\r\n    id: string;\r\n    role: 'user' | 'assistant' | 'system';\r\n    content: string;\r\n    timestamp: Date;\r\n    scope?: 'backend' | 'frontend' | 'full';\r\n    /** Base64 encoded images (raw or data URI) */\r\n    images?: string[];\r\n}\r\n\r\n/**\r\n * Get API key value for a provider from the apiKeyStore.\r\n */\r\nasync function getApiKeyValue(provider: AiChatProvider): Promise<string | null> {\r\n    if (provider === 'ollama') {\r\n        return null; // Ollama doesn't need API key\r\n    }\r\n    const store = useApiKeyStore.getState();\r\n    return store.getActiveKeyValue(provider as ApiKeyService);\r\n}\r\n\r\n/**\r\n * Generate text using Google Gemini with specific config.\r\n */\r\nasync function generateWithGeminiConfig(\r\n    apiKey: string,\r\n    config: LLMInstanceConfig,\r\n    prompt: string,\r\n    conversationHistory?: ChatMessage[],\r\n    images?: string[]\r\n): Promise<LLMResult> {\r\n    const ai = new GoogleGenAI({ apiKey });\r\n\r\n    // Helper to strip data URI header from base64\r\n    const stripBase64Header = (img: string) => img.replace(/^data:image\\/\\w+;base64,/, '');\r\n\r\n    // Build current user message parts\r\n    const currentParts: Array<{ text: string } | { inlineData: { mimeType: string; data: string } }> = [\r\n        { text: prompt }\r\n    ];\r\n\r\n    // Add images if provided (for multimodal Vision models)\r\n    if (images && images.length > 0) {\r\n        images.forEach(img => {\r\n            currentParts.push({\r\n                inlineData: {\r\n                    mimeType: 'image/png',\r\n                    data: stripBase64Header(img)\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    // Build conversation contents if history provided\r\n    type ContentPart = { text: string } | { inlineData: { mimeType: string; data: string } };\r\n    type ContentMessage = { role: string; parts: ContentPart[] };\r\n    let contents: string | ContentMessage[];\r\n\r\n    if (conversationHistory && conversationHistory.length > 0) {\r\n        contents = conversationHistory.map(msg => ({\r\n            role: msg.role === 'assistant' ? 'model' : msg.role,\r\n            parts: [{ text: msg.content }]\r\n        }));\r\n        // Add current user message with text and images\r\n        contents.push({\r\n            role: 'user',\r\n            parts: currentParts\r\n        });\r\n    } else {\r\n        // Single message with potential images\r\n        contents = [{\r\n            role: 'user',\r\n            parts: currentParts\r\n        }];\r\n    }\r\n\r\n    const response = await ai.models.generateContent({\r\n        model: config.model,\r\n        contents,\r\n        config: {\r\n            systemInstruction: config.systemPrompt,\r\n            temperature: config.temperature,\r\n        },\r\n    });\r\n\r\n    return { success: true, text: response.text };\r\n}\r\n\r\n/**\r\n * Generate text using Anthropic with specific config.\r\n */\r\nasync function generateWithAnthropicConfig(\r\n    apiKey: string,\r\n    config: LLMInstanceConfig,\r\n    prompt: string,\r\n    conversationHistory?: ChatMessage[],\r\n    images?: string[]\r\n): Promise<LLMResult> {\r\n    const anthropic = new Anthropic({ apiKey, dangerouslyAllowBrowser: true });\r\n\r\n    const messages: Anthropic.MessageParam[] = [];\r\n\r\n    // Add history\r\n    if (conversationHistory && conversationHistory.length > 0) {\r\n        conversationHistory.forEach(msg => {\r\n            if (msg.role === 'user' || msg.role === 'assistant') {\r\n                messages.push({\r\n                    role: msg.role,\r\n                    content: msg.content\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    // Prepare current message content\r\n    const currentContent: Anthropic.ContentBlockParam[] = [];\r\n\r\n    // Add images if present\r\n    if (images && images.length > 0) {\r\n        images.forEach(img => {\r\n            // Strip header if present\r\n            const base64Data = img.replace(/^data:image\\/\\w+;base64,/, '');\r\n            currentContent.push({\r\n                type: 'image',\r\n                source: {\r\n                    type: 'base64',\r\n                    media_type: 'image/png', // Assuming PNG from html2canvas\r\n                    data: base64Data\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    // Add text prompt\r\n    currentContent.push({ type: 'text', text: prompt });\r\n\r\n    messages.push({\r\n        role: 'user',\r\n        content: currentContent\r\n    });\r\n\r\n    const response = await anthropic.messages.create({\r\n        model: config.model || 'claude-3-opus-20240229',\r\n        max_tokens: 4096,\r\n        messages,\r\n        system: config.systemPrompt,\r\n        temperature: config.temperature,\r\n    });\r\n\r\n    // Extract text from response\r\n    const textContent = response.content.find(c => c.type === 'text');\r\n    return {\r\n        success: true,\r\n        text: textContent?.type === 'text' ? textContent.text : ''\r\n    };\r\n}\r\n\r\n/**\r\n * Generate text using a specific LLM configuration.\r\n * Does NOT use global settings - uses provided config only.\r\n * \r\n * @param config - The LLM instance configuration\r\n * @param prompt - User prompt to send\r\n * @param conversationHistory - Optional conversation history for context\r\n * @returns LLMResult with success status and text or error\r\n */\r\nexport async function generateWithConfig(\r\n    config: LLMInstanceConfig,\r\n    prompt: string,\r\n    conversationHistory?: ChatMessage[],\r\n    images?: string[]\r\n): Promise<LLMResult> {\r\n    // Handle Ollama separately (no API key needed)\r\n    if (config.provider === 'ollama') {\r\n        try {\r\n            return await generateWithOllama(\r\n                config.model,\r\n                config.temperature,\r\n                config.systemPrompt,\r\n                prompt,\r\n                images\r\n            );\r\n        } catch (err) {\r\n            const message = err instanceof Error ? err.message : 'Unknown Ollama error';\r\n            return { success: false, error: message };\r\n        }\r\n    }\r\n\r\n    // Get API key for the provider\r\n    const apiKey = await getApiKeyValue(config.provider);\r\n\r\n    if (!apiKey) {\r\n        return {\r\n            success: false,\r\n            error: `No API key configured for ${config.provider}. Please add one in AI Chat Settings.`\r\n        };\r\n    }\r\n\r\n    try {\r\n        if (config.provider === 'gemini') {\r\n            return await generateWithGeminiConfig(apiKey, config, prompt, conversationHistory, images);\r\n        } else if (config.provider === 'anthropic') {\r\n            return await generateWithAnthropicConfig(apiKey, config, prompt, conversationHistory, images);\r\n        } else {\r\n            // Placeholder for OpenAI\r\n            // TODO: Implement when needed\r\n            return {\r\n                success: false,\r\n                error: `Provider \"${config.provider}\" is not yet implemented.`\r\n            };\r\n        }\r\n    } catch (err) {\r\n        const message = err instanceof Error ? err.message : 'Unknown error occurred';\r\n        return { success: false, error: message };\r\n    }\r\n}\r\n\r\n/**\r\n * Generate text from multiple LLM instances concurrently.\r\n * Useful for orchestration (Full scope) where multiple AIs collaborate.\r\n * \r\n * @param configs - Array of LLM configurations\r\n * @param prompt - User prompt to send to all instances\r\n * @returns Array of LLMResult in same order as configs\r\n */\r\nexport async function generateConcurrent(\r\n    configs: LLMInstanceConfig[],\r\n    prompt: string\r\n): Promise<LLMResult[]> {\r\n    const promises = configs.map(config => generateWithConfig(config, prompt));\r\n    return Promise.all(promises);\r\n}\r\n\r\n/**\r\n * Test connection for a specific LLM configuration.\r\n */\r\nexport async function testConfigConnection(config: LLMInstanceConfig): Promise<LLMResult> {\r\n    return generateWithConfig(\r\n        config,\r\n        'Respond with exactly: \"Connection successful!\"'\r\n    );\r\n}\r\n\r\n/**\r\n * Default system prompts for each scope.\r\n */\r\nexport const DEFAULT_SYSTEM_PROMPTS = {\r\n    backend: `You are a Backend AI expert for the App Factory.\r\nYour scope: Plugins, services, contracts, configurations.\r\nRules:\r\n- Use documented brownfield solutions from existing plugins\r\n- Follow hotswappable plugin architecture patterns\r\n- You CANNOT modify App Factory code - only loaded app files\r\n- In Chat mode: Analyze and answer questions only\r\n- In Change mode: Follow debugging-workflow (plan ÔåÆ approval ÔåÆ execute)`,\r\n\r\n    frontend: `You are a Frontend UI expert following Apple Human Interface Guidelines (HIG).\r\nYour scope: Canvas elements, themes, window config, FE component library.\r\n\r\nCRITICAL: To modify canvas elements, you MUST use the EXACT element ID from CANVAS_CONTEXT.\r\nElement IDs look like \"element-1735934876543\" - copy them EXACTLY, do not invent names.\r\n\r\nOutput format for changes:\r\n\\`\\`\\`json\r\n{\r\n  \"changes\": [\r\n    {\"elementId\": \"element-COPY_EXACT_ID_FROM_CONTEXT\", \"code\": \"const ComponentName = () => { return <div>...</div>; }\"}\r\n  ],\r\n  \"explanation\": \"Description of changes made\"\r\n}\r\n\\`\\`\\`\r\n\r\nRules:\r\n- ALWAYS copy the exact elementId from the CANVAS_CONTEXT block\r\n- Generate complete, self-contained React functional components\r\n- Use Tailwind classes for styling\r\n- In Chat mode: Analyze and answer questions only\r\n- In Change mode: Output JSON with changes array`,\r\n\r\n    full: `You are an Architect AI orchestrating Frontend and Backend solutions.\r\nYour role: Coordinate between FE and BE scopes to create end-to-end solutions.\r\nYour scope: All loaded app resources.\r\n\r\nCRITICAL: To modify canvas elements, you MUST use the EXACT element ID from CANVAS_CONTEXT.\r\nElement IDs look like \"element-1735934876543\" - copy them EXACTLY, do not invent names.\r\n\r\nOutput format for changes:\r\n\\`\\`\\`json\r\n{\r\n  \"changes\": [\r\n    {\"elementId\": \"element-COPY_EXACT_ID_FROM_CONTEXT\", \"code\": \"const ComponentName = () => { return <div>...</div>; }\"}\r\n  ],\r\n  \"explanation\": \"Description of changes made\"\r\n}\r\n\\`\\`\\`\r\n\r\nRules:\r\n- ALWAYS copy the exact elementId from the CANVAS_CONTEXT block\r\n- Delegate FE concerns to Frontend patterns, BE concerns to Backend patterns\r\n- In Chat mode: Analyze and answer questions only\r\n- In Change mode: Output JSON with changes array`,\r\n};\r\n\r\n/**\r\n * Default LLM configuration for each scope.\r\n */\r\nexport const DEFAULT_SCOPE_CONFIGS: Record<'backend' | 'frontend' | 'full', LLMInstanceConfig> = {\r\n    backend: {\r\n        provider: 'gemini',\r\n        model: 'gemini-3-flash-preview',\r\n        apiKeyId: '',\r\n        systemPrompt: DEFAULT_SYSTEM_PROMPTS.backend,\r\n        temperature: 0.3,\r\n    },\r\n    frontend: {\r\n        provider: 'gemini',\r\n        model: 'gemini-3-flash-preview',\r\n        apiKeyId: '',\r\n        systemPrompt: DEFAULT_SYSTEM_PROMPTS.frontend,\r\n        temperature: 0.3,\r\n    },\r\n    full: {\r\n        provider: 'gemini',\r\n        model: 'gemini-3-flash-preview',\r\n        apiKeyId: '',\r\n        systemPrompt: DEFAULT_SYSTEM_PROMPTS.full,\r\n        temperature: 0.2,\r\n    },\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\services\\compilerService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\services\\llmService.ts","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number | undefined\" of template literal expression.","line":112,"column":60,"nodeType":"ChainExpression","messageId":"invalidType","endLine":112,"endColumn":72}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * llmService.ts\r\n * =============\r\n * Service for LLM API calls using the @google/genai SDK.\r\n * Supports Gemini 3 Flash and other Google Gemini models.\r\n * \r\n * Updated for D079 (API Key Management) - now fetches API keys from .env via Tauri IPC.\r\n */\r\n\r\nimport { GoogleGenAI } from '@google/genai';\r\nimport { useSettingsStore } from '../stores/settingsStore';\r\nimport { useApiKeyStore } from '../stores/apiKeyStore';\r\nimport { generateWithOllama } from './ollamaService';\r\n\r\n/**\r\n * Result of an LLM generation call.\r\n */\r\nexport interface LLMResult {\r\n    success: boolean;\r\n    text?: string;\r\n    error?: string;\r\n}\r\n\r\n/**\r\n * Get the current settings from the store (non-reactive).\r\n */\r\nfunction getSettings() {\r\n    return useSettingsStore.getState();\r\n}\r\n\r\n/**\r\n * Get the active API key for a provider.\r\n * Uses the apiKeyStore which fetches from .env via Tauri IPC.\r\n */\r\nasync function getApiKey(provider: string): Promise<string | null> {\r\n    const store = useApiKeyStore.getState();\r\n    // Cast provider to ApiKeyService - validated at runtime via Tauri\r\n    return store.getActiveKeyValue(provider as import('../stores/apiKeyStore').ApiKeyService);\r\n}\r\n\r\n/**\r\n * Generate text using the configured LLM.\r\n * @param prompt - The user prompt to send.\r\n * @returns LLMResult with success status and text or error.\r\n */\r\nexport async function generateText(prompt: string): Promise<LLMResult> {\r\n    const { provider, model, temperature, systemPrompt } = getSettings();\r\n\r\n    // Ollama doesn't require API key\r\n    if (provider === 'ollama') {\r\n        try {\r\n            return await generateWithOllama(model, temperature, systemPrompt, prompt);\r\n        } catch (err) {\r\n            const message = err instanceof Error ? err.message : 'Unknown error occurred';\r\n            return { success: false, error: message };\r\n        }\r\n    }\r\n\r\n    // Get API key from .env via apiKeyStore\r\n    const apiKey = await getApiKey(provider);\r\n\r\n    if (!apiKey) {\r\n        return {\r\n            success: false,\r\n            error: `No API key configured for ${provider}. Please add one in Settings > API Keys.`\r\n        };\r\n    }\r\n\r\n    try {\r\n        if (provider === 'gemini') {\r\n            return await generateWithGemini(apiKey, model, temperature, systemPrompt, prompt);\r\n        } else {\r\n            // Placeholder for other providers (openai, anthropic)\r\n            return { success: false, error: `Provider \"${provider}\" is not yet implemented.` };\r\n        }\r\n    } catch (err) {\r\n        const message = err instanceof Error ? err.message : 'Unknown error occurred';\r\n        return { success: false, error: message };\r\n    }\r\n}\r\n\r\n/**\r\n * Generate text using Google Gemini via @google/genai SDK.\r\n */\r\nasync function generateWithGemini(\r\n    apiKey: string,\r\n    modelId: string,\r\n    temperature: number,\r\n    systemPrompt: string,\r\n    userPrompt: string\r\n): Promise<LLMResult> {\r\n    // Initialize the GoogleGenAI client with the API key\r\n    const ai = new GoogleGenAI({ apiKey });\r\n\r\n    // Log the request for debugging\r\n    console.log(`[LLM Service] Sending request to Gemini (${modelId})`);\r\n    console.log(`[LLM Service] System Prompt:`, systemPrompt);\r\n    console.log(`[LLM Service] User Prompt:`, userPrompt);\r\n\r\n    // Generate content using the new SDK pattern\r\n    const response = await ai.models.generateContent({\r\n        model: modelId,\r\n        contents: userPrompt,\r\n        config: {\r\n            systemInstruction: systemPrompt,\r\n            temperature,\r\n        },\r\n    });\r\n\r\n    // Extract text from response\r\n    const text = response.text;\r\n    console.log(`[LLM Service] Received response length: ${text?.length} chars`);\r\n\r\n    return { success: true, text };\r\n}\r\n\r\n/**\r\n * Test the LLM connection with a simple prompt.\r\n * @returns LLMResult indicating success or failure.\r\n */\r\nexport async function testConnection(): Promise<LLMResult> {\r\n    return generateText('Say \"Connection successful!\" in exactly those words.');\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\services\\ollamaService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":79,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ollamaService.ts\r\n * ================\r\n * Service for interacting with the local Ollama instance.\r\n * Uses the official 'ollama' SDK.\r\n */\r\n\r\nimport ollama from 'ollama/browser';\r\nimport { LLMResult } from './llmService';\r\n\r\n/**\r\n * List all models installed on the local Ollama instance.\r\n * @returns Array of model names (e.g., 'llama3.2', 'mistral')\r\n */\r\nexport async function listLocalModels(): Promise<string[]> {\r\n    try {\r\n        const response = await ollama.list();\r\n        return response.models.map((m) => m.name);\r\n    } catch (error) {\r\n        console.error('Failed to list Ollama models:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\n/**\r\n * Generate text using a local Ollama model.\r\n * @param modelId - The model to use (e.g., 'llama3.2', 'gemma3')\r\n * @param temperature - Temperature setting\r\n * @param systemPrompt - System instruction\r\n * @param userPrompt - User's message\r\n * @param images - Optional array of base64 encoded images (raw or data URI - header stripped automatically)\r\n */\r\nexport async function generateWithOllama(\r\n    modelId: string,\r\n    temperature: number,\r\n    systemPrompt: string,\r\n    userPrompt: string,\r\n    images?: string[]\r\n): Promise<LLMResult> {\r\n    try {\r\n        // Build user message payload\r\n        const userMessage: { role: 'user'; content: string; images?: string[] } = {\r\n            role: 'user',\r\n            content: userPrompt,\r\n        };\r\n\r\n        // Add images if provided (strip data URI header if present)\r\n        if (images && images.length > 0) {\r\n            userMessage.images = images.map(img =>\r\n                img.replace(/^data:image\\/\\w+;base64,/, '')\r\n            );\r\n        }\r\n\r\n        const response = await ollama.chat({\r\n            model: modelId,\r\n            messages: [\r\n                { role: 'system', content: systemPrompt },\r\n                userMessage,\r\n            ],\r\n            options: {\r\n                temperature,\r\n            },\r\n        });\r\n\r\n        return { success: true, text: response.message.content };\r\n    } catch (error) {\r\n        const message = error instanceof Error ? error.message : 'Unknown Ollama error';\r\n        return { success: false, error: `Ollama Error: ${message}` };\r\n    }\r\n}\r\n\r\n/**\r\n * Test connectivity to the local Ollama instance.\r\n */\r\nexport async function testOllamaConnection(): Promise<LLMResult> {\r\n    try {\r\n        await ollama.list();\r\n        return { success: true, text: 'Ollama is running and accessible.' };\r\n    } catch (error) {\r\n        return {\r\n            success: false,\r\n            error: 'Could not connect to Ollama. Make sure it is running at http://localhost:11434',\r\n        };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\aiChatStore.ts","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":94,"column":19,"nodeType":"CallExpression","messageId":"invalidType","endLine":94,"endColumn":29},{"ruleId":"@typescript-eslint/no-unnecessary-type-assertion","severity":2,"message":"This assertion is unnecessary since it does not change the type of the expression.","line":129,"column":35,"nodeType":"TSAsExpression","messageId":"unnecessaryAssertion","endLine":129,"endColumn":129,"fix":{"range":[3523,3601],"text":""}}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\r\n * aiChatStore.ts\r\n * ==============\r\n * Zustand store for AI App Chat feature.\r\n * Manages per-scope LLM configurations, chat history, and operational modes.\r\n * Persisted to localStorage for session continuity.\r\n */\r\n\r\nimport { create } from 'zustand';\r\nimport { persist } from 'zustand/middleware';\r\nimport {\r\n    type LLMInstanceConfig,\r\n    type ChatMessage,\r\n    DEFAULT_SCOPE_CONFIGS,\r\n} from '../services/aiChatLlmService';\r\n\r\n/**\r\n * Operational modes for AI Chat.\r\n */\r\nexport type AiChatMode = 'chat' | 'change';\r\n\r\n/**\r\n * Scope selection for AI Chat.\r\n */\r\nexport type AiChatScope = 'backend' | 'frontend' | 'full';\r\n\r\n/**\r\n * AI Chat state interface.\r\n */\r\nexport interface AiChatState {\r\n    /** Current operational mode */\r\n    mode: AiChatMode;\r\n    /** Current scope selection */\r\n    scope: AiChatScope;\r\n\r\n    /** LLM configuration for Backend scope */\r\n    backendConfig: LLMInstanceConfig;\r\n    /** LLM configuration for Frontend scope */\r\n    frontendConfig: LLMInstanceConfig;\r\n    /** LLM configuration for Full scope */\r\n    fullConfig: LLMInstanceConfig;\r\n\r\n    /** Chat history per scope */\r\n    chatHistory: Record<AiChatScope, ChatMessage[]>;\r\n\r\n    /** Generation loading state */\r\n    isGenerating: boolean;\r\n    /** Last error message */\r\n    error: string | null;\r\n\r\n    /** Settings modal visibility */\r\n    isSettingsOpen: boolean;\r\n}\r\n\r\n/**\r\n * AI Chat actions interface.\r\n */\r\nexport interface AiChatActions {\r\n    /** Set operational mode */\r\n    setMode: (mode: AiChatMode) => void;\r\n    /** Set scope selection */\r\n    setScope: (scope: AiChatScope) => void;\r\n\r\n    /** Update config for a specific scope */\r\n    updateScopeConfig: (scope: AiChatScope, config: Partial<LLMInstanceConfig>) => void;\r\n    /** Get config for current scope */\r\n    getCurrentConfig: () => LLMInstanceConfig;\r\n\r\n    /** Add message to current scope's history */\r\n    addMessage: (message: Omit<ChatMessage, 'id' | 'timestamp'>) => void;\r\n    /** Clear chat history for current scope */\r\n    clearHistory: () => void;\r\n    /** Clear all chat history */\r\n    clearAllHistory: () => void;\r\n\r\n    /** Set generating state */\r\n    setIsGenerating: (isGenerating: boolean) => void;\r\n    /** Set error message */\r\n    setError: (error: string | null) => void;\r\n\r\n    /** Toggle settings modal */\r\n    toggleSettings: () => void;\r\n    /** Set settings modal visibility */\r\n    setSettingsOpen: (isOpen: boolean) => void;\r\n\r\n    /** Reset all settings to defaults */\r\n    resetToDefaults: () => void;\r\n}\r\n\r\n/**\r\n * Generate unique ID for messages.\r\n */\r\nfunction generateId(): string {\r\n    return `msg_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\r\n}\r\n\r\n/**\r\n * Default state values.\r\n */\r\nconst DEFAULT_STATE: AiChatState = {\r\n    mode: 'chat',\r\n    scope: 'full',\r\n    backendConfig: DEFAULT_SCOPE_CONFIGS.backend,\r\n    frontendConfig: DEFAULT_SCOPE_CONFIGS.frontend,\r\n    fullConfig: DEFAULT_SCOPE_CONFIGS.full,\r\n    chatHistory: {\r\n        backend: [],\r\n        frontend: [],\r\n        full: [],\r\n    },\r\n    isGenerating: false,\r\n    error: null,\r\n    isSettingsOpen: false,\r\n};\r\n\r\n/**\r\n * Zustand store for AI Chat with persistence.\r\n */\r\nexport const useAiChatStore = create<AiChatState & AiChatActions>()(\r\n    persist(\r\n        (set, get) => ({\r\n            ...DEFAULT_STATE,\r\n\r\n            setMode: (mode) => set({ mode }),\r\n\r\n            setScope: (scope) => set({ scope }),\r\n\r\n            updateScopeConfig: (scope, config) => {\r\n                const configKey = `${scope}Config` as keyof Pick<AiChatState, 'backendConfig' | 'frontendConfig' | 'fullConfig'>;\r\n                set((state) => ({\r\n                    [configKey]: { ...state[configKey], ...config },\r\n                }));\r\n            },\r\n\r\n            getCurrentConfig: () => {\r\n                const state = get();\r\n                switch (state.scope) {\r\n                    case 'backend':\r\n                        return state.backendConfig;\r\n                    case 'frontend':\r\n                        return state.frontendConfig;\r\n                    case 'full':\r\n                        return state.fullConfig;\r\n                }\r\n            },\r\n\r\n            addMessage: (message) => {\r\n                const { scope } = get();\r\n                const newMessage: ChatMessage = {\r\n                    ...message,\r\n                    id: generateId(),\r\n                    timestamp: new Date(),\r\n                    scope,\r\n                };\r\n                set((state) => ({\r\n                    chatHistory: {\r\n                        ...state.chatHistory,\r\n                        [scope]: [...state.chatHistory[scope], newMessage],\r\n                    },\r\n                }));\r\n            },\r\n\r\n            clearHistory: () => {\r\n                const { scope } = get();\r\n                set((state) => ({\r\n                    chatHistory: {\r\n                        ...state.chatHistory,\r\n                        [scope]: [],\r\n                    },\r\n                }));\r\n            },\r\n\r\n            clearAllHistory: () => {\r\n                set({\r\n                    chatHistory: {\r\n                        backend: [],\r\n                        frontend: [],\r\n                        full: [],\r\n                    },\r\n                });\r\n            },\r\n\r\n            setIsGenerating: (isGenerating) => set({ isGenerating }),\r\n\r\n            setError: (error) => set({ error }),\r\n\r\n            toggleSettings: () => set((state) => ({ isSettingsOpen: !state.isSettingsOpen })),\r\n\r\n            setSettingsOpen: (isOpen) => set({ isSettingsOpen: isOpen }),\r\n\r\n            resetToDefaults: () => set(DEFAULT_STATE),\r\n        }),\r\n        {\r\n            name: 'ai-chat-store',\r\n            version: 3, // Increment when system prompts change\r\n            // Only persist configs and history, not transient state\r\n            partialize: (state) => ({\r\n                mode: state.mode,\r\n                scope: state.scope,\r\n                backendConfig: state.backendConfig,\r\n                frontendConfig: state.frontendConfig,\r\n                fullConfig: state.fullConfig,\r\n                chatHistory: state.chatHistory,\r\n            }),\r\n            // Migrate old versions to apply updated system prompts\r\n            migrate: (persistedState: unknown, version: number) => {\r\n                const state = persistedState as AiChatState;\r\n                if (version < 3) {\r\n                    // Force update system prompts to new defaults\r\n                    console.log('[aiChatStore] Migrating to v3: updating system prompts with exact ID emphasis');\r\n                    return {\r\n                        ...state,\r\n                        backendConfig: { ...state.backendConfig, systemPrompt: DEFAULT_SCOPE_CONFIGS.backend.systemPrompt },\r\n                        frontendConfig: { ...state.frontendConfig, systemPrompt: DEFAULT_SCOPE_CONFIGS.frontend.systemPrompt },\r\n                        fullConfig: { ...state.fullConfig, systemPrompt: DEFAULT_SCOPE_CONFIGS.full.systemPrompt },\r\n                    };\r\n                }\r\n                return state;\r\n            },\r\n        }\r\n    )\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\aiTeamStore.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":350,"column":30,"nodeType":"Property","messageId":"anyAssignment","endLine":350,"endColumn":63},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":388,"column":34,"nodeType":"Property","messageId":"anyAssignment","endLine":388,"endColumn":65},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":426,"column":13,"nodeType":"Property","messageId":"anyAssignment","endLine":429,"endColumn":14}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { Node, Edge, MarkerType } from 'reactflow';\r\n\r\n// ============================================\r\n// TYPE DEFINITIONS\r\n// ============================================\r\n\r\nexport interface AgentLog {\r\n    id: string;\r\n    message: string;\r\n    type: 'info' | 'success' | 'warning' | 'error';\r\n    timestamp: number;\r\n}\r\n\r\nexport interface AgentToolConfig {\r\n    id: string;       // 'brave_search' | 'mcp_context7' | etc.\r\n    name: string;\r\n    enabled: boolean;\r\n}\r\n\r\nexport interface AgentConfiguration {\r\n    id: string;           // 'orchestrator' | 'researcher' | 'designer' | 'developer' | 'qa'\r\n    name: string;\r\n    provider: string;\r\n    model: string;\r\n    temperature: number;\r\n    systemPrompt: string;\r\n    tools: AgentToolConfig[];\r\n    enabled: boolean;\r\n}\r\n\r\nexport interface WorkflowProfile {\r\n    id: string;           // 'fe' | 'be' | 'fullstack' | 'research' | 'debug' | 'test'\r\n    name: string;\r\n    agents: Record<string, boolean>;  // agent_id -> enabled\r\n}\r\n\r\nexport type WorkflowProfileId = 'fe' | 'be' | 'fullstack' | 'research' | 'debug' | 'test';\r\n\r\n// ============================================\r\n// DEFAULT CONFIGURATIONS\r\n// ============================================\r\n\r\nconst DEFAULT_AGENT_TOOLS: Record<string, AgentToolConfig[]> = {\r\n    orchestrator: [],\r\n    researcher: [\r\n        { id: 'brave_search', name: 'Brave Search', enabled: true },\r\n    ],\r\n    designer: [],\r\n    developer: [\r\n        { id: 'mcp_context7', name: 'MCP Context7', enabled: true },\r\n    ],\r\n    qa: [\r\n        { id: 'skills_loader', name: 'Skills Loader', enabled: true },\r\n    ],\r\n};\r\n\r\nconst DEFAULT_AGENT_CONFIGS: AgentConfiguration[] = [\r\n    {\r\n        id: 'orchestrator',\r\n        name: 'Orchestrator',\r\n        provider: 'gemini',\r\n        model: 'gemini-2.0-flash-exp',\r\n        temperature: 0.0,\r\n        systemPrompt: 'You are the Orchestrator. Your job is to break down the user request into a clear plan and coordinate the specialized agents.',\r\n        tools: DEFAULT_AGENT_TOOLS.orchestrator,\r\n        enabled: true,\r\n    },\r\n    {\r\n        id: 'researcher',\r\n        name: 'Researcher',\r\n        provider: 'gemini',\r\n        model: 'gemini-2.0-flash-exp',\r\n        temperature: 0.2,\r\n        systemPrompt: 'You are the Research Agent. You are an expert in finding implementation patterns.',\r\n        tools: DEFAULT_AGENT_TOOLS.researcher,\r\n        enabled: true,\r\n    },\r\n    {\r\n        id: 'designer',\r\n        name: 'Designer',\r\n        provider: 'gemini',\r\n        model: 'gemini-2.0-flash-exp',\r\n        temperature: 0.4,\r\n        systemPrompt: 'You are the Designer Agent. You create architectural blueprints and design documents.',\r\n        tools: DEFAULT_AGENT_TOOLS.designer,\r\n        enabled: true,\r\n    },\r\n    {\r\n        id: 'developer',\r\n        name: 'Developer',\r\n        provider: 'gemini',\r\n        model: 'gemini-2.0-flash-exp',\r\n        temperature: 0.1,\r\n        systemPrompt: 'You are the Developer Agent. You write code based on design blueprints.',\r\n        tools: DEFAULT_AGENT_TOOLS.developer,\r\n        enabled: true,\r\n    },\r\n    {\r\n        id: 'qa',\r\n        name: 'QA',\r\n        provider: 'gemini',\r\n        model: 'gemini-2.0-flash-exp',\r\n        temperature: 0.1,\r\n        systemPrompt: 'You are the QA Agent. You validate the code and designs against the requirements.',\r\n        tools: DEFAULT_AGENT_TOOLS.qa,\r\n        enabled: true,\r\n    },\r\n];\r\n\r\nconst DEFAULT_WORKFLOW_PROFILES: WorkflowProfile[] = [\r\n    {\r\n        id: 'fe',\r\n        name: 'Frontend Only',\r\n        agents: { orchestrator: true, researcher: true, designer: true, developer: false, qa: false },\r\n    },\r\n    {\r\n        id: 'be',\r\n        name: 'Backend Only',\r\n        agents: { orchestrator: true, researcher: true, designer: false, developer: true, qa: true },\r\n    },\r\n    {\r\n        id: 'fullstack',\r\n        name: 'Full Stack',\r\n        agents: { orchestrator: true, researcher: true, designer: true, developer: true, qa: true },\r\n    },\r\n    {\r\n        id: 'research',\r\n        name: 'Pre-project Research',\r\n        agents: { orchestrator: true, researcher: true, designer: false, developer: false, qa: false },\r\n    },\r\n    {\r\n        id: 'debug',\r\n        name: 'Debug',\r\n        agents: { orchestrator: true, researcher: true, designer: false, developer: true, qa: true },\r\n    },\r\n    {\r\n        id: 'test',\r\n        name: 'Test',\r\n        agents: { orchestrator: true, researcher: false, designer: false, developer: false, qa: true },\r\n    },\r\n];\r\n\r\n// ============================================\r\n// REACTFLOW NODE/EDGE DEFAULTS\r\n// ============================================\r\n\r\nconst createInitialNodes = (agentConfigs: AgentConfiguration[]): Node[] => [\r\n    {\r\n        id: 'orchestrator',\r\n        type: 'agent',\r\n        position: { x: 400, y: 50 },\r\n        data: {\r\n            label: 'Orchestrator',\r\n            active: false,\r\n            enabled: agentConfigs.find(a => a.id === 'orchestrator')?.enabled ?? true,\r\n        },\r\n    },\r\n    {\r\n        id: 'researcher',\r\n        type: 'agent',\r\n        position: { x: 100, y: 200 },\r\n        data: {\r\n            label: 'Researcher',\r\n            active: false,\r\n            subLabel: 'Idle',\r\n            enabled: agentConfigs.find(a => a.id === 'researcher')?.enabled ?? true,\r\n        },\r\n    },\r\n    {\r\n        id: 'designer',\r\n        type: 'agent',\r\n        position: { x: 300, y: 350 },\r\n        data: {\r\n            label: 'Designer',\r\n            active: false,\r\n            subLabel: 'Idle',\r\n            enabled: agentConfigs.find(a => a.id === 'designer')?.enabled ?? true,\r\n        },\r\n    },\r\n    {\r\n        id: 'developer',\r\n        type: 'agent',\r\n        position: { x: 500, y: 350 },\r\n        data: {\r\n            label: 'Developer',\r\n            active: false,\r\n            subLabel: 'Idle',\r\n            enabled: agentConfigs.find(a => a.id === 'developer')?.enabled ?? true,\r\n        },\r\n    },\r\n    {\r\n        id: 'qa',\r\n        type: 'agent',\r\n        position: { x: 700, y: 200 },\r\n        data: {\r\n            label: 'QA',\r\n            active: false,\r\n            subLabel: 'Idle',\r\n            enabled: agentConfigs.find(a => a.id === 'qa')?.enabled ?? true,\r\n        },\r\n    },\r\n];\r\n\r\nconst initialEdges: Edge[] = [\r\n    // Orchestrator Down to Agents\r\n    {\r\n        id: 'orch-res',\r\n        source: 'orchestrator',\r\n        target: 'researcher',\r\n        animated: false,\r\n        style: { stroke: '#525252', strokeWidth: 2, strokeDasharray: '5,5' },\r\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#525252' },\r\n    },\r\n    {\r\n        id: 'orch-des',\r\n        source: 'orchestrator',\r\n        target: 'designer',\r\n        animated: false,\r\n        style: { stroke: '#525252', strokeWidth: 2, strokeDasharray: '5,5' },\r\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#525252' },\r\n    },\r\n    {\r\n        id: 'orch-dev',\r\n        source: 'orchestrator',\r\n        target: 'developer',\r\n        animated: false,\r\n        style: { stroke: '#525252', strokeWidth: 2, strokeDasharray: '5,5' },\r\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#525252' },\r\n    },\r\n    {\r\n        id: 'orch-qa',\r\n        source: 'orchestrator',\r\n        target: 'qa',\r\n        animated: false,\r\n        style: { stroke: '#525252', strokeWidth: 2, strokeDasharray: '5,5' },\r\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#525252' },\r\n    },\r\n    // Horizontal Flow\r\n    {\r\n        id: 'res-des',\r\n        source: 'researcher',\r\n        sourceHandle: 'r',\r\n        target: 'designer',\r\n        targetHandle: 'l',\r\n        animated: false,\r\n        label: 'Specs',\r\n        labelStyle: { fill: '#666', fontWeight: 500 },\r\n        labelBgStyle: { fill: '#1a1a1a', fillOpacity: 0.8 },\r\n        style: { stroke: '#525252', strokeWidth: 2, strokeDasharray: '5,5' },\r\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#525252' },\r\n    },\r\n    {\r\n        id: 'des-dev',\r\n        source: 'designer',\r\n        sourceHandle: 'r',\r\n        target: 'developer',\r\n        targetHandle: 'l',\r\n        label: 'Blueprints',\r\n        labelStyle: { fill: '#666', fontWeight: 500 },\r\n        labelBgStyle: { fill: '#1a1a1a', fillOpacity: 0.8 },\r\n        style: { stroke: '#525252', strokeWidth: 2, strokeDasharray: '5,5' },\r\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#525252' },\r\n    },\r\n    {\r\n        id: 'dev-qa',\r\n        source: 'developer',\r\n        sourceHandle: 'r',\r\n        target: 'qa',\r\n        targetHandle: 'l',\r\n        label: 'Code',\r\n        labelStyle: { fill: '#666', fontWeight: 500 },\r\n        labelBgStyle: { fill: '#1a1a1a', fillOpacity: 0.8 },\r\n        style: { stroke: '#525252', strokeWidth: 2, strokeDasharray: '5,5' },\r\n        markerEnd: { type: MarkerType.ArrowClosed, color: '#525252' },\r\n    },\r\n];\r\n\r\n// ============================================\r\n// STORE STATE INTERFACE\r\n// ============================================\r\n\r\nexport interface AiTeamState {\r\n    // ReactFlow visualization\r\n    nodes: Node[];\r\n    edges: Edge[];\r\n\r\n    // Activity logging\r\n    logs: AgentLog[];\r\n    overallProgress: number;\r\n\r\n    // Agent configuration\r\n    agentConfigs: AgentConfiguration[];\r\n\r\n    // Workflow profiles\r\n    workflowProfiles: WorkflowProfile[];\r\n    selectedProfileId: WorkflowProfileId;\r\n\r\n    // Workflow execution state\r\n    isWorkflowRunning: boolean;\r\n\r\n    // Actions - Visualization\r\n    setNodes: (nodes: Node[]) => void;\r\n    setEdges: (edges: Edge[]) => void;\r\n    updateNodeStatus: (nodeId: string, status: { active?: boolean; subLabel?: string }) => void;\r\n\r\n    // Actions - Logging\r\n    addLog: (message: string, type?: AgentLog['type']) => void;\r\n    clearLogs: () => void;\r\n    setProgress: (progress: number) => void;\r\n\r\n    // Actions - Agent configuration\r\n    updateAgentConfig: (agentId: string, config: Partial<AgentConfiguration>) => void;\r\n    toggleAgent: (agentId: string, enabled: boolean) => void;\r\n    toggleAgentTool: (agentId: string, toolId: string, enabled: boolean) => void;\r\n\r\n    // Actions - Workflow profiles\r\n    setSelectedProfile: (profileId: WorkflowProfileId) => void;\r\n    applyProfile: (profileId: WorkflowProfileId) => void;\r\n    updateProfile: (profileId: string, agents: Record<string, boolean>) => void;\r\n\r\n    // Actions - Workflow execution\r\n    setWorkflowRunning: (running: boolean) => void;\r\n\r\n    // Actions - Reset\r\n    resetSimulation: () => void;\r\n}\r\n\r\n// ============================================\r\n// STORE IMPLEMENTATION\r\n// ============================================\r\n\r\nexport const useAiTeamStore = create<AiTeamState>((set, get) => ({\r\n    nodes: createInitialNodes(DEFAULT_AGENT_CONFIGS),\r\n    edges: initialEdges,\r\n    logs: [],\r\n    overallProgress: 0,\r\n    agentConfigs: DEFAULT_AGENT_CONFIGS,\r\n    workflowProfiles: DEFAULT_WORKFLOW_PROFILES,\r\n    selectedProfileId: 'fullstack',\r\n    isWorkflowRunning: false,\r\n\r\n    // Visualization actions\r\n    setNodes: (nodes) => set({ nodes }),\r\n    setEdges: (edges) => set({ edges }),\r\n\r\n    updateNodeStatus: (nodeId, status) => set((state) => ({\r\n        nodes: state.nodes.map((node) =>\r\n            node.id === nodeId\r\n                ? { ...node, data: { ...node.data, ...status } }\r\n                : node\r\n        ),\r\n    })),\r\n\r\n    // Logging actions\r\n    addLog: (message, type = 'info') => set((state) => ({\r\n        logs: [...state.logs, {\r\n            id: Date.now().toString(),\r\n            message,\r\n            type,\r\n            timestamp: Date.now()\r\n        }].slice(-50) // Keep last 50 logs for real-time streaming\r\n    })),\r\n\r\n    clearLogs: () => set({ logs: [] }),\r\n\r\n    setProgress: (progress) => set({ overallProgress: progress }),\r\n\r\n    // Agent configuration actions\r\n    updateAgentConfig: (agentId, config) => set((state) => ({\r\n        agentConfigs: state.agentConfigs.map((agent) =>\r\n            agent.id === agentId\r\n                ? { ...agent, ...config }\r\n                : agent\r\n        ),\r\n    })),\r\n\r\n    toggleAgent: (agentId, enabled) => {\r\n        set((state) => ({\r\n            agentConfigs: state.agentConfigs.map((agent) =>\r\n                agent.id === agentId\r\n                    ? { ...agent, enabled }\r\n                    : agent\r\n            ),\r\n            // Also update the ReactFlow node\r\n            nodes: state.nodes.map((node) =>\r\n                node.id === agentId\r\n                    ? { ...node, data: { ...node.data, enabled } }\r\n                    : node\r\n            ),\r\n        }));\r\n    },\r\n\r\n    toggleAgentTool: (agentId, toolId, enabled) => set((state) => ({\r\n        agentConfigs: state.agentConfigs.map((agent) =>\r\n            agent.id === agentId\r\n                ? {\r\n                    ...agent,\r\n                    tools: agent.tools.map((tool) =>\r\n                        tool.id === toolId\r\n                            ? { ...tool, enabled }\r\n                            : tool\r\n                    ),\r\n                }\r\n                : agent\r\n        ),\r\n    })),\r\n\r\n    // Workflow profile actions\r\n    setSelectedProfile: (profileId) => set({ selectedProfileId: profileId }),\r\n\r\n    applyProfile: (profileId) => {\r\n        const state = get();\r\n        const profile = state.workflowProfiles.find((p) => p.id === profileId);\r\n        if (!profile) return;\r\n\r\n        // Update agent enabled states based on profile\r\n        const updatedAgentConfigs = state.agentConfigs.map((agent) => ({\r\n            ...agent,\r\n            enabled: profile.agents[agent.id] ?? true,\r\n        }));\r\n\r\n        // Update nodes with enabled state\r\n        const updatedNodes = state.nodes.map((node) => ({\r\n            ...node,\r\n            data: {\r\n                ...node.data,\r\n                enabled: profile.agents[node.id] ?? true,\r\n            },\r\n        }));\r\n\r\n        set({\r\n            selectedProfileId: profileId,\r\n            agentConfigs: updatedAgentConfigs,\r\n            nodes: updatedNodes,\r\n        });\r\n    },\r\n\r\n    updateProfile: (profileId, agents) => set((state) => ({\r\n        workflowProfiles: state.workflowProfiles.map((profile) =>\r\n            profile.id === profileId\r\n                ? { ...profile, agents }\r\n                : profile\r\n        ),\r\n    })),\r\n\r\n    // Workflow execution actions\r\n    setWorkflowRunning: (running) => set({ isWorkflowRunning: running }),\r\n\r\n    // Reset\r\n    resetSimulation: () => {\r\n        const state = get();\r\n        set({\r\n            nodes: createInitialNodes(state.agentConfigs),\r\n            edges: initialEdges,\r\n            logs: [],\r\n            overallProgress: 0,\r\n            isWorkflowRunning: false,\r\n        });\r\n    },\r\n}));\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\apiKeyStore.ts","messages":[{"ruleId":"@typescript-eslint/no-floating-promises","severity":2,"message":"Promises must be awaited, end with a call to .catch, end with a call to .then with a rejection handler or be explicitly marked as ignored with the `void` operator.","line":151,"column":9,"nodeType":"ExpressionStatement","messageId":"floatingVoid","endLine":151,"endColumn":34,"suggestions":[{"messageId":"floatingFixVoid","fix":{"range":[4164,4164],"text":"void "},"desc":"Add void operator to ignore."},{"messageId":"floatingFixAwait","fix":{"range":[4164,4164],"text":"await "},"desc":"Add await operator."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":195,"column":34,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":195,"endColumn":53},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":229,"column":34,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":229,"endColumn":53},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":251,"column":34,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":251,"endColumn":53},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":273,"column":34,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":273,"endColumn":53},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":292,"column":29,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":292,"endColumn":48}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * apiKeyStore.ts\r\n * ==============\r\n * Zustand store for API key management.\r\n * Communicates with Rust backend via Tauri IPC for persistent .env storage.\r\n * \r\n * D079 - API Key Management (EUR-1.2.6)\r\n */\r\n\r\nimport { create } from 'zustand';\r\nimport { invoke } from '@tauri-apps/api/tauri';\r\n\r\n// ============================================\r\n// TYPES\r\n// ============================================\r\n\r\n/**\r\n * Supported services for API keys.\r\n */\r\nexport type ApiKeyService =\r\n    | 'gemini'\r\n    | 'openai'\r\n    | 'anthropic'\r\n    | 'ollama'\r\n    | 'tts'\r\n    | 'stt'\r\n    | 'vision'\r\n    | 'embedding';\r\n\r\n/**\r\n * API key entry from backend.\r\n * Note: keyMasked shows only first 3 + last 3 characters.\r\n */\r\nexport interface ApiKeyEntry {\r\n    id: string;\r\n    service: string;\r\n    name: string;\r\n    keyMasked: string;\r\n    isActive: boolean;\r\n    createdAt: string;\r\n}\r\n\r\n/**\r\n * Response from Rust backend (snake_case).\r\n */\r\ninterface ApiKeyEntryRaw {\r\n    id: string;\r\n    service: string;\r\n    name: string;\r\n    key_masked: string;\r\n    is_active: boolean;\r\n    created_at: string;\r\n}\r\n\r\n/**\r\n * Convert raw backend response to camelCase.\r\n */\r\nfunction mapApiKeyEntry(raw: ApiKeyEntryRaw): ApiKeyEntry {\r\n    return {\r\n        id: raw.id,\r\n        service: raw.service,\r\n        name: raw.name,\r\n        keyMasked: raw.key_masked,\r\n        isActive: raw.is_active,\r\n        createdAt: raw.created_at,\r\n    };\r\n}\r\n\r\n// ============================================\r\n// STORE STATE & ACTIONS\r\n// ============================================\r\n\r\ninterface ApiKeyState {\r\n    /** Keys grouped by service */\r\n    keys: Record<string, ApiKeyEntry[]>;\r\n    /** Currently selected service in UI */\r\n    selectedService: ApiKeyService;\r\n    /** Loading state */\r\n    isLoading: boolean;\r\n    /** Error message */\r\n    error: string | null;\r\n}\r\n\r\ninterface ApiKeyActions {\r\n    /** Set the selected service for UI filtering */\r\n    setSelectedService: (service: ApiKeyService) => void;\r\n\r\n    /** Fetch all keys for a service from backend */\r\n    fetchKeys: (service: ApiKeyService) => Promise<void>;\r\n\r\n    /** Add a new API key */\r\n    addKey: (service: ApiKeyService, name: string, key: string) => Promise<ApiKeyEntry>;\r\n\r\n    /** Update an existing key */\r\n    updateKey: (service: ApiKeyService, id: string, name?: string, key?: string) => Promise<void>;\r\n\r\n    /** Delete a key */\r\n    deleteKey: (service: ApiKeyService, id: string) => Promise<void>;\r\n\r\n    /** Set the active key for a service */\r\n    setActiveKey: (service: ApiKeyService, id: string) => Promise<void>;\r\n\r\n    /** Get the active key for a service (from local cache) */\r\n    getActiveKey: (service: ApiKeyService) => ApiKeyEntry | undefined;\r\n\r\n    /** Get the actual API key value for API calls (from backend) */\r\n    getActiveKeyValue: (service: ApiKeyService) => Promise<string | null>;\r\n\r\n    /** Clear error state */\r\n    clearError: () => void;\r\n}\r\n\r\n// ============================================\r\n// TAURI-SAFE INVOKE WRAPPER\r\n// ============================================\r\n\r\n/**\r\n * Check if we're running in Tauri environment.\r\n */\r\nfunction isTauriEnv(): boolean {\r\n    return typeof window !== 'undefined' &&\r\n        '__TAURI__' in window &&\r\n        typeof (window as unknown as { __TAURI_IPC__?: unknown }).__TAURI_IPC__ === 'function';\r\n}\r\n\r\n/**\r\n * Safe invoke that returns null in browser environment.\r\n */\r\nasync function safeInvoke<T>(cmd: string, args?: Record<string, unknown>): Promise<T | null> {\r\n    if (!isTauriEnv()) {\r\n        console.warn(`[apiKeyStore] Tauri not available, skipping: ${cmd}`);\r\n        return null;\r\n    }\r\n    return invoke<T>(cmd, args);\r\n}\r\n\r\n// ============================================\r\n// STORE IMPLEMENTATION\r\n// ============================================\r\n\r\nexport const useApiKeyStore = create<ApiKeyState & ApiKeyActions>()((set, get) => ({\r\n    // Initial state\r\n    keys: {},\r\n    selectedService: 'gemini',\r\n    isLoading: false,\r\n    error: null,\r\n\r\n    setSelectedService: (service) => {\r\n        set({ selectedService: service, error: null });\r\n        // Auto-fetch keys for the selected service\r\n        get().fetchKeys(service);\r\n    },\r\n\r\n    fetchKeys: async (service) => {\r\n        set({ isLoading: true, error: null });\r\n\r\n        try {\r\n            const result = await safeInvoke<ApiKeyEntryRaw[]>('get_api_keys', { service });\r\n\r\n            if (result === null) {\r\n                // Browser environment - no keys available\r\n                set((state) => ({\r\n                    keys: { ...state.keys, [service]: [] },\r\n                    isLoading: false,\r\n                }));\r\n                return;\r\n            }\r\n\r\n            const entries = result.map(mapApiKeyEntry);\r\n\r\n            set((state) => ({\r\n                keys: { ...state.keys, [service]: entries },\r\n                isLoading: false,\r\n            }));\r\n        } catch (err) {\r\n            const message = err instanceof Error ? err.message : String(err);\r\n            console.error('[apiKeyStore] fetchKeys error:', message);\r\n            set({ error: message, isLoading: false });\r\n        }\r\n    },\r\n\r\n    addKey: async (service, name, key) => {\r\n        set({ isLoading: true, error: null });\r\n\r\n        try {\r\n            const result = await safeInvoke<ApiKeyEntryRaw>('add_api_key', { service, name, key });\r\n\r\n            if (result === null) {\r\n                throw new Error('Tauri not available - cannot add keys in browser mode');\r\n            }\r\n\r\n            const entry = mapApiKeyEntry(result);\r\n\r\n            set((state) => {\r\n                const existing = state.keys[service] || [];\r\n                // If this is the first key, it becomes active\r\n                const updated = entry.isActive\r\n                    ? [...existing.map(k => ({ ...k, isActive: false })), entry]\r\n                    : [...existing, entry];\r\n\r\n                return {\r\n                    keys: { ...state.keys, [service]: updated },\r\n                    isLoading: false,\r\n                };\r\n            });\r\n\r\n            return entry;\r\n        } catch (err) {\r\n            const message = err instanceof Error ? err.message : String(err);\r\n            console.error('[apiKeyStore] addKey error:', message);\r\n            set({ error: message, isLoading: false });\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    updateKey: async (service, id, name, key) => {\r\n        set({ isLoading: true, error: null });\r\n\r\n        try {\r\n            const result = await safeInvoke<ApiKeyEntryRaw>('update_api_key', { service, id, name, key });\r\n\r\n            if (result === null) {\r\n                throw new Error('Tauri not available');\r\n            }\r\n\r\n            const entry = mapApiKeyEntry(result);\r\n\r\n            set((state) => {\r\n                const existing = state.keys[service] || [];\r\n                const updated = existing.map(k => k.id === id ? entry : k);\r\n                return {\r\n                    keys: { ...state.keys, [service]: updated },\r\n                    isLoading: false,\r\n                };\r\n            });\r\n        } catch (err) {\r\n            const message = err instanceof Error ? err.message : String(err);\r\n            console.error('[apiKeyStore] updateKey error:', message);\r\n            set({ error: message, isLoading: false });\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    deleteKey: async (service, id) => {\r\n        set({ isLoading: true, error: null });\r\n\r\n        try {\r\n            await safeInvoke('delete_api_key', { service, id });\r\n\r\n            set((state) => {\r\n                const existing = state.keys[service] || [];\r\n                const updated = existing.filter(k => k.id !== id);\r\n                return {\r\n                    keys: { ...state.keys, [service]: updated },\r\n                    isLoading: false,\r\n                };\r\n            });\r\n        } catch (err) {\r\n            const message = err instanceof Error ? err.message : String(err);\r\n            console.error('[apiKeyStore] deleteKey error:', message);\r\n            set({ error: message, isLoading: false });\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    setActiveKey: async (service, id) => {\r\n        set({ isLoading: true, error: null });\r\n\r\n        try {\r\n            await safeInvoke('set_active_api_key', { service, id });\r\n\r\n            set((state) => {\r\n                const existing = state.keys[service] || [];\r\n                const updated = existing.map(k => ({\r\n                    ...k,\r\n                    isActive: k.id === id,\r\n                }));\r\n                return {\r\n                    keys: { ...state.keys, [service]: updated },\r\n                    isLoading: false,\r\n                };\r\n            });\r\n        } catch (err) {\r\n            const message = err instanceof Error ? err.message : String(err);\r\n            console.error('[apiKeyStore] setActiveKey error:', message);\r\n            set({ error: message, isLoading: false });\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    getActiveKey: (service) => {\r\n        const serviceKeys = get().keys[service] || [];\r\n        return serviceKeys.find(k => k.isActive);\r\n    },\r\n\r\n    getActiveKeyValue: async (service) => {\r\n        try {\r\n            const result = await safeInvoke<string | null>('get_active_api_key_value', { service });\r\n            return result;\r\n        } catch (err) {\r\n            console.error('[apiKeyStore] getActiveKeyValue error:', err);\r\n            return null;\r\n        }\r\n    },\r\n\r\n    clearError: () => set({ error: null }),\r\n}));\r\n\r\n// ============================================\r\n// SERVICE LABELS\r\n// ============================================\r\n\r\n/**\r\n * Human-readable labels for API key services.\r\n */\r\nexport const API_KEY_SERVICE_LABELS: Record<ApiKeyService, string> = {\r\n    gemini: 'Google Gemini',\r\n    openai: 'OpenAI',\r\n    anthropic: 'Anthropic',\r\n    ollama: 'Ollama (Local)',\r\n    tts: 'Text-to-Speech',\r\n    stt: 'Speech-to-Text',\r\n    vision: 'Vision',\r\n    embedding: 'Embedding',\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\componentLibraryStore.ts","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":173,"column":20,"nodeType":"CallExpression","messageId":"invalidType","endLine":173,"endColumn":30},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":181,"column":29,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":181,"endColumn":34,"fix":{"range":[5351,5399],"text":"/const\\s+([A-Z][a-zA-Z0-9]*)\\s*[:=]/.exec(code)"}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":184,"column":28,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":184,"endColumn":33,"fix":{"range":[5469,5518],"text":"/function\\s+([A-Z][a-zA-Z0-9]*)\\s*\\(/.exec(code)"}},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":187,"column":25,"nodeType":"CallExpression","messageId":"invalidType","endLine":187,"endColumn":35},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":235,"column":46,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":235,"endColumn":48,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[7296,7298],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":236,"column":38,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":236,"endColumn":40,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[7346,7348],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":297,"column":77,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":297,"endColumn":79,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[9619,9621],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-plus-operands","severity":2,"message":"Operands of '+' operations must be a number or string. Got `string` + `number`.","line":366,"column":25,"nodeType":"BinaryExpression","messageId":"mismatched","endLine":366,"endColumn":45},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":451,"column":69,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":451,"endColumn":71,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[15447,15449],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\r\n * src/stores/componentLibraryStore.ts\r\n * ====================================\r\n * Zustand store for managing AI-generated component library.\r\n * Stores saved components with code, metadata, and thumbnails.\r\n * Persisted to localStorage with Tauri storage fallback.\r\n *\r\n * Architecture: Option B (Backend Pre-Compilation)\r\n * Dependencies: D070 (ComponentGenerator), LiveComponentPreview\r\n */\r\n\r\nimport { create } from 'zustand';\r\nimport { persist, createJSONStorage } from 'zustand/middleware';\r\n\r\n// =============================================================================\r\n// TYPES\r\n// =============================================================================\r\n\r\n/**\r\n * Framework type for components.\r\n */\r\nexport type ComponentFramework = 'react' | 'vue' | 'svelte' | 'html';\r\n\r\n/**\r\n * Category for organizing components.\r\n */\r\nexport type ComponentCategory =\r\n    | 'buttons'\r\n    | 'cards'\r\n    | 'forms'\r\n    | 'navigation'\r\n    | 'layout'\r\n    | 'modals'\r\n    | 'tables'\r\n    | 'charts'\r\n    | 'icons'\r\n    | 'other';\r\n\r\n/**\r\n * A saved component in the library.\r\n */\r\nexport interface LibraryComponent {\r\n    /** Unique identifier */\r\n    id: string;\r\n    /** Display name */\r\n    name: string;\r\n    /** Optional description */\r\n    description?: string;\r\n    /** Raw TSX/component code */\r\n    code: string;\r\n    /** Compiled JavaScript (cached for performance) */\r\n    compiledCode?: string;\r\n    /** Target framework */\r\n    framework: ComponentFramework;\r\n    /** Category for organization */\r\n    category: ComponentCategory;\r\n    /** User-defined tags for search */\r\n    tags: string[];\r\n    /** Base64 thumbnail image (PNG or WebP) */\r\n    thumbnail?: string;\r\n    /** Original prompt used to generate the component */\r\n    prompt?: string;\r\n    /** Creation timestamp */\r\n    createdAt: number;\r\n    /** Last modified timestamp */\r\n    updatedAt: number;\r\n    /** Whether this is a favorite */\r\n    isFavorite: boolean;\r\n}\r\n\r\n/**\r\n * Input for adding a new component to the library.\r\n */\r\nexport interface AddComponentInput {\r\n    name: string;\r\n    code: string;\r\n    framework: ComponentFramework;\r\n    description?: string;\r\n    category?: ComponentCategory;\r\n    tags?: string[];\r\n    thumbnail?: string;\r\n    prompt?: string;\r\n}\r\n\r\n/**\r\n * Input for updating an existing component.\r\n */\r\nexport interface UpdateComponentInput {\r\n    name?: string;\r\n    description?: string;\r\n    code?: string;\r\n    compiledCode?: string;\r\n    category?: ComponentCategory;\r\n    tags?: string[];\r\n    thumbnail?: string;\r\n    isFavorite?: boolean;\r\n}\r\n\r\n// =============================================================================\r\n// STORE STATE & ACTIONS\r\n// =============================================================================\r\n\r\n/**\r\n * Component library state interface.\r\n */\r\nexport interface ComponentLibraryState {\r\n    /** All saved components */\r\n    components: LibraryComponent[];\r\n    /** Currently selected component ID */\r\n    selectedComponentId: string | null;\r\n    /** Search query for filtering */\r\n    searchQuery: string;\r\n    /** Category filter */\r\n    categoryFilter: ComponentCategory | 'all';\r\n    /** Whether to show only favorites */\r\n    showFavoritesOnly: boolean;\r\n}\r\n\r\n/**\r\n * Component library actions interface.\r\n */\r\nexport interface ComponentLibraryActions {\r\n    // CRUD operations\r\n    addComponent: (input: AddComponentInput) => LibraryComponent;\r\n    updateComponent: (id: string, input: UpdateComponentInput) => void;\r\n    deleteComponent: (id: string) => void;\r\n    duplicateComponent: (id: string) => LibraryComponent | null;\r\n\r\n    // Selection\r\n    selectComponent: (id: string | null) => void;\r\n    getSelectedComponent: () => LibraryComponent | null;\r\n\r\n    // Filtering\r\n    setSearchQuery: (query: string) => void;\r\n    setCategoryFilter: (category: ComponentCategory | 'all') => void;\r\n    setShowFavoritesOnly: (show: boolean) => void;\r\n    getFilteredComponents: () => LibraryComponent[];\r\n\r\n    // Favorites\r\n    toggleFavorite: (id: string) => void;\r\n\r\n    // Bulk operations\r\n    importComponents: (components: LibraryComponent[]) => void;\r\n    exportComponents: () => LibraryComponent[];\r\n    clearLibrary: () => void;\r\n\r\n    // Utilities\r\n    getComponentById: (id: string) => LibraryComponent | undefined;\r\n    getComponentsByCategory: (category: ComponentCategory) => LibraryComponent[];\r\n    getComponentCount: () => number;\r\n}\r\n\r\n// =============================================================================\r\n// INITIAL STATE\r\n// =============================================================================\r\n\r\nconst initialState: ComponentLibraryState = {\r\n    components: [],\r\n    selectedComponentId: null,\r\n    searchQuery: '',\r\n    categoryFilter: 'all',\r\n    showFavoritesOnly: false,\r\n};\r\n\r\n// =============================================================================\r\n// HELPERS\r\n// =============================================================================\r\n\r\n/**\r\n * Generate a unique ID for a component.\r\n */\r\nfunction generateId(): string {\r\n    return `comp_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\r\n}\r\n\r\n/**\r\n * Extract component name from code if not provided.\r\n */\r\nfunction extractNameFromCode(code: string): string {\r\n    // Match: const ComponentName = or function ComponentName\r\n    const constMatch = code.match(/const\\s+([A-Z][a-zA-Z0-9]*)\\s*[:=]/);\r\n    if (constMatch) return constMatch[1];\r\n\r\n    const funcMatch = code.match(/function\\s+([A-Z][a-zA-Z0-9]*)\\s*\\(/);\r\n    if (funcMatch) return funcMatch[1];\r\n\r\n    return `Component_${Date.now()}`;\r\n}\r\n\r\n// =============================================================================\r\n// STORE\r\n// =============================================================================\r\n\r\n/**\r\n * Zustand store for component library.\r\n * \r\n * Provides CRUD operations for managing AI-generated components,\r\n * with filtering, search, and favorites functionality.\r\n * \r\n * @example\r\n * ```typescript\r\n * import { useComponentLibraryStore } from '../stores/componentLibraryStore';\r\n * \r\n * // Add a component\r\n * const component = useComponentLibraryStore.getState().addComponent({\r\n *     name: 'PrimaryButton',\r\n *     code: 'const PrimaryButton = () => <button>Click me</button>',\r\n *     framework: 'react',\r\n *     category: 'buttons',\r\n * });\r\n * \r\n * // Get filtered components\r\n * const filtered = useComponentLibraryStore.getState().getFilteredComponents();\r\n * ```\r\n */\r\nexport const useComponentLibraryStore = create<ComponentLibraryState & ComponentLibraryActions>()(\r\n    persist(\r\n        (set, get) => ({\r\n            ...initialState,\r\n\r\n            // =========================================================\r\n            // CRUD OPERATIONS\r\n            // =========================================================\r\n\r\n            addComponent: (input) => {\r\n                const id = generateId();\r\n                const now = Date.now();\r\n\r\n                const newComponent: LibraryComponent = {\r\n                    id,\r\n                    name: input.name || extractNameFromCode(input.code),\r\n                    description: input.description,\r\n                    code: input.code,\r\n                    framework: input.framework,\r\n                    category: input.category || 'other',\r\n                    tags: input.tags || [],\r\n                    thumbnail: input.thumbnail,\r\n                    prompt: input.prompt,\r\n                    createdAt: now,\r\n                    updatedAt: now,\r\n                    isFavorite: false,\r\n                };\r\n\r\n                set((state) => ({\r\n                    components: [...state.components, newComponent],\r\n                }));\r\n\r\n                return newComponent;\r\n            },\r\n\r\n            updateComponent: (id, input) => {\r\n                set((state) => ({\r\n                    components: state.components.map((comp) =>\r\n                        comp.id === id\r\n                            ? { ...comp, ...input, updatedAt: Date.now() }\r\n                            : comp\r\n                    ),\r\n                }));\r\n            },\r\n\r\n            deleteComponent: (id) => {\r\n                set((state) => ({\r\n                    components: state.components.filter((comp) => comp.id !== id),\r\n                    selectedComponentId:\r\n                        state.selectedComponentId === id ? null : state.selectedComponentId,\r\n                }));\r\n            },\r\n\r\n            duplicateComponent: (id) => {\r\n                const original = get().getComponentById(id);\r\n                if (!original) return null;\r\n\r\n                const duplicate = get().addComponent({\r\n                    name: `${original.name} (Copy)`,\r\n                    code: original.code,\r\n                    framework: original.framework,\r\n                    description: original.description,\r\n                    category: original.category,\r\n                    tags: [...original.tags],\r\n                    thumbnail: original.thumbnail,\r\n                    prompt: original.prompt,\r\n                });\r\n\r\n                return duplicate;\r\n            },\r\n\r\n            // =========================================================\r\n            // SELECTION\r\n            // =========================================================\r\n\r\n            selectComponent: (id) => {\r\n                set({ selectedComponentId: id });\r\n            },\r\n\r\n            getSelectedComponent: () => {\r\n                const { components, selectedComponentId } = get();\r\n                return components.find((c) => c.id === selectedComponentId) || null;\r\n            },\r\n\r\n            // =========================================================\r\n            // FILTERING\r\n            // =========================================================\r\n\r\n            setSearchQuery: (query) => {\r\n                set({ searchQuery: query });\r\n            },\r\n\r\n            setCategoryFilter: (category) => {\r\n                set({ categoryFilter: category });\r\n            },\r\n\r\n            setShowFavoritesOnly: (show) => {\r\n                set({ showFavoritesOnly: show });\r\n            },\r\n\r\n            getFilteredComponents: () => {\r\n                const { components, searchQuery, categoryFilter, showFavoritesOnly } = get();\r\n\r\n                return components.filter((comp) => {\r\n                    // Favorites filter\r\n                    if (showFavoritesOnly && !comp.isFavorite) return false;\r\n\r\n                    // Category filter\r\n                    if (categoryFilter !== 'all' && comp.category !== categoryFilter) return false;\r\n\r\n                    // Search filter\r\n                    if (searchQuery.trim()) {\r\n                        const query = searchQuery.toLowerCase();\r\n                        const matchesName = comp.name.toLowerCase().includes(query);\r\n                        const matchesDescription = comp.description?.toLowerCase().includes(query);\r\n                        const matchesTags = comp.tags.some((tag) => tag.toLowerCase().includes(query));\r\n                        const matchesPrompt = comp.prompt?.toLowerCase().includes(query);\r\n\r\n                        if (!matchesName && !matchesDescription && !matchesTags && !matchesPrompt) {\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    return true;\r\n                });\r\n            },\r\n\r\n            // =========================================================\r\n            // FAVORITES\r\n            // =========================================================\r\n\r\n            toggleFavorite: (id) => {\r\n                set((state) => ({\r\n                    components: state.components.map((comp) =>\r\n                        comp.id === id\r\n                            ? { ...comp, isFavorite: !comp.isFavorite, updatedAt: Date.now() }\r\n                            : comp\r\n                    ),\r\n                }));\r\n            },\r\n\r\n            // =========================================================\r\n            // BULK OPERATIONS\r\n            // =========================================================\r\n\r\n            importComponents: (components) => {\r\n                // Assign new IDs and timestamps to imported components\r\n                const now = Date.now();\r\n                const imported = components.map((comp, index) => ({\r\n                    ...comp,\r\n                    id: generateId() + index,\r\n                    createdAt: now,\r\n                    updatedAt: now,\r\n                }));\r\n\r\n                set((state) => ({\r\n                    components: [...state.components, ...imported],\r\n                }));\r\n            },\r\n\r\n            exportComponents: () => {\r\n                return get().components;\r\n            },\r\n\r\n            clearLibrary: () => {\r\n                set({ components: [], selectedComponentId: null });\r\n            },\r\n\r\n            // =========================================================\r\n            // UTILITIES\r\n            // =========================================================\r\n\r\n            getComponentById: (id) => {\r\n                return get().components.find((c) => c.id === id);\r\n            },\r\n\r\n            getComponentsByCategory: (category) => {\r\n                return get().components.filter((c) => c.category === category);\r\n            },\r\n\r\n            getComponentCount: () => {\r\n                return get().components.length;\r\n            },\r\n        }),\r\n        {\r\n            name: 'app-factory-component-library',\r\n            storage: createJSONStorage(() => localStorage),\r\n            partialize: (state) => ({\r\n                // Only persist the components array, not UI state\r\n                components: state.components,\r\n            }),\r\n        }\r\n    )\r\n);\r\n\r\n// =============================================================================\r\n// SELECTOR HOOKS (for performance optimization)\r\n// =============================================================================\r\n\r\n/**\r\n * Get the count of components in the library.\r\n */\r\nexport const useComponentCount = () =>\r\n    useComponentLibraryStore((state) => state.components.length);\r\n\r\n/**\r\n * Get filtered components using the current filters.\r\n */\r\nexport const useFilteredComponents = () =>\r\n    useComponentLibraryStore((state) => {\r\n        const { components, searchQuery, categoryFilter, showFavoritesOnly } = state;\r\n\r\n        return components.filter((comp) => {\r\n            if (showFavoritesOnly && !comp.isFavorite) return false;\r\n            if (categoryFilter !== 'all' && comp.category !== categoryFilter) return false;\r\n\r\n            if (searchQuery.trim()) {\r\n                const query = searchQuery.toLowerCase();\r\n                const matchesName = comp.name.toLowerCase().includes(query);\r\n                const matchesDescription = comp.description?.toLowerCase().includes(query);\r\n                const matchesTags = comp.tags.some((tag) => tag.toLowerCase().includes(query));\r\n\r\n                if (!matchesName && !matchesDescription && !matchesTags) return false;\r\n            }\r\n\r\n            return true;\r\n        });\r\n    });\r\n\r\n/**\r\n * Get the currently selected component.\r\n */\r\nexport const useSelectedComponent = () =>\r\n    useComponentLibraryStore((state) => {\r\n        const { components, selectedComponentId } = state;\r\n        return components.find((c) => c.id === selectedComponentId) || null;\r\n    });\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\factoryStore.ts","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":269,"column":13,"nodeType":"CallExpression","messageId":"invalidType","endLine":269,"endColumn":23},{"ruleId":"@typescript-eslint/no-useless-default-assignment","severity":2,"message":"Default value is useless because it is undefined. Optional parameters are already undefined by default.","line":646,"column":37,"nodeType":"Identifier","messageId":"uselessUndefined","endLine":646,"endColumn":46,"fix":{"range":[15446,15458],"text":""}},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":650,"column":31,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":650,"endColumn":33,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[15558,15560],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D075 - src/stores/factoryStore.ts\n * ==================================\n * Zustand store for factory-wide state management.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport { create } from \"zustand\";\nimport { devtools, persist } from \"zustand/middleware\";\n\n/**\n * View mode for the factory layout.\n */\nexport type FactoryViewMode = \"design\" | \"preview\" | \"code\";\n\n/**\n * Panel visibility configuration.\n */\nexport interface PanelVisibility {\n  /** Left sidebar (galleries, tree) */\n  leftSidebar: boolean;\n  /** Right sidebar (properties, inspector) */\n  rightSidebar: boolean;\n  /** Bottom panel (logs, console) */\n  bottomPanel: boolean;\n  /** Top toolbar */\n  toolbar: boolean;\n}\n\n/**\n * Panel sizes in pixels or percentage.\n */\nexport interface PanelSizes {\n  /** Left sidebar width */\n  leftSidebarWidth: number;\n  /** Right sidebar width */\n  rightSidebarWidth: number;\n  /** Bottom panel height */\n  bottomPanelHeight: number;\n}\n\n/**\n * Active tab selections for each panel.\n */\nexport interface ActiveTabs {\n  /** Left sidebar active tab */\n  leftSidebar: \"plugins\" | \"components\" | \"screens\" | \"files\";\n  /** Right sidebar active tab */\n  rightSidebar: \"properties\" | \"styles\" | \"events\" | \"data\";\n  /** Bottom panel active tab */\n  bottomPanel: \"logs\" | \"console\" | \"terminal\" | \"problems\";\n}\n\n/**\n * Canvas zoom and position state.\n */\nexport interface CanvasState {\n  /** Zoom level (1 = 100%) */\n  zoom: number;\n  /** X offset in pixels */\n  panX: number;\n  /** Y offset in pixels */\n  panY: number;\n  /** Whether grid is visible */\n  showGrid: boolean;\n  /** Grid size in pixels */\n  gridSize: number;\n  /** Snap to grid enabled */\n  snapToGrid: boolean;\n}\n\n/**\n * Selection state for canvas elements.\n */\nexport interface SelectionState {\n  /** Selected element IDs */\n  selectedIds: string[];\n  /** Hovered element ID */\n  hoveredId: string | null;\n  /** Multi-select mode active */\n  multiSelectMode: boolean;\n}\n\n/**\n * History entry for undo/redo.\n */\nexport interface HistoryEntry {\n  /** Unique entry ID */\n  id: string;\n  /** Action description */\n  description: string;\n  /** Timestamp */\n  timestamp: number;\n  /** Serialized state snapshot */\n  snapshot: string;\n}\n\n/**\n * Undo/redo history state.\n */\nexport interface HistoryState {\n  /** Past entries (for undo) */\n  past: HistoryEntry[];\n  /** Future entries (for redo) */\n  future: HistoryEntry[];\n  /** Maximum history size */\n  maxSize: number;\n}\n\n/**\n * Notification message.\n */\nexport interface Notification {\n  /** Unique notification ID */\n  id: string;\n  /** Notification type */\n  type: \"info\" | \"success\" | \"warning\" | \"error\";\n  /** Title */\n  title: string;\n  /** Message body */\n  message?: string;\n  /** Auto-dismiss timeout in ms (0 = no auto-dismiss) */\n  timeout: number;\n  /** Creation timestamp */\n  createdAt: number;\n}\n\n/**\n * Factory store state interface.\n */\nexport interface FactoryState {\n  // View state\n  viewMode: FactoryViewMode;\n  panelVisibility: PanelVisibility;\n  panelSizes: PanelSizes;\n  activeTabs: ActiveTabs;\n\n  // Canvas state\n  canvas: CanvasState;\n  selection: SelectionState;\n\n  // History\n  history: HistoryState;\n\n  // Notifications\n  notifications: Notification[];\n\n  // UI state\n  isLoading: boolean;\n  loadingMessage: string | null;\n  isSaving: boolean;\n  hasUnsavedChanges: boolean;\n\n  // Modal state\n  activeModal: string | null;\n  modalData: Record<string, unknown> | null;\n}\n\n/**\n * Factory store actions interface.\n */\nexport interface FactoryActions {\n  // View actions\n  setViewMode: (mode: FactoryViewMode) => void;\n  togglePanel: (panel: keyof PanelVisibility) => void;\n  setPanelSize: (panel: keyof PanelSizes, size: number) => void;\n  setActiveTab: <K extends keyof ActiveTabs>(panel: K, tab: ActiveTabs[K]) => void;\n\n  // Canvas actions\n  setZoom: (zoom: number) => void;\n  zoomIn: () => void;\n  zoomOut: () => void;\n  resetZoom: () => void;\n  setPan: (x: number, y: number) => void;\n  toggleGrid: () => void;\n  setGridSize: (size: number) => void;\n  toggleSnapToGrid: () => void;\n\n  // Selection actions\n  select: (ids: string[]) => void;\n  addToSelection: (id: string) => void;\n  removeFromSelection: (id: string) => void;\n  clearSelection: () => void;\n  setHovered: (id: string | null) => void;\n  toggleMultiSelectMode: () => void;\n\n  // History actions\n  pushHistory: (description: string, snapshot: string) => void;\n  undo: () => HistoryEntry | null;\n  redo: () => HistoryEntry | null;\n  clearHistory: () => void;\n\n  // Notification actions\n  addNotification: (notification: Omit<Notification, \"id\" | \"createdAt\">) => string;\n  removeNotification: (id: string) => void;\n  clearNotifications: () => void;\n\n  // UI actions\n  setLoading: (isLoading: boolean, message?: string | null) => void;\n  setSaving: (isSaving: boolean) => void;\n  setUnsavedChanges: (hasChanges: boolean) => void;\n\n  // Modal actions\n  openModal: (modalId: string, data?: Record<string, unknown>) => void;\n  closeModal: () => void;\n\n  // Reset\n  reset: () => void;\n}\n\n/**\n * Initial state values.\n */\nconst initialState: FactoryState = {\n  viewMode: \"design\",\n  panelVisibility: {\n    leftSidebar: true,\n    rightSidebar: true,\n    bottomPanel: false,\n    toolbar: true,\n  },\n  panelSizes: {\n    leftSidebarWidth: 280,\n    rightSidebarWidth: 320,\n    bottomPanelHeight: 200,\n  },\n  activeTabs: {\n    leftSidebar: \"plugins\",\n    rightSidebar: \"properties\",\n    bottomPanel: \"logs\",\n  },\n  canvas: {\n    zoom: 1,\n    panX: 0,\n    panY: 0,\n    showGrid: true,\n    gridSize: 8,\n    snapToGrid: true,\n  },\n  selection: {\n    selectedIds: [],\n    hoveredId: null,\n    multiSelectMode: false,\n  },\n  history: {\n    past: [],\n    future: [],\n    maxSize: 50,\n  },\n  notifications: [],\n  isLoading: false,\n  loadingMessage: null,\n  isSaving: false,\n  hasUnsavedChanges: false,\n  activeModal: null,\n  modalData: null,\n};\n\n/**\n * Generate unique ID for notifications and history entries.\n */\nconst generateId = (): string => {\n  return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n};\n\n/**\n * Zustand factory store.\n *\n * Manages factory-wide UI state including:\n * - View mode (design/preview/code)\n * - Panel visibility and sizes\n * - Canvas zoom and pan\n * - Element selection\n * - Undo/redo history\n * - Notifications\n * - Modal state\n *\n * @example\n * ```tsx\n * const viewMode = useFactoryStore((state) => state.viewMode);\n * const setViewMode = useFactoryStore((state) => state.setViewMode);\n *\n * // Switch to preview mode\n * setViewMode(\"preview\");\n *\n * // Toggle left sidebar\n * const togglePanel = useFactoryStore((state) => state.togglePanel);\n * togglePanel(\"leftSidebar\");\n * ```\n */\nexport const useFactoryStore = create<FactoryState & FactoryActions>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        ...initialState,\n\n        // View actions\n        setViewMode: (mode) => set({ viewMode: mode }, false, \"setViewMode\"),\n\n        togglePanel: (panel) =>\n          set(\n            (state) => ({\n              panelVisibility: {\n                ...state.panelVisibility,\n                [panel]: !state.panelVisibility[panel],\n              },\n            }),\n            false,\n            \"togglePanel\"\n          ),\n\n        setPanelSize: (panel, size) =>\n          set(\n            (state) => ({\n              panelSizes: {\n                ...state.panelSizes,\n                [panel]: Math.max(0, size),\n              },\n            }),\n            false,\n            \"setPanelSize\"\n          ),\n\n        setActiveTab: (panel, tab) =>\n          set(\n            (state) => ({\n              activeTabs: {\n                ...state.activeTabs,\n                [panel]: tab,\n              },\n            }),\n            false,\n            \"setActiveTab\"\n          ),\n\n        // Canvas actions\n        setZoom: (zoom) =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                zoom: Math.max(0.1, Math.min(5, zoom)),\n              },\n            }),\n            false,\n            \"setZoom\"\n          ),\n\n        zoomIn: () =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                zoom: Math.min(5, state.canvas.zoom * 1.2),\n              },\n            }),\n            false,\n            \"zoomIn\"\n          ),\n\n        zoomOut: () =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                zoom: Math.max(0.1, state.canvas.zoom / 1.2),\n              },\n            }),\n            false,\n            \"zoomOut\"\n          ),\n\n        resetZoom: () =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                zoom: 1,\n                panX: 0,\n                panY: 0,\n              },\n            }),\n            false,\n            \"resetZoom\"\n          ),\n\n        setPan: (x, y) =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                panX: x,\n                panY: y,\n              },\n            }),\n            false,\n            \"setPan\"\n          ),\n\n        toggleGrid: () =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                showGrid: !state.canvas.showGrid,\n              },\n            }),\n            false,\n            \"toggleGrid\"\n          ),\n\n        setGridSize: (size) =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                gridSize: Math.max(1, size),\n              },\n            }),\n            false,\n            \"setGridSize\"\n          ),\n\n        toggleSnapToGrid: () =>\n          set(\n            (state) => ({\n              canvas: {\n                ...state.canvas,\n                snapToGrid: !state.canvas.snapToGrid,\n              },\n            }),\n            false,\n            \"toggleSnapToGrid\"\n          ),\n\n        // Selection actions\n        select: (ids) =>\n          set(\n            (state) => ({\n              selection: {\n                ...state.selection,\n                selectedIds: ids,\n              },\n            }),\n            false,\n            \"select\"\n          ),\n\n        addToSelection: (id) =>\n          set(\n            (state) => ({\n              selection: {\n                ...state.selection,\n                selectedIds: state.selection.selectedIds.includes(id)\n                  ? state.selection.selectedIds\n                  : [...state.selection.selectedIds, id],\n              },\n            }),\n            false,\n            \"addToSelection\"\n          ),\n\n        removeFromSelection: (id) =>\n          set(\n            (state) => ({\n              selection: {\n                ...state.selection,\n                selectedIds: state.selection.selectedIds.filter((i) => i !== id),\n              },\n            }),\n            false,\n            \"removeFromSelection\"\n          ),\n\n        clearSelection: () =>\n          set(\n            (state) => ({\n              selection: {\n                ...state.selection,\n                selectedIds: [],\n              },\n            }),\n            false,\n            \"clearSelection\"\n          ),\n\n        setHovered: (id) =>\n          set(\n            (state) => ({\n              selection: {\n                ...state.selection,\n                hoveredId: id,\n              },\n            }),\n            false,\n            \"setHovered\"\n          ),\n\n        toggleMultiSelectMode: () =>\n          set(\n            (state) => ({\n              selection: {\n                ...state.selection,\n                multiSelectMode: !state.selection.multiSelectMode,\n              },\n            }),\n            false,\n            \"toggleMultiSelectMode\"\n          ),\n\n        // History actions\n        pushHistory: (description, snapshot) =>\n          set(\n            (state) => {\n              const entry: HistoryEntry = {\n                id: generateId(),\n                description,\n                timestamp: Date.now(),\n                snapshot,\n              };\n\n              const past = [...state.history.past, entry];\n              if (past.length > state.history.maxSize) {\n                past.shift();\n              }\n\n              return {\n                history: {\n                  ...state.history,\n                  past,\n                  future: [], // Clear redo stack on new action\n                },\n                hasUnsavedChanges: true,\n              };\n            },\n            false,\n            \"pushHistory\"\n          ),\n\n        undo: () => {\n          const { history } = get();\n          if (history.past.length === 0) return null;\n\n          const entry = history.past[history.past.length - 1];\n          set(\n            (state) => ({\n              history: {\n                ...state.history,\n                past: state.history.past.slice(0, -1),\n                future: [entry, ...state.history.future],\n              },\n            }),\n            false,\n            \"undo\"\n          );\n          return entry;\n        },\n\n        redo: () => {\n          const { history } = get();\n          if (history.future.length === 0) return null;\n\n          const entry = history.future[0];\n          set(\n            (state) => ({\n              history: {\n                ...state.history,\n                past: [...state.history.past, entry],\n                future: state.history.future.slice(1),\n              },\n            }),\n            false,\n            \"redo\"\n          );\n          return entry;\n        },\n\n        clearHistory: () =>\n          set(\n            (state) => ({\n              history: {\n                ...state.history,\n                past: [],\n                future: [],\n              },\n            }),\n            false,\n            \"clearHistory\"\n          ),\n\n        // Notification actions\n        addNotification: (notification) => {\n          const id = generateId();\n          set(\n            (state) => ({\n              notifications: [\n                ...state.notifications,\n                {\n                  ...notification,\n                  id,\n                  createdAt: Date.now(),\n                },\n              ],\n            }),\n            false,\n            \"addNotification\"\n          );\n\n          // Auto-dismiss if timeout is set\n          if (notification.timeout > 0) {\n            setTimeout(() => {\n              get().removeNotification(id);\n            }, notification.timeout);\n          }\n\n          return id;\n        },\n\n        removeNotification: (id) =>\n          set(\n            (state) => ({\n              notifications: state.notifications.filter((n) => n.id !== id),\n            }),\n            false,\n            \"removeNotification\"\n          ),\n\n        clearNotifications: () => set({ notifications: [] }, false, \"clearNotifications\"),\n\n        // UI actions\n        setLoading: (isLoading, message = null) =>\n          set({ isLoading, loadingMessage: message }, false, \"setLoading\"),\n\n        setSaving: (isSaving) => set({ isSaving }, false, \"setSaving\"),\n\n        setUnsavedChanges: (hasChanges) =>\n          set({ hasUnsavedChanges: hasChanges }, false, \"setUnsavedChanges\"),\n\n        // Modal actions\n        openModal: (modalId, data = undefined) =>\n          set(\n            {\n              activeModal: modalId,\n              modalData: data || null,\n            },\n            false,\n            \"openModal\"\n          ),\n\n        closeModal: () =>\n          set(\n            {\n              activeModal: null,\n              modalData: null,\n            },\n            false,\n            \"closeModal\"\n          ),\n\n        // Reset\n        reset: () => set(initialState, false, \"reset\"),\n      }),\n      {\n        name: \"factory-store\",\n        partialize: (state) => ({\n          // Only persist UI preferences, not transient state\n          panelVisibility: state.panelVisibility,\n          panelSizes: state.panelSizes,\n          activeTabs: state.activeTabs,\n          canvas: {\n            showGrid: state.canvas.showGrid,\n            gridSize: state.canvas.gridSize,\n            snapToGrid: state.canvas.snapToGrid,\n          },\n        }),\n      }\n    ),\n    { name: \"FactoryStore\" }\n  )\n);\n\n/**\n * Selector hooks for common state slices.\n */\nexport const useViewMode = () => useFactoryStore((state) => state.viewMode);\nexport const usePanelVisibility = () => useFactoryStore((state) => state.panelVisibility);\nexport const useCanvas = () => useFactoryStore((state) => state.canvas);\nexport const useSelection = () => useFactoryStore((state) => state.selection);\nexport const useNotifications = () => useFactoryStore((state) => state.notifications);\nexport const useIsLoading = () => useFactoryStore((state) => state.isLoading);\nexport const useActiveModal = () => useFactoryStore((state) => state.activeModal);\n\nexport default useFactoryStore;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\pluginStore.ts","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":59,"column":15,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":64,"endColumn":5,"fix":{"range":[1341,1435],"text":"{\n    name: string;\n    type: string;\n    required: boolean;\n    default?: unknown;\n  }[]"}},{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":88,"column":13,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":88,"endColumn":52,"fix":{"range":[1958,1997],"text":"{ value: string; label: string }[]"}},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":275,"column":13,"nodeType":"CallExpression","messageId":"invalidType","endLine":275,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'get' is defined but never used. Allowed unused args must match /^_/u.","line":327,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":327,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'removed' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":349,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":349,"endColumn":40},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":376,"column":17,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":376,"endColumn":24},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":406,"column":17,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":406,"endColumn":24},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":426,"column":17,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":426,"endColumn":24},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":446,"column":17,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":446,"endColumn":24},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":469,"column":17,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":469,"endColumn":24}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * D076 - src/stores/pluginStore.ts\n * =================================\n * Zustand store for plugin state management.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D001, D002, D003, D004\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\n\n/**\n * Plugin status types.\n */\nexport type PluginStatus =\n  | \"discovered\"\n  | \"loading\"\n  | \"loaded\"\n  | \"active\"\n  | \"error\"\n  | \"disabled\"\n  | \"unloading\";\n\n/**\n * Plugin category/contract type.\n */\nexport type PluginCategory = \"tts\" | \"stt\" | \"llm\" | \"vision\" | \"audio\" | \"data\" | \"custom\";\n\n/**\n * Plugin health status.\n */\nexport interface PluginHealth {\n  /** Whether plugin is healthy */\n  healthy: boolean;\n  /** Last health check timestamp */\n  lastCheck: number;\n  /** Response time in ms */\n  responseTime: number | null;\n  /** Error message if unhealthy */\n  error: string | null;\n  /** Number of consecutive failures */\n  failureCount: number;\n}\n\n/**\n * Plugin method definition.\n */\nexport interface PluginMethod {\n  /** Method name */\n  name: string;\n  /** Method description */\n  description: string;\n  /** Parameter names and types */\n  parameters: Array<{\n    name: string;\n    type: string;\n    required: boolean;\n    default?: unknown;\n  }>;\n  /** Return type */\n  returnType: string;\n  /** Whether method is async */\n  async: boolean;\n}\n\n/**\n * Plugin configuration option.\n */\nexport interface PluginConfigOption {\n  /** Option key */\n  key: string;\n  /** Display label */\n  label: string;\n  /** Option type */\n  type: \"string\" | \"number\" | \"boolean\" | \"select\" | \"path\";\n  /** Current value */\n  value: unknown;\n  /** Default value */\n  defaultValue: unknown;\n  /** Description/help text */\n  description?: string;\n  /** Options for select type */\n  options?: Array<{ value: string; label: string }>;\n  /** Validation constraints */\n  validation?: {\n    min?: number;\n    max?: number;\n    pattern?: string;\n    required?: boolean;\n  };\n}\n\n/**\n * Plugin manifest structure.\n */\nexport interface PluginManifest {\n  /** Plugin unique identifier */\n  id: string;\n  /** Display name */\n  name: string;\n  /** Plugin version */\n  version: string;\n  /** Description */\n  description: string;\n  /** Author */\n  author: string;\n  /** Category/contract type */\n  category: PluginCategory;\n  /** Contract interface implemented */\n  contract: string;\n  /** Plugin entry point */\n  entryPoint: string;\n  /** Dependencies on other plugins */\n  dependencies: string[];\n  /** Tags for search */\n  tags: string[];\n  /** Icon path (relative to plugin dir) */\n  icon?: string;\n  /** License */\n  license?: string;\n  /** Repository URL */\n  repository?: string;\n  /** Minimum host version required */\n  minHostVersion?: string;\n}\n\n/**\n * Full plugin state.\n */\nexport interface Plugin {\n  /** Plugin manifest */\n  manifest: PluginManifest;\n  /** Current status */\n  status: PluginStatus;\n  /** Health state */\n  health: PluginHealth;\n  /** Available methods */\n  methods: PluginMethod[];\n  /** Configuration options */\n  config: PluginConfigOption[];\n  /** Plugin file path */\n  path: string;\n  /** Load timestamp */\n  loadedAt: number | null;\n  /** Error message if any */\n  error: string | null;\n  /** Plugin metadata */\n  metadata: Record<string, unknown>;\n}\n\n/**\n * Plugin invocation result.\n */\nexport interface PluginInvocationResult {\n  /** Invocation ID */\n  id: string;\n  /** Plugin ID */\n  pluginId: string;\n  /** Method name */\n  method: string;\n  /** Whether successful */\n  success: boolean;\n  /** Result data */\n  result: unknown;\n  /** Error message if failed */\n  error: string | null;\n  /** Execution time in ms */\n  executionTime: number;\n  /** Timestamp */\n  timestamp: number;\n}\n\n/**\n * Plugin store state interface.\n */\nexport interface PluginState {\n  /** All discovered/loaded plugins */\n  plugins: Record<string, Plugin>;\n\n  /** Currently selected plugin ID */\n  selectedPluginId: string | null;\n\n  /** Plugin discovery in progress */\n  isDiscovering: boolean;\n\n  /** Plugin load in progress (plugin ID -> boolean) */\n  loadingPlugins: Set<string>;\n\n  /** Recent invocation results */\n  invocationHistory: PluginInvocationResult[];\n\n  /** Maximum invocation history size */\n  maxInvocationHistory: number;\n\n  /** Health check interval in ms */\n  healthCheckInterval: number;\n\n  /** Whether health monitoring is active */\n  healthMonitoringActive: boolean;\n\n  /** Filter state */\n  filter: {\n    category: PluginCategory | \"all\";\n    status: PluginStatus | \"all\";\n    searchQuery: string;\n  };\n}\n\n/**\n * Plugin store actions interface.\n */\nexport interface PluginActions {\n  // Discovery actions\n  setDiscovering: (discovering: boolean) => void;\n  addDiscoveredPlugin: (manifest: PluginManifest, path: string) => void;\n  removePlugin: (pluginId: string) => void;\n  clearPlugins: () => void;\n\n  // Loading actions\n  setPluginStatus: (pluginId: string, status: PluginStatus, error?: string | null) => void;\n  setPluginMethods: (pluginId: string, methods: PluginMethod[]) => void;\n  setPluginConfig: (pluginId: string, config: PluginConfigOption[]) => void;\n  updatePluginConfigValue: (pluginId: string, key: string, value: unknown) => void;\n\n  // Health actions\n  updatePluginHealth: (pluginId: string, health: Partial<PluginHealth>) => void;\n  setHealthMonitoring: (active: boolean) => void;\n\n  // Selection actions\n  selectPlugin: (pluginId: string | null) => void;\n\n  // Invocation actions\n  addInvocationResult: (result: PluginInvocationResult) => void;\n  clearInvocationHistory: () => void;\n\n  // Filter actions\n  setFilter: (filter: Partial<PluginState[\"filter\"]>) => void;\n  resetFilter: () => void;\n\n  // Batch actions\n  setPlugins: (plugins: Record<string, Plugin>) => void;\n\n  // Reset\n  reset: () => void;\n}\n\n/**\n * Initial state values.\n */\nconst initialState: PluginState = {\n  plugins: {},\n  selectedPluginId: null,\n  isDiscovering: false,\n  loadingPlugins: new Set(),\n  invocationHistory: [],\n  maxInvocationHistory: 100,\n  healthCheckInterval: 30000, // 30 seconds\n  healthMonitoringActive: false,\n  filter: {\n    category: \"all\",\n    status: \"all\",\n    searchQuery: \"\",\n  },\n};\n\n/**\n * Generate unique ID for invocation results.\n */\nconst generateId = (): string => {\n  return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n};\n\n/**\n * Create initial plugin state from manifest.\n */\nconst createPluginState = (manifest: PluginManifest, path: string): Plugin => ({\n  manifest,\n  status: \"discovered\",\n  health: {\n    healthy: true,\n    lastCheck: 0,\n    responseTime: null,\n    error: null,\n    failureCount: 0,\n  },\n  methods: [],\n  config: [],\n  path,\n  loadedAt: null,\n  error: null,\n  metadata: {},\n});\n\n/**\n * Zustand plugin store.\n *\n * Manages plugin state including:\n * - Plugin discovery and registration\n * - Plugin loading and status\n * - Health monitoring\n * - Configuration management\n * - Method invocation history\n *\n * @example\n * ```tsx\n * const plugins = usePluginStore((state) => state.plugins);\n * const selectedPlugin = usePluginStore((state) =>\n *   state.selectedPluginId ? state.plugins[state.selectedPluginId] : null\n * );\n *\n * // Add discovered plugin\n * const addPlugin = usePluginStore((state) => state.addDiscoveredPlugin);\n * addPlugin(manifest, \"/path/to/plugin\");\n *\n * // Update plugin status\n * const setStatus = usePluginStore((state) => state.setPluginStatus);\n * setStatus(\"tts_kokoro\", \"active\");\n * ```\n */\nexport const usePluginStore = create<PluginState & PluginActions>()(\n  devtools(\n    (set, get) => ({\n      ...initialState,\n\n      // Discovery actions\n      setDiscovering: (discovering) =>\n        set({ isDiscovering: discovering }, false, \"setDiscovering\"),\n\n      addDiscoveredPlugin: (manifest, path) =>\n        set(\n          (state) => ({\n            plugins: {\n              ...state.plugins,\n              [manifest.id]: createPluginState(manifest, path),\n            },\n          }),\n          false,\n          \"addDiscoveredPlugin\"\n        ),\n\n      removePlugin: (pluginId) =>\n        set(\n          (state) => {\n            const { [pluginId]: removed, ...remaining } = state.plugins;\n            return {\n              plugins: remaining,\n              selectedPluginId:\n                state.selectedPluginId === pluginId ? null : state.selectedPluginId,\n            };\n          },\n          false,\n          \"removePlugin\"\n        ),\n\n      clearPlugins: () =>\n        set(\n          {\n            plugins: {},\n            selectedPluginId: null,\n            loadingPlugins: new Set(),\n          },\n          false,\n          \"clearPlugins\"\n        ),\n\n      // Loading actions\n      setPluginStatus: (pluginId, status, error = null) =>\n        set(\n          (state) => {\n            const plugin = state.plugins[pluginId];\n            if (!plugin) return state;\n\n            const loadingPlugins = new Set(state.loadingPlugins);\n            if (status === \"loading\") {\n              loadingPlugins.add(pluginId);\n            } else {\n              loadingPlugins.delete(pluginId);\n            }\n\n            return {\n              plugins: {\n                ...state.plugins,\n                [pluginId]: {\n                  ...plugin,\n                  status,\n                  error,\n                  loadedAt: status === \"loaded\" || status === \"active\" ? Date.now() : plugin.loadedAt,\n                },\n              },\n              loadingPlugins,\n            };\n          },\n          false,\n          \"setPluginStatus\"\n        ),\n\n      setPluginMethods: (pluginId, methods) =>\n        set(\n          (state) => {\n            const plugin = state.plugins[pluginId];\n            if (!plugin) return state;\n\n            return {\n              plugins: {\n                ...state.plugins,\n                [pluginId]: {\n                  ...plugin,\n                  methods,\n                },\n              },\n            };\n          },\n          false,\n          \"setPluginMethods\"\n        ),\n\n      setPluginConfig: (pluginId, config) =>\n        set(\n          (state) => {\n            const plugin = state.plugins[pluginId];\n            if (!plugin) return state;\n\n            return {\n              plugins: {\n                ...state.plugins,\n                [pluginId]: {\n                  ...plugin,\n                  config,\n                },\n              },\n            };\n          },\n          false,\n          \"setPluginConfig\"\n        ),\n\n      updatePluginConfigValue: (pluginId, key, value) =>\n        set(\n          (state) => {\n            const plugin = state.plugins[pluginId];\n            if (!plugin) return state;\n\n            return {\n              plugins: {\n                ...state.plugins,\n                [pluginId]: {\n                  ...plugin,\n                  config: plugin.config.map((opt) =>\n                    opt.key === key ? { ...opt, value } : opt\n                  ),\n                },\n              },\n            };\n          },\n          false,\n          \"updatePluginConfigValue\"\n        ),\n\n      // Health actions\n      updatePluginHealth: (pluginId, healthUpdate) =>\n        set(\n          (state) => {\n            const plugin = state.plugins[pluginId];\n            if (!plugin) return state;\n\n            return {\n              plugins: {\n                ...state.plugins,\n                [pluginId]: {\n                  ...plugin,\n                  health: {\n                    ...plugin.health,\n                    ...healthUpdate,\n                    lastCheck: Date.now(),\n                  },\n                },\n              },\n            };\n          },\n          false,\n          \"updatePluginHealth\"\n        ),\n\n      setHealthMonitoring: (active) =>\n        set({ healthMonitoringActive: active }, false, \"setHealthMonitoring\"),\n\n      // Selection actions\n      selectPlugin: (pluginId) =>\n        set({ selectedPluginId: pluginId }, false, \"selectPlugin\"),\n\n      // Invocation actions\n      addInvocationResult: (result) =>\n        set(\n          (state) => {\n            const history = [\n              { ...result, id: result.id || generateId() },\n              ...state.invocationHistory,\n            ];\n            if (history.length > state.maxInvocationHistory) {\n              history.pop();\n            }\n            return { invocationHistory: history };\n          },\n          false,\n          \"addInvocationResult\"\n        ),\n\n      clearInvocationHistory: () =>\n        set({ invocationHistory: [] }, false, \"clearInvocationHistory\"),\n\n      // Filter actions\n      setFilter: (filterUpdate) =>\n        set(\n          (state) => ({\n            filter: {\n              ...state.filter,\n              ...filterUpdate,\n            },\n          }),\n          false,\n          \"setFilter\"\n        ),\n\n      resetFilter: () =>\n        set(\n          {\n            filter: {\n              category: \"all\",\n              status: \"all\",\n              searchQuery: \"\",\n            },\n          },\n          false,\n          \"resetFilter\"\n        ),\n\n      // Batch actions\n      setPlugins: (plugins) => set({ plugins }, false, \"setPlugins\"),\n\n      // Reset\n      reset: () => set(initialState, false, \"reset\"),\n    }),\n    { name: \"PluginStore\" }\n  )\n);\n\n/**\n * Selector for filtered plugins list.\n */\nexport const useFilteredPlugins = () =>\n  usePluginStore((state) => {\n    const { plugins, filter } = state;\n    let result = Object.values(plugins);\n\n    // Filter by category\n    if (filter.category !== \"all\") {\n      result = result.filter((p) => p.manifest.category === filter.category);\n    }\n\n    // Filter by status\n    if (filter.status !== \"all\") {\n      result = result.filter((p) => p.status === filter.status);\n    }\n\n    // Filter by search query\n    if (filter.searchQuery) {\n      const query = filter.searchQuery.toLowerCase();\n      result = result.filter(\n        (p) =>\n          p.manifest.name.toLowerCase().includes(query) ||\n          p.manifest.description.toLowerCase().includes(query) ||\n          p.manifest.tags.some((t) => t.toLowerCase().includes(query))\n      );\n    }\n\n    return result;\n  });\n\n/**\n * Selector for selected plugin.\n */\nexport const useSelectedPlugin = () =>\n  usePluginStore((state) =>\n    state.selectedPluginId ? state.plugins[state.selectedPluginId] : null\n  );\n\n/**\n * Selector for plugins by category.\n */\nexport const usePluginsByCategory = (category: PluginCategory) =>\n  usePluginStore((state) =>\n    Object.values(state.plugins).filter((p) => p.manifest.category === category)\n  );\n\n/**\n * Selector for active plugins.\n */\nexport const useActivePlugins = () =>\n  usePluginStore((state) =>\n    Object.values(state.plugins).filter((p) => p.status === \"active\")\n  );\n\n/**\n * Selector for plugin count by status.\n */\nexport const usePluginCounts = () =>\n  usePluginStore((state) => {\n    const counts = {\n      total: 0,\n      active: 0,\n      loaded: 0,\n      error: 0,\n      disabled: 0,\n    };\n\n    Object.values(state.plugins).forEach((p) => {\n      counts.total++;\n      if (p.status === \"active\") counts.active++;\n      if (p.status === \"loaded\") counts.loaded++;\n      if (p.status === \"error\") counts.error++;\n      if (p.status === \"disabled\") counts.disabled++;\n    });\n\n    return counts;\n  });\n\nexport default usePluginStore;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\projectStore.ts","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":309,"column":12,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":315,"endColumn":5,"fix":{"range":[7430,7558],"text":"{\n    id: string;\n    name: string;\n    contract: string;\n    enabled: boolean;\n    config?: Record<string, unknown>;\n  }[]"}},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":487,"column":13,"nodeType":"CallExpression","messageId":"invalidType","endLine":487,"endColumn":23},{"ruleId":"@typescript-eslint/no-unsafe-return","severity":2,"message":"Unsafe return of a value of type `any`.","line":494,"column":3,"nodeType":"ReturnStatement","messageId":"unsafeReturn","endLine":494,"endColumn":42},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":526,"column":66,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":526,"endColumn":68,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[13651,13653],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":617,"column":15,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":617,"endColumn":36},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":2,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":617,"column":15,"nodeType":null,"messageId":"preferOptionalChain","endLine":617,"endColumn":66,"fix":{"range":[15856,15907],"text":"!projectJson.metadata?.name"}},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":631,"column":24,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":631,"endColumn":43},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":632,"column":27,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":632,"endColumn":49},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":633,"column":22,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":633,"endColumn":39},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":634,"column":28,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":634,"endColumn":51},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":636,"column":58,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":636,"endColumn":60,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[16774,16776],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":638,"column":54,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":638,"endColumn":56,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[16914,16916],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":645,"column":31,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":645,"endColumn":50},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1049,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1049,"endColumn":26},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1052,"column":54,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1052,"endColumn":56,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[31665,31706],"text":"(screen.windowConfig ?? state.windowConfig)"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1052,"column":76,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1052,"endColumn":78,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[31707,31709],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1077,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1077,"endColumn":26},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1102,"column":52,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1102,"endColumn":54,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[33135,33137],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1113,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1113,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'removed' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":1130,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":1130,"endColumn":42},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1135,"column":25,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1135,"endColumn":27,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[34076,34078],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1139,"column":28,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1139,"endColumn":30,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[34275,34277],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-dynamic-delete","severity":2,"message":"Do not delete dynamically computed property keys.","line":1145,"column":62,"nodeType":"Identifier","messageId":"dynamicDelete","endLine":1145,"endColumn":64},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1154,"column":77,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1154,"endColumn":79,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[34868,34870],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1170,"column":15,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1170,"endColumn":22},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1212,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1212,"endColumn":29},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1234,"column":26,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1234,"endColumn":28,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[37063,37065],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":1241,"column":28,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":1241,"endColumn":30,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[37341,37343],"text":"."},"desc":"Remove unnecessary optional chain"}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1241,"column":42,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1241,"endColumn":72},{"ruleId":"@typescript-eslint/no-dynamic-delete","severity":2,"message":"Do not delete dynamically computed property keys.","line":1251,"column":61,"nodeType":"Identifier","messageId":"dynamicDelete","endLine":1251,"endColumn":63},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":1255,"column":76,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":1255,"endColumn":78,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[37915,37917],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1272,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1272,"endColumn":29},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1277,"column":41,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1277,"endColumn":71},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1287,"column":34,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1287,"endColumn":57},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1318,"column":15,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1318,"endColumn":25},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1331,"column":44,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1331,"endColumn":77},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1356,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1356,"endColumn":29},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1379,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1379,"endColumn":29},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1402,"column":19,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1402,"endColumn":29},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1459,"column":15,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1459,"endColumn":25},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":1476,"column":15,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":1476,"endColumn":22},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1510,"column":39,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":1510,"endColumn":65},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, comparison is always true, since `\"screen\" === \"screen\"` is true.","line":1530,"column":15,"nodeType":"BinaryExpression","messageId":"comparisonBetweenLiteralTypes","endLine":1530,"endColumn":42},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":1640,"column":11,"nodeType":"Identifier","messageId":"alwaysTruthy","endLine":1640,"endColumn":20}],"suppressedMessages":[],"errorCount":44,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * D077 - src/stores/projectStore.ts\n * ===================================\n * Zustand store for project state management.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D075, D076\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n */\n\nimport { create } from \"zustand\";\nimport { devtools, persist } from \"zustand/middleware\";\nimport { save, open } from \"@tauri-apps/api/dialog\";\nimport { writeTextFile, readTextFile } from \"@tauri-apps/api/fs\";\nimport { resolve, dirname } from \"@tauri-apps/api/path\";\nimport { isTauri } from \"../utils/tauriUtils\";\nimport type { ThemeConfig } from \"../context/ThemeProvider\";\nimport { defaultLightTheme } from \"../context/ThemeProvider\";\n\n/**\n * Canvas element types (mirrored from CanvasEditor for serialization).\n */\nexport type CanvasElementType = \"component\" | \"container\" | \"text\" | \"image\" | \"spacer\";\n\n/**\n * Canvas element bounds for serialization.\n */\nexport interface SerializedElementBounds {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\n/**\n * Serialized canvas element for project file persistence.\n */\nexport interface SerializedCanvasElement {\n  id: string;\n  type: CanvasElementType;\n  name: string;\n  bounds: SerializedElementBounds;\n  componentId?: string;\n  children?: SerializedCanvasElement[];\n  props?: Record<string, unknown>;\n  locked?: boolean;\n  visible?: boolean;\n  zIndex?: number;\n}\n\n/**\n * Window configuration for project file persistence.\n */\nexport interface SerializedWindowConfig {\n  title: string;\n  width: number;\n  height: number;\n  minWidth: number;\n  minHeight: number;\n  maxWidth: number | null;\n  maxHeight: number | null;\n  x: number | null;\n  y: number | null;\n  center: boolean;\n  fullscreen: boolean;\n  resizable: boolean;\n  decorations: boolean;\n  alwaysOnTop: boolean;\n  skipTaskbar: boolean;\n  transparent: boolean;\n  visible: boolean;\n  focus: boolean;\n  closable: boolean;\n  minimizable: boolean;\n  maximizable: boolean;\n  fileDropEnabled: boolean;\n}\n\n/**\n * Project status.\n */\nexport type ProjectStatus = \"new\" | \"saved\" | \"modified\" | \"building\" | \"error\";\n\n/**\n * Screen type in the project.\n */\nexport type ScreenType = \"main\" | \"settings\" | \"dialog\" | \"overlay\" | \"widget\";\n\n/**\n * Component slot binding.\n */\nexport interface ComponentSlot {\n  /** Slot ID */\n  id: string;\n  /** Slot name */\n  name: string;\n  /** Contract type required */\n  contractType: string;\n  /** Bound plugin ID (null if unbound) */\n  pluginId: string | null;\n  /** Whether binding is required */\n  required: boolean;\n  /** Slot configuration */\n  config: Record<string, unknown>;\n}\n\n/**\n * UI Component definition in project.\n */\nexport interface ProjectComponent {\n  /** Component ID */\n  id: string;\n  /** Component type (e.g., \"Button\", \"Panel\") */\n  type: string;\n  /** Display name */\n  name: string;\n  /** Component properties */\n  props: Record<string, unknown>;\n  /** Child component IDs */\n  children: string[];\n  /** Parent component ID */\n  parentId: string | null;\n  /** Position in layout */\n  position: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  };\n  /** Plugin slots this component has */\n  slots: ComponentSlot[];\n  /** Custom styles */\n  styles: Record<string, string>;\n  /** Event handlers */\n  events: Record<string, string>;\n  /** Whether component is visible */\n  visible: boolean;\n  /** Whether component is locked (can't be edited) */\n  locked: boolean;\n}\n\n/**\n * Screen definition in project.\n */\nexport interface ProjectScreen {\n  /** Screen ID */\n  id: string;\n  /** Screen name */\n  name: string;\n  /** Screen type */\n  type: ScreenType;\n  /** Root component ID */\n  rootComponentId: string | null;\n  /** Screen route/path */\n  route: string;\n  /** Screen title */\n  title: string;\n  /** Whether this is the default screen */\n  isDefault: boolean;\n  /** Screen-specific settings */\n  settings: Record<string, unknown>;\n  /** Screen-specific window configuration (overrides global windowConfig) */\n  windowConfig?: SerializedWindowConfig;\n}\n\n/**\n * Project theme configuration.\n * Uses the same structure as the UI theme persistence.\n */\nexport type ProjectTheme = ThemeConfig;\n\n/**\n * Project build configuration.\n */\nexport interface ProjectBuildConfig {\n  /** Output directory */\n  outputDir: string;\n  /** Target platform */\n  platform: \"windows\" | \"macos\" | \"linux\" | \"all\";\n  /** Build mode */\n  mode: \"development\" | \"production\";\n  /** Include Python runtime */\n  includePythonRuntime: boolean;\n  /** Bundled plugins */\n  bundledPlugins: string[];\n  /** App icon path */\n  appIcon: string | null;\n  /** Version string */\n  version: string;\n  /** Author/publisher */\n  publisher: string;\n  /** App identifier */\n  identifier: string;\n}\n\n/**\n * Project metadata.\n */\nexport interface ProjectMetadata {\n  /** Project name */\n  name: string;\n  /** Project description */\n  description: string;\n  /** Author */\n  author: string;\n  /** Version */\n  version: string;\n  /** Created timestamp */\n  createdAt: number;\n  /** Last modified timestamp */\n  modifiedAt: number;\n  /** Project file path */\n  filePath: string | null;\n  /** Tags */\n  tags: string[];\n}\n\n/**\n * Recent project entry.\n */\nexport interface RecentProject {\n  /** Project file path */\n  path: string;\n  /** Project name */\n  name: string;\n  /** Last opened timestamp */\n  lastOpened: number;\n  /** Thumbnail path */\n  thumbnail: string | null;\n}\n\n/**\n * Project store state interface.\n */\nexport interface ProjectState {\n  // Current project\n  metadata: ProjectMetadata;\n  status: ProjectStatus;\n  screens: Record<string, ProjectScreen>;\n  components: Record<string, ProjectComponent>;\n  theme: ProjectTheme;\n  buildConfig: ProjectBuildConfig;\n\n  // Canvas state - the actual visual layout\n  canvasElements: SerializedCanvasElement[];\n  windowConfig: SerializedWindowConfig | null;\n\n  // Active selections\n  activeScreenId: string | null;\n  activeComponentId: string | null;\n\n  // Clipboard\n  clipboard: {\n    type: \"component\" | \"screen\" | null;\n    data: unknown;\n  };\n\n  // Recent projects\n  recentProjects: RecentProject[];\n  maxRecentProjects: number;\n\n  // Save version tracking\n  saveVersion: number;\n\n  // Project state\n  isLoading: boolean;\n  isSaving: boolean;\n  error: string | null;\n}\n\n/**\n * Project store actions interface.\n */\n/**\n * Project file structure for loading from disk.\n * Version 2: Includes canvasElements and windowConfig for complete save/load fidelity.\n */\nexport interface ProjectFile {\n  /** File format version for forward compatibility */\n  version: number;\n  /** Project metadata */\n  metadata: ProjectMetadata;\n  /** Screens configuration */\n  screens: Record<string, ProjectScreen>;\n  /** Components configuration */\n  components: Record<string, ProjectComponent>;\n  /** Theme configuration */\n  theme: ProjectTheme;\n  /** Build configuration */\n  buildConfig: ProjectBuildConfig;\n  /** Canvas elements - the actual visual layout on the canvas */\n  canvasElements?: SerializedCanvasElement[];\n  /** Window configuration - Tauri window settings */\n  windowConfig?: SerializedWindowConfig;\n  /** Active screen ID */\n  activeScreenId?: string | null;\n  /** Active component ID */\n  activeComponentId?: string | null;\n}\n\n/**\n * Plugin configuration from plugins.yaml.\n */\nexport interface PluginsConfig {\n  /** Active plugins */\n  plugins: Array<{\n    id: string;\n    name: string;\n    contract: string;\n    enabled: boolean;\n    config?: Record<string, unknown>;\n  }>;\n}\n\nexport interface ProjectActions {\n  // Project lifecycle\n  newProject: (name: string, author?: string) => void;\n  loadProject: (data: Partial<ProjectState>) => void;\n  loadProjectFromFile: (\n    projectPath: string,\n    projectJson: ProjectFile,\n    pluginsConfig?: PluginsConfig\n  ) => void;\n  browseAndLoadProject: () => Promise<boolean>;\n  /** Save project - writes a new versioned file (prompts for location if none exists) */\n  saveProject: () => Promise<string | null>;\n  /** Save As - prompts for a file location (defaulting to current file name if present) */\n  saveProjectAs: () => Promise<string | null>;\n  setMetadata: (metadata: Partial<ProjectMetadata>) => void;\n  setStatus: (status: ProjectStatus) => void;\n\n  // Canvas element actions\n  setCanvasElements: (elements: SerializedCanvasElement[]) => void;\n  updateCanvasElement: (elementId: string, updates: Partial<SerializedCanvasElement>) => void;\n  addCanvasElement: (element: SerializedCanvasElement) => void;\n  removeCanvasElement: (elementId: string) => void;\n\n  // Window config actions\n  setWindowConfig: (config: Partial<SerializedWindowConfig>) => void;\n  /** Update window config for a specific screen (for per-screen window settings) */\n  updateScreenWindowConfig: (screenId: string, config: Partial<SerializedWindowConfig>) => void;\n  /** Clear a screen's window config (inherit from main) */\n  clearScreenWindowConfig: (screenId: string) => void;\n\n  // Screen actions\n  addScreen: (screen: ProjectScreen) => void;\n  updateScreen: (screenId: string, updates: Partial<ProjectScreen>) => void;\n  removeScreen: (screenId: string) => void;\n  setActiveScreen: (screenId: string | null) => void;\n  duplicateScreen: (screenId: string) => ProjectScreen | null;\n\n  // Component actions\n  addComponent: (component: ProjectComponent) => void;\n  updateComponent: (componentId: string, updates: Partial<ProjectComponent>) => void;\n  removeComponent: (componentId: string) => void;\n  setActiveComponent: (componentId: string | null) => void;\n  moveComponent: (componentId: string, newParentId: string | null, index?: number) => void;\n  duplicateComponent: (componentId: string) => ProjectComponent | null;\n\n  // Slot actions\n  bindSlot: (componentId: string, slotId: string, pluginId: string) => void;\n  unbindSlot: (componentId: string, slotId: string) => void;\n  updateSlotConfig: (componentId: string, slotId: string, config: Record<string, unknown>) => void;\n\n  // Theme actions\n  setTheme: (theme: Partial<ProjectTheme>) => void;\n  resetTheme: () => void;\n\n  // Build config actions\n  setBuildConfig: (config: Partial<ProjectBuildConfig>) => void;\n\n  // Clipboard actions\n  copyComponent: (componentId: string) => void;\n  copyScreen: (screenId: string) => void;\n  paste: (targetParentId?: string | null) => string | null;\n  clearClipboard: () => void;\n\n  // Recent projects\n  addRecentProject: (project: RecentProject) => void;\n  removeRecentProject: (path: string) => void;\n  clearRecentProjects: () => void;\n\n  // State actions\n  setLoading: (loading: boolean) => void;\n  setSaving: (saving: boolean) => void;\n  setError: (error: string | null) => void;\n\n  // Reset\n  reset: () => void;\n}\n\n/**\n * Default theme configuration.\n */\nconst defaultTheme: ProjectTheme = defaultLightTheme;\n\n/**\n * Default build configuration.\n */\nconst defaultBuildConfig: ProjectBuildConfig = {\n  outputDir: \"./dist\",\n  platform: \"windows\",\n  mode: \"development\",\n  includePythonRuntime: true,\n  bundledPlugins: [],\n  appIcon: null,\n  version: \"1.0.0\",\n  publisher: \"\",\n  identifier: \"com.appfactory.app\",\n};\n\n/**\n * Default metadata.\n */\nconst defaultMetadata: ProjectMetadata = {\n  name: \"Untitled Project\",\n  description: \"\",\n  author: \"\",\n  version: \"1.0.0\",\n  createdAt: Date.now(),\n  modifiedAt: Date.now(),\n  filePath: null,\n  tags: [],\n};\n\n/**\n * Default window configuration.\n */\nconst defaultWindowConfig: SerializedWindowConfig = {\n  title: \"App Factory\",\n  width: 1200,\n  height: 800,\n  minWidth: 800,\n  minHeight: 600,\n  maxWidth: null,\n  maxHeight: null,\n  x: null,\n  y: null,\n  center: true,\n  fullscreen: false,\n  resizable: true,\n  decorations: true,\n  alwaysOnTop: false,\n  skipTaskbar: false,\n  transparent: false,\n  visible: true,\n  focus: true,\n  closable: true,\n  minimizable: true,\n  maximizable: true,\n  fileDropEnabled: true,\n};\n\n/**\n * Initial state values.\n */\nconst initialState: ProjectState = {\n  metadata: defaultMetadata,\n  status: \"new\",\n  screens: {},\n  components: {},\n  theme: defaultTheme,\n  buildConfig: defaultBuildConfig,\n  canvasElements: [],\n  windowConfig: defaultWindowConfig,\n  activeScreenId: null,\n  activeComponentId: null,\n  clipboard: {\n    type: null,\n    data: null,\n  },\n  recentProjects: [],\n  maxRecentProjects: 10,\n  saveVersion: 0,\n  isLoading: false,\n  isSaving: false,\n  error: null,\n};\n\n/**\n * Generate unique ID.\n */\nconst generateId = (): string => {\n  return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n};\n\n/**\n * Deep clone an object.\n */\nconst deepClone = <T>(obj: T): T => {\n  return JSON.parse(JSON.stringify(obj));\n};\n\nconst VERSIONED_FILENAME_REGEX = /^(.*)_v(\\d{3})_(\\d{6})$/;\n\nconst sanitizeBaseName = (name: string): string => {\n  const safe = name.replace(/[^a-zA-Z0-9_-]/g, \"_\").replace(/^_+|_+$/g, \"\");\n  return safe || \"project\";\n};\n\nconst formatDateForFilename = (date: Date): string => {\n  return [\n    String(date.getFullYear()).slice(-2),\n    String(date.getMonth() + 1).padStart(2, \"0\"),\n    String(date.getDate()).padStart(2, \"0\"),\n  ].join(\"\");\n};\n\nconst buildVersionedFilename = (baseName: string, version: number, date = new Date()): string => {\n  const versionStr = String(version).padStart(3, \"0\");\n  const dateStr = formatDateForFilename(date);\n  return `${sanitizeBaseName(baseName)}_v${versionStr}_${dateStr}.json`;\n};\n\nconst getBaseNameAndDetectedVersion = (\n  filePath: string | null,\n  fallbackName: string\n): { baseName: string; detectedVersion: number } => {\n  if (!filePath) {\n    return { baseName: sanitizeBaseName(fallbackName), detectedVersion: 0 };\n  }\n\n  const filename = filePath.replace(/\\\\/g, \"/\").split(\"/\").pop() || \"\";\n  const withoutExt = filename.replace(/\\.json$/i, \"\");\n  const match = VERSIONED_FILENAME_REGEX.exec(withoutExt);\n\n  if (match) {\n    return {\n      baseName: sanitizeBaseName(match[1] || fallbackName),\n      detectedVersion: Number(match[2]) || 0,\n    };\n  }\n\n  return {\n    baseName: sanitizeBaseName(withoutExt || fallbackName),\n    detectedVersion: 0,\n  };\n};\n\n/**\n * Zustand project store.\n *\n * Manages project state including:\n * - Project metadata and lifecycle\n * - Screens and screen management\n * - Components and component tree\n * - Plugin slot bindings\n * - Theme configuration\n * - Build settings\n *\n * @example\n * ```tsx\n * const projectName = useProjectStore((state) => state.metadata.name);\n * const screens = useProjectStore((state) => state.screens);\n *\n * // Create new project\n * const newProject = useProjectStore((state) => state.newProject);\n * newProject(\"My App\", \"John Doe\");\n *\n * // Add a screen\n * const addScreen = useProjectStore((state) => state.addScreen);\n * addScreen({\n *   id: generateId(),\n *   name: \"Home\",\n *   type: \"main\",\n *   rootComponentId: null,\n *   route: \"/\",\n *   title: \"Home\",\n *   isDefault: true,\n *   settings: {},\n * });\n * ```\n */\nexport const useProjectStore = create<ProjectState & ProjectActions>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        ...initialState,\n\n        // Project lifecycle\n        newProject: (name, author = \"\") => {\n          const now = Date.now();\n          set(\n            {\n              ...initialState,\n              metadata: {\n                ...defaultMetadata,\n                name,\n                author,\n                createdAt: now,\n                modifiedAt: now,\n              },\n              status: \"new\",\n            },\n            false,\n            \"newProject\"\n          );\n        },\n\n        loadProject: (data) =>\n          set(\n            (state) => ({\n              ...state,\n              ...data,\n              status: \"saved\",\n              isLoading: false,\n            }),\n            false,\n            \"loadProject\"\n          ),\n\n        loadProjectFromFile: (projectPath, projectJson, _pluginsConfig) => {\n          // Validate project.json schema\n          if (!projectJson.metadata || !projectJson.metadata.name) {\n            set({ error: \"Invalid project file: missing metadata\" }, false, \"loadProjectFromFile:error\");\n            return;\n          }\n\n          // Hydrate project state from file - restore ALL fields for perfect round-trip\n          set(\n            (state) => ({\n              ...state,\n              metadata: {\n                ...projectJson.metadata,\n                filePath: projectPath,\n                // Preserve original modifiedAt from file, don't overwrite\n              },\n              screens: projectJson.screens || {},\n              components: projectJson.components || {},\n              theme: projectJson.theme || state.theme,\n              buildConfig: projectJson.buildConfig || state.buildConfig,\n              // Restore canvas elements (v2 format) or empty array for v1 files\n              canvasElements: projectJson.canvasElements || [],\n              // Restore window config (v2 format) or keep default for v1 files\n              windowConfig: projectJson.windowConfig || state.windowConfig,\n              status: \"saved\",\n              isLoading: false,\n              error: null,\n              // Restore active selections from file, or fallback to first screen\n              activeScreenId: projectJson.activeScreenId !== undefined\n                ? projectJson.activeScreenId\n                : Object.keys(projectJson.screens || {})[0] || null,\n              activeComponentId: projectJson.activeComponentId !== undefined\n                ? projectJson.activeComponentId\n                : null,\n            }),\n            false,\n            \"loadProjectFromFile\"\n          );\n\n          // Add to recent projects\n          const recentProject: RecentProject = {\n            path: projectPath,\n            name: projectJson.metadata.name,\n            lastOpened: Date.now(),\n            thumbnail: null,\n          };\n          get().addRecentProject(recentProject);\n        },\n\n        browseAndLoadProject: async () => {\n          set({ isLoading: true, error: null }, false, \"browseAndLoadProject:start\");\n\n          try {\n            if (!isTauri()) {\n              console.warn(\"Browse unavailable in browser mode\");\n              set({ isLoading: false }, false, \"browseAndLoadProject:browserMode\");\n              return false;\n            }\n\n            // Hardcoded path for development - projects directory\n            const defaultDir = 'C:\\\\Users\\\\anujd\\\\Documents\\\\01_AI\\\\173_piovisstudio\\\\app_factory\\\\outputs\\\\projects';\n\n            // Open file dialog\n            const selectedPath = await open({\n              filters: [{ name: \"App Factory Project\", extensions: [\"json\"] }],\n              defaultPath: defaultDir,\n              multiple: false,\n              directory: false,\n            });\n\n            if (!selectedPath || Array.isArray(selectedPath)) {\n              // User cancelled or invalid selection\n              set({ isLoading: false }, false, \"browseAndLoadProject:cancelled\");\n              return false;\n            }\n\n            // Read the project file\n            const content = await readTextFile(selectedPath);\n            const projectJson = JSON.parse(content) as ProjectFile;\n\n            // Load the project using existing method\n            get().loadProjectFromFile(selectedPath, projectJson);\n\n            set({ isLoading: false }, false, \"browseAndLoadProject:success\");\n            return true;\n          } catch (error) {\n            console.error(\"Failed to browse and load project:\", error);\n            set(\n              {\n                isLoading: false,\n                error: error instanceof Error ? error.message : \"Failed to load project\",\n              },\n              false,\n              \"browseAndLoadProject:error\"\n            );\n            return false;\n          }\n        },\n\n        /**\n         * Save project - writes a new versioned file each time.\n         * Prompts for a location if none exists, then auto-increments version\n         * in the chosen directory on subsequent saves.\n         */\n        saveProject: async () => {\n          const state = get();\n          set({ isSaving: true, error: null }, false, \"saveProject:start\");\n\n          try {\n            const now = Date.now();\n            const { baseName, detectedVersion } = getBaseNameAndDetectedVersion(\n              state.metadata.filePath,\n              state.metadata.name\n            );\n            const nextVersion = Math.max(state.saveVersion, detectedVersion) + 1;\n            const versionedFilename = buildVersionedFilename(baseName, nextVersion, new Date(now));\n\n            // Determine file path - prompt for new location once, then auto-increment\n            let filePath = state.metadata.filePath;\n\n            if (!filePath) {\n              if (isTauri()) {\n                const defaultDir = await resolve(\"outputs\", \"projects\");\n                const defaultFilePath = await resolve(defaultDir, versionedFilename);\n                const selectedPath = await save({\n                  filters: [{ name: \"App Factory Project\", extensions: [\"json\"] }],\n                  defaultPath: defaultFilePath,\n                });\n                if (!selectedPath) {\n                  set({ isSaving: false }, false, \"saveProject:cancelled\");\n                  return null;\n                }\n                filePath = selectedPath;\n              } else {\n                console.warn(\"Save unavailable in browser mode: Tauri IPC not available\");\n                set(\n                  (s) => ({\n                    status: \"error\",\n                    isSaving: false,\n                    error: \"Save to disk unavailable in browser mode. Run with 'npm run tauri dev' for full functionality.\",\n                    metadata: { ...s.metadata },\n                  }),\n                  false,\n                  \"saveProject:browserModeUnavailable\"\n                );\n                return null;\n              }\n            } else {\n              if (isTauri()) {\n                const targetDir = await dirname(filePath);\n                filePath = await resolve(targetDir, versionedFilename);\n              } else {\n                console.warn(\"Save unavailable in browser mode: Tauri IPC not available\");\n                set(\n                  (s) => ({\n                    status: \"error\",\n                    isSaving: false,\n                    error: \"Save to disk unavailable in browser mode. Run with 'npm run tauri dev' for full functionality.\",\n                    metadata: { ...s.metadata },\n                  }),\n                  false,\n                  \"saveProject:browserModeUnavailable\"\n                );\n                return null;\n              }\n            }\n\n            // Prepare complete Project File Data (version 2 format)\n            const projectFile: ProjectFile = {\n              version: 2,\n              metadata: {\n                ...state.metadata,\n                filePath,\n                modifiedAt: now,\n              },\n              screens: state.screens,\n              components: state.components,\n              theme: state.theme,\n              buildConfig: state.buildConfig,\n              canvasElements: state.canvasElements,\n              windowConfig: state.windowConfig ?? undefined,\n              activeScreenId: state.activeScreenId,\n              activeComponentId: state.activeComponentId,\n            };\n\n            // Write to disk (Tauri)\n            if (isTauri() && filePath) {\n              await writeTextFile(filePath, JSON.stringify(projectFile, null, 2));\n\n              // Update state on success\n              set(\n                (s) => ({\n                  status: \"saved\",\n                  isSaving: false,\n                  saveVersion: nextVersion,\n                  metadata: { ...s.metadata, filePath, modifiedAt: now },\n                }),\n                false,\n                \"saveProject:success\"\n              );\n\n              // Update recent projects\n              get().addRecentProject({\n                path: filePath,\n                name: state.metadata.name,\n                lastOpened: now,\n                thumbnail: null,\n              });\n\n              return filePath;\n            } else if (!isTauri()) {\n              console.warn(\"Save unavailable in browser mode: Tauri IPC not available\");\n              set(\n                (s) => ({\n                  status: \"error\",\n                  isSaving: false,\n                  error: \"Save to disk unavailable in browser mode. Run with 'npm run tauri dev' for full functionality.\",\n                  metadata: { ...s.metadata },\n                }),\n                false,\n                \"saveProject:browserModeUnavailable\"\n              );\n              return null;\n            } else {\n              throw new Error(\"Cannot save: invalid file path\");\n            }\n          } catch (error) {\n            console.error(\"Failed to save project:\", error);\n            set(\n              {\n                isSaving: false,\n                error: error instanceof Error ? error.message : \"Unknown error saving project\",\n              },\n              false,\n              \"saveProject:error\"\n            );\n            return null;\n          }\n        },\n\n        /**\n         * Save As - prompts for a file location (defaulting to current file name if present).\n         * Format recommendation: <projectName>_v<NNN>_<YYMMDD>.json\n         * Increments saveVersion counter for each Save As operation.\n         */\n        saveProjectAs: async () => {\n          const state = get();\n          set({ isSaving: true, error: null }, false, \"saveProjectAs:start\");\n\n          try {\n            const now = Date.now();\n            const { baseName, detectedVersion } = getBaseNameAndDetectedVersion(\n              state.metadata.filePath,\n              state.metadata.name\n            );\n            const newVersion = Math.max(state.saveVersion, detectedVersion) + 1;\n            const versionedFilename = buildVersionedFilename(baseName, newVersion, new Date(now));\n\n            // Prepare complete Project File Data\n            const projectFile: ProjectFile = {\n              version: 2,\n              metadata: {\n                ...state.metadata,\n                modifiedAt: now,\n              },\n              screens: state.screens,\n              components: state.components,\n              theme: state.theme,\n              buildConfig: state.buildConfig,\n              canvasElements: state.canvasElements,\n              windowConfig: state.windowConfig ?? undefined,\n              activeScreenId: state.activeScreenId,\n              activeComponentId: state.activeComponentId,\n            };\n\n            if (isTauri()) {\n              // Determine default directory\n              let defaultFilePath: string;\n              if (state.metadata.filePath) {\n                defaultFilePath = state.metadata.filePath;\n              } else {\n                const defaultDir = await resolve(\"outputs\", \"projects\");\n                defaultFilePath = await resolve(defaultDir, versionedFilename);\n              }\n\n              const selectedPath = await save({\n                filters: [{ name: \"App Factory Project\", extensions: [\"json\"] }],\n                defaultPath: defaultFilePath,\n              });\n\n              if (!selectedPath) {\n                set({ isSaving: false }, false, \"saveProjectAs:cancelled\");\n                return null;\n              }\n\n              // Write to disk\n              const projectFileWithPath: ProjectFile = {\n                ...projectFile,\n                metadata: {\n                  ...projectFile.metadata,\n                  filePath: selectedPath,\n                },\n              };\n\n              await writeTextFile(selectedPath, JSON.stringify(projectFileWithPath, null, 2));\n\n              // Update state with new path and version\n              set(\n                (s) => ({\n                  status: \"saved\",\n                  isSaving: false,\n                  saveVersion: newVersion,\n                  metadata: {\n                    ...s.metadata,\n                    filePath: selectedPath,\n                    modifiedAt: now,\n                  },\n                }),\n                false,\n                \"saveProjectAs:success\"\n              );\n\n              // Update Recent Projects\n              get().addRecentProject({\n                path: selectedPath,\n                name: state.metadata.name,\n                lastOpened: now,\n                thumbnail: null,\n              });\n\n              return selectedPath;\n            } else {\n              // Browser fallback\n              console.warn(\"Save As unavailable in browser: mocking save\");\n              await new Promise((r) => setTimeout(r, 500));\n              set(\n                (s) => ({\n                  status: \"saved\",\n                  isSaving: false,\n                  saveVersion: newVersion,\n                  metadata: { ...s.metadata, modifiedAt: Date.now() },\n                }),\n                false,\n                \"saveProjectAs:mockSuccess\"\n              );\n              return null;\n            }\n          } catch (error) {\n            console.error(\"Failed to save project as:\", error);\n            set(\n              {\n                isSaving: false,\n                error: error instanceof Error ? error.message : \"Unknown error saving project\",\n              },\n              false,\n              \"saveProjectAs:error\"\n            );\n            return null;\n          }\n        },\n\n        setMetadata: (metadata) =>\n          set(\n            (state) => ({\n              metadata: {\n                ...state.metadata,\n                ...metadata,\n                modifiedAt: Date.now(),\n              },\n              status: state.status === \"saved\" ? \"modified\" : state.status,\n            }),\n            false,\n            \"setMetadata\"\n          ),\n\n        setStatus: (status) => set({ status }, false, \"setStatus\"),\n\n        // Canvas element actions\n        setCanvasElements: (elements) =>\n          set(\n            { canvasElements: elements, status: \"modified\" },\n            false,\n            \"setCanvasElements\"\n          ),\n\n        updateCanvasElement: (elementId, updates) =>\n          set(\n            (state) => ({\n              canvasElements: state.canvasElements.map((el) =>\n                el.id === elementId ? { ...el, ...updates } : el\n              ),\n              status: \"modified\",\n            }),\n            false,\n            \"updateCanvasElement\"\n          ),\n\n        addCanvasElement: (element) =>\n          set(\n            (state) => ({\n              canvasElements: [...state.canvasElements, element],\n              status: \"modified\",\n            }),\n            false,\n            \"addCanvasElement\"\n          ),\n\n        removeCanvasElement: (elementId) =>\n          set(\n            (state) => ({\n              canvasElements: state.canvasElements.filter((el) => el.id !== elementId),\n              status: \"modified\",\n            }),\n            false,\n            \"removeCanvasElement\"\n          ),\n\n        // Window config actions\n        setWindowConfig: (config) =>\n          set(\n            (state) => ({\n              windowConfig: state.windowConfig\n                ? { ...state.windowConfig, ...config }\n                : { ...defaultWindowConfig, ...config },\n              status: \"modified\",\n            }),\n            false,\n            \"setWindowConfig\"\n          ),\n\n        updateScreenWindowConfig: (screenId, config) =>\n          set(\n            (state) => {\n              const screen = state.screens[screenId];\n              if (!screen) return state;\n\n              // Merge with existing screen windowConfig or create new one based on defaults\n              const baseConfig = screen.windowConfig || state.windowConfig || defaultWindowConfig;\n              const newWindowConfig: SerializedWindowConfig = {\n                ...baseConfig,\n                ...config,\n              };\n\n              return {\n                screens: {\n                  ...state.screens,\n                  [screenId]: {\n                    ...screen,\n                    windowConfig: newWindowConfig,\n                  },\n                },\n                status: \"modified\",\n              };\n            },\n            false,\n            \"updateScreenWindowConfig\"\n          ),\n\n        clearScreenWindowConfig: (screenId) =>\n          set(\n            (state) => {\n              const screen = state.screens[screenId];\n              if (!screen) return state;\n\n              // Create a copy without windowConfig\n              const { windowConfig: _, ...screenWithoutConfig } = screen;\n\n              return {\n                screens: {\n                  ...state.screens,\n                  [screenId]: screenWithoutConfig as ProjectScreen,\n                },\n                status: \"modified\",\n              };\n            },\n            false,\n            \"clearScreenWindowConfig\"\n          ),\n\n        // Screen actions\n        addScreen: (screen) =>\n          set(\n            (state) => ({\n              screens: {\n                ...state.screens,\n                [screen.id]: screen,\n              },\n              activeScreenId: state.activeScreenId || screen.id,\n              status: \"modified\",\n            }),\n            false,\n            \"addScreen\"\n          ),\n\n        updateScreen: (screenId, updates) =>\n          set(\n            (state) => {\n              const screen = state.screens[screenId];\n              if (!screen) return state;\n\n              return {\n                screens: {\n                  ...state.screens,\n                  [screenId]: { ...screen, ...updates },\n                },\n                status: \"modified\",\n              };\n            },\n            false,\n            \"updateScreen\"\n          ),\n\n        removeScreen: (screenId) =>\n          set(\n            (state) => {\n              const { [screenId]: removed, ...remaining } = state.screens;\n\n              // Also remove components belonging to this screen\n              const screen = state.screens[screenId];\n              const componentIds = new Set<string>();\n              if (screen?.rootComponentId) {\n                const collectIds = (id: string) => {\n                  componentIds.add(id);\n                  const component = state.components[id];\n                  component?.children.forEach(collectIds);\n                };\n                collectIds(screen.rootComponentId);\n              }\n\n              const components = { ...state.components };\n              componentIds.forEach((id) => delete components[id]);\n\n              return {\n                screens: remaining,\n                components,\n                activeScreenId:\n                  state.activeScreenId === screenId\n                    ? Object.keys(remaining)[0] || null\n                    : state.activeScreenId,\n                activeComponentId: componentIds.has(state.activeComponentId || \"\")\n                  ? null\n                  : state.activeComponentId,\n                status: \"modified\",\n              };\n            },\n            false,\n            \"removeScreen\"\n          ),\n\n        setActiveScreen: (screenId) =>\n          set({ activeScreenId: screenId, activeComponentId: null }, false, \"setActiveScreen\"),\n\n        duplicateScreen: (screenId) => {\n          const state = get();\n          const screen = state.screens[screenId];\n          if (!screen) return null;\n\n          const newScreen: ProjectScreen = {\n            ...deepClone(screen),\n            id: generateId(),\n            name: `${screen.name} (Copy)`,\n            isDefault: false,\n          };\n\n          set(\n            (s) => ({\n              screens: {\n                ...s.screens,\n                [newScreen.id]: newScreen,\n              },\n              status: \"modified\",\n            }),\n            false,\n            \"duplicateScreen\"\n          );\n\n          return newScreen;\n        },\n\n        // Component actions\n        addComponent: (component) =>\n          set(\n            (state) => ({\n              components: {\n                ...state.components,\n                [component.id]: component,\n              },\n              status: \"modified\",\n            }),\n            false,\n            \"addComponent\"\n          ),\n\n        updateComponent: (componentId, updates) =>\n          set(\n            (state) => {\n              const component = state.components[componentId];\n              if (!component) return state;\n\n              return {\n                components: {\n                  ...state.components,\n                  [componentId]: { ...component, ...updates },\n                },\n                status: \"modified\",\n              };\n            },\n            false,\n            \"updateComponent\"\n          ),\n\n        removeComponent: (componentId) =>\n          set(\n            (state) => {\n              // Collect all descendant IDs\n              const idsToRemove = new Set<string>();\n              const collectIds = (id: string) => {\n                idsToRemove.add(id);\n                const component = state.components[id];\n                component?.children.forEach(collectIds);\n              };\n              collectIds(componentId);\n\n              // Remove from parent's children\n              const components = { ...state.components };\n              const component = components[componentId];\n              if (component?.parentId && components[component.parentId]) {\n                components[component.parentId] = {\n                  ...components[component.parentId],\n                  children: components[component.parentId].children.filter(\n                    (id) => id !== componentId\n                  ),\n                };\n              }\n\n              // Remove all collected components\n              idsToRemove.forEach((id) => delete components[id]);\n\n              return {\n                components,\n                activeComponentId: idsToRemove.has(state.activeComponentId || \"\")\n                  ? null\n                  : state.activeComponentId,\n                status: \"modified\",\n              };\n            },\n            false,\n            \"removeComponent\"\n          ),\n\n        setActiveComponent: (componentId) =>\n          set({ activeComponentId: componentId }, false, \"setActiveComponent\"),\n\n        moveComponent: (componentId, newParentId, index) =>\n          set(\n            (state) => {\n              const component = state.components[componentId];\n              if (!component) return state;\n\n              const components = { ...state.components };\n\n              // Remove from old parent\n              if (component.parentId && components[component.parentId]) {\n                components[component.parentId] = {\n                  ...components[component.parentId],\n                  children: components[component.parentId].children.filter(\n                    (id) => id !== componentId\n                  ),\n                };\n              }\n\n              // Add to new parent\n              if (newParentId && components[newParentId]) {\n                const children = [...components[newParentId].children];\n                if (index !== undefined && index >= 0) {\n                  children.splice(index, 0, componentId);\n                } else {\n                  children.push(componentId);\n                }\n                components[newParentId] = {\n                  ...components[newParentId],\n                  children,\n                };\n              }\n\n              // Update component's parentId\n              components[componentId] = {\n                ...component,\n                parentId: newParentId,\n              };\n\n              return {\n                components,\n                status: \"modified\",\n              };\n            },\n            false,\n            \"moveComponent\"\n          ),\n\n        duplicateComponent: (componentId) => {\n          const state = get();\n          const component = state.components[componentId];\n          if (!component) return null;\n\n          const newComponent: ProjectComponent = {\n            ...deepClone(component),\n            id: generateId(),\n            name: `${component.name} (Copy)`,\n          };\n\n          set(\n            (s) => {\n              const components = { ...s.components, [newComponent.id]: newComponent };\n\n              // Add to parent's children if has parent\n              if (newComponent.parentId && components[newComponent.parentId]) {\n                const parent = components[newComponent.parentId];\n                const insertIndex = parent.children.indexOf(componentId) + 1;\n                const children = [...parent.children];\n                children.splice(insertIndex, 0, newComponent.id);\n                components[newComponent.parentId] = { ...parent, children };\n              }\n\n              return {\n                components,\n                status: \"modified\",\n              };\n            },\n            false,\n            \"duplicateComponent\"\n          );\n\n          return newComponent;\n        },\n\n        // Slot actions\n        bindSlot: (componentId, slotId, pluginId) =>\n          set(\n            (state) => {\n              const component = state.components[componentId];\n              if (!component) return state;\n\n              return {\n                components: {\n                  ...state.components,\n                  [componentId]: {\n                    ...component,\n                    slots: component.slots.map((slot) =>\n                      slot.id === slotId ? { ...slot, pluginId } : slot\n                    ),\n                  },\n                },\n                status: \"modified\",\n              };\n            },\n            false,\n            \"bindSlot\"\n          ),\n\n        unbindSlot: (componentId, slotId) =>\n          set(\n            (state) => {\n              const component = state.components[componentId];\n              if (!component) return state;\n\n              return {\n                components: {\n                  ...state.components,\n                  [componentId]: {\n                    ...component,\n                    slots: component.slots.map((slot) =>\n                      slot.id === slotId ? { ...slot, pluginId: null } : slot\n                    ),\n                  },\n                },\n                status: \"modified\",\n              };\n            },\n            false,\n            \"unbindSlot\"\n          ),\n\n        updateSlotConfig: (componentId, slotId, config) =>\n          set(\n            (state) => {\n              const component = state.components[componentId];\n              if (!component) return state;\n\n              return {\n                components: {\n                  ...state.components,\n                  [componentId]: {\n                    ...component,\n                    slots: component.slots.map((slot) =>\n                      slot.id === slotId\n                        ? { ...slot, config: { ...slot.config, ...config } }\n                        : slot\n                    ),\n                  },\n                },\n                status: \"modified\",\n              };\n            },\n            false,\n            \"updateSlotConfig\"\n          ),\n\n        // Theme actions\n        setTheme: (theme) =>\n          set(\n            (state) => ({\n              theme: { ...state.theme, ...theme },\n              status: \"modified\",\n            }),\n            false,\n            \"setTheme\"\n          ),\n\n        resetTheme: () =>\n          set(\n            {\n              theme: defaultTheme,\n              status: \"modified\",\n            },\n            false,\n            \"resetTheme\"\n          ),\n\n        // Build config actions\n        setBuildConfig: (config) =>\n          set(\n            (state) => ({\n              buildConfig: { ...state.buildConfig, ...config },\n              status: \"modified\",\n            }),\n            false,\n            \"setBuildConfig\"\n          ),\n\n        // Clipboard actions\n        copyComponent: (componentId) => {\n          const state = get();\n          const component = state.components[componentId];\n          if (!component) return;\n\n          set(\n            {\n              clipboard: {\n                type: \"component\",\n                data: deepClone(component),\n              },\n            },\n            false,\n            \"copyComponent\"\n          );\n        },\n\n        copyScreen: (screenId) => {\n          const state = get();\n          const screen = state.screens[screenId];\n          if (!screen) return;\n\n          set(\n            {\n              clipboard: {\n                type: \"screen\",\n                data: deepClone(screen),\n              },\n            },\n            false,\n            \"copyScreen\"\n          );\n        },\n\n        paste: (targetParentId = null) => {\n          const state = get();\n          const { clipboard } = state;\n\n          if (!clipboard.type || !clipboard.data) return null;\n\n          if (clipboard.type === \"component\") {\n            const original = clipboard.data as ProjectComponent;\n            const newId = generateId();\n            const newComponent: ProjectComponent = {\n              ...deepClone(original),\n              id: newId,\n              name: `${original.name} (Copy)`,\n              parentId: targetParentId,\n            };\n\n            set(\n              (s) => {\n                const components = { ...s.components, [newId]: newComponent };\n\n                if (targetParentId && components[targetParentId]) {\n                  components[targetParentId] = {\n                    ...components[targetParentId],\n                    children: [...components[targetParentId].children, newId],\n                  };\n                }\n\n                return {\n                  components,\n                  activeComponentId: newId,\n                  status: \"modified\",\n                };\n              },\n              false,\n              \"paste\"\n            );\n\n            return newId;\n          }\n\n          if (clipboard.type === \"screen\") {\n            const original = clipboard.data as ProjectScreen;\n            const newId = generateId();\n            const newScreen: ProjectScreen = {\n              ...deepClone(original),\n              id: newId,\n              name: `${original.name} (Copy)`,\n              isDefault: false,\n            };\n\n            set(\n              (s) => ({\n                screens: { ...s.screens, [newId]: newScreen },\n                activeScreenId: newId,\n                status: \"modified\",\n              }),\n              false,\n              \"paste\"\n            );\n\n            return newId;\n          }\n\n          return null;\n        },\n\n        clearClipboard: () =>\n          set({ clipboard: { type: null, data: null } }, false, \"clearClipboard\"),\n\n        // Recent projects\n        addRecentProject: (project) =>\n          set(\n            (state) => {\n              const filtered = state.recentProjects.filter((p) => p.path !== project.path);\n              const updated = [\n                { ...project, lastOpened: Date.now() },\n                ...filtered,\n              ].slice(0, state.maxRecentProjects);\n\n              return { recentProjects: updated };\n            },\n            false,\n            \"addRecentProject\"\n          ),\n\n        removeRecentProject: (path) =>\n          set(\n            (state) => ({\n              recentProjects: state.recentProjects.filter((p) => p.path !== path),\n            }),\n            false,\n            \"removeRecentProject\"\n          ),\n\n        clearRecentProjects: () =>\n          set({ recentProjects: [] }, false, \"clearRecentProjects\"),\n\n        // State actions\n        setLoading: (loading) => set({ isLoading: loading }, false, \"setLoading\"),\n        setSaving: (saving) => set({ isSaving: saving }, false, \"setSaving\"),\n        setError: (error) => set({ error }, false, \"setError\"),\n\n        // Reset\n        reset: () => set(initialState, false, \"reset\"),\n      }),\n      {\n        name: \"project-store\",\n        partialize: (state) => ({\n          // Only persist recent projects, not the current project\n          recentProjects: state.recentProjects,\n        }),\n      }\n    ),\n    { name: \"ProjectStore\" }\n  )\n);\n\n/**\n * Selector for all screens as array.\n */\nexport const useScreens = () =>\n  useProjectStore((state) => Object.values(state.screens));\n\n/**\n * Selector for active screen.\n */\nexport const useActiveScreen = () =>\n  useProjectStore((state) =>\n    state.activeScreenId ? state.screens[state.activeScreenId] : null\n  );\n\n/**\n * Selector for active component.\n */\nexport const useActiveComponent = () =>\n  useProjectStore((state) =>\n    state.activeComponentId ? state.components[state.activeComponentId] : null\n  );\n\n/**\n * Selector for component tree of active screen.\n */\nexport const useActiveScreenComponents = () =>\n  useProjectStore((state) => {\n    const screen = state.activeScreenId ? state.screens[state.activeScreenId] : null;\n    if (!screen?.rootComponentId) return [];\n\n    const components: ProjectComponent[] = [];\n    const collect = (id: string) => {\n      const component = state.components[id];\n      if (component) {\n        components.push(component);\n        component.children.forEach(collect);\n      }\n    };\n    collect(screen.rootComponentId);\n\n    return components;\n  });\n\n/**\n * Selector for project status.\n */\nexport const useProjectStatus = () => useProjectStore((state) => state.status);\n\n/**\n * Selector for project theme.\n */\nexport const useProjectTheme = () => useProjectStore((state) => state.theme);\n\n/**\n * Selector for build config.\n */\nexport const useBuildConfig = () => useProjectStore((state) => state.buildConfig);\n\n/**\n * Selector for canvas elements.\n */\nexport const useCanvasElements = () => useProjectStore((state) => state.canvasElements);\n\n/**\n * Selector for window config.\n */\nexport const useWindowConfig = () => useProjectStore((state) => state.windowConfig);\n\n/**\n * Selector for save version.\n */\nexport const useSaveVersion = () => useProjectStore((state) => state.saveVersion);\n\nexport default useProjectStore;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\settingsStore.ts","messages":[{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary optional chain on a non-nullish value.","line":133,"column":60,"nodeType":"MemberExpression","messageId":"neverOptionalChain","endLine":133,"endColumn":62,"suggestions":[{"messageId":"suggestRemoveOptionalChain","fix":{"range":[5235,5237],"text":""},"desc":"Remove unnecessary optional chain"}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * settingsStore.ts\r\n * ================\r\n * Zustand store for LLM and application settings.\r\n * Persisted to localStorage.\r\n */\r\n\r\nimport { create } from 'zustand';\r\nimport { persist } from 'zustand/middleware';\r\n\r\n/**\r\n * Supported LLM providers.\r\n */\r\nexport type LLMProvider = 'gemini' | 'openai' | 'anthropic' | 'ollama';\r\n\r\n/**\r\n * Model options per provider.\r\n */\r\nexport const MODEL_OPTIONS: Record<LLMProvider, { id: string; label: string }[]> = {\r\n    gemini: [\r\n        { id: 'gemini-3-flash-preview', label: 'Gemini 3 Flash (Preview)' },\r\n        { id: 'gemini-2.5-flash', label: 'Gemini 2.5 Flash' },\r\n        { id: 'gemini-2.0-flash', label: 'Gemini 2.0 Flash' },\r\n        { id: 'gemini-1.5-pro', label: 'Gemini 1.5 Pro' },\r\n    ],\r\n    openai: [\r\n        { id: 'gpt-4o', label: 'GPT-4o' },\r\n        { id: 'gpt-4o-mini', label: 'GPT-4o Mini' },\r\n        { id: 'gpt-4-turbo', label: 'GPT-4 Turbo' },\r\n    ],\r\n    anthropic: [\r\n        { id: 'claude-3-5-sonnet-20241022', label: 'Claude 3.5 Sonnet' },\r\n        { id: 'claude-3-opus-20240229', label: 'Claude 3 Opus' },\r\n    ],\r\n    ollama: [\r\n        { id: 'llama3.2', label: 'Llama 3.2' },\r\n        { id: 'mistral', label: 'Mistral' },\r\n        { id: 'codellama', label: 'Code Llama' },\r\n    ],\r\n};\r\n\r\n/**\r\n * Settings state interface.\r\n */\r\nexport interface SettingsState {\r\n    provider: LLMProvider;\r\n    apiKey: string;\r\n    model: string;\r\n    temperature: number;\r\n    systemPrompt: string;\r\n    ollamaModels: string[]; // Dynamically fetched models\r\n}\r\n\r\n/**\r\n * Settings actions interface.\r\n */\r\nexport interface SettingsActions {\r\n    setProvider: (provider: LLMProvider) => void;\r\n    setApiKey: (apiKey: string) => void;\r\n    setModel: (model: string) => void;\r\n    setTemperature: (temperature: number) => void;\r\n    setSystemPrompt: (systemPrompt: string) => void;\r\n    setOllamaModels: (models: string[]) => void;\r\n    resetToDefaults: () => void;\r\n}\r\n\r\n/**\r\n * Default settings values.\r\n */\r\nconst DEFAULT_SETTINGS: SettingsState = {\r\n    provider: 'gemini',\r\n    apiKey: '',\r\n    model: 'gemini-3-flash-preview',\r\n    temperature: 0.0,\r\n    systemPrompt: `You are an expert Frontend Engineer and strict code compiler. Return ONLY valid React/Tailwind code.\r\n\r\nCRITICAL INSTRUCTIONS:\r\n1. OUTPUT FORMAT: Return ONLY the raw component code. NO markdown fences, NO explanations, NO imports, NO comments.\r\n2. ACCURACY: Implement EXACTLY what is requested. DO NOT hallucinate features.\r\n3. NEGATIVE CONSTRAINTS (DO NOT DO):\r\n   - DO NOT add background colors unless requested.\r\n   - DO NOT add filler text (Lorem Ipsum) unless requested.\r\n   - DO NOT add extra padding/margins to the root element. It must be reflowable.\r\n   - DO NOT wrap the component in a centered div (the previewer handles centering).\r\n   - DO NOT use <button> tags for \"Shapes\" (Sphere, Square, Box) unless explicitly asked. Use <div>.\r\n   - DO NOT use absolute positioning on the root element.\r\n\r\nDESIGN SYSTEM (Apple HIG & Platform Agnostic Best Practices):\r\n- TYPOGRAPHY: Use 'font-sans' (Inter/system-ui). distinct weights (medium/semibold for interactive).\r\n- SPACING: Use standard Tailwind spacing (p-4, gap-2).\r\n- INTERACTION: All interactive elements MUST have:\r\n  - hover states (brightness-105 or bg-opacity changes)\r\n  - active states (scale-95 or brightness-90)\r\n  - focus states (ring-2 ring-primary-500 ring-offset-2)\r\n  - cursor-pointer\r\n\r\nANIMATION RULES (Exact Implementation):\r\n- \"jelly\" / \"bouncy\" -> transition-transform duration-300 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] hover:scale-110 active:scale-90\r\n- \"spin\" -> transition-transform duration-700 ease-in-out hover:rotate-[360deg]\r\n- \"squishy\" -> transition-all duration-200 hover:scale-x-125 hover:scale-y-75 active:scale-x-75 active:scale-y-125\r\n- \"neomorphic\" -> shadow-[5px_5px_10px_rgba(0,0,0,0.1),-5px_-5px_10px_rgba(255,255,255,0.8)]\r\n\r\nSTYLING:\r\n- Use Tailwind CSS for EVERYTHING.\r\n- Borders: 'ring-1 ring-white/10' for dark mode subtlety.\r\n- Colors: Use 'bg-primary-500', 'text-neutral-900' unless specific colors requested.\r\n\r\nBROWNFIELD PATTERNS (MANDATORY overrides):\r\n- If user says \"HEXAGON\" -> className=\"aspect-square bg-primary-500 [clip-path:polygon(25%_0%,75%_0%,100%_50%,75%_100%,25%_100%,0%_50%)]\"\r\n- If user says \"SPARKLES\" -> Use a wrapper div with 'relative'. Add absolute positioned spans for 'sparkles'.\r\n\r\nFINAL CHECK:\r\n- Did you add a background color? If user didn't ask, REMOVE IT.\r\n- Did you add text? If user didn't ask, make it empty.\r\n- Is the root element margin-free? Yes.`,\r\n    ollamaModels: [],\r\n};\r\n\r\n/**\r\n * Zustand store for settings with persistence.\r\n */\r\nexport const useSettingsStore = create<SettingsState & SettingsActions>()(\r\n    persist(\r\n        (set) => ({\r\n            ...DEFAULT_SETTINGS,\r\n\r\n            setProvider: (provider) =>\r\n                set((state) => {\r\n                    // When provider changes, reset model to first option of new provider\r\n                    let newModel = state.model;\r\n                    if (provider === 'gemini') newModel = 'gemini-3-flash-preview';\r\n                    else if (provider === 'ollama') newModel = state.ollamaModels[0] || 'llama3.2';\r\n                    else newModel = MODEL_OPTIONS[provider]?.[0]?.id || '';\r\n\r\n                    return { provider, model: newModel };\r\n                }),\r\n\r\n            setApiKey: (apiKey) => set({ apiKey }),\r\n\r\n            setModel: (model) => set({ model }),\r\n\r\n            setTemperature: (temperature) => {\r\n                // Round to 1 decimal place and clamp between 0 and 2\r\n                const rounded = Math.round(Math.max(0, Math.min(2, temperature)) * 10) / 10;\r\n                set({ temperature: rounded });\r\n            },\r\n\r\n            setSystemPrompt: (systemPrompt) => set({ systemPrompt }),\r\n\r\n            setOllamaModels: (models) => set({ ollamaModels: models }),\r\n\r\n            resetToDefaults: () => set(DEFAULT_SETTINGS),\r\n        }),\r\n        {\r\n            name: 'app-factory-settings',\r\n        }\r\n    )\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\stores\\templateStore.ts","messages":[{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":119,"column":20,"nodeType":"CallExpression","messageId":"invalidType","endLine":119,"endColumn":30},{"ruleId":"@typescript-eslint/require-await","severity":2,"message":"Async method 'loadTemplate' has no 'await' expression.","line":194,"column":17,"nodeType":"ArrowFunctionExpression","messageId":"missingAwait","endLine":194,"endColumn":37,"suggestions":[{"messageId":"removeAsync","fix":{"range":[6606,6612],"text":""},"desc":"Remove 'async'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * src/stores/templateStore.ts\r\n * ===========================\r\n * Zustand store for FE UI template management.\r\n * \r\n * Implements EUR-1.1.10 (load templates) and EUR-1.1.10a (save as template).\r\n * Templates are persisted to local filesystem via Tauri FS API.\r\n */\r\n\r\nimport { create } from \"zustand\";\r\nimport { devtools, persist } from \"zustand/middleware\";\r\nimport { readDir, readTextFile, writeTextFile, removeFile, createDir, exists } from \"@tauri-apps/api/fs\";\r\nimport { appDataDir, join } from \"@tauri-apps/api/path\";\r\nimport { isTauri } from \"../utils/tauriUtils\";\r\nimport type { ProjectComponent, ProjectScreen, ProjectTheme } from \"./projectStore\";\r\nimport { useProjectStore } from \"./projectStore\";\r\n\r\n// =============================================================================\r\n// TYPES\r\n// =============================================================================\r\n\r\n/**\r\n * FE UI Template structure.\r\n */\r\nexport interface FETemplate {\r\n    /** Unique template ID */\r\n    id: string;\r\n    /** Template name */\r\n    name: string;\r\n    /** Template description */\r\n    description: string;\r\n    /** Base64 encoded thumbnail image */\r\n    thumbnail: string | null;\r\n    /** Component definitions */\r\n    components: Record<string, ProjectComponent>;\r\n    /** Screen definitions */\r\n    screens: Record<string, ProjectScreen>;\r\n    /** Theme configuration */\r\n    theme: ProjectTheme;\r\n    /** Creation timestamp */\r\n    createdAt: number;\r\n    /** Last modified timestamp */\r\n    updatedAt: number;\r\n    /** Tags for filtering */\r\n    tags: string[];\r\n    /** Template author */\r\n    author: string;\r\n    /** Version */\r\n    version: string;\r\n}\r\n\r\n/**\r\n * Template store state.\r\n */\r\ninterface TemplateState {\r\n    /** All available templates */\r\n    templates: FETemplate[];\r\n    /** Currently selected template ID */\r\n    selectedTemplateId: string | null;\r\n    /** Search query */\r\n    searchQuery: string;\r\n    /** Loading state */\r\n    isLoading: boolean;\r\n    /** Saving state */\r\n    isSaving: boolean;\r\n    /** Error message */\r\n    error: string | null;\r\n}\r\n\r\n/**\r\n * Template store actions.\r\n */\r\ninterface TemplateActions {\r\n    /** Save current project as a template */\r\n    saveAsTemplate: (name: string, description?: string, tags?: string[]) => Promise<FETemplate>;\r\n    /** Load a template into the current project */\r\n    loadTemplate: (templateId: string) => Promise<void>;\r\n    /** Delete a template */\r\n    deleteTemplate: (templateId: string) => Promise<void>;\r\n    /** Refresh templates from disk */\r\n    refreshTemplates: () => Promise<void>;\r\n    /** Set selected template */\r\n    setSelectedTemplate: (templateId: string | null) => void;\r\n    /** Set search query */\r\n    setSearchQuery: (query: string) => void;\r\n    /** Clear error */\r\n    clearError: () => void;\r\n}\r\n\r\n// =============================================================================\r\n// HELPERS\r\n// =============================================================================\r\n\r\nconst TEMPLATES_DIR = \"templates\";\r\n\r\n/**\r\n * Get templates directory path.\r\n */\r\nasync function getTemplatesDir(): Promise<string> {\r\n    const appData = await appDataDir();\r\n    return await join(appData, TEMPLATES_DIR);\r\n}\r\n\r\n/**\r\n * Ensure templates directory exists.\r\n */\r\nasync function ensureTemplatesDir(): Promise<void> {\r\n    const templatesPath = await getTemplatesDir();\r\n    const dirExists = await exists(templatesPath);\r\n    if (!dirExists) {\r\n        await createDir(templatesPath, { recursive: true });\r\n    }\r\n}\r\n\r\n/**\r\n * Generate unique ID.\r\n */\r\nconst generateId = (): string => {\r\n    return `tmpl-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\r\n};\r\n\r\n// =============================================================================\r\n// INITIAL STATE\r\n// =============================================================================\r\n\r\nconst initialState: TemplateState = {\r\n    templates: [],\r\n    selectedTemplateId: null,\r\n    searchQuery: \"\",\r\n    isLoading: false,\r\n    isSaving: false,\r\n    error: null,\r\n};\r\n\r\n// =============================================================================\r\n// STORE\r\n// =============================================================================\r\n\r\n/**\r\n * Zustand store for template management.\r\n */\r\nexport const useTemplateStore = create<TemplateState & TemplateActions>()(\r\n    devtools(\r\n        persist(\r\n            (set, get) => ({\r\n                ...initialState,\r\n\r\n                saveAsTemplate: async (name, description = \"\", tags = []) => {\r\n                    set({ isSaving: true, error: null });\r\n\r\n                    try {\r\n                        // Get current project state\r\n                        const projectStore = useProjectStore.getState();\r\n                        const { components, screens, theme, metadata } = projectStore;\r\n\r\n                        // Create template\r\n                        const template: FETemplate = {\r\n                            id: generateId(),\r\n                            name,\r\n                            description,\r\n                            thumbnail: null, // Could capture canvas as image in future\r\n                            components,\r\n                            screens,\r\n                            theme,\r\n                            createdAt: Date.now(),\r\n                            updatedAt: Date.now(),\r\n                            tags,\r\n                            author: metadata.author || \"Unknown\",\r\n                            version: \"1.0.0\",\r\n                        };\r\n\r\n                        if (isTauri()) {\r\n                            // Save to filesystem\r\n                            await ensureTemplatesDir();\r\n                            const templatesPath = await getTemplatesDir();\r\n                            const filePath = await join(templatesPath, `${template.id}.json`);\r\n                            await writeTextFile(filePath, JSON.stringify(template, null, 2));\r\n                        }\r\n\r\n                        // Update store\r\n                        set((state) => ({\r\n                            templates: [...state.templates, template],\r\n                            isSaving: false,\r\n                        }));\r\n\r\n                        return template;\r\n                    } catch (error) {\r\n                        const message = error instanceof Error ? error.message : \"Failed to save template\";\r\n                        set({ isSaving: false, error: message });\r\n                        throw error;\r\n                    }\r\n                },\r\n\r\n                loadTemplate: async (templateId) => {\r\n                    set({ isLoading: true, error: null });\r\n\r\n                    try {\r\n                        const { templates } = get();\r\n                        const template = templates.find((t) => t.id === templateId);\r\n\r\n                        if (!template) {\r\n                            throw new Error(\"Template not found\");\r\n                        }\r\n\r\n                        // Apply template to project store\r\n                        const projectStore = useProjectStore.getState();\r\n\r\n                        // Merge template into current project\r\n                        projectStore.loadProject({\r\n                            components: template.components,\r\n                            screens: template.screens,\r\n                            theme: template.theme,\r\n                            status: \"modified\",\r\n                        });\r\n\r\n                        set({ isLoading: false, selectedTemplateId: templateId });\r\n                    } catch (error) {\r\n                        const message = error instanceof Error ? error.message : \"Failed to load template\";\r\n                        set({ isLoading: false, error: message });\r\n                        throw error;\r\n                    }\r\n                },\r\n\r\n                deleteTemplate: async (templateId) => {\r\n                    set({ isLoading: true, error: null });\r\n\r\n                    try {\r\n                        if (isTauri()) {\r\n                            const templatesPath = await getTemplatesDir();\r\n                            const filePath = await join(templatesPath, `${templateId}.json`);\r\n                            await removeFile(filePath);\r\n                        }\r\n\r\n                        set((state) => ({\r\n                            templates: state.templates.filter((t) => t.id !== templateId),\r\n                            selectedTemplateId:\r\n                                state.selectedTemplateId === templateId ? null : state.selectedTemplateId,\r\n                            isLoading: false,\r\n                        }));\r\n                    } catch (error) {\r\n                        const message = error instanceof Error ? error.message : \"Failed to delete template\";\r\n                        set({ isLoading: false, error: message });\r\n                        throw error;\r\n                    }\r\n                },\r\n\r\n                refreshTemplates: async () => {\r\n                    set({ isLoading: true, error: null });\r\n\r\n                    try {\r\n                        const templates: FETemplate[] = [];\r\n\r\n                        if (isTauri()) {\r\n                            await ensureTemplatesDir();\r\n                            const templatesPath = await getTemplatesDir();\r\n                            const entries = await readDir(templatesPath);\r\n\r\n                            for (const entry of entries) {\r\n                                if (entry.name?.endsWith(\".json\") && entry.path) {\r\n                                    try {\r\n                                        const content = await readTextFile(entry.path);\r\n                                        const template = JSON.parse(content) as FETemplate;\r\n                                        templates.push(template);\r\n                                    } catch {\r\n                                        // Skip invalid files\r\n                                        console.warn(\"Failed to parse template:\", entry.path);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        set({ templates, isLoading: false });\r\n                    } catch (error) {\r\n                        const message = error instanceof Error ? error.message : \"Failed to refresh templates\";\r\n                        set({ isLoading: false, error: message });\r\n                    }\r\n                },\r\n\r\n                setSelectedTemplate: (templateId) => {\r\n                    set({ selectedTemplateId: templateId });\r\n                },\r\n\r\n                setSearchQuery: (query) => {\r\n                    set({ searchQuery: query });\r\n                },\r\n\r\n                clearError: () => {\r\n                    set({ error: null });\r\n                },\r\n            }),\r\n            {\r\n                name: \"template-store\",\r\n                partialize: (state) => ({\r\n                    templates: state.templates,\r\n                }),\r\n            }\r\n        ),\r\n        { name: \"TemplateStore\" }\r\n    )\r\n);\r\n\r\n// =============================================================================\r\n// SELECTORS\r\n// =============================================================================\r\n\r\n/**\r\n * Get filtered templates based on search query.\r\n */\r\nexport const useFilteredTemplates = () =>\r\n    useTemplateStore((state) => {\r\n        const query = state.searchQuery.toLowerCase();\r\n        if (!query) return state.templates;\r\n\r\n        return state.templates.filter(\r\n            (t) =>\r\n                t.name.toLowerCase().includes(query) ||\r\n                t.description.toLowerCase().includes(query) ||\r\n                t.tags.some((tag) => tag.toLowerCase().includes(query))\r\n        );\r\n    });\r\n\r\n/**\r\n * Get selected template.\r\n */\r\nexport const useSelectedTemplate = () =>\r\n    useTemplateStore((state) =>\r\n        state.templates.find((t) => t.id === state.selectedTemplateId)\r\n    );\r\n\r\nexport default useTemplateStore;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\utils\\ComponentRegistry.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'componentRegistry' is never reassigned. Use 'const' instead.","line":34,"column":5,"nodeType":"Identifier","messageId":"useConst","endLine":34,"endColumn":64,"fix":{"range":[960,1649],"text":"const componentRegistry: Record<string, React.ComponentType<any>> = {\r\n    // Atoms\r\n    'button': Button,\r\n    'input': Input,\r\n    'select': Select,\r\n    'checkbox': Checkbox,\r\n\r\n    // Containers / Molecules\r\n    'panel': Panel,\r\n    'modal': Modal,\r\n    'tabs': Tabs,\r\n\r\n    // Mapped/Aliased types (handling generic usage)\r\n    'card': Panel,      // Map 'card' to Panel\r\n    'container': Panel, // Map 'container' to Panel\r\n    'form': Panel,      // Map 'form' to Panel\r\n    'navigation': Tabs, // Map 'navigation' to Tabs\r\n\r\n    // Specialized Panels\r\n    'theme-customization': ThemeCustomizationPanel,\r\n    'theme-preview': ThemePreview,\r\n    'window-config': WindowConfigPanel\r\n};"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1018,1021],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1018,1021],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2139,2142],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2139,2142],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always falsy.","line":72,"column":9,"nodeType":"UnaryExpression","messageId":"alwaysFalsy","endLine":72,"endColumn":19},{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":74,"column":16,"nodeType":"ArrowFunctionExpression","messageId":"noDisplayName","endLine":80,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2321,2324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2321,2324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":103,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3390,3393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3390,3393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":117,"column":9,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":117,"endColumn":42},{"ruleId":"@typescript-eslint/no-dynamic-delete","severity":2,"message":"Do not delete dynamically computed property keys.","line":118,"column":34,"nodeType":"Identifier","messageId":"dynamicDelete","endLine":118,"endColumn":48},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4832,4835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4832,4835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\r\n * src/utils/ComponentRegistry.tsx\r\n * ===============================\r\n * Registry mapping string component types to actual React components.\r\n * Used by LivePreview to dynamically render the component tree.\r\n * Supports hot-loading by allowing dynamic registration/unregistration.\r\n *\r\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\r\n * Dependencies: D045-D047 (Live preview requirements)\r\n */\r\n\r\nimport React from 'react';\r\nimport {\r\n    Button,\r\n    Input,\r\n    Select,\r\n    Checkbox,\r\n    Modal,\r\n    Panel,\r\n    Tabs,\r\n    ThemeCustomizationPanel,\r\n    ThemePreview,\r\n    WindowConfigPanel\r\n} from '../components/ui';\r\n\r\n// =============================================================================\r\n// COMPONENT REGISTRY\r\n// =============================================================================\r\n\r\n/**\r\n * Component mapping registry.\r\n * Mutable to support dynamic registration for hot-loading.\r\n */\r\nlet componentRegistry: Record<string, React.ComponentType<any>> = {\r\n    // Atoms\r\n    'button': Button,\r\n    'input': Input,\r\n    'select': Select,\r\n    'checkbox': Checkbox,\r\n\r\n    // Containers / Molecules\r\n    'panel': Panel,\r\n    'modal': Modal,\r\n    'tabs': Tabs,\r\n\r\n    // Mapped/Aliased types (handling generic usage)\r\n    'card': Panel,      // Map 'card' to Panel\r\n    'container': Panel, // Map 'container' to Panel\r\n    'form': Panel,      // Map 'form' to Panel\r\n    'navigation': Tabs, // Map 'navigation' to Tabs\r\n\r\n    // Specialized Panels\r\n    'theme-customization': ThemeCustomizationPanel,\r\n    'theme-preview': ThemePreview,\r\n    'window-config': WindowConfigPanel\r\n};\r\n\r\n// =============================================================================\r\n// REGISTRY ACCESS FUNCTIONS\r\n// =============================================================================\r\n\r\n/**\r\n * Get a React component by its string type.\r\n * Returns a fallback if not found.\r\n *\r\n * @param type - The component type string (e.g., 'button', 'panel')\r\n * @returns The React component or a fallback placeholder\r\n */\r\nexport const getComponent = (type: string): React.ComponentType<any> => {\r\n    const Component = componentRegistry[type.toLowerCase()];\r\n\r\n    if (!Component) {\r\n        // Fallback for unknown components\r\n        return ({ children, ...props }: any) => (\r\n            <div className=\"p-2 border-2 border-dashed border-red-300 bg-red-50 text-red-700 rounded text-xs font-mono\">\r\n                <strong>Unknown Component: {type}</strong>\r\n                <pre className=\"mt-1 opacity-75\">{JSON.stringify(props, null, 2)}</pre>\r\n                {children}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return Component;\r\n};\r\n\r\n// =============================================================================\r\n// DYNAMIC REGISTRATION API (for hot-loading)\r\n// =============================================================================\r\n\r\n/**\r\n * Register a new component type at runtime.\r\n * Enables hot-loading of new components without restart.\r\n *\r\n * @param type - The component type string (will be lowercased)\r\n * @param component - The React component to register\r\n *\r\n * @example\r\n * ```tsx\r\n * import { registerComponent } from '@utils/ComponentRegistry';\r\n * registerComponent('custom-widget', MyCustomWidget);\r\n * ```\r\n */\r\nexport function registerComponent(type: string, component: React.ComponentType<any>): void {\r\n    const normalizedType = type.toLowerCase();\r\n    componentRegistry[normalizedType] = component;\r\n    console.log(`[ComponentRegistry] Registered: ${normalizedType}`);\r\n}\r\n\r\n/**\r\n * Unregister a component type at runtime.\r\n *\r\n * @param type - The component type string to unregister\r\n * @returns true if component was found and removed, false otherwise\r\n */\r\nexport function unregisterComponent(type: string): boolean {\r\n    const normalizedType = type.toLowerCase();\r\n    if (componentRegistry[normalizedType]) {\r\n        delete componentRegistry[normalizedType];\r\n        console.log(`[ComponentRegistry] Unregistered: ${normalizedType}`);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * Get all registered component type names.\r\n * Useful for introspection and debugging.\r\n *\r\n * @returns Array of registered type strings\r\n */\r\nexport function getRegisteredTypes(): string[] {\r\n    return Object.keys(componentRegistry);\r\n}\r\n\r\n/**\r\n * Check if a component type is registered.\r\n *\r\n * @param type - The component type string to check\r\n * @returns true if registered, false otherwise\r\n */\r\nexport function isComponentRegistered(type: string): boolean {\r\n    return type.toLowerCase() in componentRegistry;\r\n}\r\n\r\n/**\r\n * Get the raw registry object (for debugging).\r\n * REPLACE_WITH_PRODUCTION: Remove this function in production builds.\r\n */\r\nexport function getRegistry(): Record<string, React.ComponentType<any>> {\r\n    return { ...componentRegistry };\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\utils\\backup.ts","messages":[{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":241,"column":35,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":241,"endColumn":37,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[6099,6101],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":282,"column":33,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":282,"endColumn":35,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[7219,7221],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-inferrable-types","severity":2,"message":"Type number trivially inferred from a number literal, remove type annotation.","line":340,"column":3,"nodeType":"AssignmentPattern","messageId":"noInferrableType","endLine":340,"endColumn":24,"fix":{"range":[8896,8904],"text":""}}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * UJ-B1.1 - src/utils/backup.ts\n * ==============================\n * Project backup and restore utilities for data integrity during project updates.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: None (utility module)\n *\n * This module provides functions to:\n * - Create timestamped backups of project folders\n * - Restore projects from backup archives\n * - List available backups\n * - Manage backup retention\n */\n\n/**\n * Backup metadata structure.\n */\nexport interface BackupMetadata {\n  /** Unique backup identifier */\n  id: string;\n  /** Original project path */\n  projectPath: string;\n  /** Project name */\n  projectName: string;\n  /** Backup timestamp (ISO string) */\n  timestamp: string;\n  /** Backup file path */\n  backupPath: string;\n  /** Size in bytes */\n  sizeBytes: number;\n  /** Backup version format */\n  version: string;\n  /** Optional description/note */\n  description?: string;\n}\n\n/**\n * Backup result.\n */\nexport interface BackupResult {\n  success: boolean;\n  metadata?: BackupMetadata;\n  error?: string;\n}\n\n/**\n * Restore result.\n */\nexport interface RestoreResult {\n  success: boolean;\n  restoredPath?: string;\n  error?: string;\n}\n\n/**\n * Backup options.\n */\nexport interface BackupOptions {\n  /** Custom backup directory (default: project/backups/) */\n  backupDir?: string;\n  /** Include description in backup metadata */\n  description?: string;\n  /** Exclude patterns (glob patterns to skip) */\n  excludePatterns?: string[];\n}\n\n/**\n * Restore options.\n */\nexport interface RestoreOptions {\n  /** Target directory for restore (default: original path) */\n  targetDir?: string;\n  /** Overwrite existing files */\n  overwrite?: boolean;\n}\n\n/**\n * Default backup directory name.\n */\nconst DEFAULT_BACKUP_DIR = \"backups\";\n\n/**\n * Backup file extension.\n */\nconst BACKUP_EXTENSION = \".zip\";\n\n/**\n * Backup version format.\n */\nconst BACKUP_VERSION = \"1.0\";\n\n/**\n * Default exclude patterns for backups.\n */\nconst DEFAULT_EXCLUDE_PATTERNS = [\n  \"node_modules/**\",\n  \".git/**\",\n  \"dist/**\",\n  \"build/**\",\n  \"__pycache__/**\",\n  \"*.pyc\",\n  \".env.local\",\n  \"backups/**\",\n];\n\n/**\n * Generate a unique backup ID.\n */\nconst generateBackupId = (): string => {\n  const timestamp = Date.now().toString(36);\n  const random = Math.random().toString(36).substring(2, 8);\n  return `backup_${timestamp}_${random}`;\n};\n\n/**\n * Generate backup filename with timestamp.\n */\nconst generateBackupFilename = (projectName: string): string => {\n  const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\");\n  const safeName = projectName.replace(/[^a-zA-Z0-9_-]/g, \"_\");\n  return `${timestamp}_${safeName}${BACKUP_EXTENSION}`;\n};\n\n/**\n * Create a backup of a project folder.\n *\n * In a real Tauri application, this would use Tauri's fs and zip APIs.\n * This implementation provides the interface and mock behavior.\n *\n * @param projectPath - Path to the project folder to backup\n * @param options - Backup options\n * @returns Backup result with metadata\n *\n * @example\n * ```typescript\n * const result = await createBackup(\"C:/Projects/my-app\", {\n *   description: \"Before major refactoring\"\n * });\n * if (result.success) {\n *   console.log(\"Backup created:\", result.metadata?.backupPath);\n * }\n * ```\n */\nexport async function createBackup(\n  projectPath: string,\n  options: BackupOptions = {}\n): Promise<BackupResult> {\n  try {\n    const {\n      backupDir = `${projectPath}/${DEFAULT_BACKUP_DIR}`,\n      description,\n      excludePatterns = DEFAULT_EXCLUDE_PATTERNS,\n    } = options;\n\n    // Extract project name from path\n    const pathParts = projectPath.replace(/\\\\/g, \"/\").split(\"/\");\n    const projectName = pathParts[pathParts.length - 1] || \"project\";\n\n    // Generate backup filename and path\n    const backupFilename = generateBackupFilename(projectName);\n    const backupPath = `${backupDir}/${backupFilename}`;\n\n    // In real implementation, would:\n    // 1. Ensure backup directory exists\n    // 2. Create ZIP archive of project folder\n    // 3. Apply exclude patterns\n    // 4. Write metadata file inside archive\n    // 5. Return actual file size\n\n    // Mock implementation - simulate async operation\n    await new Promise((resolve) => setTimeout(resolve, 100));\n\n    const metadata: BackupMetadata = {\n      id: generateBackupId(),\n      projectPath,\n      projectName,\n      timestamp: new Date().toISOString(),\n      backupPath,\n      sizeBytes: 0, // Would be actual file size\n      version: BACKUP_VERSION,\n      description,\n    };\n\n    // Log backup action (would be actual file operation in Tauri)\n    console.log(\"[Backup] Created backup:\", {\n      path: backupPath,\n      excludePatterns,\n      metadata,\n    });\n\n    return {\n      success: true,\n      metadata,\n    };\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\n    console.error(\"[Backup] Failed to create backup:\", errorMessage);\n    return {\n      success: false,\n      error: `Failed to create backup: ${errorMessage}`,\n    };\n  }\n}\n\n/**\n * Restore a project from a backup archive.\n *\n * @param backupPath - Path to the backup ZIP file\n * @param options - Restore options\n * @returns Restore result\n *\n * @example\n * ```typescript\n * const result = await restoreBackup(\"C:/Projects/my-app/backups/2024-01-15_my-app.zip\", {\n *   targetDir: \"C:/Projects/my-app-restored\"\n * });\n * if (result.success) {\n *   console.log(\"Restored to:\", result.restoredPath);\n * }\n * ```\n */\nexport async function restoreBackup(\n  backupPath: string,\n  options: RestoreOptions = {}\n): Promise<RestoreResult> {\n  try {\n    const { targetDir, overwrite = false } = options;\n\n    // In real implementation, would:\n    // 1. Verify backup file exists\n    // 2. Read metadata from archive\n    // 3. Determine target directory (original or specified)\n    // 4. Extract archive contents\n    // 5. Handle file conflicts based on overwrite option\n\n    // Mock implementation - simulate async operation\n    await new Promise((resolve) => setTimeout(resolve, 100));\n\n    // Determine restore path\n    const restorePath = targetDir || extractProjectPathFromBackup(backupPath);\n\n    // Log restore action (would be actual file operation in Tauri)\n    console.log(\"[Backup] Restoring backup:\", {\n      from: backupPath,\n      to: restorePath,\n      overwrite,\n    });\n\n    return {\n      success: true,\n      restoredPath: restorePath,\n    };\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\n    console.error(\"[Backup] Failed to restore backup:\", errorMessage);\n    return {\n      success: false,\n      error: `Failed to restore backup: ${errorMessage}`,\n    };\n  }\n}\n\n/**\n * List available backups for a project.\n *\n * @param projectPath - Path to the project folder\n * @param backupDir - Optional custom backup directory\n * @returns Array of backup metadata sorted by timestamp (newest first)\n *\n * @example\n * ```typescript\n * const backups = await listBackups(\"C:/Projects/my-app\");\n * console.log(`Found ${backups.length} backups`);\n * ```\n */\nexport async function listBackups(\n  projectPath: string,\n  backupDir?: string\n): Promise<BackupMetadata[]> {\n  try {\n    const targetDir = backupDir || `${projectPath}/${DEFAULT_BACKUP_DIR}`;\n\n    // In real implementation, would:\n    // 1. List files in backup directory\n    // 2. Filter for .zip files\n    // 3. Read metadata from each archive\n    // 4. Sort by timestamp\n\n    // Mock implementation\n    await new Promise((resolve) => setTimeout(resolve, 50));\n\n    // Return empty array for mock (would return actual backups)\n    console.log(\"[Backup] Listing backups in:\", targetDir);\n    return [];\n  } catch (error) {\n    console.error(\"[Backup] Failed to list backups:\", error);\n    return [];\n  }\n}\n\n/**\n * Delete a backup file.\n *\n * @param backupPath - Path to the backup file to delete\n * @returns True if deletion was successful\n *\n * @example\n * ```typescript\n * const deleted = await deleteBackup(\"C:/Projects/my-app/backups/old-backup.zip\");\n * ```\n */\nexport async function deleteBackup(backupPath: string): Promise<boolean> {\n  try {\n    // In real implementation, would delete the file\n    await new Promise((resolve) => setTimeout(resolve, 50));\n    console.log(\"[Backup] Deleted backup:\", backupPath);\n    return true;\n  } catch (error) {\n    console.error(\"[Backup] Failed to delete backup:\", error);\n    return false;\n  }\n}\n\n/**\n * Clean up old backups, keeping only the specified number of most recent.\n *\n * @param projectPath - Path to the project folder\n * @param keepCount - Number of recent backups to keep (default: 5)\n * @returns Number of backups deleted\n *\n * @example\n * ```typescript\n * const deleted = await cleanupOldBackups(\"C:/Projects/my-app\", 3);\n * console.log(`Cleaned up ${deleted} old backups`);\n * ```\n */\nexport async function cleanupOldBackups(\n  projectPath: string,\n  keepCount: number = 5\n): Promise<number> {\n  try {\n    const backups = await listBackups(projectPath);\n\n    if (backups.length <= keepCount) {\n      return 0;\n    }\n\n    // Sort by timestamp (newest first) and get backups to delete\n    const sortedBackups = [...backups].sort(\n      (a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\n    );\n\n    const toDelete = sortedBackups.slice(keepCount);\n    let deletedCount = 0;\n\n    for (const backup of toDelete) {\n      const success = await deleteBackup(backup.backupPath);\n      if (success) {\n        deletedCount++;\n      }\n    }\n\n    console.log(\"[Backup] Cleaned up\", deletedCount, \"old backups\");\n    return deletedCount;\n  } catch (error) {\n    console.error(\"[Backup] Failed to cleanup backups:\", error);\n    return 0;\n  }\n}\n\n/**\n * Verify backup integrity.\n *\n * @param backupPath - Path to the backup file\n * @returns True if backup is valid and not corrupted\n */\nexport async function verifyBackup(backupPath: string): Promise<boolean> {\n  try {\n    // In real implementation, would:\n    // 1. Open ZIP file\n    // 2. Verify checksum\n    // 3. Check metadata is present\n    // 4. Optionally verify file contents\n\n    await new Promise((resolve) => setTimeout(resolve, 100));\n    console.log(\"[Backup] Verified backup:\", backupPath);\n    return true;\n  } catch (error) {\n    console.error(\"[Backup] Backup verification failed:\", error);\n    return false;\n  }\n}\n\n/**\n * Extract project path from backup filename (helper function).\n */\nfunction extractProjectPathFromBackup(backupPath: string): string {\n  // Parse backup path to extract original project location\n  // Format: /path/to/project/backups/timestamp_projectname.zip\n  const parts = backupPath.replace(/\\\\/g, \"/\").split(\"/\");\n  const backupsIndex = parts.indexOf(DEFAULT_BACKUP_DIR);\n\n  if (backupsIndex > 0) {\n    return parts.slice(0, backupsIndex).join(\"/\");\n  }\n\n  // Fallback: return parent of backup file\n  return parts.slice(0, -1).join(\"/\");\n}\n\n/**\n * Export backup utilities as default object.\n */\nexport default {\n  createBackup,\n  restoreBackup,\n  listBackups,\n  deleteBackup,\n  cleanupOldBackups,\n  verifyBackup,\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\utils\\exporter.ts","messages":[{"ruleId":"@typescript-eslint/array-type","severity":2,"message":"Array type using 'Array<T>' is forbidden. Use 'T[]' instead.","line":182,"column":12,"nodeType":"TSTypeReference","messageId":"errorStringArray","endLine":187,"endColumn":5,"fix":{"range":[4354,4443],"text":"{\n    id: string;\n    name: string;\n    version: string;\n    category: string;\n  }[]"}},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":349,"column":24,"nodeType":"MemberExpression","messageId":"alwaysTruthy","endLine":349,"endColumn":39},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":377,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":377,"endColumn":40},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `any` typed value.","line":377,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":377,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `any` typed value.","line":377,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":377,"endColumn":27},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .trim on an `any` value.","line":377,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":377,"endColumn":27},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .split on an `any` value.","line":377,"column":30,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":377,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Computed name [key] resolves to an `any` value.","line":382,"column":52,"nodeType":"Identifier","messageId":"unsafeComputedMemberAccess","endLine":382,"endColumn":55},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'value' will use Object's default stringification format ('[object Object]') when stringified.","line":397,"column":19,"nodeType":"Identifier","messageId":"baseToString","endLine":397,"endColumn":24},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":409,"column":42,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":409,"endColumn":44,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[10288,10290],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":441,"column":31,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":441,"endColumn":33,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[11100,11102],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"number\" of template literal expression.","line":521,"column":33,"nodeType":"CallExpression","messageId":"invalidType","endLine":521,"endColumn":57},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":794,"column":37,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":794,"endColumn":39,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[20820,20822],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":795,"column":43,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":795,"endColumn":45,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[20869,20871],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]},{"ruleId":"@typescript-eslint/no-unnecessary-condition","severity":2,"message":"Unnecessary conditional, value is always truthy.","line":815,"column":11,"nodeType":"Identifier","messageId":"alwaysTruthy","endLine":815,"endColumn":17},{"ruleId":"@typescript-eslint/prefer-nullish-coalescing","severity":2,"message":"Prefer using nullish coalescing operator (`??`) instead of a logical or (`||`), as it is a safer operator.","line":927,"column":48,"nodeType":"Punctuator","messageId":"preferNullishOverOr","endLine":927,"endColumn":50,"suggestions":[{"messageId":"suggestNullish","data":{"equals":""},"fix":{"range":[24455,24457],"text":"??"},"desc":"Fix to nullish coalescing operator (`??`)."}]}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * D080 - src/utils/exporter.ts\n * ============================\n * Project export logic for generating standalone applications.\n *\n * Architecture: Plugin Option C (Tauri + React + Python subprocess via stdio IPC)\n * Dependencies: D006, D007, D075, D076, D077, D078, D079\n *\n * Rules:\n *   - NO hardcoded colors, spacing, or sizes\n *   - ALL styling via Tailwind classes referencing design tokens\n *\n * This module provides:\n *   - Project export to standalone Tauri application\n *   - Template rendering for configuration files\n *   - Plugin bundling and packaging\n *   - Build manifest generation\n *   - Export validation and error handling\n */\n\nimport { invoke } from \"@tauri-apps/api/tauri\";\nimport type { ProjectState, ProjectTheme, ProjectScreen } from \"../stores/projectStore\";\nimport type { Plugin } from \"../stores/pluginStore\";\n\n// ============================================\n// TYPES\n// ============================================\n\n/**\n * Export configuration options.\n */\nexport interface ExportConfig {\n  /** Output directory path */\n  outputDir: string;\n  /** Project name (used for folder/file names) */\n  projectName: string;\n  /** Build mode */\n  mode: \"development\" | \"production\";\n  /** Target platform */\n  platform: \"windows\" | \"macos\" | \"linux\" | \"all\";\n  /** Whether to include Python runtime */\n  includePythonRuntime: boolean;\n  /** Plugins to bundle */\n  bundledPlugins: string[];\n  /** Application icon path */\n  appIcon: string | null;\n  /** Version string */\n  version: string;\n  /** Publisher/author name */\n  publisher: string;\n  /** Application identifier (e.g., com.example.app) */\n  identifier: string;\n  /** Whether to minify output */\n  minify: boolean;\n  /** Whether to generate source maps */\n  sourceMaps: boolean;\n  /** Custom environment variables */\n  envVariables: Record<string, string>;\n}\n\n/**\n * Export manifest containing all generated files.\n */\nexport interface ExportManifest {\n  /** Export timestamp */\n  exportedAt: number;\n  /** Project name */\n  projectName: string;\n  /** Version */\n  version: string;\n  /** Generated files list */\n  files: ExportedFile[];\n  /** Total size in bytes */\n  totalSize: number;\n  /** Bundled plugins */\n  plugins: string[];\n  /** Build configuration used */\n  config: ExportConfig;\n}\n\n/**\n * Individual exported file info.\n */\nexport interface ExportedFile {\n  /** Relative path from export root */\n  path: string;\n  /** File size in bytes */\n  size: number;\n  /** File type category */\n  type: \"config\" | \"source\" | \"asset\" | \"plugin\" | \"binary\" | \"template\";\n  /** Whether file was generated from template */\n  generated: boolean;\n}\n\n/**\n * Export validation result.\n */\nexport interface ValidationResult {\n  /** Whether validation passed */\n  valid: boolean;\n  /** Validation errors */\n  errors: ValidationError[];\n  /** Validation warnings */\n  warnings: ValidationWarning[];\n}\n\n/**\n * Validation error.\n */\nexport interface ValidationError {\n  /** Error code */\n  code: string;\n  /** Error message */\n  message: string;\n  /** Related field or file */\n  field?: string;\n}\n\n/**\n * Validation warning.\n */\nexport interface ValidationWarning {\n  /** Warning code */\n  code: string;\n  /** Warning message */\n  message: string;\n  /** Related field or file */\n  field?: string;\n}\n\n/**\n * Export progress update.\n */\nexport interface ExportProgress {\n  /** Current step number */\n  step: number;\n  /** Total steps */\n  totalSteps: number;\n  /** Current step description */\n  description: string;\n  /** Progress percentage (0-100) */\n  percentage: number;\n  /** Current file being processed */\n  currentFile?: string;\n}\n\n/**\n * Export result.\n */\nexport interface ExportResult {\n  /** Whether export succeeded */\n  success: boolean;\n  /** Export manifest */\n  manifest: ExportManifest | null;\n  /** Output directory path */\n  outputPath: string;\n  /** Error message if failed */\n  error?: string;\n  /** Export duration in ms */\n  duration: number;\n}\n\n/**\n * Template variable context.\n */\nexport interface TemplateContext {\n  /** Project configuration */\n  project: {\n    name: string;\n    description: string;\n    version: string;\n    author: string;\n    identifier: string;\n  };\n  /** Build configuration */\n  build: ExportConfig;\n  /** Theme configuration */\n  theme: ProjectTheme;\n  /** Screens list */\n  screens: ProjectScreen[];\n  /** Plugins list */\n  plugins: Array<{\n    id: string;\n    name: string;\n    version: string;\n    category: string;\n  }>;\n  /** Environment variables */\n  env: Record<string, string>;\n  /** Timestamp */\n  timestamp: string;\n}\n\n// ============================================\n// CONSTANTS\n// ============================================\n\n/**\n * Default export configuration.\n */\nexport const DEFAULT_EXPORT_CONFIG: ExportConfig = {\n  outputDir: \"./dist\",\n  projectName: \"app\",\n  mode: \"production\",\n  platform: \"windows\",\n  includePythonRuntime: true,\n  bundledPlugins: [],\n  appIcon: null,\n  version: \"1.0.0\",\n  publisher: \"\",\n  identifier: \"com.appfactory.app\",\n  minify: true,\n  sourceMaps: false,\n  envVariables: {},\n};\n\n/**\n * Export steps for progress tracking.\n */\nconst EXPORT_STEPS = [\n  \"Validating project\",\n  \"Preparing output directory\",\n  \"Generating configuration files\",\n  \"Processing screens and components\",\n  \"Bundling plugins\",\n  \"Copying assets\",\n  \"Generating launcher scripts\",\n  \"Creating manifest\",\n  \"Finalizing export\",\n];\n\n// ============================================\n// VALIDATION\n// ============================================\n\n/**\n * Validate export configuration.\n */\nexport function validateExportConfig(config: ExportConfig): ValidationResult {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationWarning[] = [];\n\n  // Required fields\n  if (!config.outputDir || config.outputDir.trim() === \"\") {\n    errors.push({\n      code: \"MISSING_OUTPUT_DIR\",\n      message: \"Output directory is required\",\n      field: \"outputDir\",\n    });\n  }\n\n  if (!config.projectName || config.projectName.trim() === \"\") {\n    errors.push({\n      code: \"MISSING_PROJECT_NAME\",\n      message: \"Project name is required\",\n      field: \"projectName\",\n    });\n  } else if (!/^[a-zA-Z][a-zA-Z0-9_-]*$/.test(config.projectName)) {\n    errors.push({\n      code: \"INVALID_PROJECT_NAME\",\n      message: \"Project name must start with a letter and contain only letters, numbers, underscores, and hyphens\",\n      field: \"projectName\",\n    });\n  }\n\n  // Version validation\n  if (!config.version || !/^\\d+\\.\\d+\\.\\d+/.test(config.version)) {\n    warnings.push({\n      code: \"INVALID_VERSION\",\n      message: \"Version should follow semver format (e.g., 1.0.0)\",\n      field: \"version\",\n    });\n  }\n\n  // Identifier validation\n  if (!config.identifier || !/^[a-z][a-z0-9]*(\\.[a-z][a-z0-9]*)+$/.test(config.identifier)) {\n    warnings.push({\n      code: \"INVALID_IDENTIFIER\",\n      message: \"Identifier should be a valid reverse domain (e.g., com.example.app)\",\n      field: \"identifier\",\n    });\n  }\n\n  // Platform validation\n  const validPlatforms = [\"windows\", \"macos\", \"linux\", \"all\"];\n  if (!validPlatforms.includes(config.platform)) {\n    errors.push({\n      code: \"INVALID_PLATFORM\",\n      message: `Platform must be one of: ${validPlatforms.join(\", \")}`,\n      field: \"platform\",\n    });\n  }\n\n  // Mode validation\n  if (![\"development\", \"production\"].includes(config.mode)) {\n    errors.push({\n      code: \"INVALID_MODE\",\n      message: \"Mode must be 'development' or 'production'\",\n      field: \"mode\",\n    });\n  }\n\n  // Python runtime warning\n  if (!config.includePythonRuntime && config.bundledPlugins.length > 0) {\n    warnings.push({\n      code: \"NO_PYTHON_RUNTIME\",\n      message: \"Plugins require Python runtime to function\",\n      field: \"includePythonRuntime\",\n    });\n  }\n\n  return {\n    valid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * Validate project state for export.\n */\nexport function validateProjectState(state: Partial<ProjectState>): ValidationResult {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationWarning[] = [];\n\n  // Check for screens\n  const screens = state.screens ? Object.values(state.screens) : [];\n  if (screens.length === 0) {\n    errors.push({\n      code: \"NO_SCREENS\",\n      message: \"Project must have at least one screen\",\n      field: \"screens\",\n    });\n  }\n\n  // Check for default screen\n  const hasDefaultScreen = screens.some((s) => s.isDefault);\n  if (screens.length > 0 && !hasDefaultScreen) {\n    warnings.push({\n      code: \"NO_DEFAULT_SCREEN\",\n      message: \"No default screen set, first screen will be used\",\n      field: \"screens\",\n    });\n  }\n\n  // Check for unbound required slots\n  const components = state.components ? Object.values(state.components) : [];\n  for (const component of components) {\n    for (const slot of component.slots || []) {\n      if (slot.required && !slot.pluginId) {\n        warnings.push({\n          code: \"UNBOUND_REQUIRED_SLOT\",\n          message: `Component \"${component.name}\" has unbound required slot \"${slot.name}\"`,\n          field: `components.${component.id}.slots.${slot.id}`,\n        });\n      }\n    }\n  }\n\n  return {\n    valid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n// ============================================\n// TEMPLATE RENDERING\n// ============================================\n\n/**\n * Simple template renderer.\n * Replaces {{variable}} and {{variable.nested}} patterns.\n */\nexport function renderTemplate(template: string, context: TemplateContext): string {\n  return template.replace(/\\{\\{([^}]+)\\}\\}/g, (_match, path) => {\n    const keys = path.trim().split(\".\");\n    let value: unknown = context;\n\n    for (const key of keys) {\n      if (value && typeof value === \"object\" && key in value) {\n        value = (value as Record<string, unknown>)[key];\n      } else {\n        // Return empty string for undefined values\n        return \"\";\n      }\n    }\n\n    if (value === null || value === undefined) {\n      return \"\";\n    }\n\n    if (typeof value === \"object\") {\n      return JSON.stringify(value);\n    }\n\n    return String(value);\n  });\n}\n\n/**\n * Build template context from project state.\n */\nexport function buildTemplateContext(\n  projectState: Partial<ProjectState>,\n  plugins: Record<string, Plugin>,\n  config: ExportConfig\n): TemplateContext {\n  const metadata = projectState.metadata || {\n    name: config.projectName,\n    description: \"\",\n    version: config.version,\n    author: config.publisher,\n    createdAt: Date.now(),\n    modifiedAt: Date.now(),\n    filePath: null,\n    tags: [],\n  };\n\n  const screens = projectState.screens ? Object.values(projectState.screens) : [];\n\n  const pluginList = config.bundledPlugins\n    .map((id) => plugins[id])\n    .filter(Boolean)\n    .map((p) => ({\n      id: p.manifest.id,\n      name: p.manifest.name,\n      version: p.manifest.version,\n      category: p.manifest.category,\n    }));\n\n  return {\n    project: {\n      name: metadata.name,\n      description: metadata.description,\n      version: config.version,\n      author: config.publisher || metadata.author,\n      identifier: config.identifier,\n    },\n    build: config,\n    theme: projectState.theme || {\n      name: \"Default\",\n      primaryColor: \"#3b82f6\",\n      secondaryColor: \"#64748b\",\n      accentColor: \"#8b5cf6\",\n      backgroundColor: \"#ffffff\",\n      textColor: \"#0f172a\",\n      borderRadius: \"md\",\n      fontFamily: \"system-ui, -apple-system, sans-serif\",\n      darkMode: false,\n      customVariables: {},\n    },\n    screens,\n    plugins: pluginList,\n    env: config.envVariables,\n    timestamp: new Date().toISOString(),\n  };\n}\n\n// ============================================\n// FILE GENERATION\n// ============================================\n\n/**\n * Generate Tauri configuration from template context.\n */\nexport function generateTauriConfig(context: TemplateContext): string {\n  const config = {\n    $schema: \"https://raw.githubusercontent.com/tauri-apps/tauri/v1/core/tauri-config-schema/schema.json\",\n    build: {\n      beforeBuildCommand: \"npm run build\",\n      beforeDevCommand: \"npm run dev\",\n      devPath: \"http://localhost:5173\",\n      distDir: \"../dist\",\n    },\n    package: {\n      productName: context.project.name,\n      version: context.project.version,\n    },\n    tauri: {\n      allowlist: {\n        all: false,\n        shell: {\n          all: false,\n          open: true,\n          sidecar: true,\n          scope: [\n            {\n              name: \"plugin_host\",\n              sidecar: true,\n            },\n          ],\n        },\n        fs: {\n          all: false,\n          readFile: true,\n          writeFile: true,\n          readDir: true,\n          createDir: true,\n          removeDir: true,\n          removeFile: true,\n          renameFile: true,\n          exists: true,\n          scope: [\"$APP/*\", \"$RESOURCE/*\"],\n        },\n        path: {\n          all: true,\n        },\n        dialog: {\n          all: true,\n        },\n        process: {\n          all: false,\n          exit: true,\n          relaunch: true,\n        },\n      },\n      bundle: {\n        active: true,\n        category: \"DeveloperTool\",\n        copyright: `Copyright ${new Date().getFullYear()} ${context.project.author}`,\n        externalBin: [\"binaries/plugin_host\"],\n        icon: [\n          \"icons/32x32.png\",\n          \"icons/128x128.png\",\n          \"icons/128x128@2x.png\",\n          \"icons/icon.icns\",\n          \"icons/icon.ico\",\n        ],\n        identifier: context.project.identifier,\n        longDescription: context.project.description,\n        resources: [\"plugins/*\", \"config/*\"],\n        shortDescription: context.project.description.slice(0, 100),\n        targets: context.build.platform === \"all\" ? null : [context.build.platform === \"windows\" ? \"msi\" : \"dmg\"],\n        windows: {\n          certificateThumbprint: null,\n          digestAlgorithm: \"sha256\",\n          timestampUrl: \"\",\n        },\n      },\n      security: {\n        csp: \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\",\n      },\n      windows: [\n        {\n          fullscreen: false,\n          height: 720,\n          width: 1280,\n          resizable: true,\n          title: context.project.name,\n          center: true,\n          decorations: true,\n        },\n      ],\n    },\n  };\n\n  return JSON.stringify(config, null, 2);\n}\n\n/**\n * Generate plugins.yaml configuration.\n */\nexport function generatePluginsConfig(context: TemplateContext): string {\n  const lines: string[] = [\n    \"# Plugin Configuration\",\n    `# Generated: ${context.timestamp}`,\n    `# Project: ${context.project.name}`,\n    \"\",\n    \"# Plugin discovery paths\",\n    \"discovery:\",\n    \"  paths:\",\n    \"    - ./plugins\",\n    \"    - $HOME/.appfactory/plugins\",\n    \"\",\n    \"# Active plugins\",\n    \"plugins:\",\n  ];\n\n  for (const plugin of context.plugins) {\n    lines.push(`  - id: ${plugin.id}`);\n    lines.push(`    name: ${plugin.name}`);\n    lines.push(`    version: ${plugin.version}`);\n    lines.push(`    category: ${plugin.category}`);\n    lines.push(`    enabled: true`);\n    lines.push(\"\");\n  }\n\n  if (context.plugins.length === 0) {\n    lines.push(\"  # No plugins bundled\");\n  }\n\n  lines.push(\"\");\n  lines.push(\"# Health monitoring\");\n  lines.push(\"health:\");\n  lines.push(\"  enabled: true\");\n  lines.push(\"  interval: 30000  # ms\");\n  lines.push(\"  timeout: 5000    # ms\");\n  lines.push(\"  maxFailures: 3\");\n\n  return lines.join(\"\\n\");\n}\n\n/**\n * Generate Windows launcher batch script.\n */\nexport function generateWindowsLauncher(context: TemplateContext): string {\n  const lines: string[] = [\n    \"@echo off\",\n    `REM ${context.project.name} Launcher`,\n    `REM Generated: ${context.timestamp}`,\n    \"\",\n    \"REM Set application root\",\n    \"set APP_ROOT=%~dp0\",\n    \"\",\n    \"REM Set environment variables\",\n  ];\n\n  // Add custom environment variables\n  for (const [key, value] of Object.entries(context.env)) {\n    lines.push(`set ${key}=${value}`);\n  }\n\n  lines.push(\"\");\n  lines.push(\"REM Python path (if bundled)\");\n  if (context.build.includePythonRuntime) {\n    lines.push('set PYTHON_PATH=%APP_ROOT%python\\\\python.exe');\n    lines.push('set PATH=%APP_ROOT%python;%PATH%');\n  } else {\n    lines.push(\"REM Python runtime not bundled - using system Python\");\n  }\n\n  lines.push(\"\");\n  lines.push(\"REM Plugin path\");\n  lines.push('set PLUGIN_PATH=%APP_ROOT%plugins');\n  lines.push(\"\");\n  lines.push(\"REM Launch application\");\n  lines.push(`echo Starting ${context.project.name}...`);\n  lines.push(`start \"\" \"%APP_ROOT%${context.project.name}.exe\"`);\n  lines.push(\"\");\n  lines.push(\"exit /b 0\");\n\n  return lines.join(\"\\r\\n\");\n}\n\n/**\n * Generate environment file template.\n */\nexport function generateEnvFile(context: TemplateContext): string {\n  const lines: string[] = [\n    `# ${context.project.name} Environment Configuration`,\n    `# Generated: ${context.timestamp}`,\n    \"\",\n    \"# Application\",\n    `APP_NAME=${context.project.name}`,\n    `APP_VERSION=${context.project.version}`,\n    `APP_ENV=${context.build.mode}`,\n    \"\",\n    \"# Paths\",\n    \"PLUGIN_DIR=./plugins\",\n    \"CONFIG_DIR=./config\",\n    \"DATA_DIR=./data\",\n    \"LOG_DIR=./logs\",\n    \"\",\n    \"# Plugin Host\",\n    \"PLUGIN_HOST_LOG_LEVEL=info\",\n    \"PLUGIN_HOST_TIMEOUT=30000\",\n    \"\",\n    \"# IPC Settings\",\n    \"IPC_BUFFER_SIZE=65536\",\n    \"IPC_HEALTH_INTERVAL=30000\",\n    \"\",\n  ];\n\n  // Add custom environment variables\n  if (Object.keys(context.env).length > 0) {\n    lines.push(\"# Custom Variables\");\n    for (const [key, value] of Object.entries(context.env)) {\n      lines.push(`${key}=${value}`);\n    }\n    lines.push(\"\");\n  }\n\n  lines.push(\"# Add your custom environment variables below\");\n  lines.push(\"# KEY=value\");\n\n  return lines.join(\"\\n\");\n}\n\n// ============================================\n// EXPORT FUNCTIONS\n// ============================================\n\n/**\n * Export project to standalone application.\n *\n * @param projectState - Current project state\n * @param plugins - Available plugins\n * @param config - Export configuration\n * @param onProgress - Progress callback\n * @returns Export result\n */\nexport async function exportProject(\n  projectState: Partial<ProjectState>,\n  plugins: Record<string, Plugin>,\n  config: Partial<ExportConfig> = {},\n  onProgress?: (progress: ExportProgress) => void\n): Promise<ExportResult> {\n  const startTime = Date.now();\n  const exportConfig: ExportConfig = { ...DEFAULT_EXPORT_CONFIG, ...config };\n  const exportedFiles: ExportedFile[] = [];\n\n  // Report progress helper\n  const reportProgress = (step: number, currentFile?: string) => {\n    if (onProgress) {\n      onProgress({\n        step,\n        totalSteps: EXPORT_STEPS.length,\n        description: EXPORT_STEPS[step - 1] || \"Processing...\",\n        percentage: Math.round((step / EXPORT_STEPS.length) * 100),\n        currentFile,\n      });\n    }\n  };\n\n  try {\n    // Step 1: Validate project\n    reportProgress(1);\n    const configValidation = validateExportConfig(exportConfig);\n    if (!configValidation.valid) {\n      return {\n        success: false,\n        manifest: null,\n        outputPath: exportConfig.outputDir,\n        error: configValidation.errors.map((e) => e.message).join(\"; \"),\n        duration: Date.now() - startTime,\n      };\n    }\n\n    const projectValidation = validateProjectState(projectState);\n    if (!projectValidation.valid) {\n      return {\n        success: false,\n        manifest: null,\n        outputPath: exportConfig.outputDir,\n        error: projectValidation.errors.map((e) => e.message).join(\"; \"),\n        duration: Date.now() - startTime,\n      };\n    }\n\n    // Step 2: Prepare output directory\n    reportProgress(2);\n    await invoke(\"export_prepare_dir\", {\n      path: exportConfig.outputDir,\n      projectName: exportConfig.projectName,\n    });\n\n    // Step 3: Generate configuration files\n    reportProgress(3);\n    const context = buildTemplateContext(projectState, plugins, exportConfig);\n\n    // Generate tauri.conf.json\n    const tauriConfig = generateTauriConfig(context);\n    await invoke(\"export_write_file\", {\n      basePath: exportConfig.outputDir,\n      relativePath: \"src-tauri/tauri.conf.json\",\n      content: tauriConfig,\n    });\n    exportedFiles.push({\n      path: \"src-tauri/tauri.conf.json\",\n      size: new Blob([tauriConfig]).size,\n      type: \"config\",\n      generated: true,\n    });\n\n    // Generate plugins.yaml\n    reportProgress(3, \"plugins.yaml\");\n    const pluginsConfig = generatePluginsConfig(context);\n    await invoke(\"export_write_file\", {\n      basePath: exportConfig.outputDir,\n      relativePath: \"config/plugins.yaml\",\n      content: pluginsConfig,\n    });\n    exportedFiles.push({\n      path: \"config/plugins.yaml\",\n      size: new Blob([pluginsConfig]).size,\n      type: \"config\",\n      generated: true,\n    });\n\n    // Step 4: Process screens and components\n    reportProgress(4);\n    const screensData = JSON.stringify({\n      screens: projectState.screens || {},\n      components: projectState.components || {},\n      theme: projectState.theme,\n    }, null, 2);\n    await invoke(\"export_write_file\", {\n      basePath: exportConfig.outputDir,\n      relativePath: \"config/project.json\",\n      content: screensData,\n    });\n    exportedFiles.push({\n      path: \"config/project.json\",\n      size: new Blob([screensData]).size,\n      type: \"config\",\n      generated: true,\n    });\n\n    // Step 5: Bundle plugins\n    reportProgress(5);\n    for (const pluginId of exportConfig.bundledPlugins) {\n      reportProgress(5, pluginId);\n      const plugin = plugins[pluginId];\n      if (plugin) {\n        await invoke(\"export_copy_plugin\", {\n          sourcePath: plugin.path,\n          destPath: `${exportConfig.outputDir}/plugins/${pluginId}`,\n        });\n        exportedFiles.push({\n          path: `plugins/${pluginId}`,\n          size: 0, // Size determined by backend\n          type: \"plugin\",\n          generated: false,\n        });\n      }\n    }\n\n    // Step 6: Copy assets\n    reportProgress(6);\n    if (exportConfig.appIcon) {\n      await invoke(\"export_copy_asset\", {\n        sourcePath: exportConfig.appIcon,\n        destPath: `${exportConfig.outputDir}/icons`,\n      });\n    }\n\n    // Step 7: Generate launcher scripts\n    reportProgress(7);\n    const launcherScript = generateWindowsLauncher(context);\n    await invoke(\"export_write_file\", {\n      basePath: exportConfig.outputDir,\n      relativePath: `start.bat`,\n      content: launcherScript,\n    });\n    exportedFiles.push({\n      path: \"start.bat\",\n      size: new Blob([launcherScript]).size,\n      type: \"template\",\n      generated: true,\n    });\n\n    // Generate .env file\n    const envFile = generateEnvFile(context);\n    await invoke(\"export_write_file\", {\n      basePath: exportConfig.outputDir,\n      relativePath: \".env\",\n      content: envFile,\n    });\n    exportedFiles.push({\n      path: \".env\",\n      size: new Blob([envFile]).size,\n      type: \"config\",\n      generated: true,\n    });\n\n    // Step 8: Create manifest\n    reportProgress(8);\n    const totalSize = exportedFiles.reduce((sum, f) => sum + f.size, 0);\n    const manifest: ExportManifest = {\n      exportedAt: Date.now(),\n      projectName: exportConfig.projectName,\n      version: exportConfig.version,\n      files: exportedFiles,\n      totalSize,\n      plugins: exportConfig.bundledPlugins,\n      config: exportConfig,\n    };\n\n    const manifestJson = JSON.stringify(manifest, null, 2);\n    await invoke(\"export_write_file\", {\n      basePath: exportConfig.outputDir,\n      relativePath: \"export-manifest.json\",\n      content: manifestJson,\n    });\n\n    // Step 9: Finalize\n    reportProgress(9);\n\n    return {\n      success: true,\n      manifest,\n      outputPath: exportConfig.outputDir,\n      duration: Date.now() - startTime,\n    };\n  } catch (err) {\n    const errorMsg = err instanceof Error ? err.message : String(err);\n    return {\n      success: false,\n      manifest: null,\n      outputPath: exportConfig.outputDir,\n      error: errorMsg,\n      duration: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * Estimate export size in bytes.\n */\nexport function estimateExportSize(\n  projectState: Partial<ProjectState>,\n  _plugins: Record<string, Plugin>,\n  config: Partial<ExportConfig>\n): number {\n  let estimatedSize = 0;\n\n  // Base application size (approximately 50MB for Tauri)\n  estimatedSize += 50 * 1024 * 1024;\n\n  // Python runtime if included (approximately 100MB)\n  if (config.includePythonRuntime !== false) {\n    estimatedSize += 100 * 1024 * 1024;\n  }\n\n  // Plugin estimates (approximately 5MB each)\n  const bundledPlugins = config.bundledPlugins || [];\n  estimatedSize += bundledPlugins.length * 5 * 1024 * 1024;\n\n  // Project data (screens, components) - rough estimate\n  const screensCount = projectState.screens ? Object.keys(projectState.screens).length : 0;\n  const componentsCount = projectState.components ? Object.keys(projectState.components).length : 0;\n  estimatedSize += (screensCount + componentsCount) * 10 * 1024;\n\n  return estimatedSize;\n}\n\n/**\n * Format byte size to human-readable string.\n */\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return \"0 B\";\n\n  const units = [\"B\", \"KB\", \"MB\", \"GB\"];\n  const i = Math.floor(Math.log(bytes) / Math.log(1024));\n  const size = bytes / Math.pow(1024, i);\n\n  return `${size.toFixed(i > 0 ? 1 : 0)} ${units[i]}`;\n}\n\n/**\n * Get export progress percentage from step.\n */\nexport function getProgressPercentage(step: number): number {\n  return Math.min(100, Math.round((step / EXPORT_STEPS.length) * 100));\n}\n\n/**\n * Get export step description.\n */\nexport function getStepDescription(step: number): string {\n  return EXPORT_STEPS[step - 1] || \"Processing...\";\n}\n\nexport default {\n  exportProject,\n  validateExportConfig,\n  validateProjectState,\n  estimateExportSize,\n  formatFileSize,\n  generateTauriConfig,\n  generatePluginsConfig,\n  generateWindowsLauncher,\n  generateEnvFile,\n  renderTemplate,\n  buildTemplateContext,\n  DEFAULT_EXPORT_CONFIG,\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\utils\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\utils\\tauriUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\src\\utils\\tokenMap.ts","messages":[{"ruleId":"@typescript-eslint/no-inferrable-types","severity":2,"message":"Type string trivially inferred from a string literal, remove type annotation.","line":100,"column":5,"nodeType":"AssignmentPattern","messageId":"noInferrableType","endLine":100,"endColumn":43,"fix":{"range":[3272,3280],"text":""}},{"ruleId":"@typescript-eslint/prefer-regexp-exec","severity":2,"message":"Use the `RegExp#exec()` method instead.","line":131,"column":26,"nodeType":"Identifier","messageId":"regExpExecOverStringMatch","endLine":131,"endColumn":31,"fix":{"range":[4194,4266],"text":"/^(\\d+px)\\s+(solid|dashed|dotted)\\s+(#[0-9a-fA-F]{3,6})$/i.exec(border)"}}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\r\n * src/utils/tokenMap.ts\r\n * =====================\r\n * Maps hex color values to CSS design token variables.\r\n * \r\n * This is the enforcement layer that converts any hardcoded hex colors\r\n * to their design token equivalents at runtime.\r\n * \r\n * Usage:\r\n *   import { resolveColor, resolveBorder } from '../utils/tokenMap';\r\n *   style={{ backgroundColor: resolveColor(props.backgroundColor) }}\r\n */\r\n\r\n/**\r\n * Maps hex colors to CSS variable tokens.\r\n * \r\n * IMPORTANT: Sidebar/dark colors map to PRIMARY shades (not neutral)\r\n * so they reflect the user's selected theme color.\r\n */\r\nexport const HEX_TO_TOKEN: Record<string, string> = {\r\n    // Dark backgrounds (sidebars) -> Use PRIMARY dark shades for theme consistency\r\n    \"#1e1e2e\": \"var(--color-primary-950)\",\r\n    \"#18181b\": \"var(--color-primary-950)\",\r\n    \"#1a1a2e\": \"var(--color-primary-950)\",\r\n    \"#16213e\": \"var(--color-primary-950)\",\r\n    \"#1e1e1e\": \"var(--color-primary-900)\",\r\n    \"#27272a\": \"var(--color-primary-800)\",\r\n\r\n    // Light backgrounds\r\n    \"#ffffff\": \"var(--bg-primary)\",\r\n    \"#fff\": \"var(--bg-primary)\",\r\n    \"#fafafa\": \"var(--color-neutral-50)\",\r\n    \"#f9fafb\": \"var(--color-neutral-50)\",\r\n    \"#f8fafc\": \"var(--color-neutral-50)\",\r\n    \"#f4f4f5\": \"var(--color-neutral-100)\",\r\n    \"#f3f4f6\": \"var(--color-neutral-100)\",\r\n\r\n    // Borders\r\n    \"#e5e5e5\": \"var(--border-primary)\",\r\n    \"#e4e4e7\": \"var(--border-primary)\",\r\n    \"#e2e8f0\": \"var(--border-primary)\",\r\n    \"#d4d4d8\": \"var(--border-secondary)\",\r\n\r\n    // Primary/Accent colors\r\n    \"#6366f1\": \"var(--color-primary-500)\",\r\n    \"#3b82f6\": \"var(--color-primary-500)\",\r\n    \"#2563eb\": \"var(--color-primary-600)\",\r\n    \"#1d4ed8\": \"var(--color-primary-700)\",\r\n\r\n    // Text colors\r\n    \"#71717a\": \"var(--text-tertiary)\",\r\n    \"#52525b\": \"var(--text-secondary)\",\r\n    \"#3f3f46\": \"var(--color-neutral-700)\",\r\n\r\n    // Status colors\r\n    \"#22c55e\": \"var(--color-success-500)\",\r\n    \"#ef4444\": \"var(--color-error-500)\",\r\n    \"#f59e0b\": \"var(--color-warning-500)\",\r\n};\r\n\r\n/**\r\n * Semantic color tokens that templates should use instead of hex values.\r\n * These map directly to CSS variables in design_tokens.css\r\n */\r\nexport const SEMANTIC_TOKENS: Record<string, string> = {\r\n    // Backgrounds\r\n    \"bg-primary\": \"var(--bg-primary)\",\r\n    \"bg-secondary\": \"var(--bg-secondary)\",\r\n    \"bg-tertiary\": \"var(--bg-tertiary)\",\r\n    \"bg-inverse\": \"var(--bg-inverse)\",\r\n\r\n    // Sidebar/Dark\r\n    \"neutral-900\": \"var(--color-neutral-900)\",\r\n    \"neutral-950\": \"var(--color-neutral-950)\",\r\n    \"neutral-800\": \"var(--color-neutral-800)\",\r\n\r\n    // Light\r\n    \"neutral-50\": \"var(--color-neutral-50)\",\r\n    \"neutral-100\": \"var(--color-neutral-100)\",\r\n\r\n    // Borders\r\n    \"border-primary\": \"var(--border-primary)\",\r\n    \"border-secondary\": \"var(--border-secondary)\",\r\n\r\n    // Primary\r\n    \"primary-500\": \"var(--color-primary-500)\",\r\n    \"primary-600\": \"var(--color-primary-600)\",\r\n};\r\n\r\n/**\r\n * Resolve a color value to a CSS variable.\r\n * Accepts hex colors, semantic tokens, or CSS variables.\r\n * \r\n * @param color - The color to resolve (hex, semantic token, or CSS var)\r\n * @param fallback - Fallback value if resolution fails\r\n * @returns CSS variable string\r\n */\r\nexport function resolveColor(\r\n    color: string | undefined,\r\n    fallback: string = \"var(--bg-primary)\"\r\n): string {\r\n    if (!color) return fallback;\r\n\r\n    // Already a CSS variable\r\n    if (color.startsWith(\"var(\")) return color;\r\n\r\n    // Check semantic tokens first\r\n    const semantic = SEMANTIC_TOKENS[color];\r\n    if (semantic) return semantic;\r\n\r\n    // Check hex mapping\r\n    const normalized = color.toLowerCase();\r\n    const token = HEX_TO_TOKEN[normalized];\r\n    if (token) return token;\r\n\r\n    // Return original if no mapping found (allows gradual migration)\r\n    return color;\r\n}\r\n\r\n/**\r\n * Resolve a border value to use CSS variable for color.\r\n * Parses border shorthand like \"1px solid #e5e5e5\"\r\n * \r\n * @param border - Border shorthand string\r\n * @returns Border string with resolved color\r\n */\r\nexport function resolveBorder(border: string | undefined): string | undefined {\r\n    if (!border) return undefined;\r\n\r\n    // Match pattern: \"Xpx solid #color\"\r\n    const match = border.match(/^(\\d+px)\\s+(solid|dashed|dotted)\\s+(#[0-9a-fA-F]{3,6})$/i);\r\n    if (match) {\r\n        const [, size, style, color] = match;\r\n        const resolvedColor = resolveColor(color, \"var(--border-primary)\");\r\n        return `${size} ${style} ${resolvedColor}`;\r\n    }\r\n\r\n    return border;\r\n}\r\n\r\n/**\r\n * Resolve box shadow to use CSS variable.\r\n * \r\n * @param shadow - Shadow string or undefined\r\n * @returns CSS variable for shadow\r\n */\r\nexport function resolveShadow(shadow: string | undefined): string | undefined {\r\n    if (!shadow) return undefined;\r\n\r\n    // Map common shadows to tokens\r\n    if (shadow.includes(\"0 4px 20px\") || shadow.includes(\"0 10px 40px\")) {\r\n        return \"var(--shadow-lg)\";\r\n    }\r\n    if (shadow.includes(\"0 4px 6px\")) {\r\n        return \"var(--shadow-md)\";\r\n    }\r\n    if (shadow.includes(\"0 1px 2px\")) {\r\n        return \"var(--shadow-sm)\";\r\n    }\r\n\r\n    return shadow;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\anujd\\Documents\\01_AI\\173_piovisstudio\\app_factory\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
